(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     37500,       1052]
NotebookOptionsPosition[     34145,        999]
NotebookOutlinePosition[     34542,       1015]
CellTagsIndexPosition[     34499,       1012]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"98f2bbb4-6ed0-4270-91dd-7f208479904c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<polyline`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.891721845149164*^9, 3.891721855926444*^9}, 
   3.8917240187754307`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"54a3738f-cfeb-44ba-b992-e30076371279"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "255839"}], "/", "checking"}], "-", "if", "-", 
     "two", "-", "line", "-", "segments", "-", "intersect"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Lukasz", "'"}], "s", " ", "solution", " ", "benchmarked", " ", 
    "by", " ", "LouisB"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"segmentIntersectionQ", "[", 
      RowBox[{
       RowBox[{"_", "[", 
        RowBox[{"u1_", ",", "u2_"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"And", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"u2", "-", "u1"}], ",", 
            RowBox[{"v1", "-", "u2"}]}], "}"}], "]"}], " ", 
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"u2", "-", "u1"}], ",", 
            RowBox[{"v2", "-", "u2"}]}], "}"}], "]"}]}], "<", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v2", "-", "v1"}], ",", 
            RowBox[{"u1", "-", "v2"}]}], "}"}], "]"}], " ", 
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v2", "-", "v1"}], ",", 
            RowBox[{"u2", "-", "v2"}]}], "}"}], "]"}]}], "<", "0"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"www", ".", "wolframcloud", ".", "com"}], "/", "objects"}], 
        "/", "demonstrations"}], "/", "SegmentIntersection"}], "-", 
      RowBox[{"source", ".", "nb"}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineIntersectionPoint", "[", 
     RowBox[{
      RowBox[{"_", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ",", 
      RowBox[{"_", "[", 
       RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"c", "-", "d"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", "b"}], ")"}]}]}], 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "-", "b"}], ",", 
        RowBox[{"c", "-", "d"}]}], "}"}], "]"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.891693161515649*^9, 3.8916931991423883`*^9}, {
  3.8916932474905777`*^9, 3.891693249038147*^9}, {3.891693920864904*^9, 
  3.891693999560816*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"41a7dfc4-fe2c-435c-b064-bc82ee4cf0ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"leftEnd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rightEnd", "=", 
   RowBox[{"{", 
    RowBox[{"Infinity", ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.891721611898514*^9, 3.891721622842593*^9}, {
  3.891721909358383*^9, 3.891721912580418*^9}, {3.8917250495757637`*^9, 
  3.8917250529842663`*^9}},ExpressionUUID->"684ce371-9ded-4344-9528-\
9ef2d05e4437"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Event", "-", 
    RowBox[{"based", " ", "merging", " ", "of", " ", "polylines"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Invariant", ":", " ", 
     RowBox[{
     "All", " ", "events", " ", "on", " ", "the", " ", "left", " ", "of", " ",
       "a1", " ", "has", " ", "been", " ", "processed"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"and", " ", 
     RowBox[{"it", "'"}], "s", " ", "time", " ", "to", " ", "process", " ", 
     "a1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "and", " ", "b1", " ", "is", " ", "right", " ", "before", " ", "a1", " ", 
     "and", " ", "b2", " ", "is", " ", "right", " ", "after", " ", "a1"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"emitEvents", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"aHead_", "[", 
       RowBox[{"a1_", ",", 
        RowBox[{"a2", ":", 
         RowBox[{"{", 
          RowBox[{"a2x_", ",", "_"}], "}"}]}], ",", "aRest___"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"b", ":", 
      RowBox[{"bHead_", "[", 
       RowBox[{"b1_", ",", 
        RowBox[{"b2", ":", 
         RowBox[{"{", 
          RowBox[{"b2x_", ",", "_"}], "}"}]}], ",", "bRest___"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sow", "[", 
       RowBox[{"aHead", "[", "a1", "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"segmentIntersectionQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "a2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sow", "[", 
          RowBox[{"cross", "[", 
           RowBox[{"lineIntersectionPoint", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a1", ",", "a2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], "]"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a2x", "<=", "b2x"}], ",", "\[IndentingNewLine]", 
        RowBox[{"emitEvents", "[", 
         RowBox[{
          RowBox[{"aHead", "[", 
           RowBox[{"a2", ",", "aRest"}], "]"}], ",", "b"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"emitEvents", "[", 
         RowBox[{
          RowBox[{"bHead", "[", 
           RowBox[{"b2", ",", "bRest"}], "]"}], ",", "a"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891699866291319*^9, 3.891699873897546*^9}, {
   3.891699962896124*^9, 3.89169998447267*^9}, {3.8917002957808323`*^9, 
   3.8917003352406883`*^9}, {3.891700391838681*^9, 3.891700442271521*^9}, {
   3.8917005517987747`*^9, 3.8917005988198566`*^9}, {3.8917006301275263`*^9, 
   3.8917006785800867`*^9}, {3.891713977441461*^9, 3.8917139852170677`*^9}, {
   3.891714166469623*^9, 3.891714258634136*^9}, {3.891714573531259*^9, 
   3.891714601302959*^9}, 3.891714670266717*^9, {3.8917148802151947`*^9, 
   3.891714882327449*^9}, {3.8917150098006163`*^9, 3.891715011988063*^9}, {
   3.891715055828371*^9, 3.891715085310997*^9}, {3.8917151202165823`*^9, 
   3.891715147771047*^9}, {3.891721923341997*^9, 3.891721924154611*^9}, {
   3.891722043330904*^9, 3.891722107337015*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"5ea22067-ab47-4645-b62d-8fb300cc63d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pad", "[", 
    RowBox[{"aHead_", "[", "aSeq___", "]"}], "]"}], ":=", 
   RowBox[{"aHead", "[", 
    RowBox[{"leftEnd", ",", "aSeq", ",", "rightEnd"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eventList", "[", 
    RowBox[{"aList_List", ",", "bList_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Last", "@", 
    RowBox[{"Last", "@", 
     RowBox[{"Reap", "[", 
      RowBox[{"emitEvents", "[", 
       RowBox[{
        RowBox[{"pad", "[", 
         RowBox[{"a", "@@", "aList"}], "]"}], ",", 
        RowBox[{"pad", "[", 
         RowBox[{"b", "@@", "bList"}], "]"}]}], "]"}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.891721993483642*^9, 3.891722031855424*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ad8b830a-4fd4-456e-a563-02e16375f95e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"takeA", "[", 
   RowBox[{
    RowBox[{"a", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeA", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeA", "[", 
   RowBox[{
    RowBox[{"cross", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeB", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeA", "[", 
   RowBox[{"_", ",", "rest___"}], "]"}], ":=", 
  RowBox[{"takeA", "[", "rest", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"takeA", "[", "]"}], ":=", 
   RowBox[{"{", "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", 
   RowBox[{
    RowBox[{"b", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeB", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", 
   RowBox[{
    RowBox[{"cross", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeA", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", 
   RowBox[{"_", ",", "rest___"}], "]"}], ":=", 
  RowBox[{"takeB", "[", "rest", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", "]"}], ":=", 
  RowBox[{"{", "}"}]}]}], "Input",
 CellChangeTimes->{{3.891715712111375*^9, 3.891715792491377*^9}, {
  3.8917158789162703`*^9, 3.891715978067725*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b73cfce8-e3e2-4ecb-9112-e0f2ecda2fa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"merge", "[", 
   RowBox[{"a_List", ",", "b_List"}], "]"}], ":=", 
  RowBox[{"Rest", "@", 
   RowBox[{"(", 
    RowBox[{"takeA", "@@", 
     RowBox[{"eventList", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.891722196611891*^9, 3.89172219879989*^9}, {
  3.891723495913425*^9, 3.891723567700529*^9}, {3.891724804062018*^9, 
  3.891724807695531*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"505a1b1b-8666-4d56-9c6b-b97bf7fb88af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.891723578885873*^9, 3.891723579854526*^9}, 
   3.891724029718731*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"b1ce9837-29ed-427c-abdb-ff6cfcbbc7f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sofa", "=", 
   RowBox[{"Sofa", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Pi", "/", "8"}], ",", 
       RowBox[{"Pi", "/", "4"}], ",", 
       RowBox[{"3", 
        RowBox[{"Pi", "/", "8"}]}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"i", "*", 
            RowBox[{"Pi", "/", "4"}]}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"i", "*", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], "}"}], "/", "Pi"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.891726163624802*^9, 3.891726223148179*^9}, {
  3.891726641041205*^9, 3.891726642179634*^9}, {3.891727726479411*^9, 
  3.8917277577151937`*^9}, {3.891728330066983*^9, 3.891728337932173*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"f40b435d-8f32-4b48-9e38-effc87b634fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "[", 
   RowBox[{"s", ":", 
    RowBox[{"Sofa", "[", 
     RowBox[{"angles_", ",", "_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Length", "[", "angles", "]"}]}]], "Input",
 CellChangeTimes->{{3.891726244933711*^9, 3.891726272416803*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"0921adb5-c21d-422e-bd85-0c1b49778d76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"s", ":", 
     RowBox[{"Sofa", "[", 
      RowBox[{"angles_", ",", "_"}], "]"}]}], "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"angles", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"i", ",", 
        RowBox[{"n", "[", "s", "]"}]}], "]"}], "+", "1"}], "]"}], "]"}], "+", 
   
   RowBox[{
    RowBox[{"Quotient", "[", 
     RowBox[{"i", ",", 
      RowBox[{"n", "[", "s", "]"}]}], "]"}], "*", 
    RowBox[{"Pi", "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8917264505914707`*^9, 3.891726487729857*^9}, {
  3.891728244527006*^9, 3.8917282590548983`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"7d8016a4-09dc-4079-8e7c-2af34de475b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"s", ":", 
     RowBox[{"Sofa", "[", 
      RowBox[{"angles_", ",", "_"}], "]"}]}], "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"angle", "[", "s", "]"}], "[", "i", "]"}], "]"}], ",", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"angle", "[", "s", "]"}], "[", "i", "]"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"s", ":", 
     RowBox[{"Sofa", "[", 
      RowBox[{"angles_", ",", "_"}], "]"}]}], "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"angle", "[", "s", "]"}], "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"angle", "[", "s", "]"}], "[", "i", "]"}], "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.891726387889677*^9, 3.891726427449627*^9}, {
  3.89172649950285*^9, 3.891726521014852*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"782889e0-d902-4ebe-bd69-6484946458d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"Sofa", "[", 
     RowBox[{"_", ",", "xlist_"}], "]"}], "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"xlist", "[", 
   RowBox[{"[", 
    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], "+", 
   RowBox[{
    RowBox[{"u", "[", "s", "]"}], "[", "i", "]"}], "+", 
   RowBox[{
    RowBox[{"v", "[", "s", "]"}], "[", "i", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.89172703109188*^9, 3.891727050105144*^9}, {
  3.8917270866665497`*^9, 3.8917270869093533`*^9}, {3.891727122593464*^9, 
  3.891727148081272*^9}, {3.891727931571208*^9, 3.891727932564968*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"d3e794cc-c8c3-463e-808b-dd816b045788"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"0", "<=", "i", "<", 
     RowBox[{"n", "[", "s", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], ".", 
      RowBox[{
       RowBox[{"u", "[", "s", "]"}], "[", "i", "]"}]}], "+", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"2", "*", 
      RowBox[{"n", "[", "s", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "s", "]"}], "[", 
       RowBox[{"i", "-", 
        RowBox[{"n", "[", "s", "]"}]}], "]"}], ".", 
      RowBox[{
       RowBox[{"v", "[", "s", "]"}], "[", "i", "]"}]}], "+", "1"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.891726668558313*^9, 3.891726709597054*^9}, {
   3.891726769014841*^9, 3.89172691792914*^9}, 3.891727006169075*^9, {
   3.891727057521538*^9, 3.89172707535429*^9}, {3.891727904745564*^9, 
   3.891727905001062*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"52c748cc-43c2-4971-8034-06a718c147cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"p", "[", "s", "]"}], "[", 
   RowBox[{"i", "+", 
    RowBox[{"n", "[", "s", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8917271005326157`*^9, 3.891727111605679*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"2812e645-6bfa-45c2-a820-105f5dcb12d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lA", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"HalfLine", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "[", "s", "]"}], "[", "i", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", "s", "]"}], "[", "i", "]"}], "-", 
      RowBox[{
       RowBox[{"v", "[", "s", "]"}], "[", "i", "]"}]}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lC", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"HalfLine", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "[", "s", "]"}], "[", "i", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", "s", "]"}], "[", "i", "]"}], "-", 
      RowBox[{
       RowBox[{"u", "[", "s", "]"}], "[", "i", "]"}]}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lB", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"HalfLine", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], "-", 
      RowBox[{
       RowBox[{"v", "[", "s", "]"}], "[", "i", "]"}]}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lD", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"HalfLine", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], "-", 
      RowBox[{
       RowBox[{"u", "[", "s", "]"}], "[", "i", "]"}]}]}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.891727177504818*^9, 3.891727197691299*^9}, {
  3.891727772059155*^9, 3.8917278510815783`*^9}, {3.89172866289191*^9, 
  3.891728671049595*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"b33bb66c-c351-40cb-85a2-01aa47a7bd2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"lA", "[", "sofa", "]"}], "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"2321693e-57a9-44f8-b641-88c1da8dfef4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"HalfLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "+", 
         FractionBox["1", "\[Pi]"]}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "+", 
         FractionBox["1", "\[Pi]"]}], ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
   
   RowBox[{"HalfLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SqrtBox["2"], " ", "\[Pi]"}]], "+", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Pi]", "8"], "]"}], "-", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SqrtBox["2"], " ", "\[Pi]"}]], "+", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Pi]", "8"], "]"}], "+", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SqrtBox["2"], " ", "\[Pi]"}]], "+", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SqrtBox["2"], " ", "\[Pi]"}]], "+", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"HalfLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         SqrtBox["2"], "+", 
         FractionBox["1", "\[Pi]"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SqrtBox["2"]]}], "+", 
         SqrtBox["2"], "+", 
         FractionBox["1", "\[Pi]"]}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"HalfLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{
            SqrtBox["2"], " ", "\[Pi]"}]]}], "-", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Pi]", "8"], "]"}], "+", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SqrtBox["2"], " ", "\[Pi]"}]], "+", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Pi]", "8"], "]"}], "+", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{
            SqrtBox["2"], " ", "\[Pi]"}]]}], "+", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SqrtBox["2"], " ", "\[Pi]"}]], "+", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"HalfLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         FractionBox["1", "\[Pi]"]}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "\[Pi]"]}], ",", "1"}], "}"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.891727874676373*^9, {3.8917279117366953`*^9, 3.891727936815145*^9}, 
   3.8917284768080397`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"2fb1f978-e597-4788-ada7-6790eea3032d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineIntersectionPoint", "[", 
   RowBox[{
    RowBox[{"_", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ",", 
    RowBox[{"_", "[", 
     RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"c", "-", "d"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}]}], 
   RowBox[{"Det", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "-", "b"}], ",", 
      RowBox[{"c", "-", "d"}]}], "}"}], "]"}]]}]], "Input",
 CellChangeTimes->{{3.891693161515649*^9, 3.8916931991423883`*^9}, {
  3.8916932474905777`*^9, 3.891693249038147*^9}, {3.891693920864904*^9, 
  3.891693999560816*^9}, {3.8917286012522163`*^9, 3.891728602455373*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"9de541a7-3ab5-4407-9f8e-595928ea8d91"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", "s_Sofa", "]"}], "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{
       RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}]}], "<=", "0"}], ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lineIntersectionPoint", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"lD", "[", "s", "]"}], "[", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "s", "]"}], "[", "i", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lineIntersectionPoint", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"lB", "[", "s", "]"}], "[", "]"}]}], "]"}], ","}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.891728535779346*^9, 3.891728565410287*^9}, {
  3.8917286420267*^9, 3.891728649675796*^9}, {3.891728770574836*^9, 
  3.8917288096088867`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"55575aeb-d287-4ac3-a0e5-4f5b680306b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lA", "[", "sofa", "]"}], "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lB", "[", "sofa", "]"}], "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lC", "[", "sofa", "]"}], "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lD", "[", "sofa", "]"}], "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.891727859532031*^9, 3.8917278710338507`*^9}, {
  3.891728497786047*^9, 3.8917285195049562`*^9}, {3.891728743466254*^9, 
  3.891728750637287*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"fdcb886d-68fd-45f5-bfa7-b3fc46565459"],

Cell[BoxData[
 GraphicsBox[{{
    TagBox[
     ConicHullRegionBox[
      NCache[{{1 + Pi^(-1), 1}}, {{1.3183098861837907`, 1}}], {{0, -1}}],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{2^Rational[-1, 2]/Pi + Cos[Rational[1, 8] Pi] - Sin[
         Rational[1, 8] Pi], 2^Rational[-1, 2]/Pi + Cos[Rational[1, 8] Pi] + 
         Sin[Rational[1, 8] Pi]}}, {{0.7662751791854734, 1.531642043915653}}],
       NCache[{{Sin[Rational[1, 8] Pi], -Cos[Rational[1, 8] Pi]}}, {{
       0.3826834323650898, -0.9238795325112867}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{0, 2^Rational[1, 2] + Pi^(-1)}}, {{0, 1.732523448556886}}], 
      NCache[{{2^Rational[-1, 2], -2^Rational[-1, 2]}}, {{
       0.7071067811865475, -0.7071067811865475}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{-2^Rational[-1, 2]/Pi - Cos[Rational[1, 8] Pi] + 
         Sin[Rational[1, 8] Pi], 2^Rational[-1, 2]/Pi + 
         Cos[Rational[1, 8] Pi] + 
         Sin[Rational[1, 8] Pi]}}, {{-0.7662751791854734, 
       1.531642043915653}}], 
      NCache[{{Cos[Rational[1, 8] Pi], -Sin[Rational[1, 8] Pi]}}, {{
       0.9238795325112867, -0.3826834323650898}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{-1 - Pi^(-1), 1}}, {{-1.3183098861837907`, 1}}], {{1, 0}}],
     "HalfLine"]}, {
    TagBox[
     ConicHullRegionBox[NCache[{{Pi^(-1), 0}}, {{0.3183098861837907, 0}}], {{
      0, -1}}],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{2^Rational[-1, 2]/Pi, 2^Rational[-1, 2]/Pi}}, {{
       0.22507907903927651`, 0.22507907903927651`}}], 
      NCache[{{Sin[Rational[1, 8] Pi], -Cos[Rational[1, 8] Pi]}}, {{
       0.3826834323650898, -0.9238795325112867}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[NCache[{{0, Pi^(-1)}}, {{0, 0.3183098861837907}}], 
      NCache[{{2^Rational[-1, 2], -2^Rational[-1, 2]}}, {{
       0.7071067811865475, -0.7071067811865475}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{-2^Rational[-1, 2]/Pi, 2^Rational[-1, 2]/
         Pi}}, {{-0.22507907903927651`, 0.22507907903927651`}}], 
      NCache[{{Cos[Rational[1, 8] Pi], -Sin[Rational[1, 8] Pi]}}, {{
       0.9238795325112867, -0.3826834323650898}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[NCache[{{(-1)/Pi, 0}}, {{-0.3183098861837907, 0}}], {{
      1, 0}}],
     "HalfLine"]}, {
    TagBox[
     ConicHullRegionBox[
      NCache[{{1 + Pi^(-1), 1}}, {{1.3183098861837907`, 1}}], {{-1, 0}}],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{2^Rational[-1, 2]/Pi + Cos[Rational[1, 8] Pi] - Sin[
         Rational[1, 8] Pi], 2^Rational[-1, 2]/Pi + Cos[Rational[1, 8] Pi] + 
         Sin[Rational[1, 8] Pi]}}, {{0.7662751791854734, 1.531642043915653}}],
       NCache[{{-Cos[Rational[1, 8] Pi], -
         Sin[Rational[1, 8] 
           Pi]}}, {{-0.9238795325112867, -0.3826834323650898}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{0, 2^Rational[1, 2] + Pi^(-1)}}, {{0, 1.732523448556886}}], 
      NCache[{{-2^Rational[-1, 2], -2^
          Rational[-1, 2]}}, {{-0.7071067811865475, -0.7071067811865475}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{-2^Rational[-1, 2]/Pi - Cos[Rational[1, 8] Pi] + 
         Sin[Rational[1, 8] Pi], 2^Rational[-1, 2]/Pi + 
         Cos[Rational[1, 8] Pi] + 
         Sin[Rational[1, 8] Pi]}}, {{-0.7662751791854734, 
       1.531642043915653}}], 
      NCache[{{-Sin[Rational[1, 8] Pi], -
         Cos[Rational[1, 8] 
           Pi]}}, {{-0.3826834323650898, -0.9238795325112867}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{-1 - Pi^(-1), 1}}, {{-1.3183098861837907`, 1}}], {{0, -1}}],
     "HalfLine"]}, {
    TagBox[
     ConicHullRegionBox[
      NCache[{{Pi^(-1), 0}}, {{0.3183098861837907, 0}}], {{-1, 0}}],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{2^Rational[-1, 2]/Pi, 2^Rational[-1, 2]/Pi}}, {{
       0.22507907903927651`, 0.22507907903927651`}}], 
      NCache[{{-Cos[Rational[1, 8] Pi], -
         Sin[Rational[1, 8] 
           Pi]}}, {{-0.9238795325112867, -0.3826834323650898}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[NCache[{{0, Pi^(-1)}}, {{0, 0.3183098861837907}}], 
      NCache[{{-2^Rational[-1, 2], -2^
          Rational[-1, 2]}}, {{-0.7071067811865475, -0.7071067811865475}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[
      NCache[{{-2^Rational[-1, 2]/Pi, 2^Rational[-1, 2]/
         Pi}}, {{-0.22507907903927651`, 0.22507907903927651`}}], 
      NCache[{{-Sin[Rational[1, 8] Pi], -
         Cos[Rational[1, 8] 
           Pi]}}, {{-0.3826834323650898, -0.9238795325112867}}]],
     "HalfLine"], 
    TagBox[
     ConicHullRegionBox[NCache[{{(-1)/Pi, 0}}, {{-0.3183098861837907, 0}}], {{
      0, -1}}],
     "HalfLine"]}, RectangleBox[{0, 0}]},
  ImageSize->{605.765625, Automatic}]], "Output",
 CellChangeTimes->{
  3.891727871364933*^9, 3.891727940778573*^9, 3.891728264972324*^9, {
   3.8917284822958527`*^9, 3.891728520159786*^9}, 3.8917287508689528`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"2561ad4d-736c-47f5-aca4-c9f04ffda4fe"]
}, Open  ]],

Cell[BoxData["HalfLine"], "Input",
 CellChangeTimes->{{3.8917265462190533`*^9, 
  3.891726547128928*^9}},ExpressionUUID->"077f53ed-a835-4273-81ff-\
c43d760ee26a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.891726335394395*^9, 
  3.891726338936205*^9}},ExpressionUUID->"cb83d05f-1a5b-48a5-85de-\
1b29d5f5ed16"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HalfLine", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891727788100697*^9, 3.891727790929673*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"817de3ef-2531-406e-952d-befc161be46d"],

Cell[BoxData[
 RowBox[{"HalfLine", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8917277911829767`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"0302e8d5-209c-4005-9dc5-80731c1dbdf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "[", "sofa", "]"}]], "Input",
 CellChangeTimes->{{3.891726279267407*^9, 3.891726280329705*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"acea483e-5ed1-4404-8942-673b546d5d99"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.89172628078483*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"7f2ed642-b920-4b5b-9ed1-59a4b798e8d6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"sofa", "[", 
  RowBox[{"angles", ",", "xlocations"}], "]"}]], "Input",
 CellChangeTimes->{{3.89172499418291*^9, 
  3.8917250091095552`*^9}},ExpressionUUID->"b5670fd9-b876-49c5-a8dd-\
c52037faae6e"],

Cell[BoxData["ConvexHullRegion"], "Input",
 CellChangeTimes->{{3.891725335767465*^9, 
  3.89172533910743*^9}},ExpressionUUID->"ed824685-6fd4-417d-865c-\
8ce3be77e912"]
},
WindowSize->{1156, 697},
WindowMargins->{{74, Automatic}, {1, Automatic}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fb3195cb-a9bb-4f48-b535-4fc6c4fe914d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 99, 1, 4, "PageBreak",ExpressionUUID->"98f2bbb4-6ed0-4270-91dd-7f208479904c",
 PageBreakBelow->True],
Cell[660, 23, 264, 5, 30, "Input",ExpressionUUID->"54a3738f-cfeb-44ba-b992-e30076371279"],
Cell[927, 30, 3203, 93, 245, "Input",ExpressionUUID->"41a7dfc4-fe2c-435c-b064-bc82ee4cf0ad"],
Cell[4133, 125, 511, 14, 52, "Input",ExpressionUUID->"684ce371-9ded-4344-9528-9ef2d05e4437"],
Cell[4647, 141, 3710, 87, 367, "Input",ExpressionUUID->"5ea22067-ab47-4645-b62d-8fb300cc63d7"],
Cell[8360, 230, 852, 24, 73, "Input",ExpressionUUID->"ad8b830a-4fd4-456e-a563-02e16375f95e"],
Cell[9215, 256, 1702, 46, 199, "Input",ExpressionUUID->"b73cfce8-e3e2-4ecb-9112-e0f2ecda2fa0"],
Cell[10920, 304, 504, 12, 30, "Input",ExpressionUUID->"505a1b1b-8666-4d56-9c6b-b97bf7fb88af"],
Cell[11427, 318, 240, 5, 30, "Input",ExpressionUUID->"b1ce9837-29ed-427c-abdb-ff6cfcbbc7f0"],
Cell[11670, 325, 1030, 28, 30, "Input",ExpressionUUID->"f40b435d-8f32-4b48-9e38-effc87b634fd"],
Cell[12703, 355, 350, 8, 30, "Input",ExpressionUUID->"0921adb5-c21d-422e-bd85-0c1b49778d76"],
Cell[13056, 365, 755, 22, 30, "Input",ExpressionUUID->"7d8016a4-09dc-4079-8e7c-2af34de475b7"],
Cell[13814, 389, 1117, 34, 52, "Input",ExpressionUUID->"782889e0-d902-4ebe-bd69-6484946458d1"],
Cell[14934, 425, 871, 22, 52, "Input",ExpressionUUID->"d3e794cc-c8c3-463e-808b-dd816b045788"],
Cell[15808, 449, 1109, 31, 52, "Input",ExpressionUUID->"52c748cc-43c2-4971-8034-06a718c147cb"],
Cell[16920, 482, 371, 9, 30, "Input",ExpressionUUID->"2812e645-6bfa-45c2-a820-105f5dcb12d0"],
Cell[17294, 493, 1937, 61, 94, "Input",ExpressionUUID->"b33bb66c-c351-40cb-85a2-01aa47a7bd2a"],
Cell[CellGroupData[{
Cell[19256, 558, 282, 7, 30, "Input",ExpressionUUID->"2321693e-57a9-44f8-b641-88c1da8dfef4"],
Cell[19541, 567, 3690, 121, 142, "Output",ExpressionUUID->"2fb1f978-e597-4788-ada7-6790eea3032d"]
}, Open  ]],
Cell[23246, 691, 1050, 31, 51, "Input",ExpressionUUID->"9de541a7-3ab5-4407-9f8e-595928ea8d91"],
Cell[24299, 724, 1466, 42, 145, "Input",ExpressionUUID->"55575aeb-d287-4ac3-a0e5-4f5b680306b3"],
Cell[CellGroupData[{
Cell[25790, 770, 1339, 38, 52, "Input",ExpressionUUID->"fdcb886d-68fd-45f5-bfa7-b3fc46565459"],
Cell[27132, 810, 5220, 129, 448, "Output",ExpressionUUID->"2561ad4d-736c-47f5-aca4-c9f04ffda4fe"]
}, Open  ]],
Cell[32367, 942, 162, 3, 30, "Input",ExpressionUUID->"077f53ed-a835-4273-81ff-c43d760ee26a"],
Cell[32532, 947, 152, 3, 30, "Input",ExpressionUUID->"cb83d05f-1a5b-48a5-85de-1b29d5f5ed16"],
Cell[CellGroupData[{
Cell[32709, 954, 327, 8, 30, "Input",ExpressionUUID->"817de3ef-2531-406e-952d-befc161be46d"],
Cell[33039, 964, 306, 8, 34, "Output",ExpressionUUID->"0302e8d5-209c-4005-9dc5-80731c1dbdf7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33382, 977, 202, 3, 30, "Input",ExpressionUUID->"acea483e-5ed1-4404-8942-673b546d5d99"],
Cell[33587, 982, 148, 2, 34, "Output",ExpressionUUID->"7f2ed642-b920-4b5b-9ed1-59a4b798e8d6"]
}, Open  ]],
Cell[33750, 987, 221, 5, 30, "Input",ExpressionUUID->"b5670fd9-b876-49c5-a8dd-c52037faae6e"],
Cell[33974, 994, 167, 3, 30, "Input",ExpressionUUID->"ed824685-6fd4-417d-865c-8ce3be77e912"]
}
]
*)

