(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59164,       1604]
NotebookOptionsPosition[     53434,       1514]
NotebookOutlinePosition[     53834,       1530]
CellTagsIndexPosition[     53791,       1527]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "255839"}], "/", "checking"}], "-", "if", "-", 
     "two", "-", "line", "-", "segments", "-", "intersect"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Lukasz", "'"}], "s", " ", "solution", " ", "benchmarked", " ", 
    "by", " ", "LouisB"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"segmentIntersectionQ", "[", 
      RowBox[{
       RowBox[{"_", "[", 
        RowBox[{"u1_", ",", "u2_"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"And", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"u2", "-", "u1"}], ",", 
            RowBox[{"v1", "-", "u2"}]}], "}"}], "]"}], " ", 
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"u2", "-", "u1"}], ",", 
            RowBox[{"v2", "-", "u2"}]}], "}"}], "]"}]}], "<", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v2", "-", "v1"}], ",", 
            RowBox[{"u1", "-", "v2"}]}], "}"}], "]"}], " ", 
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v2", "-", "v1"}], ",", 
            RowBox[{"u2", "-", "v2"}]}], "}"}], "]"}]}], "<", "0"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"www", ".", "wolframcloud", ".", "com"}], "/", "objects"}], 
        "/", "demonstrations"}], "/", "SegmentIntersection"}], "-", 
      RowBox[{"source", ".", "nb"}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lineIntersectionPoint", "[", 
     RowBox[{
      RowBox[{"_", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ",", 
      RowBox[{"_", "[", 
       RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"c", "-", "d"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", "b"}], ")"}]}]}], 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "-", "b"}], ",", 
        RowBox[{"c", "-", "d"}]}], "}"}], "]"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.891693161515649*^9, 3.8916931991423883`*^9}, {
  3.8916932474905777`*^9, 3.891693249038147*^9}, {3.891693920864904*^9, 
  3.891693999560816*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"41a7dfc4-fe2c-435c-b064-bc82ee4cf0ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"isAbove", "[", 
    RowBox[{"p_", ",", 
     RowBox[{"_", "[", 
      RowBox[{"q1_", ",", "q2_"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q1", "-", "p"}], ",", 
       RowBox[{"q2", "-", "p"}]}], "}"}], "]"}], ">", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isBelow", "[", 
    RowBox[{"p_", ",", 
     RowBox[{"_", "[", 
      RowBox[{"q1_", ",", "q2_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"!", 
    RowBox[{"isAbove", "[", 
     RowBox[{"p", ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.891695704721904*^9, 3.891695789423292*^9}, {
  3.891695979348134*^9, 3.891696000373714*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"eb10ee09-413e-4191-8b8f-0d30cb1cbea6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Ignores", " ", 
    RowBox[{"degenerate", "/", "empty"}], " ", "list", " ", "of", " ", 
    "points"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"merge", ",", "mergeCross"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"merge", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ":=", "a"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"merge", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", "}"}], "]"}], ",", "b_"}], "]"}], ":=", "b"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"merge", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "_", "}"}], ",", "a___"}], "}"}], "]"}], ",", "b_"}], 
      "]"}], ":=", 
     RowBox[{"merge", "[", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ",", "b"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"merge", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "_", "}"}], ",", "b___"}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"merge", "[", 
      RowBox[{"a", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", "b", "}"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"appendToFirst", "[", 
      RowBox[{"p_", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "aHead___", "}"}], ",", "aRest___"}], "}"}], "]"}]}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "aHead"}], "}"}], ",", "aRest"}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"merge", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", ":", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", ":", 
              RowBox[{"{", 
               RowBox[{"a1x_", ",", "_"}], "}"}]}], ",", 
             RowBox[{"a2", ":", 
              RowBox[{"{", 
               RowBox[{"a2x_", ",", "_"}], "}"}]}], ",", "aTail___"}], "}"}], 
           ",", "aRest___"}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"b", ":", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"b1", ":", 
              RowBox[{"{", 
               RowBox[{"b1x_", ",", "_"}], "}"}]}], ",", 
             RowBox[{"b2", ":", 
              RowBox[{"{", 
               RowBox[{"b2x_", ",", "_"}], "}"}]}], ",", "bTail___"}], "}"}], 
           ",", "bRest___"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ":=", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a2x", "<=", "b1x"}], ",", 
       RowBox[{"appendToFirst", "[", 
        RowBox[{"a1", ",", 
         RowBox[{"merge", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a2", ",", "aTail"}], "}"}], ",", "aRest"}], "}"}], 
            "]"}], ",", "b"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"b2x", "<=", "a1x"}], ",", 
       RowBox[{"appendToFirst", "[", 
        RowBox[{"b1", ",", 
         RowBox[{"merge", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"b2", ",", "bTail"}], "}"}], ",", "bRest"}], "}"}], 
            "]"}], ",", "a"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"a1x", "<=", "b1x"}], ",", 
       RowBox[{"mergeCross", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"a1x", ">", "b1x"}], ",", 
       RowBox[{"mergeCross", "[", 
        RowBox[{"b", ",", "a"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mergeCross", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", ":", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a1", ":", 
             RowBox[{"{", 
              RowBox[{"a1x_", ",", "_"}], "}"}]}], ",", 
            RowBox[{"a2", ":", 
             RowBox[{"{", 
              RowBox[{"a2x_", ",", "_"}], "}"}]}], ",", "aTail___"}], "}"}], 
          ",", "aRest___"}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"b", ":", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b1", ":", 
             RowBox[{"{", 
              RowBox[{"b1x_", ",", "_"}], "}"}]}], ",", 
            RowBox[{"b2", ":", 
             RowBox[{"{", 
              RowBox[{"b2x_", ",", "_"}], "}"}]}], ",", "bTail___"}], "}"}], 
          ",", "bRest___"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQXca+zPrivzeOE7LOOoFov4JzbiA6U6bZF0SXGd0J
AdFVnX/iQPS2/m1lIJoja3Y/iJa9PmsaiL6vZj4PRMdJ868H0Y+l9m0C0Q8u
8+4E0fXKvrtA9JpP+cdA9I9ExXMgetHU7Csg2tTs8Q0QfYlf6CmI/n1WFkyv
K1jzCkTfs1nIcglIf+twNwbRZ8IOWoHonF8lziA6WXKpN4hum3AyCUS7BX1I
AdHFuq+KQfSnmtnlIDrD7nQNiA5le1kLohXen+0Fy9stnQiiNxQEzQPRqz5M
XQWiA3pO2F0G0gb2K5xANABYU8GF
  "],ExpressionUUID->"e7d9d778-f3cb-45bd-9db9-1c30bd2334bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "0"}], "}"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.891696245090358*^9, 3.8916963143298473`*^9}, {
  3.891696352295454*^9, 3.891696363981447*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"15b2e562-3615-425b-90d9-f628d3a35603"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"merge", "[", 
  RowBox[{"a", ",", "c"}], "]"}]], "Input",
 CellChangeTimes->{{3.891696275823887*^9, 3.891696277087372*^9}, 
   3.891696309939348*^9, {3.891696367161632*^9, 3.8916963732722387`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"ff1e3d2b-bb57-4123-9799-c62924c97d41"],

Cell[BoxData[
 RowBox[{"appendToFirst", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
   RowBox[{"mergeCross", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0"}], "}"}]}], "}"}]}], "}"}], "]"}]}], "]"}]}],
   "]"}]], "Output",
 CellChangeTimes->{
  3.891696277381116*^9, {3.891696310147018*^9, 3.891696316034665*^9}, {
   3.8916963675109673`*^9, 3.891696373694203*^9}, {3.8916965489975147`*^9, 
   3.891696575047638*^9}, {3.8916966179531317`*^9, 3.891696624597621*^9}, 
   3.8916969470159807`*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"1748a344-4707-44cc-a32d-3dcabc6c68d2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.891694876554131*^9, 
  3.891696210666086*^9},ExpressionUUID->"1ed7dd95-a300-4ea3-a8b5-\
4c00534734a0"],

Cell[BoxData["If"], "Input",
 CellChangeTimes->{{3.891694739982739*^9, 
  3.891694740114086*^9}},ExpressionUUID->"6d308f9f-3d7e-4af3-a804-\
f240c1d7472b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Now", " ", "the", " ", "projections", " ", "intersect"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"!", "segmentIntersectionQ"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"segments", " ", "intersect"}], " ", "*)"}], ",", 
   "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]"}]}]], "Input",Exp\
ressionUUID->"9663f22a-f5cb-4723-9c09-df6ac5989e18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"1", "+", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8916946764586887`*^9, 3.891694682198826*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b54d923c-7c95-4e47-a789-4eb693dd34c6"],

Cell[BoxData[
 TemplateBox[{
  "Block", "lvset", 
   "\"Local variable specification \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"p\\\", \\\",\\\", \\\"q\\\"}], \\\"}\\\
\"}], \\\"=\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) contains \\!\\(\\*RowBox[{RowBox[{\
\\\"{\\\", RowBox[{\\\"p\\\", \\\",\\\", \\\"q\\\"}], \\\"}\\\"}], \\\"=\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \
\\\"}\\\"}]}]\\), which is an assignment to \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"p\\\", \\\",\\\", \\\"q\\\"}], \\\"}\\\"}]\\); only assignments \
to symbols are allowed.\"", 2, 18, 1, 22209374318267726612, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.891694682487055*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"055a9b6f-33c4-4135-be34-850ad7e9326c"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"1", "+", "2"}]}], "]"}]], "Output",
 CellChangeTimes->{3.891694682498197*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"11a9a4f6-d4c2-4c7f-a4a8-e8ab64a7dff0"]
}, Open  ]],

Cell[BoxData["Sow"], "Input",
 CellChangeTimes->{{3.891697334547181*^9, 
  3.891697336160718*^9}},ExpressionUUID->"df21d48d-73b9-4707-a175-\
78761b4e21fb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.891693336511814*^9, 3.891693359818351*^9}, 
   3.8916939605656776`*^9},ExpressionUUID->"1e745674-f26e-45b1-9c23-\
7851a24dee42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mergePolyline", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Line", "[", 
     RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.89169137677874*^9, 3.8916914013421593`*^9}, {
  3.891693822739367*^9, 
  3.891693825257433*^9}},ExpressionUUID->"dbd588f0-9816-4dd4-b76c-\
3f51ae76f38e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Line", "[", 
   RowBox[{"{", "}"}], "]"}], "//", "Graphics"}]], "Input",
 CellChangeTimes->{{3.891691297680122*^9, 3.891691309632791*^9}, 
   3.8916942732687893`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"0794f49d-18d1-4b5b-8d96-d6533a9ef21c"],

Cell[BoxData[
 GraphicsBox[LineBox[{}]]], "Output",
 CellChangeTimes->{{3.891691305464911*^9, 3.8916913098784122`*^9}, 
   3.891694273537854*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"89cc64bd-e385-4c88-9ec0-296a20cb7a8d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ftn", "[", 
   RowBox[{"_", "[", 
    RowBox[{"b_", ",", "c_"}], "]"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"b", "+", "c"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.891691672093704*^9, 3.891691701455874*^9}, {
  3.891696591716342*^9, 3.891696594155079*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"b4c6c04d-495c-40b7-8169-e4702f0c15ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ftn", "[", 
  RowBox[{"List", "[", 
   RowBox[{"2", ",", "4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.891691683339521*^9, 3.89169169233539*^9}, {
  3.89169659792624*^9, 3.891696598780367*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"4735ba14-96f9-45c1-bc8a-de1ffaa12fa1"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{{3.891691686522581*^9, 3.891691703142881*^9}, {
  3.891696595950807*^9, 3.891696599002017*^9}},
 CellLabel->"Out[71]=",ExpressionUUID->"03717b9a-e02f-4f7f-a3d0-43ace0fd7faa"]
}, Open  ]],

Cell[BoxData["VectorQ"], "Input",
 CellChangeTimes->{{3.89169318042955*^9, 
  3.891693181258524*^9}},ExpressionUUID->"b5ce62a4-fe00-47f9-b549-\
24f2a092b2e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fff", "[", 
   RowBox[{"tt", ":", 
    RowBox[{"{", 
     RowBox[{"b11_", ",", "c11_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"b11", "+", "c11"}]}]], "Input",
 CellChangeTimes->{{3.891696629978189*^9, 3.891696636437249*^9}, {
   3.891696726188271*^9, 3.891696737776073*^9}, {3.8916968117435703`*^9, 
   3.89169681271485*^9}, 3.891696876030957*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"81d02add-1256-43fb-9d07-3f448e03e327"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fff", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.891696637256061*^9, 3.89169663853615*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"6da64cd8-b1f6-4de6-8c97-50a16bcd8d77"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{
  3.891696638775931*^9, {3.891696730630197*^9, 3.8916967391573477`*^9}, {
   3.8916968153559647`*^9, 3.891696820188468*^9}, 3.891696879343093*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"20e0091c-44be-46be-9c88-d590ee7a45bb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "fff", "]"}]], "Input",
 CellChangeTimes->{{3.891696816474588*^9, 3.8916968179342318`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"6486f8c9-1932-489d-abbc-c6fc7631e322"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "It", " ", "should", " ", "be", " ", "based", " ", "on", " ", "event", 
     " ", 
     RowBox[{"type", "?", "\[IndentingNewLine]", "Event"}], " ", 
     RowBox[{"list", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"starts", " ", "p1"}]}]}], "->", "p2"}], ",", " ", 
   RowBox[{
    RowBox[{"polyline", " ", "A", " ", "or", " ", "B"}], ";", 
    RowBox[{"pointA", "[", 
     RowBox[{"p", ",", "q"}], "]"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"pointB", "[", 
      RowBox[{"r", ",", "s"}], "]"}], "\[IndentingNewLine]", "ends", " ", 
     "polyline", " ", "A", " ", "or", " ", "B"}], ";", "endA"}], ",", " ", 
   RowBox[{
    RowBox[{
    "endB", "\[IndentingNewLine]", "crosses", " ", "A", " ", "and", " ", 
     "B"}], ";", 
    RowBox[{
    "cross", "\[IndentingNewLine]", "\[IndentingNewLine]", "State", " ", 
     RowBox[{"machine", ":", "\[IndentingNewLine]", 
      RowBox[{"Last", " ", "event", " ", "happened", " ", 
       RowBox[{"when", "?", "\[IndentingNewLine]", "What"}], " ", "line", " ",
        "segment", " ", "is", " ", "being", " ", 
       RowBox[{"involved", "?", "\[IndentingNewLine]", "Which"}], " ", "line",
        " ", "goes", " ", "on", " ", 
       RowBox[{
        RowBox[{
        "top", "?", "\[IndentingNewLine]", "\[IndentingNewLine]", "Let"}], 
        "'"}], "s", " ", "focus", " ", "on", " ", "correctness"}]}]}]}], ",", 
   " ", 
   RowBox[{"really", "."}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.891697364954067*^9, 3.8916973719083*^9}, {
  3.891697464569933*^9, 3.891697465078351*^9}, {3.891697747023584*^9, 
  3.891697808933416*^9}, {3.8916979259143677`*^9, 3.891698029105403*^9}, {
  3.891698128384684*^9, 3.8916981389727507`*^9}, {3.891698447073889*^9, 
  3.891698454116037*^9}, {3.8916988397160788`*^9, 3.891698851783551*^9}, {
  3.891699170085813*^9, 
  3.891699170257139*^9}},ExpressionUUID->"14178f97-3c03-49f7-aed1-\
9eff291bc3fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"endA", ",", 
   RowBox[{"pointA", "[", 
    RowBox[{"p", ",", "q"}], "]"}], ",", 
   RowBox[{"pointB", "[", 
    RowBox[{"r", ",", "s"}], "]"}], ",", "cross", ",", 
   RowBox[{"pointA", "[", 
    RowBox[{"q", ",", "tt"}], "]"}], ",", 
   RowBox[{"pointB", "[", 
    RowBox[{"s", ",", "uu"}], "]"}], ","}], "}"}]], "Input",
 CellChangeTimes->{{3.8916984846635323`*^9, 3.891698519391568*^9}, {
  3.891698702815789*^9, 3.8916987053826513`*^9}, {3.891698946537889*^9, 
  3.8916989887884274`*^9}},ExpressionUUID->"c777b534-dfb5-4b03-b0c4-\
8799d76a116c"],

Cell[BoxData["Null"], "Input",
 CellChangeTimes->{{3.891697969516*^9, 3.8916979873558607`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"a242a180-d9e4-4d03-9ade-ceb908e18f48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", ",", "time"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"_", ",", "_"}], "]"}], ":=", "777"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"a_", ",", "b_", ",", "c___"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"a", "*", "b"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"time", "[", "n_", "]"}], ":=", 
     RowBox[{"First", "@", 
      RowBox[{"Timing", "@", 
       RowBox[{"f", "[", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "*", "1000000"}], "]"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"time", "/@", 
      RowBox[{"Range", "[", "10", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.891699374789359*^9, 3.891699415386108*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"8b1b1c81-45de-4be0-83bd-e028b10a960b"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{1., 0.065485}, {2., 0.076348}, {3., 0.111563}, {4., 
     0.147172}, {5., 0.186136}, {6., 0.231119}, {7., 0.270342}, {8., 
     0.303941}, {9., 0.332053}, {10., 0.366116}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 10.}, {0, 0.366116}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.891699383372013*^9, 3.891699418404848*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"a298e9ec-f639-4f17-b72e-6e549da0a140"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.8916992209377327`*^9, 3.891699254405073*^9}, 
   3.891699302856998*^9},ExpressionUUID->"4adda2de-4200-4f1b-84da-\
cfcbd43b7ae2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.973664`", ",", "777"}], "}"}]], "Output",
 CellChangeTimes->{{3.891699229350507*^9, 3.891699255523901*^9}},
 CellLabel->
  "Out[120]=",ExpressionUUID->"43b2c517-64bf-4733-b87b-dcba7d767dec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Two", " ", "competing", " ", "ways", " ", "to", " ", 
    RowBox[{"implement", ".", " ", 
     RowBox[{"First", ":", " ", 
      RowBox[{"basic", " ", 
       RowBox[{"recursion", ".", " ", "Second"}]}], ":", " ", 
      RowBox[{"Explicitly", " ", "handle", " ", 
       RowBox[{
       "events", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "Another"}], " ", 
       RowBox[{"issue", ":", "\[IndentingNewLine]", 
        RowBox[{"Arbitrary", " ", 
         RowBox[{"frontline", "?", " ", "May"}], " ", "lead", " ", "to", " ", 
         
         RowBox[{"degeneracy", ".", "\[IndentingNewLine]", "So"}], " ", "we", 
         " ", "need", " ", "some", " ", "kind", " ", "of", " ", "assumption", 
         " ", "on", " ", 
         RowBox[{"ends", ".", "\[IndentingNewLine]", "This"}], " ", "problem",
          " ", "is", " ", "much", " ", 
         RowBox[{"simpler", ".", " ", "To"}], " ", "save", " ", 
         "time"}]}]}]}]}]}], ",", " ", 
   RowBox[{"focus", " ", "on", " ", "just", " ", "this", " ", 
    RowBox[{
    "problem", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "No"}], " ", 
    RowBox[{"end", "/", "start"}], " ", 
    RowBox[{"events", ".", " ", "Just"}], " ", "a", " ", "bunch", " ", "of", 
    " ", "points", " ", "kicking", " ", "in"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.891699452650633*^9, 3.891699508907226*^9}, {
  3.8916995449360657`*^9, 3.891699555621058*^9}, {3.891699769738675*^9, 
  3.891699781341798*^9}},ExpressionUUID->"207045d6-2d19-4bc8-8c6d-\
6d8a6878e2df"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Let", "'"}], "s", " ", "do", " ", "event"}], "-", 
    RowBox[{
     RowBox[{"based", ".", " ", "No"}], " ", "BS", " ", "on", " ", "case", 
     " ", "analysis", "\[IndentingNewLine]", "\[IndentingNewLine]", "Assume", 
     " ", "vertices", " ", "on", " ", "both", " ", 
     RowBox[{
     "ends", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "New"}], " ", 
     "point", " ", "incoming"}]}], ",", " ", 
   RowBox[{"A", " ", "or", " ", 
    RowBox[{"B", ".", "\[IndentingNewLine]", "OR"}]}], ",", " ", 
   RowBox[{"some", " ", "crossing", " ", 
    RowBox[{"happening", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.891699798691848*^9, 
  3.891699851803009*^9}},ExpressionUUID->"6995b8e2-b83a-4281-9400-\
d4c4215b2e46"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.891699859549078*^9, 3.891699859865623*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"c79aeb29-9d25-49f3-b8e6-195841c9a388"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"leftEnd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "100"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rightEnd", "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8916998877244787`*^9, 3.891699900582335*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7e7cc62e-31dc-4ae0-8407-18a029961d54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Principle", ":", " ", 
     RowBox[{
      RowBox[{"for", " ", "the", " ", "x"}], "-", 
      RowBox[{"coordinate", " ", "you", " ", "are", " ", "located"}]}]}], ",",
     " ", 
    RowBox[{
    "all", " ", "the", " ", "events", " ", "that", " ", "should", " ", "have",
      " ", "happened", " ", "beforehand", "\[IndentingNewLine]", "should", 
     " ", "have", " ", "been", " ", "emitted"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "and", " ", "nothing", " ", "else", " ", "on", " ", "the", " ", "right", 
     " ", "side"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "All", " ", "events", " ", "before", " ", "a1", " ", "has", " ", "been", 
    " ", 
    RowBox[{"emitted", ".", " ", "\[IndentingNewLine]", "  ", "b1"}], " ", 
    "should", " ", "retain", " ", "the", " ", "vertex", " ", "right", " ", 
    "before", " ", "a1", " ", "as", " ", 
    RowBox[{"well", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.891700021183661*^9, 3.891700035236438*^9}, {
  3.891700160961886*^9, 3.891700209637444*^9}, {3.891700342979347*^9, 
  3.8917003790930653`*^9}, {3.891700428646455*^9, 
  3.8917004363177557`*^9}},ExpressionUUID->"ac877869-f5c6-455e-b8c5-\
7d3d4d0ca11c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"emitEvents", "[", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"{", 
       RowBox[{"a1_", ",", 
        RowBox[{"a2", ":", 
         RowBox[{"{", 
          RowBox[{"a2x_", ",", "_"}], "}"}]}], ",", "aRest_"}], "}"}]}], ",", 
     
     RowBox[{"b", ":", 
      RowBox[{"{", 
       RowBox[{"b1_", ",", 
        RowBox[{"b2", ":", 
         RowBox[{"{", 
          RowBox[{"b2x_", ",", "_"}], "}"}]}], ",", "bRest_"}], "}"}]}]}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sow", "[", "a1", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"segmentIntersectionQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "a2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sow", "[", 
          RowBox[{"lineIntersectionPoint", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a1", ",", "a2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a2x", "<=", "b2x"}], ",", "\[IndentingNewLine]", 
        RowBox[{"emitEvents", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a2", ",", "aRest"}], "}"}], ",", "b"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"emitEvents", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"b2", ",", "bRest"}], "}"}], ",", "a"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.891699866291319*^9, 3.891699873897546*^9}, {
  3.891699962896124*^9, 3.89169998447267*^9}, {3.8917002957808323`*^9, 
  3.8917003352406883`*^9}, {3.891700391838681*^9, 3.891700442271521*^9}, {
  3.8917005517987747`*^9, 3.8917005988198566`*^9}, {3.8917006301275263`*^9, 
  3.8917006785800867`*^9}, {3.891713977441461*^9, 3.8917139852170677`*^9}, {
  3.891714166469623*^9, 3.891714258634136*^9}, {3.891714573531259*^9, 
  3.891714601302959*^9}},ExpressionUUID->"5ea22067-ab47-4645-b62d-\
8fb300cc63d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", ",", "time"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"_", ",", "_"}], "]"}], ":=", "777"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"a_", ",", "b_", ",", "c___"}], "]"}], ":=", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"b", ",", "c"}], "]"}], ",", 
       RowBox[{"a", "*", "b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"time", "[", "n_", "]"}], ":=", 
     RowBox[{"First", "@", 
      RowBox[{"Timing", "@", 
       RowBox[{"f", "[", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "*", "1000000"}], "]"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"time", "/@", 
      RowBox[{"Range", "[", "10", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.891715825849852*^9, 3.8917158608335238`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"32cec18a-12da-436d-819a-f9be76f320fb"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{1., 0.071754}, {2., 0.080781}, {3., 0.113169}, {4., 
     0.157636}, {5., 0.195891}, {6., 0.23176}, {7., 0.271474}, {8., 
     0.315971}, {9., 0.348835}, {10., 0.391102}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 10.}, {0, 0.391102}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.891715841946637*^9, 3.891715863651719*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"b0703d30-368b-4c9a-8a87-4194cabe4fbd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Principle", ":", " ", 
     RowBox[{
      RowBox[{"for", " ", "the", " ", "x"}], "-", 
      RowBox[{"coordinate", " ", "you", " ", "are", " ", "located"}]}]}], ",",
     " ", 
    RowBox[{
    "all", " ", "the", " ", "events", " ", "that", " ", "should", " ", "have",
      " ", "happened", " ", "beforehand", "\[IndentingNewLine]", "should", 
     " ", "have", " ", "been", " ", "emitted"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "and", " ", "nothing", " ", "else", " ", "on", " ", "the", " ", "right", 
     " ", "side"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "All", " ", "events", " ", "before", " ", "a1", " ", "has", " ", "been", 
    " ", 
    RowBox[{"emitted", ".", " ", "\[IndentingNewLine]", "  ", "b1"}], " ", 
    "should", " ", "retain", " ", "the", " ", "vertex", " ", "right", " ", 
    "before", " ", "a1", " ", "as", " ", 
    RowBox[{"well", "."}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.891700021183661*^9, 3.891700035236438*^9}, {
  3.891700160961886*^9, 3.891700209637444*^9}, {3.891700342979347*^9, 
  3.8917003790930653`*^9}, {3.891700428646455*^9, 
  3.8917004363177557`*^9}},ExpressionUUID->"e92bc386-c5e9-447c-9828-\
6acf4771b8d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emitEvents", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", ":", 
     RowBox[{"aHead_", "[", 
      RowBox[{"a1_", ",", 
       RowBox[{"a2", ":", 
        RowBox[{"{", 
         RowBox[{"a2x_", ",", "_"}], "}"}]}], ",", "aRest___"}], "]"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"b", ":", 
     RowBox[{"bHead_", "[", 
      RowBox[{"b1_", ",", 
       RowBox[{"b2", ":", 
        RowBox[{"{", 
         RowBox[{"b2x_", ",", "_"}], "}"}]}], ",", "bRest___"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sow", "[", 
      RowBox[{"aHead", "[", "a1", "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"segmentIntersectionQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", "a2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sow", "[", 
         RowBox[{"cross", "[", 
          RowBox[{"lineIntersectionPoint", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a1", ",", "a2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], "]"}], "]"}], ";"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a2x", "<=", "b2x"}], ",", "\[IndentingNewLine]", 
       RowBox[{"emitEvents", "[", 
        RowBox[{
         RowBox[{"aHead", "[", 
          RowBox[{"a2", ",", "aRest"}], "]"}], ",", "b"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"emitEvents", "[", 
        RowBox[{
         RowBox[{"bHead", "[", 
          RowBox[{"b2", ",", "bRest"}], "]"}], ",", "a"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.891699866291319*^9, 3.891699873897546*^9}, {
   3.891699962896124*^9, 3.89169998447267*^9}, {3.8917002957808323`*^9, 
   3.8917003352406883`*^9}, {3.891700391838681*^9, 3.891700442271521*^9}, {
   3.8917005517987747`*^9, 3.8917005988198566`*^9}, {3.8917006301275263`*^9, 
   3.8917006785800867`*^9}, {3.891713977441461*^9, 3.8917139852170677`*^9}, {
   3.891714166469623*^9, 3.891714258634136*^9}, {3.891714573531259*^9, 
   3.891714601302959*^9}, 3.891714670266717*^9, {3.8917148802151947`*^9, 
   3.891714882327449*^9}, {3.8917150098006163`*^9, 3.891715011988063*^9}, {
   3.891715055828371*^9, 3.891715085310997*^9}, {3.8917151202165823`*^9, 
   3.891715147771047*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"7982fd7d-78a0-4163-8c24-739509b5898d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aList", "=", 
   RowBox[{"a", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bList", "=", 
   RowBox[{"b", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89171472034861*^9, 3.891714751544228*^9}, {
  3.8917147931238127`*^9, 3.891714798121542*^9}, {3.891715097728281*^9, 
  3.89171511239327*^9}, {3.891717586527749*^9, 3.891717586597144*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"dec17e3e-7589-443c-bf00-3325542958d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pad", "[", 
    RowBox[{"aHead_", "[", "aSeq___", "]"}], "]"}], ":=", 
   RowBox[{"aHead", "[", 
    RowBox[{"leftEnd", ",", "aSeq", ",", "rightEnd"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eventList", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"Last", "@", 
     RowBox[{"Reap", "[", 
      RowBox[{"emitEvents", "[", 
       RowBox[{
        RowBox[{"pad", "[", "aList", "]"}], ",", 
        RowBox[{"pad", "[", "bList", "]"}]}], "]"}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8917148193798*^9, 3.8917148559887743`*^9}, {
  3.891714961309053*^9, 3.8917149708329687`*^9}, {3.891715160182044*^9, 
  3.891715164655303*^9}, {3.891715255545829*^9, 3.891715256709531*^9}, {
  3.891715519949504*^9, 3.8917156425101557`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"5a1256e8-e28d-4272-adbf-e9fbd1f11589"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"takeA", "[", 
   RowBox[{
    RowBox[{"a", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeA", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeA", "[", 
   RowBox[{
    RowBox[{"cross", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeB", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeA", "[", 
   RowBox[{"_", ",", "rest___"}], "]"}], ":=", 
  RowBox[{"takeA", "[", "rest", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"takeA", "[", "]"}], ":=", 
   RowBox[{"{", "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", 
   RowBox[{
    RowBox[{"b", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeB", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", 
   RowBox[{
    RowBox[{"cross", "[", "p_", "]"}], ",", "rest___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Prepend", "[", "p", "]"}], "[", 
   RowBox[{"takeA", "[", "rest", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", 
   RowBox[{"_", ",", "rest___"}], "]"}], ":=", 
  RowBox[{"takeB", "[", "rest", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeB", "[", "]"}], ":=", 
  RowBox[{"{", "}"}]}]}], "Input",
 CellChangeTimes->{{3.891715712111375*^9, 3.891715792491377*^9}, {
  3.8917158789162703`*^9, 3.891715978067725*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"eeaf9af5-fa5f-4c31-b2d0-95aea97152bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c", "=", 
  RowBox[{
   RowBox[{"takeA", "@@", "eventList"}], "//", "Rest"}]}]], "Input",
 CellChangeTimes->{{3.891715983086911*^9, 3.891716022950343*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"39cbe9d1-04fd-4185-a895-dee648357f10"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["5", "2"], ",", 
     FractionBox["1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["7", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["9", "2"], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.891715987222492*^9, 3.891716023734379*^9}, {
  3.8917175900154877`*^9, 3.891717595763401*^9}},
 CellLabel->"Out[57]=",ExpressionUUID->"ffa83895-4f16-4731-ba8e-5c7ef66df50c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Line", "@@", "aList"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"67115147-5deb-4247-84a4-ca4b3a1a706f"],

Cell[BoxData[
 RowBox[{"Line", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.891716074277705*^9, 3.891717600670903*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"cbaa3751-0b08-4e01-a8e8-b363fa089fbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Line", "@@", "aList"}], ",", 
   RowBox[{"List", "@@", "bList"}], ",", "Thick", ",", 
   RowBox[{"Line", "[", "c", "]"}]}], "}"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"f7ad808c-49a6-4ae9-b229-db6eb0f75ce1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Line", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"Thickness", "[", "Large", "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "2"], ",", 
        FractionBox["1", "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["5", "2"], ",", 
        FractionBox["1", "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["7", "2"], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["9", "2"], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.891716088849948*^9, 3.89171760159501*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"a82f22fb-790d-481d-8526-7951338256df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"List", "@@", "aList"}], "]"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"List", "@@", "bList"}], "]"}], ",", "Thick", ",", 
    RowBox[{"Line", "[", "c", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.891716024750702*^9, 3.8917161028770103`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"705a9c81-b0ba-48c4-bf47-f7342090bd41"],

Cell[BoxData[
 GraphicsBox[{LineBox[{{0, 0}, {1, 1}, {2, 1}, {3, 0}}], 
   LineBox[{{0, 1}, {1, 0}, {2, 0}, {3, 1}, {4, -1}, {5, 1}}], 
   {Thickness[Large], 
    LineBox[NCache[{{0, 0}, {Rational[1, 2], Rational[1, 2]}, {1, 0}, {2, 
       0}, {Rational[5, 2], Rational[1, 2]}, {3, 0}, {Rational[7, 2], 0}, {
       4, -1}, {Rational[9, 2], 0}}, {{0, 0}, {0.5, 0.5}, {1, 0}, {2, 0}, {
       2.5, 0.5}, {3, 0}, {3.5, 0}, {4, -1}, {4.5, 0}}]]}},
  ImageSize->{696.640625, Automatic}]], "Output",
 CellChangeTimes->{3.8917160300378103`*^9, 3.8917160687321453`*^9, 
  3.891716103184875*^9, 3.891717602685144*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"64f00c1f-2f7a-44f8-af2c-9d2b3ed176ca"]
}, Open  ]]
},
WindowSize->{1156, 697},
WindowMargins->{{Automatic, -225}, {Automatic, 26}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7a96c3cb-7c94-4a1f-9e0b-251c6004b7b5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3203, 93, 245, "Input",ExpressionUUID->"41a7dfc4-fe2c-435c-b064-bc82ee4cf0ad"],
Cell[3764, 115, 886, 27, 52, "Input",ExpressionUUID->"eb10ee09-413e-4191-8b8f-0d30cb1cbea6"],
Cell[4653, 144, 5904, 167, 536, "Input",ExpressionUUID->"e7d9d778-f3cb-45bd-9db9-1c30bd2334bf"],
Cell[10560, 313, 2115, 71, 73, "Input",ExpressionUUID->"15b2e562-3615-425b-90d9-f628d3a35603"],
Cell[CellGroupData[{
Cell[12700, 388, 304, 6, 30, "Input",ExpressionUUID->"ff1e3d2b-bb57-4123-9799-c62924c97d41"],
Cell[13007, 396, 1498, 45, 34, "Output",ExpressionUUID->"1748a344-4707-44cc-a32d-3dcabc6c68d2"]
}, Open  ]],
Cell[14520, 444, 150, 3, 30, "Input",ExpressionUUID->"1ed7dd95-a300-4ea3-a8b5-4c00534734a0"],
Cell[14673, 449, 154, 3, 30, "Input",ExpressionUUID->"6d308f9f-3d7e-4af3-a804-f240c1d7472b"],
Cell[14830, 454, 457, 10, 115, "Input",ExpressionUUID->"9663f22a-f5cb-4723-9c09-df6ac5989e18"],
Cell[CellGroupData[{
Cell[15312, 468, 407, 11, 30, "Input",ExpressionUUID->"b54d923c-7c95-4e47-a789-4eb693dd34c6"],
Cell[15722, 481, 894, 16, 28, "Message",ExpressionUUID->"055a9b6f-33c4-4135-be34-850ad7e9326c"],
Cell[16619, 499, 382, 11, 34, "Output",ExpressionUUID->"11a9a4f6-d4c2-4c7f-a4a8-e8ab64a7dff0"]
}, Open  ]],
Cell[17016, 513, 155, 3, 30, "Input",ExpressionUUID->"df21d48d-73b9-4707-a175-78761b4e21fb"],
Cell[17174, 518, 177, 3, 30, "Input",ExpressionUUID->"1e745674-f26e-45b1-9c23-7851a24dee42"],
Cell[17354, 523, 488, 12, 115, "Input",ExpressionUUID->"dbd588f0-9816-4dd4-b76c-3f51ae76f38e"],
Cell[CellGroupData[{
Cell[17867, 539, 280, 6, 30, "Input",ExpressionUUID->"0794f49d-18d1-4b5b-8d96-d6533a9ef21c"],
Cell[18150, 547, 224, 4, 376, "Output",ExpressionUUID->"89cc64bd-e385-4c88-9ec0-296a20cb7a8d"]
}, Open  ]],
Cell[18389, 554, 431, 11, 30, "Input",ExpressionUUID->"b4c6c04d-495c-40b7-8169-e4702f0c15ec"],
Cell[CellGroupData[{
Cell[18845, 569, 303, 6, 30, "Input",ExpressionUUID->"4735ba14-96f9-45c1-bc8a-de1ffaa12fa1"],
Cell[19151, 577, 222, 3, 34, "Output",ExpressionUUID->"03717b9a-e02f-4f7f-a3d0-43ace0fd7faa"]
}, Open  ]],
Cell[19388, 583, 158, 3, 30, "Input",ExpressionUUID->"b5ce62a4-fe00-47f9-b549-24f2a092b2e6"],
Cell[19549, 588, 457, 10, 30, "Input",ExpressionUUID->"81d02add-1256-43fb-9d07-3f448e03e327"],
Cell[CellGroupData[{
Cell[20031, 602, 251, 6, 30, "Input",ExpressionUUID->"6da64cd8-b1f6-4de6-8c97-50a16bcd8d77"],
Cell[20285, 610, 278, 5, 34, "Output",ExpressionUUID->"20e0091c-44be-46be-9c88-d590ee7a45bb"]
}, Open  ]],
Cell[20578, 618, 210, 3, 30, "Input",ExpressionUUID->"6486f8c9-1932-489d-abbc-c6fc7631e322"],
Cell[20791, 623, 2084, 45, 367, "Input",ExpressionUUID->"14178f97-3c03-49f7-aed1-9eff291bc3fb"],
Cell[22878, 670, 589, 14, 30, "Input",ExpressionUUID->"c777b534-dfb5-4b03-b0c4-8799d76a116c"],
Cell[23470, 686, 178, 3, 30, "Input",ExpressionUUID->"a242a180-d9e4-4d03-9ade-ceb908e18f48"],
Cell[CellGroupData[{
Cell[23673, 693, 1126, 32, 136, "Input",ExpressionUUID->"8b1b1c81-45de-4be0-83bd-e028b10a960b"],
Cell[24802, 727, 3537, 94, 242, "Output",ExpressionUUID->"a298e9ec-f639-4f17-b72e-6e549da0a140"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28376, 826, 229, 5, 30, "Input",ExpressionUUID->"4adda2de-4200-4f1b-84da-cfcbd43b7ae2"],
Cell[28608, 833, 232, 5, 34, "Output",ExpressionUUID->"43b2c517-64bf-4733-b87b-dcba7d767dec"]
}, Open  ]],
Cell[28855, 841, 1628, 33, 221, "Input",ExpressionUUID->"207045d6-2d19-4bc8-8c6d-6d8a6878e2df"],
Cell[30486, 876, 856, 19, 178, "Input",ExpressionUUID->"6995b8e2-b83a-4281-9400-d4c4215b2e46"],
Cell[31345, 897, 179, 3, 30, "Input",ExpressionUUID->"c79aeb29-9d25-49f3-b8e6-195841c9a388"],
Cell[31527, 902, 422, 12, 52, "Input",ExpressionUUID->"7e7cc62e-31dc-4ae0-8407-18a029961d54"],
Cell[31952, 916, 1303, 29, 136, "Input",ExpressionUUID->"ac877869-f5c6-455e-b8c5-7d3d4d0ca11c"],
Cell[33258, 947, 2418, 63, 241, "Input",ExpressionUUID->"5ea22067-ab47-4645-b62d-8fb300cc63d7"],
Cell[CellGroupData[{
Cell[35701, 1014, 1164, 32, 136, "Input",ExpressionUUID->"32cec18a-12da-436d-819a-f9be76f320fb"],
Cell[36868, 1048, 3534, 93, 269, "Output",ExpressionUUID->"b0703d30-368b-4c9a-8a87-4194cabe4fbd"]
}, Open  ]],
Cell[40417, 1144, 1303, 29, 136, "Input",ExpressionUUID->"e92bc386-c5e9-447c-9828-6acf4771b8d3"],
Cell[41723, 1175, 2775, 67, 283, "Input",ExpressionUUID->"7982fd7d-78a0-4163-8c24-739509b5898d"],
Cell[44501, 1244, 1155, 33, 52, "Input",ExpressionUUID->"dec17e3e-7589-443c-bf00-3325542958d7"],
Cell[45659, 1279, 888, 22, 52, "Input",ExpressionUUID->"5a1256e8-e28d-4272-adbf-e9fbd1f11589"],
Cell[46550, 1303, 1703, 46, 199, "Input",ExpressionUUID->"eeaf9af5-fa5f-4c31-b2d0-95aea97152bb"],
Cell[CellGroupData[{
Cell[48278, 1353, 258, 5, 30, "Input",ExpressionUUID->"39cbe9d1-04fd-4185-a895-dee648357f10"],
Cell[48539, 1360, 945, 30, 49, "Output",ExpressionUUID->"ffa83895-4f16-4731-ba8e-5c7ef66df50c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49521, 1395, 136, 2, 30, "Input",ExpressionUUID->"67115147-5deb-4247-84a4-ca4b3a1a706f"],
Cell[49660, 1399, 440, 12, 34, "Output",ExpressionUUID->"cbaa3751-0b08-4e01-a8e8-b363fa089fbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50137, 1416, 271, 6, 30, "Input",ExpressionUUID->"f7ad808c-49a6-4ae9-b229-db6eb0f75ce1"],
Cell[50411, 1424, 1832, 59, 79, "Output",ExpressionUUID->"a82f22fb-790d-481d-8526-7951338256df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52280, 1488, 446, 10, 30, "Input",ExpressionUUID->"705a9c81-b0ba-48c4-bf47-f7342090bd41"],
Cell[52729, 1500, 689, 11, 312, "Output",ExpressionUUID->"64f00c1f-2f7a-44f8-af2c-9d2b3ed176ca"]
}, Open  ]]
}
]
*)

