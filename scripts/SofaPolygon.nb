(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51865,       1424]
NotebookOptionsPosition[     47326,       1348]
NotebookOutlinePosition[     47725,       1364]
CellTagsIndexPosition[     47682,       1361]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Protect", "[", 
  RowBox[{"angles", ",", "xValues"}], "]"}]], "Input",
 CellChangeTimes->{{3.8922062595261793`*^9, 3.892206289021728*^9}, {
  3.892206336982541*^9, 3.892206338559976*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"cfc15008-a37b-4de6-b8da-0a9e6938ba38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"angles\"\>", ",", "\<\"xValues\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.8922063405337973`*^9, 3.892217108328412*^9, 
  3.892239411928398*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"6dd4cc82-e289-41b1-93c1-4e3b4b5e2745"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lineIntersectionSolution", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "/.", 
    RowBox[{"First", "@", 
     RowBox[{"Solve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
         RowBox[{"InfiniteLine", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", ",", "q"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "s"}], "}"}]}], "]"}]}], "&&", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
         RowBox[{"InfiniteLine", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "Reals"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.891859841982442*^9, 3.891859848878192*^9}, {
  3.8918598799065847`*^9, 3.891859952596383*^9}, {3.8918599903060093`*^9, 
  3.891859993922496*^9}, {3.891860084293038*^9, 3.891860151117661*^9}, {
  3.891860191527275*^9, 3.891860216700501*^9}, {3.891860264185145*^9, 
  3.891860266356866*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"30e8503f-cfe3-45bd-b998-35dc78cc18f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"b", " ", "c", " ", "r"}], "-", 
     RowBox[{"a", " ", "d", " ", "r"}], "-", 
     RowBox[{"c", " ", "q", " ", "r"}], "+", 
     RowBox[{"c", " ", "p", " ", "s"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "d"}], " ", "r"}], "+", 
     RowBox[{"c", " ", "s"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"d", " ", "q", " ", "r"}], "-", 
     RowBox[{"b", " ", "c", " ", "s"}], "+", 
     RowBox[{"a", " ", "d", " ", "s"}], "-", 
     RowBox[{"d", " ", "p", " ", "s"}]}], 
    RowBox[{
     RowBox[{"d", " ", "r"}], "-", 
     RowBox[{"c", " ", "s"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.89185976652841*^9, {3.8918598423884783`*^9, 3.891859849161566*^9}, {
   3.8918598817238827`*^9, 3.8918599529426117`*^9}, 3.891859994107484*^9, {
   3.8918601418439827`*^9, 3.8918601621305523`*^9}, {3.891860198482647*^9, 
   3.8918602171814957`*^9}, 3.891860266629944*^9, {3.8918609684711037`*^9, 
   3.891860976682296*^9}, 3.8918612420455093`*^9, 3.891863292333788*^9, 
   3.891863397694188*^9, {3.891869177633456*^9, 3.891869193828968*^9}, 
   3.8918734527544537`*^9, 3.8918738959446507`*^9, 3.891874359554861*^9, {
   3.8918778707693644`*^9, 3.8918778881340933`*^9}, 3.89220584687962*^9, 
   3.89220634404963*^9, 3.892217108432625*^9, 3.892239412017167*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"58db336d-5ac2-457d-b0be-86f12f4663d3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineIntersection", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r_", ",", "s_"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", "  ", 
  RowBox[{"Evaluate", "@", "lineIntersectionSolution"}]}]], "Input",
 CellChangeTimes->{{3.8918611656849327`*^9, 3.891861219771778*^9}, {
  3.891877860852147*^9, 3.891877861667276*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"fe93333e-ed20-48db-be1b-cc01762c64f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"validAngleList", "[", "angleList_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"AllTrue", "[", 
   RowBox[{
    RowBox[{"Differences", "@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "angleList", ",", 
       RowBox[{"{", 
        RowBox[{"Pi", "/", "2"}], "}"}]}], "]"}]}], ",", "Positive"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.89220643000939*^9, 3.892206445828511*^9}, {
  3.8922065440595512`*^9, 3.892206555920751*^9}, {3.892208402304859*^9, 
  3.8922084032522583`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6381ffbc-0302-4274-81e4-0ff0a091dbc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"validXValueList", "[", "xValueList_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ArrayQ", "[", 
    RowBox[{"xValueList", ",", "_", ",", "NumberQ"}], "]"}], "&&", 
   "\[IndentingNewLine]", 
   RowBox[{"MatchQ", "[", 
    RowBox[{
     RowBox[{"Dimensions", "[", "xValueList", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", "2"}], "}"}]}], "]"}], "&&", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Last", "@", 
     RowBox[{"First", "@", "xValueList"}]}], "==", 
    RowBox[{"Last", "@", 
     RowBox[{"Last", "@", "xValueList"}]}], "==", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.892206693841797*^9, 3.892206693845557*^9}, {
   3.892206742635687*^9, 3.8922067719038982`*^9}, 3.892206831787319*^9, {
   3.892206933873519*^9, 3.892206966785404*^9}, {3.8922070249327297`*^9, 
   3.892207051517675*^9}, {3.892217628861568*^9, 3.892217629201148*^9}, {
   3.8922181538429728`*^9, 3.8922181574714746`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"d74168cb-0cee-4317-8c98-5aa3c0f8a085"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sofa", "[", 
    RowBox[{"angleList_", ",", "xValueList_"}], "]"}], "/;", 
   "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"validAngleList", "[", "angleList", "]"}], "&&", 
     RowBox[{"validXValueList", "[", "xValueList", "]"}], "&&", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "angleList", "]"}], "+", "2"}], "==", 
      RowBox[{"Length", "[", "xValueList", "]"}]}]}], ")"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"angles", "->", "angleList"}], ",", 
    RowBox[{"xValues", "->", "xValueList"}]}], "|>"}]}]], "Input",
 CellChangeTimes->{{3.892206373176108*^9, 3.892206423152968*^9}, {
   3.8922065599838743`*^9, 3.892206585609836*^9}, 3.892206675610512*^9, {
   3.892206781302927*^9, 3.892206791451468*^9}, {3.892207503535762*^9, 
   3.8922075162816668`*^9}, {3.892208741769898*^9, 3.892208758990456*^9}, {
   3.892218648495193*^9, 3.8922186512292*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"86cedb5c-bc5b-401b-bec8-33af082736a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ss", "=", 
  RowBox[{"sofa", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"Range", "[", "4", "]"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Pi", "/", "2"}], ")"}], "/", "5"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"i", "/", "5"}], "*", "Pi"}], "]"}], ",", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"i", "/", "5"}], "*", "Pi"}], "]"}]}], "}"}], ")"}], "*", 
        RowBox[{"2", "/", "Pi"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.892206571421505*^9, 3.89220657296375*^9}, {
   3.89220754177804*^9, 3.892207571968851*^9}, {3.892207656830852*^9, 
   3.8922076573684597`*^9}, 3.892218943051756*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"0bc5d71b-f3ab-44be-ad99-e599a9f9cd30"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"angles", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "0.3141592653589793`", ",", "0.6283185307179586`", ",", 
      "0.9424777960769379`", ",", "1.2566370614359172`"}], "}"}]}], ",", 
   RowBox[{"xValues", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.6366197723675814`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5150362148004839`", ",", "0.37419571351545566`"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0.19672632861669323`", ",", "0.6054613829125256`"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.19672632861669323`"}], ",", "0.6054613829125256`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5150362148004839`"}], ",", "0.37419571351545566`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.6366197723675814`"}], ",", "0.`"}], "}"}]}], 
     "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.892207561600355*^9, 3.892207572757228*^9}, 
   3.892207657786046*^9, 3.8922138921669273`*^9, 3.892217108469061*^9, 
   3.892217524944249*^9, 3.892218165355152*^9, 3.892218652496705*^9, 
   3.892218945104681*^9, 3.892239412039583*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"d1bc4b07-7dcf-47c8-8328-493ff2e48906"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "[", "sofa_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "@", 
    RowBox[{"sofa", "[", "angles", "]"}]}], "+", "1"}]}]], "Input",
 CellChangeTimes->{{3.892207634562237*^9, 3.89220765104913*^9}, {
  3.892207843439746*^9, 3.89220784487073*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"2e109ab7-a4ed-4cfc-8a27-78558e788aeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"sofa_", ",", "0"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"0", "<", "i", "<", 
      RowBox[{"n", "[", "sofa", "]"}]}], ",", 
     RowBox[{
      RowBox[{"sofa", "[", "angles", "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"angle", "[", 
       RowBox[{"sofa", ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", 
          RowBox[{"n", "[", "sofa", "]"}]}], "]"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{"i", ",", 
         RowBox[{"n", "[", "sofa", "]"}]}], "]"}], "*", 
       RowBox[{"Pi", "/", "2"}]}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.891868119620116*^9, 3.8918681861653214`*^9}, {
  3.892207874993083*^9, 3.8922079371974163`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"847ddab4-155c-462a-b842-136554521aa5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"angle", "[", 
       RowBox[{"sofa", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"angle", "[", 
       RowBox[{"sofa", ",", "i"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"angle", "[", 
        RowBox[{"sofa", ",", "i"}], "]"}], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      RowBox[{"angle", "[", 
       RowBox[{"sofa", ",", "i"}], "]"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.891868208934566*^9, 3.891868230743514*^9}, {
  3.8922079480613937`*^9, 3.892207958831574*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"55002317-f12d-4e48-a570-44a5df4c005d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sofa", "[", "xValues", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"sofa", ",", "i"}], "]"}], "+", 
   RowBox[{"u", "[", 
    RowBox[{"sofa", ",", "i"}], "]"}], "+", 
   RowBox[{"v", "[", 
    RowBox[{"sofa", ",", "i"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.891874401659582*^9, 3.8918744284709272`*^9}, {
  3.892208432883746*^9, 3.892208466076035*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"f51f7346-24a0-485c-9d8e-6d0cfb79cea4"],

Cell[CellGroupData[{

Cell[BoxData["ss"], "Input",
 CellChangeTimes->{{3.892209517988434*^9, 3.89220951810739*^9}, {
  3.892218917723412*^9, 3.892218921748659*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"b4db92ec-6741-40a4-ab89-021d49a6e71a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"angles", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "0.3141592653589793`", ",", "0.6283185307179586`", ",", 
      "0.9424777960769379`", ",", "1.2566370614359172`"}], "}"}]}], ",", 
   RowBox[{"xValues", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.6366197723675814`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5150362148004839`", ",", "0.37419571351545566`"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0.19672632861669323`", ",", "0.6054613829125256`"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.19672632861669323`"}], ",", "0.6054613829125256`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5150362148004839`"}], ",", "0.37419571351545566`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.6366197723675814`"}], ",", "0.`"}], "}"}]}], 
     "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.892209518437051*^9, 3.89221393312112*^9, 
  3.8922171171439*^9, 3.8922175169206944`*^9, 3.892218657408482*^9, 
  3.892239412067514*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"58fe10bb-5f11-4a14-807f-3bbc5d837bee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ";;", 
    RowBox[{"-", "2"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.892218872236373*^9, 3.892218875849612*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"0b7efc76-3ae6-420d-af67-8ff02464cba2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.89221887613908*^9, 3.89223941208246*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"b6006069-cc32-4299-8446-f55d3903a2f9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"sofaControlPane", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sofaControlPane", "[", 
   RowBox[{"sofa_", ",", "bg_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"LocatorPane", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dynamic", "[", 
     RowBox[{
      RowBox[{"sofa", "[", "xValues", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sofa", "[", "xValues", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"First", "[", "#", "]"}]}], ",", "0"}], "}"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"Last", "[", "#", "]"}]}], ",", "0"}], "}"}], "}"}]}], 
          "]"}]}], ")"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", "bg"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.892208490211973*^9, 3.892208559841818*^9}, {
   3.8922086684095907`*^9, 3.892208668965229*^9}, {3.892209116663773*^9, 
   3.892209119480772*^9}, {3.892209425346846*^9, 3.892209461131318*^9}, {
   3.8922094942028513`*^9, 3.892209497516364*^9}, {3.892213680267717*^9, 
   3.8922136929936438`*^9}, {3.89221373907353*^9, 3.892213760927567*^9}, 
   3.892213924537203*^9, {3.892217125001854*^9, 3.8922171768638983`*^9}, {
   3.892217212402749*^9, 3.8922172233510847`*^9}, {3.8922172702408657`*^9, 
   3.892217271819106*^9}, {3.8922173514791937`*^9, 3.8922173541092463`*^9}, 
   3.892217391726984*^9, 3.8922174619409018`*^9, {3.892218702087405*^9, 
   3.892218783232539*^9}, {3.892218814151476*^9, 3.892218870176731*^9}, {
   3.892218956982923*^9, 3.892218958773024*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"6db28334-901e-4fa4-894d-86e0497adca3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sofaControlPane", "[", 
  RowBox[{"ss", ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Gray", ",", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "3"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8922094725604277`*^9, 3.8922094762859*^9}, {
  3.892217368643773*^9, 3.892217370481933*^9}, {3.892218721136129*^9, 
  3.892218721285206*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"90a70832-fc5a-4fbf-bf46-8273ac4b5f16"],

Cell[BoxData[
 LocatorPaneBox[Dynamic[
   $CellContext`ss[$CellContext`xValues], \
($CellContext`ss[$CellContext`xValues] = Join[{{
       First[
        First[#]], 0}}, 
     Part[#, 
      Span[2, -2]], {{
       First[
        Last[#]], 0}}])& ], 
  GraphicsBox[
   {GrayLevel[0.5], DiskBox[{0, 0}, 3]}]]], "Output",
 CellChangeTimes->{3.8922189609628468`*^9, 3.8922394121006603`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"aedb5881-5bb4-401d-965b-66f55863b9cb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"InfiniteLine", "[", 
   RowBox[{
    RowBox[{"y", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"InfiniteLine", "[", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}], ",", 
    RowBox[{"v", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"InfiniteLine", "[", 
   RowBox[{
    RowBox[{"y", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}], ",", 
    RowBox[{"-", 
     RowBox[{"u", "[", 
      RowBox[{"sofa", ",", "i"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"InfiniteLine", "[", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}], ",", 
    RowBox[{"-", 
     RowBox[{"u", "[", 
      RowBox[{"sofa", ",", "i"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.891874516874506*^9, 3.89187456379522*^9}, {
  3.8918787040890503`*^9, 3.891878705049988*^9}, {3.892238010104136*^9, 
  3.892238032382883*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"0939f794-228d-49b8-9ae4-a91cc1a6816e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nicheLine", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"n", "[", "sofa", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"sofa", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "<=", "0"}], ",", 
          RowBox[{"n", "+", "i"}], ",", "i"}], "]"}]}], "]"}], ",", 
      RowBox[{"u", "[", 
       RowBox[{"sofa", ",", "i"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8922380025151653`*^9, 3.892238069610326*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"d72eb451-066d-4f5e-9f03-ae7d6b60b212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nicheIntersection", "[", 
   RowBox[{"sofa_", ",", "i_Integer", ",", "j_Integer"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"lineIntersection", "[", 
   RowBox[{
    RowBox[{"nicheLine", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}], ",", 
    RowBox[{"nicheLine", "[", 
     RowBox[{"sofa", ",", "j"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.892219814721385*^9, 3.892219824168455*^9}, {
  3.892238090296928*^9, 3.892238104979097*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"e5481c68-8017-4634-91e6-cd3ac8248418"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nodes", "[", 
    RowBox[{"sofa_", ",", "polyline_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"lineIntersection", "@@@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"nicheLine", "[", 
         RowBox[{"sofa", ",", "#"}], "]"}], "&"}], "/@", "polyline"}], ",", 
      "2", ",", "1"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstNode", "[", 
    RowBox[{"_", ",", 
     RowBox[{"{", "line_", "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Infinity", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstNode", "[", 
    RowBox[{"sofa_", ",", "polyline_"}], "]"}], ":=", 
   RowBox[{"nicheIntersection", "[", 
    RowBox[{"sofa", ",", 
     RowBox[{"polyline", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"polyline", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reportIntervals", "[", 
    RowBox[{"_", ",", "prevX_", ",", 
     RowBox[{"{", "aFirst_Integer", "}"}], ",", 
     RowBox[{"{", "bFirst_Integer", "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"prevX", ",", "Infinity"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aFirst", ",", "bFirst"}], "}"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reportIntervals", "[", 
    RowBox[{"sofa_", ",", "prevX_", ",", 
     RowBox[{"a", ":", 
      RowBox[{"{", 
       RowBox[{"aFirst_Integer", ",", "aRest___"}], "}"}]}], ",", 
     RowBox[{"b", ":", 
      RowBox[{"{", 
       RowBox[{"bFirst_Integer", ",", "bRest___"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"curX", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"firstNode", "[", 
           RowBox[{"sofa", ",", "a"}], "]"}]}], ",", 
         RowBox[{"First", "@", 
          RowBox[{"firstNode", "[", 
           RowBox[{"sofa", ",", "b"}], "]"}]}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"firstNode", "[", 
            RowBox[{"sofa", ",", "a"}], "]"}]}], "<", 
          RowBox[{"First", "@", 
           RowBox[{"firstNode", "[", 
            RowBox[{"sofa", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"reportIntervals", "[", 
          RowBox[{"sofa", ",", "curX", ",", 
           RowBox[{"{", "aRest", "}"}], ",", "b"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"reportIntervals", "[", 
          RowBox[{"sofa", ",", "curX", ",", "a", ",", 
           RowBox[{"{", "bRest", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prevX", ",", "curX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aFirst", ",", "bFirst"}], "}"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"handleInterval", "[", 
    RowBox[{"sofa_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t1_", ",", "t2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l1_Integer", ",", "l2_Integer"}], "}"}]}], "}"}]}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inter", "=", 
        RowBox[{"nicheIntersection", "[", 
         RowBox[{"sofa", ",", "l1", ",", "l2"}], "]"}]}], ",", 
       RowBox[{"a", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"l1", ",", "l2"}], "]"}]}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"l1", ",", "l2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"inter", "===", "Null"}], ",", 
       RowBox[{"{", "b", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", "@", "inter"}], "<=", "t1"}], ",", 
       RowBox[{"{", "b", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", "@", "inter"}], "<", "t2"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", "True", 
       ",", 
       RowBox[{"{", "a", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polylineUnion", "[", 
    RowBox[{"sofa_", ",", "polyline1_", ",", "polyline2_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ReplaceRepeated", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"handleInterval", "[", 
         RowBox[{"sofa", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"reportIntervals", "[", 
        RowBox[{"sofa", ",", 
         RowBox[{"-", "Infinity"}], ",", "polyline1", ",", "polyline2"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a___", ",", "x_", ",", "x_", ",", "b___"}], "}"}], ":>", 
        RowBox[{"{", 
         RowBox[{"a", ",", "x", ",", "b"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a___", ",", "x_", ",", "_", ",", "x_", ",", "b___"}], "}"}],
         ":>", 
        RowBox[{"{", 
         RowBox[{"a", ",", "x", ",", "b"}], "}"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drawPolyline", "[", 
    RowBox[{"_", ",", 
     RowBox[{"{", "a_", "}"}]}], "]"}], ":=", "a"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drawPolyline", "[", 
    RowBox[{"sofa_", ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b___", ",", "c_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ad", "=", 
        RowBox[{"Last", "@", 
         RowBox[{"nicheLine", "[", 
          RowBox[{"sofa", ",", "a"}], "]"}]}]}], ",", 
       RowBox[{"cd", "=", 
        RowBox[{"Last", "@", 
         RowBox[{"nicheLine", "[", 
          RowBox[{"sofa", ",", "c"}], "]"}]}]}], ",", "nds"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nds", "=", 
       RowBox[{"nodes", "[", 
        RowBox[{"sofa", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"HalfLine", "[", 
         RowBox[{
          RowBox[{"First", "@", "nds"}], ",", 
          RowBox[{"-", "ad"}]}], "]"}], ",", 
        RowBox[{"Line", "[", "nds", "]"}], ",", 
        RowBox[{"HalfLine", "[", 
         RowBox[{
          RowBox[{"Last", "@", "nds"}], ",", "cd"}], "]"}]}], "}"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8918696482630787`*^9, 3.89186972036773*^9}, {
   3.891873668813657*^9, 3.891873676537459*^9}, {3.891873846996997*^9, 
   3.891873881914741*^9}, {3.892219857577787*^9, 3.892219875598749*^9}, {
   3.8922199056722116`*^9, 3.892219908276595*^9}, 3.8922363093760357`*^9, {
   3.892236356029745*^9, 3.892236374148753*^9}, {3.892236973265757*^9, 
   3.892236995785796*^9}, {3.892238117148796*^9, 3.892238117576931*^9}, {
   3.89223819067673*^9, 3.892238199582782*^9}, {3.892238245960258*^9, 
   3.8922382918780746`*^9}, {3.892238500808085*^9, 3.8922385559537086`*^9}, {
   3.892238619264839*^9, 3.892238636785343*^9}, {3.892239694426671*^9, 
   3.892239704735326*^9}, {3.892240659594657*^9, 3.892240675652343*^9}, {
   3.8922409099871693`*^9, 3.892240928785183*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"17c312c2-55fa-473b-8e30-b43553dfdad8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"niche", "[", "sofa_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"polylineUnion", "[", 
      RowBox[{"sofa", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"i", "-", 
         RowBox[{"n", "[", "sofa", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"n", "[", "sofa", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.89186974832451*^9, 3.891869766416903*^9}, {
  3.891869801410531*^9, 3.891869807613422*^9}, {3.891873318225415*^9, 
  3.8918733414152946`*^9}, {3.892238643733273*^9, 3.892238683839192*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"20ac915d-598d-4558-be4a-9e5b0bc9fc1e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"drawPolyline", "[", 
    RowBox[{"ss", ",", 
     RowBox[{"niche", "[", "ss", "]"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "1.2"}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892240788753791*^9, 3.8922407897982616`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"de2570ac-9509-41c1-8e76-bf41f97db07d"],

Cell[BoxData[
 GraphicsBox[{
   TagBox[ConicHullRegionBox[{{-0.6366197723675814, 0.}}, {{-1, 0}}],
    "HalfLine"], 
   LineBox[{{-0.6366197723675814, 0.}, {-0.5150362148004839, 
    0.37419571351545566`}, {-0.39345265723338635`, 
    0.3346908209238383}, {-0.1967263286166932, 0.6054613829125256}, {0., 
    0.46253133879414005`}, {0.1967263286166932, 0.6054613829125256}, {
    0.39345265723338635`, 0.3346908209238383}, {0.5150362148004839, 
    0.37419571351545566`}, {0.6366197723675814, 0.}}], 
   TagBox[ConicHullRegionBox[{{0.6366197723675814, 0.}}, {{1, 0}}],
    "HalfLine"]},
  PlotRange->{{-3, 1}, {-0.2, 1.2}}]], "Output",
 CellChangeTimes->{
  3.892240750384736*^9, 3.892240790179925*^9, {3.892240919773525*^9, 
   3.892240938748281*^9}},
 CellLabel->
  "Out[107]=",ExpressionUUID->"246f3f99-b2a4-420f-88ac-1dbfc0699bc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sofaControlPane", "[", 
  RowBox[{"ss", ",", 
   RowBox[{"Dynamic", "@", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"drawPolyline", "[", 
       RowBox[{"ss", ",", 
        RowBox[{"niche", "[", "ss", "]"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.2"}], ",", "1.2"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8918733422436943`*^9, 3.891873408562072*^9}, {
   3.892240709347479*^9, 3.892240745019869*^9}, 3.892240946387744*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"b431419a-b4d1-4ba6-964c-2c1a0c025b96"],

Cell[BoxData[
 LocatorPaneBox[Dynamic[
   $CellContext`ss[$CellContext`xValues], \
($CellContext`ss[$CellContext`xValues] = Join[{{
       First[
        First[#]], 0}}, 
     Part[#, 
      Span[2, -2]], {{
       First[
        Last[#]], 0}}])& ], 
  DynamicBox[ToBoxes[
    Graphics[
     $CellContext`drawPolyline[$CellContext`ss, 
      $CellContext`niche[$CellContext`ss]], 
     PlotRange -> {{-3, 1}, {-0.2, 1.2}}], StandardForm],
   ImageSizeCache->{360., {61., 65.}}]]], "Output",
 CellChangeTimes->{{3.891873342888228*^9, 3.8918733757116737`*^9}, 
   3.8918734093055696`*^9, {3.8918734991693296`*^9, 3.891873509567829*^9}, 
   3.8918738961214247`*^9, 3.8918744819811993`*^9, {3.891877870950057*^9, 
   3.891877888305841*^9}, {3.892240712168939*^9, 3.892240745680819*^9}, {
   3.892240940224155*^9, 3.892240946935174*^9}},
 CellLabel->
  "Out[109]=",ExpressionUUID->"14768fd0-0398-475f-931f-2feccd02e92e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"va", "[", 
   RowBox[{"sofa_", ",", "0"}], "]"}], ":=", 
  RowBox[{"lineIntersection", "[", 
   RowBox[{
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
    RowBox[{"a", "[", 
     RowBox[{"sofa", ",", "0"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"va", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"lineIntersection", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"sofa", ",", "i"}], "]"}], ",", 
    RowBox[{"a", "[", 
     RowBox[{"sofa", ",", 
      RowBox[{"i", "-", "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vc", "[", 
   RowBox[{"sofa_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "===", 
     RowBox[{"n", "[", "sofa", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"lineIntersection", "[", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"sofa", ",", "n"}], "]"}], ",", 
      RowBox[{"InfiniteLine", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"lineIntersection", "[", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"sofa", ",", "i"}], "]"}], ",", 
      RowBox[{"c", "[", 
       RowBox[{"sofa", ",", 
        RowBox[{"i", "+", "1"}]}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.891874569622342*^9, 3.8918746070494537`*^9}, {
  3.891874780687943*^9, 3.891874789649659*^9}, {3.891874913440508*^9, 
  3.891874947106735*^9}, {3.8922415111215477`*^9, 3.89224152956504*^9}, {
  3.892243816689513*^9, 3.8922438521302023`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"21909876-aa16-4fc8-8849-aaf1f39d3bfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"l0", "=", 
   RowBox[{"InfiniteLine", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "y0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u0", ",", "v0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", "=", 
   RowBox[{"InfiniteLine", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "y1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u1", ",", "v1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", 
   RowBox[{"InfiniteLine", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", "y2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u2", ",", "v2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u1", ",", "v1"}], "}"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"lineIntersection", "[", 
      RowBox[{"l1", ",", "l2"}], "]"}], "-", 
     RowBox[{"lineIntersection", "[", 
      RowBox[{"l0", ",", "l1"}], "]"}]}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891877630114584*^9, 3.8918777484246473`*^9}, {
  3.891877796414796*^9, 3.891877821829924*^9}, {3.891877913511738*^9, 
  3.891877917193672*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"7a89d3e7-02d8-44c1-8a82-fb8e97412ff8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["u1", "2"], "+", 
     SuperscriptBox["v1", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"u0", " ", "v1", " ", "v2", " ", 
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}]}], "+", 
     RowBox[{"u1", " ", "v2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v0", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x0"}], "+", "x2"}], ")"}]}], "+", 
        RowBox[{"u0", " ", 
         RowBox[{"(", 
          RowBox[{"y0", "-", "y1"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"u2", " ", "v0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v1", " ", 
         RowBox[{"(", 
          RowBox[{"x0", "-", "x1"}], ")"}]}], "+", 
        RowBox[{"u1", " ", 
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"u0", " ", "u2", " ", "v1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y0"}], "+", "y2"}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"u1", " ", "v0"}], "-", 
     RowBox[{"u0", " ", "v1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "u2"}], " ", "v1"}], "+", 
     RowBox[{"u1", " ", "v2"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.891877748912663*^9, 3.891877754122493*^9}, {
   3.891877801767675*^9, 3.891877822484194*^9}, 3.891877870982814*^9, {
   3.8918779058425503`*^9, 3.891877917540889*^9}, 3.891878712670632*^9, 
   3.892243863786848*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"989871cb-eda2-441a-a3e7-0afa0e500e24"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"isCap", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0_", ",", "y0_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u0_", ",", "v0_"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u1_", ",", "v1_"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"InfiniteLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u2_", ",", "v2_"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{" ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u0", " ", "v1", " ", "v2", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}]}], "+", 
       RowBox[{"u1", " ", "v2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x0"}], "+", "x2"}], ")"}]}], "+", 
          RowBox[{"u0", " ", 
           RowBox[{"(", 
            RowBox[{"y0", "-", "y1"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"u2", " ", "v0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v1", " ", 
           RowBox[{"(", 
            RowBox[{"x0", "-", "x1"}], ")"}]}], "+", 
          RowBox[{"u1", " ", 
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"u0", " ", "u2", " ", "v1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y0"}], "+", "y2"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u1", " ", "v0"}], "-", 
       RowBox[{"u0", " ", "v1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "u2"}], " ", "v1"}], "+", 
       RowBox[{"u1", " ", "v2"}]}], ")"}]}]], ">", "0"}]}]], "Input",
 CellChangeTimes->{{3.89187804620339*^9, 3.8918780892435493`*^9}, 
   3.8918784187744827`*^9, {3.891878476266425*^9, 3.891878476932001*^9}, {
   3.891878553519424*^9, 3.891878555999721*^9}, 3.892243868182085*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"fb0c5969-23ae-49a6-bedd-91f9d0c87de1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"addHullStack", "[", 
    RowBox[{
     RowBox[{"{", "l0_", "}"}], ",", "l1_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"l0", ",", "l1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addHullStack", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stackMost___", ",", "l0_", ",", "l1_"}], "}"}], ",", "l2_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"isCap", "[", 
      RowBox[{"l0", ",", "l1", ",", "l2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"stackMost", ",", "l0", ",", "l1", ",", "l2"}], "}"}], ",", 
     RowBox[{"addHullStack", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"stackMost", ",", "l0"}], "}"}], ",", "l2"}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.891878093829978*^9, 3.891878097047942*^9}, {
  3.891878130737256*^9, 3.891878235202482*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"59e2a71c-08df-43c8-8f4c-e9ad93c30b42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hull", "[", "sofa_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"n", "[", "sofa", "]"}]}], "}"}], ",", 
    RowBox[{"lineIntersection", "@@@", 
     RowBox[{"Partition", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fold", "[", 
        RowBox[{"addHullStack", ",", 
         RowBox[{"{", 
          RowBox[{"InfiniteLine", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"sofa", ",", "i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"sofa", ",", "i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"InfiniteLine", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "}"}]}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", "2", ",", "1"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.891878246877803*^9, 3.891878313129478*^9}, {
   3.891878357445088*^9, 3.89187835892124*^9}, 3.8918783974671907`*^9, {
   3.891878526912855*^9, 3.8918785316519413`*^9}, {3.891878733679572*^9, 
   3.891878738444454*^9}, {3.891878850705872*^9, 3.8918788534478083`*^9}, {
   3.891878917463159*^9, 3.891878924156908*^9}, {3.891879039141824*^9, 
   3.891879090142041*^9}, {3.891879127326703*^9, 3.891879150230504*^9}, {
   3.892243890314476*^9, 3.892243951957369*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"5c9ddb00-9e98-4ea6-b00d-49633503cbd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hull", "[", "ss", "]"}]], "Input",
 CellChangeTimes->{{3.892243935759922*^9, 3.8922439366932077`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"4eac9839-73fd-4493-818c-445d03c34f0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.3316503903376051`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1977653866484121`", ",", "0.4120556717288772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0830280230156886`", ",", "0.5699781046354843`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.24044328497258013`"}], ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9500000000000002`"}], ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9500000000000002`"}], ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8922439371758327`*^9, 3.892243958885009*^9}},
 CellLabel->
  "Out[130]=",ExpressionUUID->"f06cb289-a412-4398-9b02-1dcc17ff2bf9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sofaGraphics", "[", "sofa_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"drawPolyline", "[", 
     RowBox[{"sofa", ",", 
      RowBox[{"niche", "[", "sofa", "]"}]}], "]"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"hull", "[", "sofa", "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8918750690932093`*^9, 3.8918751191226597`*^9}, {
  3.891875177228114*^9, 3.891875179116188*^9}, {3.8918789951757793`*^9, 
  3.8918789957951593`*^9}, {3.8918791094046707`*^9, 3.8918791099377947`*^9}, {
  3.89187918474196*^9, 3.891879184896546*^9}, {3.892243964883276*^9, 
  3.892243980441762*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"e50b4420-e11b-40a7-bd4a-e36a387a42da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sofaControlPane", "[", 
  RowBox[{"ss", ",", 
   RowBox[{"Dynamic", "@", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"sofaGraphics", "[", "ss", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "600"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891875151968844*^9, 3.891875185891139*^9}, {
  3.891877469303026*^9, 3.891877490678548*^9}, {3.89224398288306*^9, 
  3.892243998540444*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"c35ceb27-f1a5-4943-8034-b25e4263843d"],

Cell[BoxData[
 LocatorPaneBox[Dynamic[
   $CellContext`ss[$CellContext`xValues], \
($CellContext`ss[$CellContext`xValues] = Join[{{
       First[
        First[#]], 0}}, 
     Part[#, 
      Span[2, -2]], {{
       First[
        Last[#]], 0}}])& ], 
  DynamicBox[ToBoxes[
    Graphics[
     $CellContext`sofaGraphics[$CellContext`ss], 
     PlotRange -> {{-3, 1}, {-0.2, 1.2}}, ImageSize -> 600], StandardForm],
   ImageSizeCache->{600., {103., 107.}}]]], "Output",
 CellChangeTimes->{3.891877871006579*^9, 3.891878997627055*^9, 
  3.891879177603592*^9, 3.892243999784354*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"9783d472-0236-4d8c-a68d-c4f362e78cd5"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{22, Automatic}, {48, Automatic}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9000b01d-e3a9-4800-810a-98e9a78bfc20"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 289, 5, 30, "Input",ExpressionUUID->"cfc15008-a37b-4de6-b8da-0a9e6938ba38"],
Cell[872, 29, 269, 5, 34, "Output",ExpressionUUID->"6dd4cc82-e289-41b1-93c1-4e3b4b5e2745"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1178, 39, 1466, 38, 94, "Input",ExpressionUUID->"30e8503f-cfe3-45bd-b998-35dc78cc18f4"],
Cell[2647, 79, 1433, 32, 51, "Output",ExpressionUUID->"58db336d-5ac2-457d-b0be-86f12f4663d3"]
}, Open  ]],
Cell[4095, 114, 811, 21, 94, "Input",ExpressionUUID->"fe93333e-ed20-48db-be1b-cc01762c64f6"],
Cell[4909, 137, 640, 16, 52, "Input",ExpressionUUID->"6381ffbc-0302-4274-81e4-0ff0a091dbc1"],
Cell[5552, 155, 1047, 23, 94, "Input",ExpressionUUID->"d74168cb-0cee-4317-8c98-5aa3c0f8a085"],
Cell[6602, 180, 1088, 25, 94, "Input",ExpressionUUID->"86cedb5c-bc5b-401b-bec8-33af082736a8"],
Cell[CellGroupData[{
Cell[7715, 209, 1061, 30, 30, "Input",ExpressionUUID->"0bc5d71b-f3ab-44be-ad99-e599a9f9cd30"],
Cell[8779, 241, 1386, 35, 60, "Output",ExpressionUUID->"d1bc4b07-7dcf-47c8-8328-493ff2e48906"]
}, Open  ]],
Cell[10180, 279, 363, 8, 30, "Input",ExpressionUUID->"2e109ab7-a4ed-4cfc-8a27-78558e788aeb"],
Cell[10546, 289, 1059, 30, 52, "Input",ExpressionUUID->"847ddab4-155c-462a-b842-136554521aa5"],
Cell[11608, 321, 978, 29, 52, "Input",ExpressionUUID->"55002317-f12d-4e48-a570-44a5df4c005d"],
Cell[12589, 352, 732, 20, 52, "Input",ExpressionUUID->"f51f7346-24a0-485c-9d8e-6d0cfb79cea4"],
Cell[CellGroupData[{
Cell[13346, 376, 221, 3, 30, "Input",ExpressionUUID->"b4db92ec-6741-40a4-ab89-021d49a6e71a"],
Cell[13570, 381, 1288, 34, 60, "Output",ExpressionUUID->"58fe10bb-5f11-4a14-807f-3bbc5d837bee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14895, 420, 344, 8, 30, "Input",ExpressionUUID->"0b7efc76-3ae6-420d-af67-8ff02464cba2"],
Cell[15242, 430, 224, 4, 34, "Output",ExpressionUUID->"b6006069-cc32-4299-8446-f55d3903a2f9"]
}, Open  ]],
Cell[15481, 437, 2169, 48, 178, "Input",ExpressionUUID->"6db28334-901e-4fa4-894d-86e0497adca3"],
Cell[CellGroupData[{
Cell[17675, 489, 550, 14, 30, "Input",ExpressionUUID->"90a70832-fc5a-4fbf-bf46-8273ac4b5f16"],
Cell[18228, 505, 466, 13, 384, "Output",ExpressionUUID->"aedb5881-5bb4-401d-965b-66f55863b9cb"]
}, Open  ]],
Cell[18709, 521, 1445, 42, 94, "Input",ExpressionUUID->"0939f794-228d-49b8-9ae4-a91cc1a6816e"],
Cell[20157, 565, 784, 21, 73, "Input",ExpressionUUID->"d72eb451-066d-4f5e-9f03-ae7d6b60b212"],
Cell[20944, 588, 569, 13, 52, "Input",ExpressionUUID->"e5481c68-8017-4634-91e6-cd3ac8248418"],
Cell[21516, 603, 7988, 216, 682, "Input",ExpressionUUID->"17c312c2-55fa-473b-8e30-b43553dfdad8"],
Cell[29507, 821, 893, 24, 30, "Input",ExpressionUUID->"20ac915d-598d-4558-be4a-9e5b0bc9fc1e"],
Cell[CellGroupData[{
Cell[30425, 849, 586, 18, 30, "Input",ExpressionUUID->"de2570ac-9509-41c1-8e76-bf41f97db07d"],
Cell[31014, 869, 835, 17, 143, "Output",ExpressionUUID->"246f3f99-b2a4-420f-88ac-1dbfc0699bc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31886, 891, 795, 22, 30, "Input",ExpressionUUID->"b431419a-b4d1-4ba6-964c-2c1a0c025b96"],
Cell[32684, 915, 915, 22, 151, "Output",ExpressionUUID->"14768fd0-0398-475f-931f-2feccd02e92e"]
}, Open  ]],
Cell[33614, 940, 1913, 54, 115, "Input",ExpressionUUID->"21909876-aa16-4fc8-8849-aaf1f39d3bfd"],
Cell[CellGroupData[{
Cell[35552, 998, 1326, 42, 94, "Input",ExpressionUUID->"7a89d3e7-02d8-44c1-8a82-fb8e97412ff8"],
Cell[36881, 1042, 1642, 50, 57, "Output",ExpressionUUID->"989871cb-eda2-441a-a3e7-0afa0e500e24"]
}, Open  ]],
Cell[38538, 1095, 2359, 70, 135, "Input",ExpressionUUID->"fb0c5969-23ae-49a6-bedd-91f9d0c87de1"],
Cell[40900, 1167, 1021, 29, 73, "Input",ExpressionUUID->"59e2a71c-08df-43c8-8f4c-e9ad93c30b42"],
Cell[41924, 1198, 2129, 52, 94, "Input",ExpressionUUID->"5c9ddb00-9e98-4ea6-b00d-49633503cbd1"],
Cell[CellGroupData[{
Cell[44078, 1254, 209, 4, 30, "Input",ExpressionUUID->"4eac9839-73fd-4493-818c-445d03c34f0a"],
Cell[44290, 1260, 777, 21, 34, "Output",ExpressionUUID->"f06cb289-a412-4398-9b02-1dcc17ff2bf9"]
}, Open  ]],
Cell[45082, 1284, 721, 16, 30, "Input",ExpressionUUID->"e50b4420-e11b-40a7-bd4a-e36a387a42da"],
Cell[CellGroupData[{
Cell[45828, 1304, 819, 21, 52, "Input",ExpressionUUID->"c35ceb27-f1a5-4943-8034-b25e4263843d"],
Cell[46650, 1327, 660, 18, 258, "Output",ExpressionUUID->"9783d472-0236-4d8c-a68d-c4f362e78cd5"]
}, Open  ]]
}
]
*)

