> __Definition [niche-monotonization-hallway-intersection].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, define the _niche_ of a hallway intersection $S$ as the following set. ^def-niche-hallway-intersection
$$
\mathcal{N}(S) = F_{\omega} \cap \bigcup_{t \in \Theta} Q^-_S(t) 
$$
> Also, define the _monotonization_ of $S$ as the set $\mathcal{M}(S) = \mathcal{C}(S) \setminus \mathcal{N}(S)$. 

> __Theorem [monotonization-connected-iff].__ Let $K$ be any cap. Then the followings are all equivalent. ^thm-monotonization-connected-iff
> 
> - Normalization $\mathcal{M}_\Theta(K)$ is connected
> - $\mathcal{N}_\Theta(K) \subseteq K \setminus \delta K$.
> - For any $t \in \Theta$, either $\mathbf{x}(t) \not\in F_\omega^\circ$ or $\mathbf{x}(t) \in K$.

_Proof._ (1 $\Rightarrow$ 2) To show this, it suffices to show that the set $T_t = P_\omega \cap Q^-_K(t)$ is contained in $K$ for any $t \in \Theta$. Then, as $T_t$ is an open set with respect to subset topology of $F_\omega$, and $K \setminus \delta K$ is the interior of $K$ inside the subset topology of $F_\omega$, we prove that $T_t$ is disjoint from $\delta K$. If $\mathbf{x}(t) \not\in F_\omega^\circ$ then $T_t$ is an empty set and we're done. So we can assume that $\mathbf{x}(t)$ is in $K$. Note that $T_t$ degenerates to empty set when $t = 0$ or $\omega$, so we assume $0 < t < \omega$.

We then show the following two facts.

- (a) The point $z_L = d_K(t) \cap l(\omega, 0)$ lies right to the point $C^+_K(\omega)$.
- (b) The point $z_R = b_K(t) \cap l(\pi/2, 0)$ lies left to the point $A^-_K(0)$.

We first show that $z_L$ lies right to the point $C^+_K(\omega)$. Say that a point $p_0$ is further than $p_1$ in the direction of nonzero vector $v \in \mathbb{R}^2$ if and only if $p_0 \cdot v \geq p_1 \cdot v$. For a fixed $v$, this is a partial order. 
$c_K(t) \cap l(\omega, 1)$ is further than $z_L = d(t) \cap l(\omega, 0)$ in the direction of $v_\omega$ as they are the intersection points of boundaries of strips $R_\omega(V)$ and $[f_K(t)](H)$. Take any point $q$ in $\delta K \cap c_K(t)$. $q$ is further than $c_K(t) \cap l(\omega, 1)$ in the direction of $v_\omega$. Finally, the endpoint $C^+_K(\omega)$ is further than $q$ in the direction of $v_\omega$ (TODO: add reference). Thus, $u_L$ is further than $z_L$ in the direction of $u_\omega$,
and the proof of (a) is complete. The proof of (b) can be done using a symmetric argument.

> __Figure [fan-convexity-argument].__  ^fig-fan-convexity-argument
![70%](images/fan-convexity-argument.png)

Next, we observe that there are essentially three types of how $T_t$ can be positioned inside $F_\omega$ as $\mathbf{x}(t) \in K$ and $0 < t < \omega$.

- (i) $(0, 0)$ is above or on $b_K(t)$ and below $d_K(t)$. 
- (ii) $(0, 0)$ is below $b_K(t)$ and $d_K(t)$
- (iii) $(0, 0)$ is below $b_K(t)$ and above or on $d_K(t)$

Now we finish the proof that $T_t$ is in $K$. In the first case (i), the wedge $T_t$ is the triangle with vertices $\mathbf{x}(t)$, $z_L$ and $l(\omega, 0) \cap b_K(t)$, and it is that $l(\omega, 0) \cap b_K(t)$ is on the line segment connecting $z_L$ and the origin. As the three vertices are in $K$ by assumptions and (a), we have $T_t$ contained in $K$. In the second case, $T_t$ is the quadrilateral with vertices $z_L, (0, 0), z_R$, and $\mathbf{x}(t)$ and all the vertices are in $K$ by (a) and (b), so we're done. Likewise, for the third case (iii) $T_t$ is the triangle with vertices $\mathbf{x}(t)$, $l(\pi/2, 0) \cap d_K(t)$, and $z_R$, and they are in $K$ by assumptions and (b). So $T_t$ is contained in $K$. This ends the proof that the upper boundary $\delta K$ is disjoint from $\mathcal{N}_\Theta(K)$.

(2 $\Rightarrow$ 3) As $\delta K$ is disjoint from $\mathcal{N}_\Theta(K)$, we have $\delta K \subseteq \mathcal{M}_\Theta(K)$. We show that $\mathcal{M}_\Theta(K)$ is connected. First, $\delta K$ is connected. Next, take any point $p \in \mathcal{M}_\Theta(K) = K \setminus \mathcal{N}_\Theta(K)$. Take the ray $r$ upwards starting from $p$. Then $r$ touches a point in $\delta K$ as $p \in K$. Moreover, $r$ is disjoint from $\mathcal{N}_\Theta(K)$ or otherwise, there is some point $p'$ in both $r$ and $\mathcal{N}_\Theta(K)$ so there is some $t \in \Theta$ such that $p' \in Q^-_K(t)$. But then $p \in Q_K^-(t)$ as the set $Q_K^-(t)$ is downwardsly-closed (TODO: what it means). So this gives contradiction and $r$ is disjoint from $\mathcal{N}_\Theta(K)$. Now $r \cap K$ is a line segment inside $\mathcal{M}_\Theta(K)$ that connects any point $p \in \mathcal{M}_\Theta(K)$ to a point in $\delta K$. So $\mathcal{M}_\Theta(K)$ is connected.

(TODO: factor out closedness under decreasing y-coordinates, and mention that it is a crucial fact that we rely on)

(3 $\Rightarrow$ 1) Assume by contradictory that $S := \mathcal{M}_\Theta(K)$ is connected and $\mathbf{x}(t) \in F_\omega^\circ \setminus K$ for some $t \in \Theta$. We first show that the vertical line passing through $\mathbf{x}(t)$ does not overlap with $S$. The ray $r$ upwards from $\mathbf{x}(t)$ is also inside $F_\omega^\circ \setminus K$ by the property of $F_\omega^\circ \setminus K$. The ray downwards from $\mathbf{x}(t)$ is not in $S$ because $\mathbf{x}(t)$ is the corner of $Q_K^-(t)$. 

Now separate $H$ into two chunks by the vertical line $l$ passing through $\mathbf{x}(t)$. The line $l$ does not overlap with $S$. As $S$ is connected, $S$ should lie either strictly on left or strictly on right of $l$. Let $(x_0, y_0) = \mathbf{x}(t)$. As $\mathbf{x}(t) \in F_\omega$ we have $y_0 \geq 0$. Assume first that $S$ lies strictly on left. Then any point of $S$ has $x$-coordinate less than $x_0$, and $y$-coordinate less than or equal to 1. Now $p_S(t) \leq x_0 \cos(t) + \sin(t) < x_0 \cos(t) + 1$, but by definition of $\mathbf{x}(t)$ we have $p_S(t) = \mathbf{x}(t) \cdot u_t + 1 = x_0 \cos(t) + y_0 \sin (t) + 1 \geq x_0 \cos(t) + 1$, and this leads to contradiction and ends the proof. □

> __Theorem [monotonization-is-hallway-intersection].__ Let $S$ be a hallway intersection with rotation angle $\omega$ and angle set $\Theta$. Then the monotonization $\mathcal{M}(S)$ is also a hallway intersection that contains $S$. ^thm-monotonization-is-hallway-intersection

_Proof._ The containment $\mathcal{M}(S) \supseteq S$ come from the following.
$$
\mathcal{M}(S) = \mathcal{C}(S) \setminus \mathcal{N}(S) = P_\omega \cap \left( \bigcap_{t \in \Theta} Q^+_S(t) \setminus \bigcup_{t \in \Theta} Q^-_S(t) \right) = P_\omega \cap \bigcap_{t \in \Theta} L_S(t) \supseteq S
$$
Here the last containment holds from [[01. Moving Hallway Problem#^lem-in-tangent-hallway]]. 

It remains to show that $\mathcal{M}_\Theta(S)$ is connected. Take any point $p$ in $\mathcal{M}_\Theta(S)$. Take the line $l_\theta$ starting from $p$ that makes an angle of arbitrary $\theta \in [\omega, \pi/2]$ with the $x$-axis. Observe that $l_\theta \cap \mathcal{M}_\Theta(S)$ is a nonempty line segment. So if any of $l_\theta$ meets $S$, then $p$ is connected to $S$ inside $\mathcal{M}_\Theta(S)$ and the proof is done. Our goal now is to prove that there is some $\theta \in [\omega, \pi/2]$ such that 

The line $l_S(0)$ is not on the strictly left side of $l_{\pi/2}$, or otherwise as $l_S(0) = l_{\mathcal{M}_{\Theta}(S)}(0)$ and $p \in \mathcal{M}_\Theta(S)$ this is contradiction. If $l_S(0)$ passes $p$, then we prove that $l_{\pi/2} = l_{S}(0)$ passes $p$ so we are done. So we are left with the assumption that $l_{S}(0)$ is strictly on the right side of $l_{\pi/2}$. Consequently, some point of $S$ is on the strictly right side of $l_{\pi/2}$.

Likewise, the line $l_S(\omega + \pi/2)$ is not on the strictly right side of $l_{\omega}$, or otherwise as $l_{S}(\omega + \pi/2) = l_{\mathcal{M}_{\Theta}(S)}(\omega + \pi/2)$ and $p \in \mathcal{M}_\Theta(S)$ this is contradiction. If $l_S(\omega + \pi/2)$ passes $p$, then we have $l_\omega = l_S(\omega + \pi/2)$ passing $p$ so we are done. So we are left with the assumption that $l_{S}(\omega + \pi/2)$ is strictly on the left side of $l_{\omega}$. Consequently, some point of $S$ is strictly on the left side of $l_{\omega}$.

Assume contradictory that there is some $p$ such that for all $\theta \in [\omega, \pi/2]$ the line $l_\theta$ does not meet $S$. Then as $S$ is connected $S$ is either on the left side or right side of $l_\theta$ for any $\theta \in [\omega, \pi/2]$. As some point of $S$ is strictly on right side of $l_{\pi/2}$, the whole $S$ has to lie on strictly right side of $l_{\pi/2}$. Likewise, as some point of $S$ is strictly on the left side of $l_{\omega}$, the whole $S$ has to lie strictly on the left side of $l_{\omega}$. This is contradiction. (TODO: improve explanation: what does it mean exacly to 'strictly lie on left'?) □

> __Definition [monotone-sofa].__ A _monotone sofa_ $S$ with cap $K$ and angle set $\Theta$ and rotation angle $\omega$ is the shape $S = \mathcal{M}_\Theta(K)$ that is connected. ^def-monotone-sofa

_Proof._ We check that such $S$ is indeed a sofa with angle set $\Theta$. First, $S$ is connected. Second, the set $S = \mathcal{M}_\Theta(K)$ is inside $P_\omega$ and admits any hallways rotated by any angle in $\Theta$. □

> __Corollary [maximum-area-monotone-sofa].__ For any fixed angle set $\Theta$, any sofa $S$ is contained in the monotone sofa $\mathcal{M}_\Theta(K)$ with cap $K = \mathcal{C}(S)$ after some proper rigid motion. ^cor-maximum-area-monotone-sofa

_Proof._ We have $\mathcal{M}_\Theta(K) = \mathcal{M}_\Theta(\mathcal{C}(S)) = \mathcal{M}_\Theta(S)$. We can assume that $S$ is hallway intersection using [[01. Moving Hallway Problem#^thm-sofa-iff-hallway-intersection]]. Then [[#^thm-monotonization-is-hallway-intersection]] tells that $\mathcal{M}_\Theta(S)$ is a sofa containing $S$. By definition this is a monotone sofa. □

> __Theorem [maximum-sofa-polygon-limit].__ Fix the rotation angle $\omega$.  ^thm-maximum-sofa-polygon-limit