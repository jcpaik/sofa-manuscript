# Overview

Let $S$ be a sofa with rotation angle $\omega \in [0, \pi/2]$ in standard position. We pushed the moving hallway towards $S$ as much as possible in [[01. Moving Hallway Problem#^thm-in-tangent-hallway]], so that for any angle $t \in [0, \omega]$ the tangent hallway $L_S(t)$ contains $S$ and touches $S$ in the outer walls $a_S(t)$ and $c_S(t)$. Here, we define the _monotonization_ of $S$ as the intersection $\mathcal{M}(S) = P_\omega \cap \bigcap_{0 \leq t \leq \omega} L_S(t)$ of the parallelogram and tangent hallways. As a sofa in standard position is a hallway intersection, the definition generalizes to arbitrary hallway intersections.

> __Definition [monotonization].__ Let $S$ is any hallway intersection in standard position with rotation angle $\omega$ and angle set $\Theta$. Define the _monotonization_ of $S$ as the following set. ^def-monotonization
$$
\mathcal{M}(K) = P_\omega \cap \bigcap_{t \in \Theta} L_S(t)
$$

Our main theorems are the followings. First, the monotonization of any hallway intersection $S$ contains $S$ and is itself a hallway intersection. Thus, it is safe to assume that a hallway intersection of maximum area with angle set $\Theta$ is .

Second, the monotonization consists of a cap subtracted by the niche determined by the cap. The cap $K$ of S is defined as the intersection of Pw and Qs. So it is convex. The niche is the region carved out by the inner corners. We will show that $\mathcal{N}(K)$ is strictly inside $K$ and does not touch the upper boundary of $K$. As one can see, everything is determined by the cap $K$. This helps as we can understand everything in $\mathcal{K}$.

Let us examine $\mathcal{M}(K)$ in more details. For any angle $\omega \in [0, \pi/2]$, define the fan $F_\omega$ as the following.

> __Definition [fan].__ For any angle $\omega \in [0, \pi/2]$, define the _fan_ $F_\omega = H(0, \pi+\omega) \cap H(0, 3\pi/2)$. $F_\omega$ is the convex cone spanned by $u_0$ and $v_\omega$. The lines $l(\omega)$ and $l(\pi/2)$ are the edges of $F_\omega$. Denote the interior of $F_\omega$ as $F_\omega^\circ = H^\circ(0, \pi+\omega) \cap H^\circ(0, 3\pi/2)$. ^def-fan

Note that the fan $F_\omega$ contains the parallelogram $P_\omega$. Writing each $L_S(t)$ as $Q^+_S(t)\setminus Q^-_S(t)$, the intersection $M$ can be separated into two parts.
$$
M = P_\omega \cap \bigcap_{0 \leq t \leq \omega} L_S(t) =
\left( P_\omega \cap \bigcap_{0 \leq t \leq \omega} Q^+_S(t) \right) \setminus \left( F_\omega \cap \bigcup_{0 \leq t \leq \omega} Q^-_S(t) \right) 
$$
The set $K = P_\omega \cap \bigcap_{0 \leq t \leq \omega} Q^+_S(t)$ is a convex set bounded by parallelogram $P_\omega$ and closed quarter-planes $Q^+_S(t)$. We will call $K$ the _cap_ of $S$. The convex cap $K$ is carved out by the inner corners $Q^-_S(t)$. We will define the carved region $\mathcal{N}(K) = F_\omega \cap \bigcup_{0 \leq t \leq \omega} Q^-_S(t)$ as the _niche_ of $K$. Then our monotone sofa $M$ is the difference $K \setminus \mathcal{N}(K)$ of cap and niche. We will show that $M$ itself is connected and so it is a sofa. Moreover, we will show that $\mathcal{N}(K)$ is strictly inside $K$ and does not touch the upper boundary of $K$.

# Formal Definitions and Main Theorems

We provide the full details of the previous overview. First, we formally define what is a cap.

> __Definition [cap].__ A _cap_ $K$ with _rotation angle_ $\omega \in [0, \pi/2]$ and a closed _angle set_ $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq \left[ 0, \omega \right]$ is a convex body such that the followings hold. ^def-cap
> 
> - $p_K(\omega) = p_K(\pi/2) = 1$ and $p_K(\pi + \omega) = p_K(3\pi/2) = 0$. Geometrically speaking, $K$ is contained in the parallelogram $P_\omega$ and touches all the sides of $P_\omega$.
> - $K$ is [[01. Geometric Definitions#^def-convex-body-supported|supported by]] the set $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$.

> __Corollary [cap-in-standard-position].__ A cap $K$ with rotation angle $\omega \in [0, \pi/2]$ is in standard position respect to $\omega$. ^cor-cap-in-standard-position

Let us formally show that the set $K = P_\omega \cap \bigcap_{0 \leq t \leq \omega} Q^+_S(t)$ in the overview indeed adheres to [[02. Monotone Sofas#^def-cap]]. Note that we prove this in the general case where $S$ is a hallway intersection with arbitrary angle set.

> __Theorem [cap-hallway-intersection].__ Let $S$ be any hallway intersection in standard position with rotation angle $\omega \in [0, \pi/2]$ and angle set $\Theta \subseteq [0, \omega]$. Define  $\mathcal{C}(S)$ as the following set.
$$
\mathcal{C}(S) = P_\omega \cap \bigcap_{t \in \Theta} Q^+_S(t)
$$
> Then $\mathcal{C}(S)$ is a cap with rotation angle $\omega$ and angle set $\Theta$. We call $\mathcal{C}(S)$ as the _cap_ of $S$. ^thm-cap-hallway-intersection

_Proof._ As $Q^+_S(t)$ is the intersection of two half-planes of normal angle $t$ and $t + \pi/2$, the set $K = \mathcal{C}(S)$ is a convex set supported by the set $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$. Moreover, $p_K(\omega) = p_K(\pi/2) = 1$ because $S$ is in standard position so $p_{S}(\omega)=p_S(\pi/2)=1$. It remains to verify $p_K(\pi + \omega) = p_K(3\pi/2) = 0$.

We first handle the case $\omega = \pi/2$. For this we only need to prove $p_{K}(3\pi/2) = 0$. As $p_{S}(\pi/2)=1$, we have some point $(x_0, 1)$ which is in $S$ and thus $K$. Observe that $(x_0, 0)$ is also in $K$ as the set $\bigcap_{t \in \Theta} Q^+_S(t)$ is [[01. Geometric Definitions#^def-closed-in-direction|closed in the downwards direction]]. This implies that $p_{K}(3\pi/2) = 0$.

Next we handle the case $\omega < \pi/2$. As $p_S(\omega) = p_S(\pi/2) = 1$, there are points $q$ and $r$ of $S$ touching the sides $l(\omega, 1)$ and $l(\pi/2, 1)$ of $P_\omega$ respectively. We then observe that the upper-right corner $p_\omega = l(\omega, 1) \cap l(\pi/2, 1)$ of $P_\omega$ is also contained in the set $\bigcap_{t \in \Theta} Q^+_S(t)$ by a geometric argument: for any $t \in \Theta$, $q$ is further than $p_\omega$ in the direction of $u_t$ ([[01. Geometric Definitions#^def-further-in-direction]]), and $r$ is further than $p_\omega$ in the direction of $v_t$, so $p_\omega \in Q^+_S(t)$ always.

Now as the set $\bigcap_{t \in \Theta} Q^+_S(t)$ contains $p_\omega$ and is closed in the direction of $-u_\omega$ and $-v_0$, the orthogonal projections of $p_\omega$ to the bottom sides $l(\omega, 0)$ and $l(\pi/2, 0)$ of $P_\omega$ respetively are also contained in $K$. This implies that $p_K(\pi + \omega) = p_K(3\pi/2) = 0$. □

We also gather some basic facts on the cap $K$ of a hallway intersection $S$.

> __Corollary [cap-contains-hallway-intersection].__ For any hallway intersection $S$ in standard position, its cap $K = \mathcal{C}(S)$ contains $S$. ^cor-cap-contains-hallway-intersection

> __Lemma [cap-same-support-function].__ Let $S$ be any hallway intersection in standard position with rotation angle $\omega \in [0, \pi/2]$ and angle set $\Theta \subseteq [0, \omega]$. Let $K = \mathcal{C}(S)$ be its cap. Then the support functions $p_S$ and $p_K$ have the same value on the set $\Theta \cup (\Theta + \pi/2)$. Consequently, the tangent hallways $L_S(t)$ and $L_K(t)$ are the same on any $t \in \Theta$, and so are the parts $?_S(t) = ?_K(t)$ for $? = a, b, c, d, \mathbf{x}, \mathbf{y}, Q^+, Q^-$ of $L$. ^lem-cap-same-support-function

_Proof._ By [[02. Monotone Sofas#^cor-cap-contains-hallway-intersection]] we have $p_S \leq p_K$ on the set $\Theta \cup (\Theta + \pi/2)$. On the other hand, $K \subseteq Q^+_S(t)$ for any $t \in \Theta$ so $p_K(t') \leq p_{Q_S^+(t)}(t') = p_S(t')$ for $t'=t, t+ \pi/2$. So $p_K \leq p_S$ on the set $\Theta \cup (\Theta + \pi/2)$. □

Define the niche $\mathcal{N}(K)$ of an arbitrary cap $K$. Note that this is essentially the region carved out from the cap $K$ in our monotone sofa $M$ in the overview, generalized to arbitrary angle set.

> __Definition [niche].__ Let $K$ be any cap in standard position with rotation angle $\omega \in [0, \pi/2]$ and angle set $\Theta \subseteq [0, \omega]$. Define the _triangular set_ $T_K(t) = F_\omega \cap Q_K^-(t)$ of $K$ for any $t \in \Theta$. Define the _niche_ of $K$ as the union of all triangular sets. ^def-niche
$$
\mathcal{N}(K) = F_{\omega} \cap \bigcup_{t \in \Theta} Q^-_K(t) = \bigcup_{t \in \Theta} T_K(t) 
$$

Then we simply define the monotonization of cap $K$ as $\mathcal{M}(K) = K \setminus \mathcal{N}(K)$. 

> __Definition [monotonization-cap].__ Let $K$ be any cap in standard position with rotation angle $\omega \in [0, \pi/2]$ and angle set $\Theta \subseteq [0, \omega]$. Define the _monotonization of_ $K$ as the following set. ^def-monotonization-cap
$$
\mathcal{M}(K) = P_\omega \cap \bigcap_{t \in \Theta} L_K(t) = K \setminus \mathcal{N}(K)
$$
> If $S$ is any hallway intersection in standard position with rotation angle $\omega$ and angle set $\Theta$, then define the _monotonization of_ $S$ as the set $\mathcal{M}(\mathcal{C}(S))$. That is, the monotonization of cap $K = \mathcal{C}(S)$.

_Proof._ The equality is justified as the following.
$$
\begin{align}
P_\omega \cap \bigcap_{t \in \Theta} L_K(t) &  =
\left( P_\omega \cap \bigcap_{t \in \Theta} Q^+_K(t) \right) \setminus \left( F_\omega \cap \bigcup_{t \in \Theta} Q^-_K(t) \right)  \\
& = K \setminus \mathcal{N}(K)
\end{align}
$$
The first equality comes from substituting $L_K(t) = Q^+_K(t)\setminus Q^-_K(t)$. Because $K$ is a cap and so supported by the set $\Pi = \Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$, we have $K = \bigcap_{t \in \Pi} H_K(t) = P_\omega \cap \bigcap_{t \in \Theta} Q^+_K(t)$. This and [[02. Monotone Sofas#^def-niche]] implies the second equality. □

> __Definition [monotone-intersection].__ A _monotone intersection_ $S$ with cap $K$, angle set $\Theta$, and rotation angle $\omega$ is the monotonization $M = \mathcal{M}(K) = K \setminus \mathcal{N}(K)$ of the cap $K$ that is connected. If the angle set $\Theta$ is $[0, \omega]$, then we call $S$ a _monotone sofa_ with cap $K$. ^def-monotone-intersection

> __Corollary [monotone-intersection].__ A monotone intersection $S$ with cap $K$, angle set $\Theta$, and rotation angle $\omega$ is a hallway intersection with angle set $\Theta$. Consequently, a monotone sofa $S$ with cap $K$ and rotation angle $\omega$ is a sofa with rotation angle $\omega$. ^cor-monotone-intersection

_Proof._  □

We state the main theorems regarding 

> __Theorem [monotonization].__  ^thm-monotonization




> __Theorem [sofa-in-monotone-sofa].__  ^thm-sofa-in-monotone-sofa










# Structure of a Cap

Here, we examine the structure of a cap and define the details.

By [[01. Moving Hallway Problem#^def-tangent-hallway]] and [[01. Moving Hallway Problem#^def-hallway-parts]], the tangent hallway $L_K(t)$ has the walls $a_K(t), b_K(t), c_K(t), d_K(t)$ where the outer walls $a_K(t)$ and $c_K(t)$ are the tangent lines of $K$. We also define the vertices of a cap.

> __Definition [cap-vertices].__ Let $K$ be a cap with angle set $\Theta$ and rotation angle $\omega$. For any $t \in \Theta$, define the vertices $A^+_K(t) = v^+_K(t)$, $A^-_K(t) = v^-_K(t)$,  $C^+_K(t) = v^+_K(t + \pi/2)$, and $C^-_K(t) = v^+_K(t + \pi/2)$ of $K$. ^def-cap-vertices

An arbitrary cap has a certain structure in its vertices and edges. See Figure xx.

%% TODO: add a figure of general caps %%

> __Theorem [cap-structure].__ If $\omega < \pi/2$, then any $K \in \mathcal{K}_\omega$ contains the vertex $p_{\omega}$ of $P_{\omega}$, and we have $A^+_K(\omega) = p_\omega = C^-_K(0)$. It has edges $e_{K}(3\pi/2) \subset l(\pi/2, 0)$ and $e_{K}(\omega+\pi) \subset l(\omega, 0)$ each connecting the origin to the vertices $A_K^-(0)$ and $C_K^+(\omega)$ respectively.
> 
> If $\omega = \pi/2$, then any $K \in \mathcal{K}_\omega$ translated horizontally is also contained in $\mathcal{K}_\omega$. That is, $K_{\pi/2}$ is closed under horizontal translation. Also the upper edge $e_{K}(\pi/2)$ is the horizontal line segment connecting $A^+_K(\pi/2) = C^+_K(0)$ to $A^-_K(\pi/2) = C^-_K(0)$ from left to right. The edge $e_{K}(3\pi/2) \subset l(\pi/2, 0)$ connects $C_K^+(\omega)$ to $A_K^-(0)$ from left to right. ^thm-cap-structure

We define the _upper boundary_ of arbitrary cap $K$.

> __Definition [upper-boundary-of-cap].__ Define the _upper boundary_ $\delta K$ of $K$ as the set $\delta K = \bigcup_{t \in \Theta \cup \Theta+\pi/2} e_K(t)$. By [[02. Geometric Results#^thm-boundary-parametrization]], if $K$ has nonempty interior then the function $\mathbf{x}_{K, A^-_K(0), C^+_K(\omega)}$ is a parametrization of $\delta K$ from $A_K^-(0)$ to $C^+_K(\omega)$, and so $\delta K$ is a Jordan arc. ^def-upper-boundary-of-cap

We characterize the exact condition when the monotonization $\mathcal{M}(K)$ of a cap $K$ is connected.

> __Theorem [monotonization-connected-iff].__ Let $K$ be any cap with angle set $\Theta$ and rotation angle $\omega$. Then the followings are all equivalent. ^thm-monotonization-connected-iff
> 
> 1. Normalization $\mathcal{M}_\Theta(K)$ is connected
> 2. $\mathcal{N}_\Theta(K) \subseteq K \setminus \delta K$.
> 3. For any $t \in \Theta$, either $\mathbf{x}(t) \not\in F_\omega^\circ$ or $\mathbf{x}(t) \in K$.

Connectedness of upper boundary??

_Proof._ First, we eliminate the case where $K$ has empty interior. $K$ can have an empty interior only when $\omega=\pi/2$ and $K$ is a vertical line segment of length 1. If so, all the conditions are satisfied. Now we assume that $K$ has nonempty interior, so that $\delta K$ is a Jordan arc by [[#^def-upper-boundary-of-cap]]. Now we show the equivalence of 1, 2 and 3.

(3 $\Rightarrow$ 2) To show this, it suffices to show that the set $T_t = F_\omega \cap Q^-_K(t)$ is contained in $K$ for any $t \in \Theta$. Then, as $T_t$ is an open set with respect to subset topology of $F_\omega$, and $K \setminus \delta K$ is the interior of $K$ inside the subset topology of $F_\omega$, we prove that $T_t$ is disjoint from $\delta K$. If $\mathbf{x}(t) \not\in F_\omega^\circ$ then $T_t$ is an empty set and we're done. So we can assume that $\mathbf{x}(t)$ is in $K$. Note that $T_t$ degenerates to empty set when $t = 0$ or $\omega$, so we assume $0 < t < \omega$.
 
We then show the following two facts.

- (a) The point $z_L = d_K(t) \cap l(\omega, 0)$ lies right to the point $C^+_K(\omega)$.
- (b) The point $z_R = b_K(t) \cap l(\pi/2, 0)$ lies left to the point $A_K^-(0)$.

We first show that $z_L$ lies right to the point $C^+_K(\omega)$. For a fixed $v$, this is a partial order. 
$c_K(t) \cap l(\omega, 1)$ is further than $z_L = d(t) \cap l(\omega, 0)$ in the direction of $v_\omega$ as they are the intersection points of boundaries of strips $R_\omega(V)$ and $[f_K(t)](H)$ with width 1. Take any point $q$ in $\delta K \cap c_K(t)$. $q$ is further than $c_K(t) \cap l(\omega, 1)$ in the direction of $v_\omega$. Finally, the endpoint $C^+_K(\omega)$ is further than $q$ in the direction of $v_\omega$. Thus, $u_L$ is further than $z_L$ in the direction of $u_\omega$ 
and the proof of (a) is complete. The proof of (b) can be done using a symmetric argument.

Next, we observe that there are essentially three types of how $T_t$ can be positioned inside $F_\omega$ as $\mathbf{x}(t) \in K$ and $0 < t < \omega$.

- (i) $(0, 0)$ is above or on $b_K(t)$ and below $d_K(t)$. 
- (ii) $(0, 0)$ is below $b_K(t)$ and $d_K(t)$
- (iii) $(0, 0)$ is below $b_K(t)$ and above or on $d_K(t)$

Now we finish the proof that $T_t$ is in $K$. In the first case (i), the wedge $T_t$ is the triangle with vertices $\mathbf{x}(t)$, $z_L$ and $l(\omega, 0) \cap b_K(t)$, and it is that $l(\omega, 0) \cap b_K(t)$ is on the line segment connecting $z_L$ and the origin. As the three vertices are in $K$ by assumptions and (a), we have $T_t$ contained in $K$. In the second case (ii), $T_t$ is the quadrilateral with vertices $z_L, (0, 0), z_R$, and $\mathbf{x}(t)$ and all the vertices are in $K$ by (a) and (b), so we're done. Likewise, for the third case (iii) $T_t$ is the triangle with vertices $\mathbf{x}(t)$, $l(\pi/2, 0) \cap d_K(t)$, and $z_R$, and they are in $K$ by assumptions and (b). So $T_t$ is contained in $K$. This ends the proof that the upper boundary $\delta K$ is disjoint from $\mathcal{N}_\Theta(K)$.

(2 $\Rightarrow$ 1) As $\delta K$ is disjoint from $\mathcal{N}_\Theta(K)$, we have $\delta K \subseteq \mathcal{M}_\Theta(K)$. We show that $\mathcal{M}_\Theta(K)$ is connected. First, $\delta K$ is connected as it is a Jordan arc. Next, take any point $p \in \mathcal{M}_\Theta(K) = K \setminus \mathcal{N}_\Theta(K)$. Take the ray $r$ upwards starting from $p$. Then $r$ touches a point in $\delta K$ as $p \in K$. Moreover, $r$ is disjoint from $\mathcal{N}_\Theta(K)$ or otherwise, there is some point $p'$ in both $r$ and $\mathcal{N}_\Theta(K)$ so there is some $t \in \Theta$ such that $p' \in Q^-_K(t)$. But then $p \in Q_K^-(t)$ as the set $Q_K^-(t)$ is closed in the direction downwards. So this gives contradiction and $r$ is disjoint from $\mathcal{N}_\Theta(K)$. Now $r \cap K$ is a line segment inside $\mathcal{M}_\Theta(K)$ that connects any point $p \in \mathcal{M}_\Theta(K)$ to a point in $\delta K$. So $\mathcal{M}_\Theta(K)$ is connected.

(1 $\Rightarrow$ 3) Assume by contradictory that $S := \mathcal{M}_\Theta(K)$ is connected and $\mathbf{x}(t) \in F_\omega^\circ \setminus K$ for some $t \in \Theta$. We first show that the vertical line $l$ passing through $\mathbf{x}(t)$ does not overlap with $S$. The ray upwards from $\mathbf{x}(t)$ is also inside $F_\omega^\circ \setminus K$ as the set $F_\omega^\circ \setminus K$ is closed in the direction upwards. The ray downwards from $\mathbf{x}(t)$ is not in $S$ because $\mathbf{x}(t)$ is the corner of $Q_K^-(t)$ and $Q_K^-(t)$ in the direction downwards. So the vertical line $l$ passing through $\mathbf{x}(t)$ does not overlap with $S$.

Now separate $H$ into two chunks by the vertical line $l$ passing through $\mathbf{x}(t)$. The line $l$ does not overlap with $S$. As $S$ is connected, $S$ should lie either strictly on left or strictly on right of $l$. Let $(x_0, y_0) = \mathbf{x}(t)$. As $\mathbf{x}(t) \in F_\omega$ we have $y_0 \geq 0$. Assume first that $S$ lies strictly on left of $l$. Then any point of $S$ has $x$-coordinate less than $x_0$, and $y$-coordinate less than or equal to 1. So $p_S(t) \leq x_0 \cos(t) + \sin(t) < x_0 \cos(t) + 1$, but by definition of $\mathbf{x}(t)$ we have $p_S(t) = \mathbf{x}(t) \cdot u_t + 1 = x_0 \cos(t) + y_0 \sin (t) + 1 \geq x_0 \cos(t) + 1$, and this leads to contradiction. Now assume that $S$ lies strictly on right of $l$. Then any point of $S$ has $x$-coordinate greater than $x_0$, and $y$-coordinate less than or equal to 1. So $p_S(t+\pi/2) \leq - x_0 \sin(t) + \cos(t) < - x_0 \sin(t) + 1$, but by definition of $\mathbf{x}(t)$ we have $p_S(t+\pi/2) = \mathbf{x}(t) \cdot v_t + 1 = -x_0 \sin(t) + y_0 \cos(t) + 1 \geq -x_0 \sin(t) + 1$ and we get contradiction. So we get contradiction in any case, and the proof is complete. □

> __Theorem [monotonization-is-hallway-intersection].__ Let $S$ be a hallway intersection with rotation angle $\omega$ and angle set $\Theta$. Then the monotonization $\mathcal{M}_\Theta(S)$ is also a hallway intersection with angle set $\Theta$ that contains $S$. ^thm-monotonization-is-hallway-intersection

_Proof._ The containment $\mathcal{M}(S) \supseteq S$ come from the following.
$$
\mathcal{M}(S) = \mathcal{C}(S) \setminus \mathcal{N}(S) = P_\omega \cap \left( \bigcap_{t \in \Theta} Q^+_S(t) \setminus \bigcup_{t \in \Theta} Q^-_S(t) \right) = P_\omega \cap \bigcap_{t \in \Theta} L_S(t) \supseteq S
$$
Here the last containment holds from [[01. Moving Hallway Problem#^lem-in-tangent-hallway]]. As $S \subseteq \mathcal{M}(S) \subseteq P_\omega$, we can see that $\mathcal{M}(S)$ is in standard position. By definition $\mathcal{M}(S)$ admits hallways rotated by any angle in $\Theta$ that contains $\mathcal{M}(S)$.

It remains to show that $\mathcal{M}_\Theta(S)$ is connected. Take any point $p$ in $\mathcal{M}_\Theta(S)$. Take the line $l_\theta$ starting from $p$ that makes an angle of arbitrary $\theta \in [\omega, \pi/2]$ with the $x$-axis. Observe that $l_\theta \cap \mathcal{M}_\Theta(S)$ is a nonempty line segment because $\bigcup_{t \in \Theta} Q^-_S(t)$ is closed in the direction of $\theta + \pi$. So if any of $l_\theta$ meets $S$, then $p$ is connected to $S$ inside $\mathcal{M}_\Theta(S)$ and the proof is done. Our goal now is to prove that there is some $\theta \in [\omega, \pi/2]$ such that $l_\theta$ meets $S$. Assume by contradiction that for any $\theta \in [\omega, \pi/2]$ the line $l_\theta$ is disjoint from $S$.

As $S \subseteq \mathcal{M}(S) \subseteq \mathcal{C}(S)$ and the support function of $S$ and $\mathcal{C}(S)$ agrees on the set $\Theta \cup (\Theta + \pi/2)$, the support function of $\mathcal{M}(S)$ also agrees with that of $S$ on $\Theta \cup (\Theta + \pi/2)$ as well.

As $p \in \mathcal{M}_\Theta(S)$, the line $l_{\pi/2}$ that passes through $p$ is either equal to $l_{\mathcal{M}(S)}(0)$ or strictly on the left side of $l_{\mathcal{M}(S)(0)}$. As $p_S(0) = p_{\mathcal{M}(S)}(0)$ we have $l_{\mathcal{M}(S)}(0) = l_S(0)$. Now the line $l_{\pi/2}$ is either equal to $l_S(0)$ or strictly on the left side of $l_{S}(0)$. If they are equal, then $l_{\pi/2}$ contains some point of $S$ and this contradicts our assumption. So the line $l_{\pi/2}$ is strictly on the left side of $l_{S}(0)$. So there is a point of $S$ strictly on the right side of $l_{\pi/2}$.

As $p \in \mathcal{M}_\Theta(S)$, the line $l_{\omega}$ that passes through $p$ is either equal to $l_{\mathcal{M}(S)}(\omega + \pi/2)$ or strictly on the right side of $l_{\mathcal{M}(S)}(\omega + \pi/2)$. As $p_S(\omega + \pi/2) = p_{\mathcal{M}(S)}(\omega + \pi/2)$ we have $l_{\mathcal{M}(S)}(\omega + \pi/2) = l_S(\omega + \pi/2)$. Now the line $l_{\omega}$ is either equal to $l_S(\omega + \pi/2)$ or strictly on the right side of $l_S(\omega + \pi/2)$. If they are equal, then $l_{\omega}$ contains some point of $S$ and this contradicts our assumption. So the line $l_{\omega}$ is strictly on the right side of $l_S(\omega + \pi/2)$. So there is a point of $S$ strictly on the left side of $l_{\omega}$.

As the line $l_\theta$ is disjoint from $S$ for any $\theta \in [\omega, \pi/2]$, $S$ is inside the set $X = \mathbb{R}^2 \setminus \bigcup_{\theta \in [\omega, \pi/2]} l_\theta$. Note that $X$ has exactly two connected components $X_L$ and $X_R$, one in left and another in right respectively. As there is a point of $S$ strictly on the right side of $l_{\pi/2}$, the point of $S$ lies in $X_R$. As there is also a point of $S$ strictly on the left side of $l_\omega$, the point of $S$ lies in $X_L$. Then we get contradiction as $S$ is connected and a subset of $X$. □

Observe that such $S$ is a hallway intersection: by condition 2 of [[#^thm-monotonization-connected-iff]], $S$ is in standard position. Also, by condition 2 of [[#^thm-monotonization-connected-iff]], $S$ contains the upper boundary of $K$ and so we have $\mathcal{C}(S) = K$. 

>  Indeed, $S$ is a sofa by [[01. Moving Hallway Problem#^thm-sofa-iff-hallway-intersection]]. Observe that $S$ admits the movement of rotating hallway $L_S(t) = L_K(t)$. ^def-monotone-sofa

This corollary ensures that any maximum sofa $S$ with rotation angle $\omega$ is contained in some monotone sofa $\mathcal{M}_{[0, \omega]}(K)$ with cap $K$. That is, we can assume that a maximum sofa is a monotone sofa.

> __Corollary [maximum-area-monotone-sofa].__ Let $S$ be any sofa in standard position with rotation angle $\omega \in [0, \pi/2]$. Then the monotonization $\mathcal{M}_{[0, \omega]}(S)$ is a monotone sofa with rotation angle $\omega$ containing $S$. ^cor-maximum-area-monotone-sofa

_Proof._ Specialize [[#^cor-monotonization-is-hallway-intersection]] to the angle set $\Theta = [0, \omega]$. □

%% Important TODO: argue that we can also assume that a sofa is balanced by a limiting argument. Tell dan that I'm carrying all this generalization to arbitrary angle set, just to execute this limiting argument. %%

%%

We get the following two corollaries from [[#^cor-hallway-intersection-quadrant]] and [[#^def-niche-hallway-intersection]].

> __Corollary [cap-depends-on-support-function].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, its cap $\mathcal{C}(S)$, niche $\mathcal{N}(S)$, and monotonization $\mathcal{M}(S)$ solely depends on the support function $p_S|_{\Theta \cup \Theta + \pi/2}$ restricted to the angle set $\Theta \cup \Theta + \pi/2$. Moreover, if $K = \mathcal{C}(S)$ then $p_K|_{\Theta \cup \Theta + \pi/2} = p_S|_{\Theta \cup \Theta + \pi/2}$. ^cor-cap-depends-on-support-function

> __Corollary [monotonization-of-cap].__ Let $S$ be any shape in standard position with rotation angle $\omega \in [0, \pi/2]$. Let $K = \mathcal{C}(S)$ be the cap of $S$. Then we have $\mathcal{C}(K) = \mathcal{C}(S) = K$, $\mathcal{N}(K) = \mathcal{N}(S)$, and $\mathcal{M}(K) = \mathcal{M}(S)$. That is, the cap/niche/monotonization of $S$ is same as that of the cap $K = \mathcal{C}(S)$. ^cor-monotonization-of-cap

%%