By [[01. Moving Hallway Problem#^thm-sofa-iff-hallway-intersection]] we can assume that a maximum sofa $S$ is a hallway intersection of angle set $[0, \omega]$ for some $\omega \in [0, \pi/2]$. Here we construct the _motononization_ $\mathcal{M}(S)$ of a sofa $S$ which is a sofa that contains $S$ that consists of its cap $\mathcal{C}(S)$ minus its niche $\mathcal{N}(S)$.

First, we formally define what is a cap.

> __Definition [cap].__ A _cap_ $K$ with _rotation angle_ $\omega \in [0, \pi/2]$ and a closed _angle set_ $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq \left[ 0, \omega \right]$ is a convex body such that the followings hold. ^def-cap
> - $p_K(\omega) = p_K(\pi/2) = 1$ and $p_K(\pi + \omega) = p_K(3\pi/2) = 0$. Geometrically speaking, $K$ is contained in the parallelogram $P_\omega$ and touches all the sides of $P_\omega$.
> - $K$ is supported by ([[03. Convex Bodies#^def-convex-body-supported]]) the set $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$.

> __Corollary [cap-in-standard-position].__ A cap $K$ with rotation angle $\omega \in [0, \pi/2]$ is in standard position respect to $\omega$. ^cor-cap-in-standard-position

We also define the vertices of a cap.

> __Definition [cap-vertices].__ Let $K$ be a cap with angle set $\Theta$ and rotation angle $\omega$. For any $t \in \Theta$, define the vertices $A^+_K(t) = v^+_K(t)$, $A^-_K(t) = v^-_K(t)$,  $C^+_K(t) = v^+_K(t + \pi/2)$, and $C^-_K(t) = v^+_K(t + \pi/2)$ of $K$. ^def-cap-vertices

These are the sides of the rotating hallway $L_K(t)$.

> __Definition [cap-lines].__ Let $K$ be a cap with angle set $\Theta$ and rotation angle $\omega$. For any $t \in \Theta$, define $a_K(t) = l_K(t)$, $b_K(t) = l(t, p_K(t) - 1)$,  $c_K(t) = l_K(t+\pi/2)$, and $d_K(t) = l(t + \pi/2, p_K(t+\pi/2) - 1)$. ^def-cap-lines

We introduce the definition of _upper boundary_ of arbitrary cap $K$.

> __Definition [upper-boundary-of-cap].__ Define the _upper boundary_ $\delta K$ of $K$ as the set $\delta K = \bigcup_{t \in \Theta \cup \Theta+\pi/2} e_K(t)$. By [[03. Geometric Results#^thm-boundary-parametrization]], the function $\mathbf{x}_{K, A^-_K(0), C^+_K(\omega)}$ is a parametrization of $\delta K$ from $A_K^-(0)$ to $C^+_K(\omega)$, and so $\delta K$ is a Jordan arc. ^def-upper-boundary-of-cap

Next, we define the _monotonization_ of an arbitrary shape $S$ in standard position. To do so, we first see a hallway $L_S(t)$ as the subtraction of two quadrants: the outer quadrant $Q_S^+(t)$ formed by outer walls of the hallway, subtracted by the inner quadrant $Q_S^-(t)$ formed by inner walls of the hallway.

> __Definition [hallway-intersection-quadrant].__ Define $Q^+ = (-\infty, 1] \times (-\infty, 1]$ and $Q^- = (-\infty, 0) \times (-\infty, 0)$ so that $L = Q^+ \setminus Q^-$. Moreover, for any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, and every $t \in [0, \omega]$, define $Q^+_S(t) = [f_S(t)](Q^+)$ and $Q^-_S(t) = [f_S(t)](Q^-)$, so that $L_S(t) = Q^+_S(t) \setminus Q^-_S(t)$. ^def-hallway-intersection-quadrant

The outer quadrant $Q_S^+(t)$ touches $S$ with normal angles $t$ and $t+\pi/2$. So $Q_S^+(t)$ is the intersection of half-planes $H_S(t)$ and $H_S(t+\pi/2)$.

> __Corollary [hallway-intersection-quadrant].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$ and every $t \in [0, \omega]$, we have the followings. ^cor-hallway-intersection-quadrant
$$
Q^+_S(t) = H_{S}(t) \cap H_{S}(t + \pi/2) \qquad 
Q^-_S(t) = H(t, p_S(t) - 1) \cap H(t+ \pi/2, p_S(t + \pi/2) - 1)
$$

We prepare a notion of ray.

> __Definition [ray].__ For any point $p \in \mathbb{R}^2$ and an angle $t \in S^1$, define $R_p(t)$ as the closed ray (half-line) in the direction of $u_t$ starting from the point $p$. Say that a subset $X$ of $\mathbb{R}^2$ is _closed in the direction of angle_ $t$ if for any point $p \in X$, the ray $R_p(t)$ is contained in $X$. ^def-ray

Now we define the monotonization of arbitrary shape $S$ in standard position.

> __Definition [niche-monotonization-hallway-intersection].__ Let $S$ be any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$ and angle set $\Theta \subseteq [0, \omega]$. Define the _cap_ $\mathcal{C}_\Theta(S)$ of $S$ as the following set. ^def-niche-hallway-intersection
$$
\mathcal{C}_\Theta(S) = P_\omega \cap \bigcap_{t \in \Theta} Q^+_S(t)
$$
> Define the set $T_S(t) = F_\omega \cap Q_S^-(t)$ for any $t \in [0, \omega]$. Define the _niche_ of $S$ as the following set.
$$
\mathcal{N}_\Theta(S) = F_{\omega} \cap \bigcup_{t \in \Theta} Q^-_S(t) = \bigcup_{t \in \Theta} T_S(t) 
$$
> Also, define the _monotonization_ of $S$ as the set $\mathcal{M}_\Theta(S) = \mathcal{C}_\Theta(S) \setminus \mathcal{N}_\Theta(S)$. As the angle set $\Theta$ is often clear from context, we will usually omit the subscript $\Theta$ for the cap/cup/monotonization $\mathcal{C}(S)$, $\mathcal{N}(S)$, and $\mathcal{M}(S)$. 

_Proof._ We need to justify that $\mathcal{C}(S)$ is indeed a cap according to [[#^def-cap]]. As $Q^+_S(t)$ is the intersection of two half-planes of normal angle $t$ and $t + \pi/2$, the set $K = \mathcal{C}(S)$ is a convex set supported by the set $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$. Moreover, $p_K(\omega) = p_K(\pi/2) = 1$ because $p_{S}(\omega)=p_S(\pi/2)=1$ as $S$ is in standard position. It remains to verify $p_K(\pi + \omega) = p_K(3\pi/2) = 0$. 

We first handle the case $\omega = \pi/2$. For this we only need to prove $p_{K}(3\pi/2) = 0$. As $p_{S}(\pi/2)=1$, we have some point $(x_0, 1)$ which is in $S$ and thus $K$. Observe that $(x_0, 0)$ is also in $K$ as the set $\bigcap_{t \in \Theta} Q^+_S(t)$ is closed in the downwards direction. This implies that $p_{\mathcal{C}(S)}(3\pi/2) = 0$.

Next we handle the case $\omega < \pi/2$. As $p_S(\omega) = p_S(\pi/2) = 1$, there are points $q$ and $r$ of $S$ touching the sides $l(\omega, 1)$ and $l(\pi/2, 1)$ of $P_\omega$ respectively. By an elementary geometric argument, we can then see that the upper-right corner $p_\omega = l(\omega, 1) \cap l(\pi/2, 1)$ of $P_\omega$ is also contained in the set $\bigcap_{t \in \Theta} Q^+_S(t)$. Now as the set $\bigcap_{t \in \Theta} Q^+_S(t)$ is closed in the direction of angle $\omega + \pi$ and $3\pi/2$, the orthogonal projections of $p_\omega$ to the sides $l(\omega, 0)$ and $l(\pi/2, 0)$ of $P_\omega$ respetively are also contained in $\mathcal{C}(S)$. Thus implies that $p_K(\pi + \omega) = p_K(3\pi/2) = 0$. â–¡

We get the following two corollaries from [[#^cor-hallway-intersection-quadrant]] and [[#^def-niche-hallway-intersection]].

> __Corollary [cap-depends-on-support-function].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, its cap $\mathcal{C}(S)$, niche $\mathcal{N}(S)$, and monotonization $\mathcal{M}(S)$ solely depends on the support function $p_S|_{\Theta \cup \Theta + \pi/2}$ restricted to the angle set $\Theta \cup \Theta + \pi/2$. Moreover, if $K = \mathcal{C}(S)$ then $p_K|_{\Theta \cup \Theta + \pi/2} = p_S|_{\Theta \cup \Theta + \pi/2}$. ^cor-cap-depends-on-support-function

> __Corollary [monotonization-of-cap].__ Let $S$ be any shape in standard position with rotation angle $\omega \in [0, \pi/2]$. Let $K = \mathcal{C}(S)$ be the cap of $S$. Then we have $\mathcal{C}(K) = \mathcal{C}(S) = K$, $\mathcal{N}(K) = \mathcal{N}(S)$, and $\mathcal{M}(K) = \mathcal{M}(S)$. That is, the cap/niche/monotonization of $S$ is same as that of the cap $K = \mathcal{C}(S)$. ^cor-monotonization-of-cap

We then characterize the exact condition when the monotonization $\mathcal{M}(K)$ of a cap $K$ is connected.

> __Theorem [monotonization-connected-iff].__ Let $K$ be any cap with angle set $\Theta$ and rotation angle $\omega$. Then the followings are all equivalent. ^thm-monotonization-connected-iff
> 
> 1. Normalization $\mathcal{M}_\Theta(K)$ is connected
> 2. $\mathcal{N}_\Theta(K) \subseteq K \setminus \delta K$.
> 3. For any $t \in \Theta$, either $\mathbf{x}(t) \not\in F_\omega^\circ$ or $\mathbf{x}(t) \in K$.

_Proof._ (3 $\Rightarrow$ 2) To show this, it suffices to show that the set $T_t = P_\omega \cap Q^-_K(t)$ is contained in $K$ for any $t \in \Theta$. Then, as $T_t$ is an open set with respect to subset topology of $F_\omega$, and $K \setminus \delta K$ is the interior of $K$ inside the subset topology of $F_\omega$, we prove that $T_t$ is disjoint from $\delta K$. If $\mathbf{x}(t) \not\in F_\omega^\circ$ then $T_t$ is an empty set and we're done. So we can assume that $\mathbf{x}(t)$ is in $K$. Note that $T_t$ degenerates to empty set when $t = 0$ or $\omega$, so we assume $0 < t < \omega$.
 
We then show the following two facts.

- (a) The point $z_L = d_K(t) \cap l(\omega, 0)$ lies right to the point $C^+_K(\omega)$.
- (b) The point $z_R = b_K(t) \cap l(\pi/2, 0)$ lies left to the point $A_K^-(0)$.

We first show that $z_L$ lies right to the point $C^+_K(\omega)$. Say that a point $p_0$ is further than $p_1$ in the direction of nonzero vector $v \in \mathbb{R}^2$ if and only if $p_0 \cdot v \geq p_1 \cdot v$. For a fixed $v$, this is a partial order. 
$c_K(t) \cap l(\omega, 1)$ is further than $z_L = d(t) \cap l(\omega, 0)$ in the direction of $v_\omega$ as they are the intersection points of boundaries of strips $R_\omega(V)$ and $[f_K(t)](H)$ with width 1. Take any point $q$ in $\delta K \cap c_K(t)$. $q$ is further than $c_K(t) \cap l(\omega, 1)$ in the direction of $v_\omega$. Finally, the endpoint $C^+_K(\omega)$ is further than $q$ in the direction of $v_\omega$. Thus, $u_L$ is further than $z_L$ in the direction of $u_\omega$ 
and the proof of (a) is complete. The proof of (b) can be done using a symmetric argument.

> __Figure [fan-convexity-argument].__  ^fig-fan-convexity-argument
![70%](images/fan-convexity-argument.png)

Next, we observe that there are essentially three types of how $T_t$ can be positioned inside $F_\omega$ as $\mathbf{x}(t) \in K$ and $0 < t < \omega$.

- (i) $(0, 0)$ is above or on $b_K(t)$ and below $d_K(t)$. 
- (ii) $(0, 0)$ is below $b_K(t)$ and $d_K(t)$
- (iii) $(0, 0)$ is below $b_K(t)$ and above or on $d_K(t)$

Now we finish the proof that $T_t$ is in $K$. In the first case (i), the wedge $T_t$ is the triangle with vertices $\mathbf{x}(t)$, $z_L$ and $l(\omega, 0) \cap b_K(t)$, and it is that $l(\omega, 0) \cap b_K(t)$ is on the line segment connecting $z_L$ and the origin. As the three vertices are in $K$ by assumptions and (a), we have $T_t$ contained in $K$. In the second case (ii), $T_t$ is the quadrilateral with vertices $z_L, (0, 0), z_R$, and $\mathbf{x}(t)$ and all the vertices are in $K$ by (a) and (b), so we're done. Likewise, for the third case (iii) $T_t$ is the triangle with vertices $\mathbf{x}(t)$, $l(\pi/2, 0) \cap d_K(t)$, and $z_R$, and they are in $K$ by assumptions and (b). So $T_t$ is contained in $K$. This ends the proof that the upper boundary $\delta K$ is disjoint from $\mathcal{N}_\Theta(K)$.

(2 $\Rightarrow$ 1) As $\delta K$ is disjoint from $\mathcal{N}_\Theta(K)$, we have $\delta K \subseteq \mathcal{M}_\Theta(K)$. We show that $\mathcal{M}_\Theta(K)$ is connected. First, $\delta K$ is connected as it is a Jordan arc. Next, take any point $p \in \mathcal{M}_\Theta(K) = K \setminus \mathcal{N}_\Theta(K)$. Take the ray $r$ upwards starting from $p$. Then $r$ touches a point in $\delta K$ as $p \in K$. Moreover, $r$ is disjoint from $\mathcal{N}_\Theta(K)$ or otherwise, there is some point $p'$ in both $r$ and $\mathcal{N}_\Theta(K)$ so there is some $t \in \Theta$ such that $p' \in Q^-_K(t)$. But then $p \in Q_K^-(t)$ as the set $Q_K^-(t)$ is closed in the direction downwards. So this gives contradiction and $r$ is disjoint from $\mathcal{N}_\Theta(K)$. Now $r \cap K$ is a line segment inside $\mathcal{M}_\Theta(K)$ that connects any point $p \in \mathcal{M}_\Theta(K)$ to a point in $\delta K$. So $\mathcal{M}_\Theta(K)$ is connected.

(1 $\Rightarrow$ 3) Assume by contradictory that $S := \mathcal{M}_\Theta(K)$ is connected and $\mathbf{x}(t) \in F_\omega^\circ \setminus K$ for some $t \in \Theta$. We first show that the vertical line $l$ passing through $\mathbf{x}(t)$ does not overlap with $S$. The ray upwards from $\mathbf{x}(t)$ is also inside $F_\omega^\circ \setminus K$ as the set $F_\omega^\circ \setminus K$ is closed in the direction upwards. The ray downwards from $\mathbf{x}(t)$ is not in $S$ because $\mathbf{x}(t)$ is the corner of $Q_K^-(t)$ and $Q_K^-(t)$ in the direction downwards. So the vertical line $l$ passing through $\mathbf{x}(t)$ does not overlap with $S$.

Now separate $H$ into two chunks by the vertical line $l$ passing through $\mathbf{x}(t)$. The line $l$ does not overlap with $S$. As $S$ is connected, $S$ should lie either strictly on left or strictly on right of $l$. Let $(x_0, y_0) = \mathbf{x}(t)$. As $\mathbf{x}(t) \in F_\omega$ we have $y_0 \geq 0$. Assume first that $S$ lies strictly on left of $l$. Then any point of $S$ has $x$-coordinate less than $x_0$, and $y$-coordinate less than or equal to 1. So $p_S(t) \leq x_0 \cos(t) + \sin(t) < x_0 \cos(t) + 1$, but by definition of $\mathbf{x}(t)$ we have $p_S(t) = \mathbf{x}(t) \cdot u_t + 1 = x_0 \cos(t) + y_0 \sin (t) + 1 \geq x_0 \cos(t) + 1$, and this leads to contradiction. Now assume that $S$ lies strictly on right of $l$. Then any point of $S$ has $x$-coordinate greater than $x_0$, and $y$-coordinate less than or equal to 1. So $p_S(t+\pi/2) \leq - x_0 \sin(t) + \cos(t) < - x_0 \sin(t) + 1$, but by definition of $\mathbf{x}(t)$ we have $p_S(t+\pi/2) = \mathbf{x}(t) \cdot v_t + 1 = -x_0 \sin(t) + y_0 \cos(t) + 1 \geq -x_0 \sin(t) + 1$ and we get contradiction. So we get contradiction in any case, and the proof is complete. â–¡

> __Theorem [monotonization-is-hallway-intersection].__ Let $S$ be a hallway intersection with rotation angle $\omega$ and angle set $\Theta$. Then the monotonization $\mathcal{M}_\Theta(S)$ is also a hallway intersection with angle set $\Theta$ that contains $S$. ^thm-monotonization-is-hallway-intersection

_Proof._ The containment $\mathcal{M}(S) \supseteq S$ come from the following.
$$
\mathcal{M}(S) = \mathcal{C}(S) \setminus \mathcal{N}(S) = P_\omega \cap \left( \bigcap_{t \in \Theta} Q^+_S(t) \setminus \bigcup_{t \in \Theta} Q^-_S(t) \right) = P_\omega \cap \bigcap_{t \in \Theta} L_S(t) \supseteq S
$$
Here the last containment holds from [[01. Moving Hallway Problem#^lem-in-tangent-hallway]]. 

It remains to show that $\mathcal{M}_\Theta(S)$ is connected. Take any point $p$ in $\mathcal{M}_\Theta(S)$. Take the line $l_\theta$ starting from $p$ that makes an angle of arbitrary $\theta \in [\omega, \pi/2]$ with the $x$-axis. Observe that $l_\theta \cap \mathcal{M}_\Theta(S)$ is a nonempty line segment because $\bigcup_{t \in \Theta} Q^-_S(t)$ is closed in the direction of $\theta + \pi$. So if any of $l_\theta$ meets $S$, then $p$ is connected to $S$ inside $\mathcal{M}_\Theta(S)$ and the proof is done. Our goal now is to prove that there is some $\theta \in [\omega, \pi/2]$ such that $l_\theta$ meets $S$. Assume by contradiction that there is no such $\theta \in [\omega, \pi/2]$.

As $S \subseteq \mathcal{M}(S) \subseteq \mathcal{C}(S)$ and the support function of $S$ and $\mathcal{C}(S)$ agrees on the set $\Theta \cup (\Theta + \pi/2)$, the support function of $\mathcal{M}(S)$ also agrees with that of $S$ on $\Theta \cup (\Theta + \pi/2)$ as well.

Because $l_{\pi/2}$ is disjoint from $S$, 

As $p \in \mathcal{M}_\Theta(S)$, the line $l_{\pi/2}$ that passes through $p$ is either equal to $l_{\mathcal{M}(S)(0)}$ or strictly on the left side of $l_{\mathcal{M}(S)(0)}$. As $p_S(0) = p_{\mathcal{M}(S)}(0)$ we have $l_{\mathcal{M}(S)}(0) = l_S(0)$. Now the line $l_{\pi/2}$ is either equal to $l_S(0)$ or strictly on the left side of $l_{S}(0)$. If they are equal, then $l_{\pi/2}$ contains some point of $S$ and this contradicts our assumption. So the line $l_{\pi/2}$ is strictly on the left side of $l_{S}(0)$. So there is a point of $S$ strictly on the right side of $l_{\pi/2}$.

Likewise, the line $l_S(\omega + \pi/2)$ is not on the strictly right side of $l_{\omega}$, or otherwise as $l_{S}(\omega + \pi/2) = l_{\mathcal{M}_{\Theta}(S)}(\omega + \pi/2)$ and $p \in \mathcal{M}_\Theta(S)$ this is contradiction. If $l_S(\omega + \pi/2)$ passes $p$, then we have $l_\omega = l_S(\omega + \pi/2)$ passing $p$ so we are done. So we are left with the assumption that $l_{S}(\omega + \pi/2)$ is strictly on the left side of $l_{\omega}$. Consequently, some point of $S$ is strictly on the left side of $l_{\omega}$.

Assume contradictory that there is some $p$ such that for all $\theta \in [\omega, \pi/2]$ the line $l_\theta$ does not meet $S$. Then as $S$ is connected $S$ is either on the left side or right side of $l_\theta$ for any $\theta \in [\omega, \pi/2]$. As some point of $S$ is strictly on right side of $l_{\pi/2}$, the whole $S$ has to lie on strictly right side of $l_{\pi/2}$. Likewise, as some point of $S$ is strictly on the left side of $l_{\omega}$, the whole $S$ has to lie strictly on the left side of $l_{\omega}$. This is contradiction. â–¡

> __Definition [monotone-sofa].__ A _monotone sofa_ $S$ with cap $K$ and angle set $\Theta$ and rotation angle $\omega$ is the shape $S = \mathcal{M}_\Theta(K)$ that is connected. ^def-monotone-sofa

_Proof._ We check that such $S$ is indeed a sofa with angle set $\Theta$. First, $S$ is connected. Second, the set $S = \mathcal{M}_\Theta(K)$ is inside $P_\omega$ and admits any hallways rotated by any angle in $\Theta$. â–¡

> __Corollary [maximum-area-monotone-sofa].__ For any fixed angle set $\Theta$, any sofa $S$ is contained in the monotone sofa $\mathcal{M}_\Theta(K)$ with cap $K = \mathcal{C}(S)$ after some proper rigid motion. ^cor-maximum-area-monotone-sofa

_Proof._ We have $\mathcal{M}_\Theta(K) = \mathcal{M}_\Theta(\mathcal{C}(S)) = \mathcal{M}_\Theta(S)$. We can assume that $S$ is hallway intersection using [[01. Moving Hallway Problem#^thm-sofa-iff-hallway-intersection]]. Then [[#^thm-monotonization-is-hallway-intersection]] tells that $\mathcal{M}_\Theta(S)$ is a sofa containing $S$. By definition this is a monotone sofa. â–¡ ^08d3ec

> __Theorem [maximum-sofa-polygon-limit].__ Fix the rotation angle $\omega$.  ^thm-maximum-sofa-polygon-limit