> __Definition [cap].__ A _cap_ $K$ with _rotation angle_ $\omega \in [0, \pi/2]$ and a closed _angle set_ $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq \left[ 0, \omega \right]$ is a convex body such that the followings hold. ^def-cap
> - $p_K(\omega) = p_K(\pi/2) = 1$ and $p_K(\pi + \omega) = p_K(3\pi/2) = 0$. Geometrically speaking, $K$ is contained in the parallelogram $P_\omega$ and touches all the sides of $P_\omega$.
> - $K$ is supported by ([[03. Convex Bodies#^def-convex-body-supported]]) the set $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$.

> __Corollary [cap-in-standard-position].__ A cap $K$ with rotation angle $\omega \in [0, \pi/2]$ is in standard position respect to $\omega$. ^cor-cap-in-standard-position

> __Definition [hallway-intersection-quadrant].__ Define $Q^+ = (-\infty, 1] \times (-\infty, 1]$ and $Q^- = (-\infty, 0) \times (-\infty, 0)$ so that $L = Q^+ \setminus Q^-$. Moreover, for any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, and every $t \in [0, \omega]$, define $Q^+_S(t) = [f_S(t)](Q^+)$ and $Q^-_S(t) = [f_S(t)](Q^-)$, so that $L_S(t) = Q^+_S(t) \setminus Q^-_S(t)$. ^def-hallway-intersection-quadrant

> __Corollary [hallway-intersection-quadrant].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$ and every $t \in [0, \omega]$, we have the followings. ^cor-hallway-intersection-quadrant
$$
Q^+_S(t) = H_{S}(t) \cap H_{S}(t + \pi/2) \qquad 
Q^-_S(t) = H(t, p_S(t) - 1) \cap H(t+ \pi/2, p_S(t + \pi/2) - 1)
$$

> __Definition [cap-of-shape].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, define the _cap_ of the hallway intersection $S$ as the following set that contains $S$. ^def-cap-of-shape
$$
\mathcal{C}(S) = P_{\omega} \cap \bigcap_{t \in \Theta} Q^+_S(t) 
$$

_Proof._ We need to show that the set $K = \mathcal{C}(S)$ adheres to the definition of a [[#^def-cap|cap]] and that $K \supseteq S$. The containment $K \supseteq S$ comes from $S \subseteq P_{\omega}$ and $S \subseteq Q_{S}^+(t) = H_{S}(t) \cap H_{S}(t + \pi/2)$. So in particular, $K$ is nonempty. As $Q^+_S(t)$ is the intersection of two half-planes of normal angle $t$ and $t + \pi/2$, the set $K$ is a convex set supported by the set $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$. Moreover, $p_K(\omega) = p_K(\pi/2) = 1$ because $p_{S}(\omega)=p_S(\pi/2)=1$ as $S$ is in standard position.

The proof of $p_K(\pi + \omega) = p_K(3\pi/2) = 0$ is elementary but requires a bit of casework.

We first handle the case $\omega = \pi/2$. For this we only need to prove $p_{K}(3\pi/2) = 0$. As $p_{S}(\pi/2)=1$, we have some point $(x_0, 1)$ which is in $S$ and thus $K$. Observe that $(x_0, 0)$ is also in $K$ by the following argument: First, $P_{\omega} = H$ so it contains $(x_0, 0)$, and $\bigcap_{t \in \Theta} Q^+_S(t)$ is an intersection of half-planes with normal vectors of nonnegative $y$-coordinates so it also contains $(x_{0}, 0)$ which is right below $(x_{0}, 1)$. So $(x_{0}, 0)$ is contained in $\mathcal{C}(S)$ and we have $p_{\mathcal{C}(S)}(3\pi/2) \leq 0$. As $S \subseteq \mathcal{C}(S)$ we also have $p_{C(S)}(3\pi/2) \geq p_{S}(3\pi/2) = 0$ as well and so $p_{\mathcal{C}(S)}(3\pi/2) = 0$.

Next we handle the case $\omega < \pi/2$. (TODO:) □

> __Corollary [cap-depends-on-support-function].__ For any shape $S$ in standard position with rotation angle $\omega \in [0, \pi/2]$, its cap $\mathcal{C}(S)$ solely depends on the support function $p_K|_{\Theta \cup \Theta + \pi/2}$ restricted to the angle set $\Theta \cup \Theta + \pi/2$. ^cor-cap-depends-on-support-function

# Geometry of Caps

Let $K$ be an arbitrary cap with rotation angle $\omega \in [0, \pi/2]$ and a closed _angle set_ $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq \left[ 0, \omega \right]$. We define geometric information of $K$ and

> __Theorem [cap-mixin].__ For any caps $K_1$ and $K_2$ with same rotation angle $\omega$ and angle set $\Theta$, the set $K = (1-\lambda)K_1 + \lambda K_2$ is also a cap. ^thm-cap-mixin

> __Theorem [cap-contains-vertex].__ If $\omega < \pi/2$, then $K$ contains the vertex $p_{\omega}$ of $P_{\omega}$. ^thm-cap-contains-vertex

> __Theorem [boundary-measure-cap].__ The boundary measure $\beta_K$ of $K$ on $S^1$  has support in $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$ and satisfies the followings. ^thm-boundary-measure-cap
$$
\int_{t \in \Theta} \cos(t) \, \beta_K(dt) = 1 \qquad \int_{t \in \Theta + \pi/2} \cos\left( \omega + \pi/2 - t \right)  \, \beta_K(dt) = 1
$$

> __Theorem [cap-from-boundary-measure].__ Conversely to [[#^thm-boundary-measure-cap]], let $\beta$ be a measure on $\Theta \cup (\Theta + \pi/2)$ that satisfies the following equation.  ^thm-cap-from-boundary-measure
$$
\int_{t \in \Theta} \cos(t) \, \beta_K(dt) = 1 \qquad \int_{t \in \Theta + \pi/2} \cos\left( \omega + \pi/2 - t \right)  \, \beta_K(dt) = 1
$$
> Then the followings hold.
> 
> - If $\omega = \pi/2$, then there is a cap $K$ with rotation angle $\omega$ and angle set $\Theta$ such that $\beta_K|_{\Theta \cup (\Theta + \pi/2)} = \beta$. This is unique up to horizontal translation: all the other caps $K'$ satisfying the same condition is a horizontal translation of $K$.
> - If $\omega < \pi/2$, then there is a unique cap $K$ with rotation angle $\omega$ and angle set $\Theta$ such that $\beta_K|_{\Theta \cup (\Theta + \pi/2)} = \beta$.

> __Definition [cap-vertices].__ For any $t \in [0, \omega]$, define $A^+_K(t) = v^+_K(t)$, $A^-_K(t) = v^-_K(t)$,  $C^+_K(t) = v^+_K(t + \pi/2)$, and $C^-_K(t) = v^+_K(t + \pi/2)$. ^def-cap-vertices

> __Definition [cap-lines].__ For any $t \in [0, \omega]$, define $a_K(t) = l_K(t)$, $b_K(t) = l(t, p_K(t) - 1)$,  $c_K(t) = l_K(t+\pi/2)$, and $d_K(t) = l(t + \pi/2, p_K(t+\pi/2) - 1)$. ^def-cap-lines

> __Theorem [cap-special-vertex].__ If $\omega < \pi/2$, then $A^+_K(\omega) = p_\omega = C^-_K(\omega)$. ^thm-cap-special-vertex

> __Definition [upper-boundary-of-cap].__ Define the _upper boundary_ $\delta K$ of $K$ as the set $\delta K = \bigcup_{t \in \Theta \cup \Theta+\pi/2} e_K(t)$. This is the path of the boundary from vertex $A_K^-(0)$ to $C^+_K(0)$. Moreover, the $x$-coordinate of the parametrization is monotonically decreasing. (TODO: add reference)  ^def-upper-boundary-of-cap

> __Theorem [upper-boundary-is-jordan-arc].__ If $K$ has a nonzero area, then the upper boundary $\delta K$ is a Jordan arc. ^thm-upper-boundary-is-jordan-arc

> __Theorem [cap-from-upper-boundary].__ We have $p_{\delta K}$ and $p_K$ matching on the domain $\Theta \cup \Theta + \pi/2$. Consequently, $\mathcal{C} (\delta K) = \mathcal{C}(K)$. ^thm-cap-from-upper-boundary

> __Theorem [cap-tangent-arm-length].__ For any $t \in [0, \omega]$, let $g_K^+(t)$ be the value such that $\mathbf{y}(t) = A^+_K(t) + g_K^+(t) v_t$. Let $g_K^-(t)$ be the value such that $\mathbf{y}(t) = A^-_K(t) + g_K^-(t) v_t$. Let $h_K^+(t)$ be the value such that $\mathbf{y}(t) = C^+_K(t) + h_K^+(t) u_t$. Let $h_K^-(t)$ be the value such that $\mathbf{y}(t) = C^-_K(t) + h_K^-(t) u_t$. ^thm-cap-tangent-arm-length

# Differential Geometry of Caps

> __Definition [inner-corner-deriv].__ For any cap $K$, $\mathbf{v}_K^+ (t)$ is the right derivative of $\mathbf{x}$ at $t$ and $\mathbf{v}_K^- (t)$ is the left derivative of $\mathbf{x}$ at $t$. ^def-inner-corner-deriv
$$
\mathbf{v}_K^{-} (t_0) = \lim_{t \rightarrow t_0^-} \frac{\mathbf{x}(t) - \mathbf{x}(t_0)}{t - t_0} \qquad
\mathbf{v}_K^{+} (t_0) = \lim_{t \rightarrow t_0^+} \frac{\mathbf{x}(t) - \mathbf{x}(t_0)}{t - t_0}.
$$

TODO: polish the theorem below.

> __Theorem [inner-corner-deriv].__ For any cap $K$, $\mathbf{v}_K^+ (t)$ exists for any $0 \leq t < \pi / 2$ and is equal to the following. ^thm-inner-corner-deriv
$$
\begin{align*}
	\mathbf{v}_K^+(t) = -(g_K^+(t) - 1) \cdot u_t + (h_K^+(t) - 1) \cdot v_t
\end{align*}
$$
> Likewise, $\mathbf{v}_K^- (t)$ exists for all $0 < t \leq \pi / 2$ and is equal to the following.
$$
\begin{equation*}
	\mathbf{v}_K^-(t) = -(g_K^-(t) - 1) \cdot u_t + (h_K^-(t) - 1) \cdot v_t
\end{equation*}
$$

_Proof._ (sketch) Take any $0 \leq t < \pi / 2$ and set $s = t + \delta$ for sufficiently small and arbitrary $\delta > 0$. We simplify $\mathbf{v}^+(t) = \lim_{\delta \rightarrow 0^+}(\mathbf{x}(s) - \mathbf{x}(t)) / \delta$.
	
Since $A_{t, s}$ is on lines $a(t)$ and $a(s)$, it satisfies both $$A_{t, s} \cdot u_t = \mathbf{x}(t) \cdot u_t + 1$$ and  $$A_{t, s} \cdot u_s = \mathbf{x}(s) \cdot u_s + 1.$$
Rewrite $u_s = \cos \delta \cdot u_t + \sin \delta \cdot v_t$ on the second equation and we have
$$
\begin{align*}
	A_{t, s} \cos \delta \cdot u_t + A_{t, s} \sin \delta \cdot v_t =  	\cos \delta (\mathbf{x}(s) \cdot u_t) + \sin \delta (\mathbf{x}(s) \cdot v_t) + 1.
\end{align*}
$$
Group by $\cos \delta$ and $\sin \delta$ and substitute $A_{t, s} \cdot u_t$ with first equation then
$$ \cos \delta (\mathbf{x}(s) \cdot u_t - \mathbf{x}(t) \cdot u_t) + (1 - \cos \delta)
	= \sin \delta (A_{t, s}  (s) \cdot v_t - \mathbf{x}(s) \cdot v_t) .
	$$
Divide by $\delta$ and send $\delta$ to zero. We get
$$ \mathbf{v}_K^+(t) \cdot u_t  = (A^+(t) - \mathbf{x}(t)) \cdot v_t$$
Note that $g_t^+ = (\mathbf{y}(t) - A^+(t)) \cdot v_t = (\mathbf{x}(t) - A^+(t))\cdot v_t + 1$ so we have 
$$ \mathbf{v}_K^+(t) \cdot u_t = 1 - g_t ^+.$$
A similar argument can be applied to show $\mathbf{v}^+(t) \cdot v_t = h_t^+ - 1$ and thus the first equation of the theorem.  A symmetric argument shows the second equation of the theorem.  □