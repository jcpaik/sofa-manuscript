

Let $\mathbf{x}(t)$ be the location of the inner corner of the rotated hallway $L_t$. Then $L_t = R_t(L) + \mathbf{x}(t)$ and the maximum-area moving sofa $S$ is equal to the set
$$
S = H \cap V_\omega \cap \bigcap_{t \in [0, \omega]} \left( R_t(L) + \mathbf{x}(t) \right).
$$
and the problem becomes the maximization of the area of $S$ with respect to the coordinates $\mathbf{x}:[0, \omega] \to \mathbb{R}^2$ of inner corners $L_t$.

Gerver derived his sofa $S_G$ using the following approximation scheme. Instead of taking the intersection of all rotated hallways $L_t$ with angle $t \in [0, \omega]$, he took a finite partition $\Theta$ of $[0, \omega]$ (that is, a finite subset of $[0, \omega]$ containing $\left\{ 0, \omega \right\}$) and took the polygon intersection ^eqn-polygon
$$
S_\Theta = H \cap V_\omega \cap \bigcap_{t \in \Theta} \left( R_t(L) + \mathbf{x}(t) \right) .
$$
The approximated finite-dimensional problem is now to maximize the area of $S_\Theta$ with respect to the coordinates $\mathbf{x}(t)$ for $t \in \Theta$. Assume now that $S_\Theta$ attains the maximum area for each fixed partition $\Theta$ of $[0, \omega]$. Then Gerver used a compactness argument to show that there is a sequence of paritions $\Theta_1, \Theta_2, \dots, \Theta_n, \dots$ of $[0, \omega]$ that gets denser in the interval $[0, \omega]$, so that the polygons $S_{\Theta_n}$ converge to a moving sofa $S_\omega$ that attains the maximum area amongst all sofas with rotation angle $\omega$.

For a fixed finite partition $\Theta$ of $[0, \omega]$, Gerver claimed that the polygon $S_\Theta$ in [[#^eqn-polygon]] attaining the maximum area should be _balanced_ (Theorem 1 of [@gerverMovingSofaCorner1992]). That is, for any angle $t \in S^1$, the sum $a_t$ of length of edges of $S_\Theta$ with normal vectors $u_t$ is equal to the sum $b_t$ of length of edges of $S_\Theta$ with normal vectors $-u_t$. 

However, such a process may break the connectedness of the intersection $S_\Theta$. Consider the example in Figure xx with $\Theta = \left\{ \pi/6, \pi/3 \right\}$. If we take the hallway $L_{\pi/6}$ and compare the right outer wall with right inner wall, it is that the right outer wall contributes the most. However, if we do push $\mathbf{x}(\pi/6)$ towards the direction of 

In this paper, we mitigate the issue by defining the _sofa area functional_ that separates the area contribution of the cap $K$ and its niche $\mathcal{N}_\Theta(K)$. We will optimize for the value $|K| - |\mathcal{N}_\Theta(K)|$, no matter whether $\mathcal{N}_\Theta(K) \subseteq K$ or not. We will analyze the 

On the way of proving [[#^thm-angle-cap]], we also show the following existence theorem of maxima of $\mathcal{A}_\omega$ satisfying certain properties.

> __Definition [niche-gap].__ Let $K \in \mathcal{K}_\omega$ be a cap with rotation angle $\omega \in (0, \pi/2]$. Define the following _niche gaps_ ^def-niche-gap
$$
w_K^\circ = \inf_{0 < t < \omega} w_K(t) \qquad
z_K^\circ = \inf_{0 < t < \omega} z_K(t)
$$
>  of $K$.

> __Theorem [main-balanced].__ For any rotation angle $\omega \in (0, \pi/2]$, there exists a maximizer $K \in \mathcal{K}_\omega$ of the sofa area functional $\mathcal{A}_{\omega}(K)$ such that the following inequalities hold. ^thm-main-balanced
> 
> - If $\omega < \pi/2$, then $w_K^\circ \leq \sigma_K\left( \pi/2 \right)$ and $z_K^\circ \leq \sigma_K\left( \omega \right)$.
> - If $\omega = \pi/2$, then $w_K^{\circ} + z_K^{\circ} \leq \sigma_K(\pi/2)$.


# Proof of [[a. Angle Hypothesis/01. Introduction/01. Main Result#^thm-angle]]

Assume a maximum-area moving sofa $S$ with rotation angle $\omega < \pi/2$. Note that $H \cap V_{\omega}$ is a parallelogram of area $\tan(\omega)$. So we can assume that $\omega \geq \arctan(2.2)$. We establish [[a. Angle Hypothesis/01. Introduction/01. Main Result#^thm-angle]] by showing that the same sofa also admits another movement of rotation angle $\pi/2$.

> __Theorem [extend-rotation-angle].__ Let the angle $\omega \in (\arctan(2.2), \pi/2)$ be arbitrary. Then there exists a monotone sofa $S$ with the rotation angle $\omega$ satisfying the following.
> 
> 1. $S$ attains the maximum area among all monotone sofas with the same rotation angle $\omega$.
> 2. $S$ admits another movement in $L$ with rotation angle $\pi/2$. ^thm-extend-rotation-angle

To prove [[a. Angle Hypothesis/01. Introduction/03. Monotone Sofas#^thm-extend-rotation-angle]], we will find two 

The idea is to extend the original movement with rotation angle $\omega$. Initially, the monotone sofa $S$ is contained in the parallelogram $P_\omega = H \cap V_\omega$. Call the lower-left and the upper-right vertex of $P_\omega$ as $o_\omega$ and $O_\omega$. Define $\Delta_\omega$ as the subset of $P_\omega$ under the arc formed by the circle of radius 1 centered at $p_\omega$. from $p_\omega - u_\omega$ to $p_\omega - v_0$  If the small region $\Delta_\omega$ is disjoint from the moving sofa $S$, then we can rotate the translate of $S$ inside $L_H$ _counterclockwise_ by an angle of $\pi/2 - \omega$. Combine this movement with the movement of $S$ in $L$ to get a movement of $S$ with rotation angle $\pi/2$.

So how do we show that $\Delta_\omega$ is disjoint from $S$? We will show that there is some $t$ such that the inner corner $Q_K^-(t)$ contains the set $\Delta_\omega$. We will need to bound two values from below. First is the length $p_K(0)$ from the origin. Second is the length of the edge $e_K(\pi/2)$ with the normal vector $(0, 1)$. Now the points $q_1 = (p_K(0), 0)$ and $q_2 = o_\omega - \beta_K(\pi/2)$ are in $K$. The positive quadrant $Q_K^+(t)$ of the hallway $L_t$ should contain the two points $q_1$ and $q_2$. We find a proper value of $t$ so that the negative quadrant $Q_K^-(t)$ contains the set $\Delta_\omega$ all.

Bounding $q_1$, or letting $p_K(0) \geq 1.1$ is sufficient by using symmetry argument. However, bounding the edge length $e_K(\pi/2)$ from below . The rightmost point $q_0$ of $S$ on the line $y=0$. The leftmost point $q_1$ of $S$ on the line $y=1$.