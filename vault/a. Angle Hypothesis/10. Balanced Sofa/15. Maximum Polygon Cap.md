# Polygon Cap and Niche

Following the outline in [[a. Angle Hypothesis/03. Outline/05. Balanced Sofa]], we define a polygon cap $K$ and its polygon niche $\mathcal{N}_\Theta(K)$.

> __Definition [angle-domain].__ For any $\omega \in (0, \pi/2]$ and nonempty finite subset $\Theta$ of $(0, \omega)$, define $\Theta^{\diamond} := \Theta \cup (\Theta + \pi/2) \cup \left\{ \omega, \pi/2 \right\}$. ^def-angle-domain

> __Definition [angled-cap-space].__ Assume $\omega \in (0, \pi/2]$ and a nonempty finite subset $\Theta$ of $(0, \omega)$. Define the space $\mathcal{K}_\Theta$ of _polygon caps with angle set_ $\Theta$ as the subset of $\mathcal{K}_\omega$ of each $K \in \mathcal{K}_\Theta$ which is an intersection of closed half-planes with normal angles in $\Theta^{\diamond} \cup \left\{\pi + \omega, 3\pi/2 \right\}$. ^def-angled-cap-space

Any cap $K \in \mathcal{K}_\omega$ can be approximated by a polygon cap $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta$ containing $K$.

> __Definition [angled-cap].__ For any $K \in \mathcal{K}_\omega$, define the set ^def-angled-cap
$$
\mathcal{C}_\Theta(K) = P_\omega \cap \bigcap_{t \in \Theta} Q_K^+(t).
$$

> __Proposition [angled-cap].__ For any $K \in \mathcal{K}_\omega$, the set $\mathcal{C}_\Theta(K)$ is a member of $\mathcal{K}_\Theta$ containing $K$ as subset. With this, call $\mathcal{C}_\Theta(K)$ the _polygon cap_ with _angle set_ $\Theta$ _approximating_ $K$. Also, the map $\mathcal{C}_\Theta : \mathcal{K}_\omega \to \mathcal{K}_\Theta$ is a surjective map fixing the elements of $\mathcal{K}_\Theta$. ^pro-angled-cap

_Proof._ That $K \subseteq \mathcal{C}_\Theta(K)$ comes from $K \subseteq P_\omega$ and $K \subseteq Q_K^+(t) = H_K(t) \cap H_K(t + \pi/2)$. We have $\mathcal{C}_\Theta(K) \in \mathcal{K}_\omega$ as $K \subseteq \mathcal{C}_\Theta(K) \subseteq P_\omega$. Then we have $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta$ by the formula in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-angled-cap]].

Now it remains to show that for any $K \in \mathcal{K}_\Theta$, we have $\mathcal{C}_\Theta(K) = K$. Since $K \in \mathcal{K}_\Theta$ is the intersection of closed half-planes with normal angles in $\Pi := \Theta^{\diamond} \cup \left\{\pi + \omega, 3\pi/2 \right\}$, we have $K = \bigcap_{t \in \Pi} H_K(t)$. As $K \in \mathcal{K}_\Theta \subset \mathcal{K}_\omega$, we have $p_K(\omega) = p_K(\pi/2) = 1$ and $p_K(\omega + \pi) = p_K(3\pi/2) = 0$ so
$$
K = \bigcap_{t \in \Pi} H_K(t) = P_\omega \cap \bigcap_{t \in \Theta} Q_K^+(t) = \mathcal{C}_\Theta(K)
$$
as we wanted. □

> __Definition [angled-niche].__ For every cap $K \in \mathcal{K}_\omega$ and finite nonempty $\Theta \subset (0, \omega)$, define its _polygon niche_ ^def-angled-niche
$$
\mathcal{N}_\Theta(K) = P_\omega \cap \bigcup_{t \in \Theta} Q_K^-(t)
$$
> with angle set $\Theta$.

> __Proposition [angled-niche-polygon-cap].__ For any $K \in \mathcal{K}_\omega$, we have $\mathcal{N}_\Theta(K) = \mathcal{N}_\Theta(\mathcal{C}_\Theta(K))$. ^pro-angled-niche-polygon-cap

_Proof._ Let $K' := \mathcal{C}_\Theta(K)$. The support function $p_X$ of $X = K, K'$ agree on the set $\Theta \cup (\Theta + \pi/2)$ by definition, and the polygon niche $\mathcal{N}_\Theta(X)$ only depends on the values of $p_X$ on $\Theta \cup (\Theta + \pi/2)$. □

> __Definition [polygon-upper-bound].__ Let $\Theta$ be an angle set with rotation angle $\omega$. Define the _polygon sofa area functional_ $\mathcal{A}_\Theta : \mathcal{K}_\omega \to \mathbb{R}$ as $\mathcal{A}_\Theta(K) := |\mathcal{C}_\Theta(K)| - |\mathcal{N}_\Theta(K)|$. ^def-polygon-upper-bound

> __Theorem [polygon-upper-bound].__ For every $K \in \mathcal{K}_\omega$, we have $\mathcal{A}_{\omega}(K) \leq \mathcal{A}_\Theta(K)$.
> ^thm-polygon-upper-bound

_Proof._ By [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-angled-cap]] we have $|K| \leq |\mathcal{C}_\Theta(K)|$. By [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-angled-niche]] we have $|\mathcal{N}(K)| \geq |\mathcal{N}_\Theta(K)|$. □

> __Remark [polygon-upper-bound].__ Note that the upper bound $\mu_{\max} \leq 2.37$ of [@kallusImprovedUpperBounds2018] is established by essentially computing an upper estimate of the upper bound $\mathcal{A}_\Theta \geq \mathcal{A}_{\pi/2}$ for a specific set $\Theta$ of five angles. ^rem-polygon-upper-bound

# Outline of Balancing Argument

We will show that the polygon cap $K \in \mathcal{K}_\Theta$ maximizing the polygon sofa area $\mathcal{A}_\Theta(K)$ is balanced ([[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-balanced-polygon-sofa]]). As described in [[a. Angle Hypothesis/03. Outline/05. Balanced Sofa]], we circumvent the issue that the polygon sofa $S_\Theta = K \setminus \mathcal{N}_\Theta(K)$ could be disconnected by maximizing $\mathcal{A}_\Theta(K)$ with respect to $K \in \mathcal{K}_\Theta$.

Let $h : \Theta^{\diamond} \to \mathbb{R}$ be the restriction of the support function $p_K$ of $K$ on the domain $\Theta^{\diamond}$.
We will see that $K$ and $\mathcal{N}_\Theta(K)$ are simple Nef polygons $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$ completely determined by the values of $h$ on $\Theta^{\diamond}$ (see [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]]). We will adjust the values of $h : \Theta^{\diamond} \to \mathbb{R}$ to increase the value of
$$
\mathcal{A}_\Theta(h) := |\mathcal{C}_\Theta(h)| - |\mathcal{N}_\Theta(h)|
$$
as a function of $h$. In context of the [[a. Angle Hypothesis/03. Outline/05. Balanced Sofa#^eqn-polygon]] in [[a. Angle Hypothesis/03. Outline/05. Balanced Sofa]], the values of $h(\pi/2)$ and $h(\omega)$ controls the locations of $H$ and $V_\omega$ respectively, and for each $t \in \Theta$, the values of $h(t)$ and $h(t + \pi/2)$ together controls the location of $L_t$.

Say that $h$ is adjusted to a new function $h^+ : \Theta^{\diamond} \to \mathbb{R}$. While $\mathcal{A}_\Theta(h^+) > \mathcal{A}_\Theta(h)$ and $h^+$ gives back a convex polygon $K^+ := \mathcal{C}_\Theta(h^+)$, an issue is that $K^+$ might not be a polygon cap to properly conclude $\mathcal{A}_\Theta(K^+) > \mathcal{A}_\Theta(K)$ as we want. We circumvent this issue by choosing $h^+$ carefully so that $K^+$ is always a _translation_ of some polygon cap $K^0$ in $\mathcal{K}_\Theta$. By translating $K^+$ back to $K^0$, we properly conclude $\mathcal{A}_\Theta(K) < \mathcal{A}_\Theta(K^0)$.

# Extensions of Polygon Cap

We extend the space $\mathcal{K}_\Theta$ of polygon caps to the space $\mathcal{K}_\Theta'$ of all _translates_ of polygon caps.

> __Definition [cap-trans].__ Define the space of _polygon cap translates_ $\mathcal{K}_\Theta'$ as the collection of all translations $K'$ of arbitrary caps $K \in \mathcal{K}_\Theta$ with angle set $\Theta$. ^def-cap-trans

> __Proposition [cap-trans-space].__ A convex polygon $K'$ is in $\mathcal{K}_\Theta'$ if and only if the followings are true. ^pro-cap-trans-space
> 
> 1. The widths $p_{K'}(\omega) + p_{K'}(\omega + \pi)$ and $p_{K'}(\pi/2) + p_{K'}(3\pi/2)$ of $K'$ measured along the angles $\omega$ and $\pi/2$ are exactly one.
> 2. $K'$ is a convex polygon with normal angles in the set $\Theta \cup (\Theta + \pi/2) \cup \left\{\omega, \pi/2, \omega + \pi, 3\pi/2 \right\}$.

_Proof._ Any translate $K'$ of an arbitrary $K \in \mathcal{K}_\Theta$ satisfies (1) and (2) immediately. On the other hand, for any $K'$ satisfying conditions (1) and (2), find a translation $K$ of $K'$ such that $p_K(\omega) = p_K(\pi/2) = 1$ so that $K \in \mathcal{K}_\Theta$. □

Subsequently, extend $\mathcal{K}_\Theta'$ again to the space $\mathcal{H}_\Theta$ of _all_ functions $h : \Theta^{\diamond} \to \mathbb{R}$, extending the support function $h = p_{K'}$ of polygon cap translates $K'$.

> __Definition [height-space].__ Define $\mathcal{H}_\Theta$ as the space of all functions $h : \Theta^{\diamond} \to \mathbb{R}$. ^def-height-space

> __Proposition [height-space-embedding].__ The map $\mathcal{K}_\Theta' \to \mathcal{H}_\Theta$ mapping $K' \in \mathcal{K}'_\Theta$ to its support function $p_{K'}$ on the domain $\Theta^{\diamond}$ is an injection. ^pro-height-space-embedding

_Proof._ By (2) of [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-trans-space]], the values of $p_{K'}$ on $\Theta^{\diamond}$ determine
$$
K' = \bigcap_{t \in \Theta^{\diamond} \cup \left\{ \omega + \pi, 3\pi/2 \right\}} H_{K'}(t) \in \mathcal{K}_\Theta'
$$
uniquely. □

We now have a series of extensions $\mathcal{K}_\Theta \subseteq \mathcal{K}_{\Theta'} \hookrightarrow \mathcal{H}_\Theta$. We will extend the notion of cap, niche, and the polygon sofa area functional $\mathcal{A}_\Theta$ from $\mathcal{K}_\Theta$ to $\mathcal{H}_\Theta$.

> __Definition [height-extensions].__ For any $h \in \mathcal{H}_\Theta$, define its _parallelogram_ ^def-height-extensions
$$
P_h := \bigcap_{t \in \left\{ \omega, \pi/2 \right\} } H_-(t, h(t)) \cap H_+(t, h(t) - 1)
$$
> and _cap_
$$
\mathcal{C}_\Theta(h) := P_h \cap \bigcap_{t \in \Theta \cup (\Theta + \pi/2)} H_-(t, h(t))
$$
> and _fan_
$$
F_h := H_+(\omega, h(\omega) - 1) \cap H_+(\pi/2, h(\pi/2) - 1)
$$
> and _niche_
$$
\mathcal{N}_{\Theta}(h) := F_h \cap \bigcup_{t \in \Theta } \left( H_-^\circ(t, h(t) - 1) \cap H_-^\circ(t + \pi/2, h(t + \pi/2) - 1) \right)
$$
> and the _polygon sofa area functional_
$$
\mathcal{A}_\Theta(h) := |\mathcal{C}(h)| - |\mathcal{N}_\Theta(h)|.
$$

> __Proposition [cap-niche-nef-polygons].__ For any $h \in \mathcal{H}_\Theta$, the sets $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$ are simple Nef polygons ([[a. Angle Hypothesis/10. Balanced Sofa/01. Nef Polygon#^def-simple-nef-polygon]]) with defining half-planes $H_-(t, h(t))$ and $H_{\pm}^{\circ}(t) - u_t$ for $t \in \Theta^{\diamond}$ (the sign is $+$ if and only if $\omega \in \left\{ \omega, \pi/2 \right\}$). ^pro-cap-niche-nef-polygons

_Proof._ The boundaries of the mentioned half-planes differ as they differ in its angle or distance from the origin. The formula of $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$ in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] is defined from the half-planes by applying only union and intersection, so by [[a. Angle Hypothesis/10. Balanced Sofa/01. Nef Polygon#^pro-monotone-boolean-function]] the defining boolean function is monotone. □

Inherit [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] on $\mathcal{H}_\Theta$ to the subspace $\mathcal{K}_{\Theta'} \hookrightarrow \mathcal{H}_\Theta$, and observe that this notion is also compatible with respect to $K_{\Theta} \subseteq K_{\Theta}'$.

> __Definition [cap-translate-extensions].__ For any cap translate $K' \in \mathcal{K}'_\Theta$, define $P_{K'}$, $\mathcal{C}(K')$, $F_{K'}$, $\mathcal{N}_\Theta(K')$, $\mathcal{A}_\Theta(K')$ as that of the support function $h := p_{K'}$. That is, $P_h$, $\mathcal{C}(h)$, $F_h$, $\mathcal{N}_\Theta(h)$, $\mathcal{A}_\Theta(h)$ in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] respectively. ^def-cap-translate-extensions

> __Proposition [cap-extension-compatible].__  ^pro-cap-extension-compatible



> __Theorem [height-extensions].__ For any translation $K' := K + \mathbf{v} \in \mathcal{K}_{\Theta}'$ of a polygon cap $K \in \mathcal{K}_\Theta$ with rotation angle $\omega$ by $\mathbf{v} \in \mathbb{R}^2$, we have the following. ^thm-height-extensions
> 
> - $P_{K'} = P_\omega + \mathbf{v}$
> - $\mathcal{C}_{\Theta}(K') = K' = K + \mathbf{v}$
> - $F_{K'} = F_{\omega} + \mathbf{v}$
> - $\mathcal{N}_\Theta(K') = \mathcal{N}_\Theta(K) + \mathbf{v}$
> - $\mathcal{A}_\Theta(K') = \mathcal{A}_\Theta(K)$

_Proof._ By [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-niche-nef-polygons]] and [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-cap-translate-extensions]], the polygons $P_{K'}$, $\mathcal{C}_{\Theta}(K')$, $F_{K'}$, $\mathcal{N}_{\Theta}(K')$ are simple Nef polygons with defining hyperplanes $H_{K'}(t)$ and $H_{K'}(t) - u_t$ for $t \in \Theta^{\diamond}$. For any convex body $K$ and fixed $t \in S^1$, the supporting hyperplane $H_K(t)$ is equivariant under translation of $K$ so that $H_{K + \mathbf{v}}(t) = H_K(t) + \mathbf{v}$. □

# Maximum Polygon Sofa

We first define the polygon cap $K_\Theta$ attaining the maximum value of $\mathcal{A}_\Theta$ which is bounded from the origin.

> __Definition [maximum-polygon-cap].__ Define a cap $K_\Theta \in \mathcal{K}_\Theta$ a _maximum polygon cap_ with _angle set_ $\Theta$ and _rotation angle_ $\omega \in (0, \pi/2]$ if (i) $K := K_\Theta$ attains the maximum value of $\mathcal{A}_\Theta : \mathcal{K}_\Theta \to \mathbb{R}$ and (ii) $o_\omega \in K_\Theta$. ^def-maximum-polygon-cap

> __Theorem [maximum-polygon-cap].__ For any $\omega \in (0, \pi/2]$ and nonempty finite $\Theta \subset (0, \omega)$, a maximum polygon cap $K_\Theta$ exists. ^thm-maximum-polygon-cap

_Proof._  □

> __Lemma [maximum-area-polygon-cap-bound].__ For any $\omega \in (0, \pi/2]$ and finite $\Theta \subset (0, \omega)$ containing $\omega/2$, a maximum polygon cap $K_{\Theta}$ with angle set $\Theta$ is contained in the closed disk of radius $R$ centered at the origin. ^lem-maximum-area-polygon-cap-bound

_Proof._  □

> __Definition [polyline].__ For any $n \geq 1$ and a finite sequence $p_1, p_2, \dots, p_n \in \mathbb{R}^2$ of points on a plane with strictly increasing $x$-coordinates, call the union of the finite segments connjecting adjacent points $p_i$ to $p_{i+1}$ ($1 \leq i < n$) an _$x$-monotone polyline_. ^def-polyline

> __Theorem [polyline].__ The boundary of the closed set $F_\omega \setminus \mathcal{N}_\Theta(K)$ is a union of the following subsets, from left to right in $\mathbb{R}^2$. ^thm-polyline
> 
> 1. The half-line starting from $C_K^+(\omega)$ and extending indefinitely in the direction $v_\omega$.
> 2. An $x$-monotone polyline $\mathbf{p}_K$ connecting $C_K^+(\omega)$ to $A_K^-(0)$ from left to right, with each segment of normal angles in $\Theta \cup (\Theta + \pi/2) \cup \left\{ \omega, \pi/2 \right\}$.
> 3. The half-line starting from $A_K^-(0)$ and extending indefinitely in the direction of $u_0$.

> __Definition [polyline].__ Define the polyline $\mathbf{p}_K$ in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-polyline]] from $C_K^+(\omega)$ to $A_K^-(0)$ as the _polyline of cap_ $K \in \mathcal{K}_\Theta$. ^def-polyline

Now we define the notion of balancedness on any $K \in \mathcal{K}_\Theta$.

> __Definition [polyline-length].__ For any cap $K \in \mathcal{K}_\Theta$ and angle $t \in \Theta \cup (\Theta + \pi/2)$, define $\nu_K(t)$ as the sum of the lengths of the edges in the polyline $\mathbf{p}_K$ with normal angle $t$. ^def-polyline-length

> __Definition [polygon-cap-balanced].__ Say that a polygonal cap $K \in \mathcal{K}_\Theta$ is _balanced_ if and only if for any $t \in \Theta^{\diamond}$, we have $\sigma_K(t) = \nu_K(t)$. ^def-polygon-cap-balanced

> __Lemma [polyline-length].__ ^lem-polyline-length
> 
> 1. For any $t \in \Theta$, we have $\nu_K(t) = \lambda^1 \left( \partial \mathcal{N}_\Theta(K) \cap b_K(t) \right)$ and $\nu_K(t + \pi/2) = \lambda^1 \left( \partial \mathcal{N}_\Theta(K) \cap d_K(t) \right)$.
> 2. For any $t \in \left\{ \omega, \pi/2 \right\}$ we have $\nu_K(t) + \lambda^1\left( \partial \mathcal{N}_\Theta(K) \cap l(t, 0) \right) = \sigma_K(t + \pi)$.

_Proof._ As $\mathbf{p}_K \subseteq F_\omega$, the polyline $\mathbf{p}_K$ is partitioned into $X := \mathbf{p}_K \cap F_\omega^{\circ}$ and $Y := \mathbf{p}_K \cap \partial F_\omega$. Let $Z := e_K(\omega + \pi) \cup e_K(3\pi/2)$. Then the boundary of $\mathcal{N}_\Theta(K)$ is $X \cup (Z \setminus Y)$.  □

We now execute the balancing argument to show that any maximum polygon cap $K_\Theta \in \mathcal{K}_\Theta$ in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-maximum-polygon-cap]] is balanced.

We choose the right angle $t \in \Theta^\diamond$ to balance $K \in \mathcal{K}_\Theta$.

> __Lemma [not-balanced-positive].__ Assume that a polygon cap $K \in \mathcal{K}_\Theta$ is _not_ balanced. Then there exists an angle $t \in \Theta^\diamond$ such that $\sigma_K(t) > \nu_K(t)$. ^lem-not-balanced-positive

_Proof._ By following the polyline $\mathbf{p}_K$ from right to left, we have the identity
$$
C_K^+(\omega) - A_K^-(0) = \sum_{t \in \Theta^{\diamond}} \nu_K(t) v_t.
$$
Also, by following the upper boundary $\delta K$ of $K$ from right to left, we also have the identity
$$
C_K^+(\omega) - A_K^-(0) = \sum_{t \in \Theta^{\diamond}} \sigma_K(t) v_t.
$$
So we have where $v_t \cdot u_0 < 0$ for all $t \in \Theta^{\diamond}$. So if $\sigma_K(t) \leq \nu_K(t)$ for all $t \in \Theta^{\diamond}$, then the equality should hold and $K$ should be balanced. Taking the contraposition concludes the proof. □

Execute the balancing step.

> __Lemma [balancing].__ Let $K \in \mathcal{K}_\Theta$ be a polygonal cap with support function $h := p_K \in \mathcal{H}_\Theta$. Let $t \in \Theta^{\diamond}$ be arbitrary. Define $h' \in \mathcal{H}_\Theta$ as $h'(t) = h(t) + \delta$ and $h'(u) = h(u)$ for all $u \in \Theta \cup (\Theta + \pi/2)$ with $u \neq t$. Then $\mathcal{A}_\Theta(h') = \mathcal{A}_\Theta(K) + (\sigma_K(t) - \nu_K(t)) \delta + O(\delta^2)$. ^lem-balancing

_Proof._  □

Choosing the right angle $t \in \Theta^\diamond$ guarantees that the new function $h^+ \in \mathcal{H}_\Theta$ with $h^+(t) := h(t) + \epsilon$ corresponds to a cap translate $K^+$.

> __Lemma [height-positive-increment].__ Let $K \in \mathcal{K}_\Theta$ be arbitrary with support function $h := p_K \in \mathcal{H}_\Theta$. Let $t \in \Theta^\diamond$ be arbitrary such that $\sigma_K(t) > 0$. Then the following holds for any sufficiently small $\epsilon > 0$. Define a new function $h^+ \in \mathcal{H}_\Theta$ so that $h^+(t) := h(t) + \epsilon$ and $h^+(u) := h(u)$ on $u \in \Theta^\diamond \setminus \left\{ t \right\}$. Then the intersection $K^+ := \mathcal{C}_\Theta(h^+)$ is a cap translate in $\mathcal{K}_\Theta'$. Also, we get back $h^+ = p_{K^+}$. ^lem-height-positive-increment

_Proof._ By , it suffices to show that $K^+$ have width 1 in the directions $u_\omega$ and $v_0$. By $\sigma_K(t) > 0$, we have  □

Combine the steps above to show the balancedness of a maximum polygon cap.

> __Theorem [balanced-polygon-sofa].__ Any maximum polygon cap $K_\Theta$ with rotation angle $\omega < \pi/2$ is balanced as in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-polygon-cap-balanced]]. ^thm-balanced-polygon-sofa

_Proof._ Assume by contradiction that the polygon cap $K := K_\Theta$ is not balanced. □

We show that for $\omega < \pi/2$, the wedge gap $w_K^{\circ}$ of a maximum polygon cap $K := K_{\Theta}$ is a lower bound of the length of the upper edge $e_K(\pi/2)$. This is a crucial ingredient for the proof of the main theorem.

> __Theorem [balanced-polygon-sofa-ineq].__ For any maximum polygon cap $K_\Theta$ with rotation angle $\omega < \pi/2$, we have $w_K^{\circ} \leq \sigma_K(\pi/2)$ and $z_K^{\circ} \leq \sigma_K(\omega)$. ^thm-balanced-polygon-sofa-ineq

_Proof._ We show $w_K^{\circ} \leq \sigma_K(\pi/2)$. Then we can appeal to the mirror symmetry to show $z_K^{\circ} \leq \sigma_K(\omega)$ in the same way.


□

> __Theorem [balanced-polygon-sofa-connected].__ Any maximum polygon cap $K_\Theta$ contains its polygon niche $\mathcal{N}_\Theta(K_{\Theta})$. ^thm-balanced-polygon-sofa-connected

_Proof._ Write $K_\Theta$ as $K := K_\Theta$ to avoid cluttering. By [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-polyline]], it suffices to show that any vertex $z$ of the polyline $\mathbf{p}_K$ are contained in $K$. We claim that it suffices to show that $z \in H_K(t_0)$ for any $t_0 \in \Theta \cup \left\{ \omega \right\}$. Then apply a corresponding argument to mirror reflection and reflect back to conclude that $z \in H_K(\omega + \pi - t)$ for any $t \in \Theta \cup \left\{ \omega \right\}$ as well.

Follow $\mathbf{p}_K$ from right to left, from the right endpoint $A_K^-(0)$ to $z$ and stop at $t$. By summing up the contribution of edges between $A_K^-(0)$ and $z$ in $\mathbf{p}_K$, we have 
$$
A_K^-(0) - z = \sum_{t \in \Theta^{\diamond}} c_t v_t
$$
for coefficients $c_t \in [0, \nu_K(t)]$ for every $t \in \Theta^{\diamond}$. Under this constraint on $c_t$, the value
$$
(z - A_K^-(0)) \cdot u_{t_0} = \sum_{t \in \Theta^{\diamond}} c_t (v_t \cdot u_{t_0})
$$
is maximized when $c_t = \nu_K(t)$ for all $t \leq t_0$ and $c_t = 0$ otherwise. For such $c_t$ we have
$$
\sum_{t \in \Theta^{\diamond}} c_t v_t = A_K^+(t_0) - A_K^-(0)
$$
as we follow the upper boundary $\delta K$ from $A_K^-(0)$ to $A_K^+(t_0)$. So we have
$$
(z - A_K^-(0)) \cdot u_{t_0} \leq (A_K^+(t_0) - A_K^-(0)) \cdot u_{t_0}
$$
which implies $z \cdot u_{t_0} \leq A_K^+(t_0) \cdot u_{t_0}$, in turn implies $z \in H_K(t_0)$ as we desired. □