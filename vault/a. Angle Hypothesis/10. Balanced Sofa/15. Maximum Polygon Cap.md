# Polygon Cap and Niche

Following the outline in [[a. Angle Hypothesis/03. Outline/05. Balanced Sofa]], we define a polygon cap $K$ and its polygon niche $\mathcal{N}_\Theta(K)$ separately. 

> __Definition [angled-cap-space].__ Assume $\omega \in (0, \pi/2]$ and a nonempty finite subset $\Theta$ of $(0, \omega)$. Define the space $\mathcal{K}_\Theta$ of _polygon caps with angle set_ $\Theta$ as the subset of $\mathcal{K}_\omega$ of each $K \in \mathcal{K}_\Theta$ which is an intersection of closed half-planes with normal angles in $\Theta \cup (\Theta + \pi/2) \cup \left\{\omega, \pi/2,  \pi + \omega, 3\pi/2 \right\}$. ^def-angled-cap-space

Any cap $K \in \mathcal{K}_\omega$ can be approximated by a polygon cap $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta$ containing $K$.

> __Definition [angled-cap].__ For any $K \in \mathcal{K}_\omega$, define the set ^def-angled-cap
$$
\mathcal{C}_\Theta(K) = P_\omega \cap \bigcap_{t \in \Theta} Q_K^+(t).
$$

> __Proposition [angled-cap].__ For any $K \in \mathcal{K}_\omega$, the set $\mathcal{C}_\Theta(K)$ is a member of $\mathcal{K}_\Theta$ containing $K$ as subset. Also, the map $\mathcal{C}_\Theta : \mathcal{K}_\omega \to \mathcal{K}_\Theta$ is a surjective map fixing the elements of $\mathcal{K}_\Theta$. ^pro-angled-cap

_Proof._ That $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta$ comes from the formula in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-angled-cap]]. That $K \subseteq \mathcal{C}_\Theta(K)$ comes from $K \subseteq P_\omega$ and $K \subseteq Q_K^+(t) = H_K(t) \cap H_K(t + \pi/2)$. Now it remains to show that for any $K \in \mathcal{K}_\Theta$, we have $\mathcal{C}_\Theta(K) = K$. Since $K \in \mathcal{K}_\Theta$ is the intersection of closed half-planes with normal angles in $\Pi := \Theta \cup (\Theta + \pi/2) \cup \left\{\omega, \pi/2,  \pi + \omega, 3\pi/2 \right\}$, we have $K = \bigcap_{t \in \Pi} H_K(t)$. As $K \in \mathcal{K}_\Theta \subset \mathcal{K}_\omega$, we have $p_K(\omega) = p_K(\pi/2) = 1$ and $p_K(\omega + \pi) = p_K(3\pi/2) = 0$ so $K = \bigcap_{t \in \Pi} H_K(t) = P_\omega \cap \bigcap_{t \in \Theta} Q_K^+(t) = \mathcal{C}_\Theta(K)$. □

> __Definition [angled-niche].__ For every polygon cap $K \in \mathcal{K}_\Theta$ with angle set $\Theta$, define its _polygon niche_ ^def-angled-niche
$$
\mathcal{N}_\Theta(K) = P_\omega \cap \bigcup_{t \in \Theta} Q_K^-(t).
$$

> __Definition [polygon-upper-bound].__ Let $\Theta$ be an angle set with rotation angle $\omega$. Define the _polygon upper bound_ $\mathcal{A}_\omega : \mathcal{K}_\Theta \to \mathbb{R}$ as $\mathcal{A}_\Theta(K) = |K'| - \mathcal{N}_\Theta(K')$ where $K' = \mathcal{C}_\Theta(K)$.
> ^def-polygon-upper-bound

> __Theorem [polygon-upper-bound].__ For every $K \in \mathcal{K}_\omega$, we have $\mathcal{A}(K) \leq \mathcal{A}_\Theta(K)$.
> ^thm-polygon-upper-bound

We will show that the maximizing polygon cap $K \in \mathcal{K}_\Theta$ of the polygon sofa area $\mathcal{A}_\Theta(K)$ is _balanced_ in the sense of Gerver ([[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-balanced-polygon-sofa]]) by executing the balancing argument described in [[a. Angle Hypothesis/03. Outline/05. Balanced Sofa]]. We circumvent the issue that the balanced polygon sofa $S_\Theta := K \setminus \mathcal{N}_\Theta(K)$ might be disconnected by applying balancing to the cap $K \in \mathcal{K}_\Theta$ and its polygon niche $\mathcal{N}_\Theta(K)$ separately. To execute the balancing argument, we will make adjustments to the support function $h = p_K$ of cap $K$ to tweak the cap $K$ and polygon niche $\mathcal{N}_{\Theta}(K)$. We note that $K$ and $\mathcal{N}_\Theta(K)$ can be reconstructed purely back from $h$.

We will adjust the values of $h : \Theta \cup (\Theta + \pi/2) \to \mathbb{R}$ and make the value $|K| - |\mathcal{N}_\Theta(K)|$ larger as a function of $h$. An issue with this argument is that, as we adjust the values of $h$ to make a new function $h^+ : \Theta \cup (\Theta + \pi/2) \to \mathbb{R}$, there might not be a corresponding cap $K' \in \mathcal{K}_\Theta$ with the support function $p_{K'} = h'$ to go back to cap and conclude $\mathcal{A}_\Theta(K) < \mathcal{A}_\Theta(K')$. We circumvent this issue by choosing the direction of increment carefully so that $h^+$ only increases in its value from $h$. This guarantees that $K^+ := \mathcal{C}_\Theta(K)$ is always a _translation_ of some cap in $\mathcal{K}_\Theta$. By translating $K^+$ back to a cap $K^0$, we conclude the increment $\mathcal{A}_\Theta(K) < \mathcal{A}_\Theta(K^+) = \mathcal{A}_\Theta(K^0)$ we desire.

# Extensions of Polygon Cap

We extend the space $\mathcal{K}_\Theta$ of polygon caps to the space $\mathcal{K}_\Theta'$ of all _translates_ of polygon caps.

> __Definition [cap-trans].__ Define the space of _polygon cap translates_ $\mathcal{K}_\Theta'$ as the collection of all translations $K'$ of arbitrary caps $K \in \mathcal{K}_\Theta$ with angle set $\Theta$. ^def-cap-trans

> __Proposition [cap-trans-space].__ A convex polygon $K'$ is in $\mathcal{K}_\Theta'$ if and only if the followings are true. ^pro-cap-trans-space
> 
> 1. The widths $p_{K'}(\omega) + p_{K'}(\omega + \pi)$ and $p_{K'}(\pi/2) + p_{K'}(3\pi/2)$ of $K'$ measured along the angles $\omega$ and $\pi/2$ are exactly one.
> 2. $K'$ is a convex polygon with normal angles in the set $\Theta \cup (\Theta + \pi/2) \cup \left\{\omega, \pi/2, \omega + \pi, 3\pi/2 \right\}$.

_Proof._ For any $K'$ satisfying conditions (1) and (2), find a translation $K$ of $K'$ such that $p_K(\omega) = p_K(\pi/2) = 1$ so that $K \in \mathcal{K}_\Theta$. On the other hand, any translate $K'$ of an arbitrary  □

Subsequently, extend $\mathcal{K}_\Theta'$ again to the space $\mathcal{H}_\Theta$ of _all_ functions $h : \widetilde{\Theta} \to \mathbb{R}$, extending the support function $h = p_{K'}$ of polygon cap translates $K'$.

> __Definition [height-space].__ For any $\omega \in (0, \pi/2]$ and nonempty finite subset $\Theta$ of $(0, \omega)$, define $\widetilde{\Theta} := \Theta \cup (\Theta + \pi/2) \cup \left\{ \omega, \pi/2 \right\}$ and define $\mathcal{H}_\Theta$ as the space of all functions $h : \widetilde{\Theta} \to \mathbb{R}$. ^def-height-space

> __Proposition [height-space-embedding].__ The map $\mathcal{K}_\Theta' \to \mathcal{H}_\Theta$ mapping $K' \in \mathcal{K}'_\Theta$ to its support function $p_{K'}$ on the domain $\widetilde{\Theta}$ is a well-defined injection. ^pro-height-space-embedding

_Proof._ By (2) of [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-trans-space]], the values of $p_{K'}$ on $\widetilde{\Theta}$ determine $K' \in \mathcal{K}_\Theta'$ uniquely. □

We now have a series of extensions $\mathcal{K}_\Theta \to \mathcal{K}_{\Theta'} \to \mathcal{H}_\Theta$. We will extend the functional $\mathcal{A}_\Theta$ on $\mathcal{K}_\Theta$ to $\mathcal{H}_\Theta$. The cap and niche of a cap generalizes naturally to an arbitrary function $h \in \mathcal{H}_\Theta$. We only need to follow [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^eqn-cap-support-ftn]] and [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^eqn-niche-support-ftn]].

> __Definition [height-extensions].__ For any $h \in \mathcal{H}_\Theta$, define its _parallelogram_ ^def-height-extensions
$$
P_h := \bigcap_{t \in \left\{ \omega, \pi/2 \right\} } H_-(t, h(t)) \cap H_+(t, h(t) - 1)
$$
> and _cap_
$$
\mathcal{C}(h) = P_h \cap \bigcap_{t \in \Theta \cup (\Theta + \pi/2)} H_-(t, h(t))
$$
> and _fan_
$$
F_h = H_+(\omega, h(\omega) - 1) \cap H_+(\pi/2, h(\pi/2) - 1)
$$
> and _niche_
$$
\mathcal{N}_{\Theta}(h) = F_h \cap \bigcup_{t \in \Theta } \left( H_-^\circ(t, h(t)) \cap H_-^\circ(t + \pi/2, h(t + \pi/2)) \right)
$$
> and the _polygon sofa area functional_
$$
\mathcal{A}_\Theta(h) := |\mathcal{C}(h)| - |\mathcal{N}_\Theta(h)|.
$$
> For any $K' \in \mathcal{K}'_\Theta$, define $P_{K'}, \mathcal{C}(K'), F_{K'}, \mathcal{N}_\Theta(K')$, $\mathcal{A}_\Theta(K')$ as $P_h, \mathcal{C}(h), F_h, \mathcal{N}_\Theta(h), \mathcal{A}_\Theta(h)$ for $h := p_{K'}$.

The notions in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] extends the corresponding notions on the cap $K \in \mathcal{K}_\Theta$ naturally.

- Translation equivariance.
- 

# Maximum Polygon Sofa

We first define the polygon cap $K_\Theta$ attaining the maximum value of $\mathcal{A}_\Theta$ which is bounded from the origin.

> __Definition [maximum-polygon-cap].__ Define a cap $K_\Theta \in \mathcal{K}_\Theta$ a _maximum polygon cap_ with _angle set_ $\Theta$ and _rotation angle_ $\omega \in (0, \pi/2]$ if (i) $K := K_\Theta$ attains the maximum value of $\mathcal{A}_\Theta : \mathcal{K}_\Theta \to \mathbb{R}$ and (ii) $o_\omega \in K_\Theta$. ^def-maximum-polygon-cap

> __Theorem [maximum-polygon-cap].__ For any $\omega \in (0, \pi/2]$ and nonempty finite $\Theta \subset (0, \omega)$, a maximum polygon cap $K_\Theta$ exists. ^thm-maximum-polygon-cap

_Proof._  □

> __Lemma [maximum-area-polygon-cap-bound].__ For any $\omega \in (0, \pi/2]$ and finite $\Theta \subset (0, \omega)$ containing $\omega/2$, a maximum polygon cap $K_{\Theta}$ with angle set $\Theta$ is contained in the closed disk of radius $R$ centered at the origin. ^lem-maximum-area-polygon-cap-bound

_Proof._  □

Now we define the notion of balancedness on any $K \in \mathcal{K}_\Theta$.

> __Definition [polyline].__ For any $n \geq 1$ and a finite sequence $p_1, p_2, \dots, p_n \in \mathbb{R}^2$ of points on a plane with strictly increasing $x$-coordinates, call the union of the finite segments connjecting adjacent points $p_i$ to $p_{i+1}$ ($1 \leq i < n$) an _$x$-monotone polyline_. ^def-polyline

> __Theorem [polyline].__ The boundary of the closed set $F_\omega \setminus \mathcal{N}_\Theta(K)$ is a union of the following subsets, from left to right in $\mathbb{R}^2$. ^thm-polyline
> 
> 1. The half-line starting from $C_K^+(\omega)$ and extending indefinitely in the direction $v_\omega$.
> 2. An $x$-monotone polyline $\mathbf{p}_K$ connecting $C_K^+(\omega)$ to $A_K^-(0)$ from left to right, with each segment of normal angles in $\Theta \cup (\Theta + \pi/2) \cup \left\{ \omega, \pi/2 \right\}$.
> 3. The half-line starting from $A_K^-(0)$ and extending indefinitely in the direction of $u_0$.

> __Definition [polyline].__ Define the polyline $\mathbf{p}_K$ in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-polyline]] from $C_K^+(\omega)$ to $A_K^-(0)$ as the _polyline of cap_ $K \in \mathcal{K}_\Theta$. ^def-polyline

> __Definition [polyline-length].__ For any cap $K \in \mathcal{K}_\Theta$ and angle $t \in \Theta \cup (\Theta + \pi/2)$, define $\nu_K(t)$ as the sum of the lengths of the edges in the polyline $\mathbf{p}_K$ with normal angle $t$. ^def-polyline-length

> __Definition [polygon-cap-balanced].__ Say that a polygonal cap $K \in \mathcal{K}_\Theta$ is _balanced_ if and only if for any $t \in \widetilde{\Theta}$, we have $\sigma_K(t) = \nu_K(t)$. ^def-polygon-cap-balanced

We now execute the balancing argument to show that any maximum polygon cap $K_\Theta \in \mathcal{K}_\Theta$ in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-maximum-polygon-cap]] is balanced.

> __Lemma [polyline-length].__ ^lem-polyline-length
> 
> 1. For any $t \in \Theta \setminus \left\{ \omega \right\}$, we have $\nu_K(t) = \lambda^1 \left( \partial \mathcal{N}(K) \cap b_K(t) \right)$.
> 2. For any $t \in \Theta \setminus \left\{ 0 \right\}$, we have $\nu_K(t + \pi/2) = \lambda^1 \left( \partial \mathcal{N}(K) \cap d_K(t) \right)$.
> 3. $\nu_K(\omega) + \lambda^1\left( \overline{\mathcal{N}(K)} \cap l(\omega, 0) \right) = \sigma_K(\omega + \pi)$.
> 4. $\nu_K(\pi/2) + \lambda^1$

> __Lemma [balancing].__ Let $K \in \mathcal{K}_\Theta$ be a polygonal cap with support function $h = p_K \in \mathcal{H}_\Theta$. There exists a constant $\epsilon = \epsilon(K) > 0$ such that the following holds. Let $t \in \Theta \cup (\Theta + \pi/2)$ and $\delta \in [0, \epsilon]$ be arbitrary. Define $h' \in \mathcal{H}_\Theta$ as $h'(t) = h(t) + \delta$ and $h'(u) = h(u)$ for all $u \in \Theta \cup (\Theta + \pi/2)$ with $u \neq t$. Then $\mathcal{A}_\Theta(h') = \mathcal{A}_\Theta(K) + (\sigma_K(t) - \nu_K(t)) \delta + O(\delta^2)$. ^lem-balancing

We choose the right angle $t \in \Theta^\diamond$ to balance $K \in \mathcal{K}_\Theta$.

> __Lemma [not-balanced-positive].__ Assume that a polygon cap $K \in \mathcal{K}_\Theta$ is _not_ balanced. Then there exists an angle $t \in \Theta^\diamond$ such that $\sigma_K(t) > \nu_K(t)$. ^lem-not-balanced-positive

_Proof._ By [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-polyline-length]] and [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-polyline-length]], we have the identity
$$
C_K^+(\omega) - A_K^-(0) = \sum_{t \in \Theta^{\diamond}} \nu_K(t) v_t.
$$
Also, by following the upper boundary $\delta K$ of $K$, we also have the identity
$$
C_K^+(\omega) - A_K^-(0) = \sum_{t \in \Theta^{\diamond}} \sigma_K(t) v_t.
$$
So we have where $v_t \cdot u_0 < 0$ for all $t \in \Theta^{\diamond}$. So if $\sigma_K(t) \leq \nu_K(t)$ for all $t \in \Theta^{\diamond}$, then the equality should hold and $K$ should be balanced. Taking the contraposition concludes the proof. □

Choosing the right angle $t \in \Theta^\diamond$ guarantees that the new function $h^+ \in \mathcal{H}_\Theta$ with $h^+(t) := h(t) + \epsilon$ corresponds to a cap translate $K^+$.

> __Lemma [height-positive-increment].__ Let $K \in \mathcal{K}_\Theta$ be arbitrary with support function $h := p_K \in \mathcal{H}_\Theta$. Let $t \in \Theta^\diamond$ be arbitrary such that $\sigma_K(t) > 0$. Then the following holds for any sufficiently small $\epsilon > 0$. Define a new function $h^+ \in \mathcal{H}_\Theta$ so that $h^+(t) := h(t) + \epsilon$ and $h^+(u) := h(u)$ on $u \in \Theta^\diamond \setminus \left\{ t \right\}$. Then the intersection $K^+ := \mathcal{C}_\Theta(h^+)$ is a cap translate in $\mathcal{K}_\Theta'$. Also, we get back $h^+ = p_{K^+}$. ^lem-height-positive-increment

_Proof._ By , it suffices to show that $K^+$ have width 1 in the directions $u_\omega$ and $v_0$. By $\sigma_K(t) > 0$, we have  □

Combine all the steps above to conclude the balancedness of maximum polygon cap.

> __Theorem [balanced-polygon-sofa].__ Any maximum polygon cap $K_\Theta$ with rotation angle $\omega < \pi/2$ is balanced as in [[a. Angle Hypothesis/10. Balanced Sofa/15. Maximum Polygon Cap#^def-polygon-cap-balanced]]. ^thm-balanced-polygon-sofa

_Proof._ Assume by contradiction that the polygon cap $K := K_\Theta$ is not balanced. □

We show that for $\omega < \pi/2$, the wedge gap of a maximum polygon cap is an effective lower bound of the length of the upper edge $e_K(\pi/2)$. This is an important ingredient for the proof of the main theorem.

> __Theorem [balanced-polygon-sofa].__ For any maximum polygon cap $K_\Theta$ with rotation angle $\omega < \pi/2$, we have $w_K^{\circ} \leq \sigma_K(\pi/2)$ and $z_K^{\circ} \leq \sigma_K(\omega)$. ^thm-balanced-polygon-sofa

_Proof._ By appealing to the mirror symmetry (see Remark, maximum polygon cap mirror, ) □