The main goal of this section is to show the following [[b. Angle Hypothesis/03. Balanced optimum#^thm-main-balanced-angled]] and [[b. Angle Hypothesis/03. Balanced optimum#^thm-main-balanced-full-angle]].

> __Definition [niche-gap].__ Let $K \in \mathcal{K}_\omega$ be a cap with rotation angle $\omega \in (0, \pi/2]$. Define the following _niche gaps_ of $K$. ^def-niche-gap
$$
w_K^\circ = \inf_{0 < t < \omega} w_K(t) \qquad
z_K^\circ = \inf_{0 < t < \omega} z_K(t)
$$

> __Theorem [main-balanced-angled].__ Let $\omega \in (0, \pi/2)$ be arbitrary. There exists a maximizer $K \in \mathcal{K}_\omega$ of the sofa area functional $\mathcal{A}_{\omega}(K)$ such that $w_K^\circ \leq \beta_K\left( \left\{ \pi/2 \right\} \right)$ and $z_K^\circ \leq \beta_K\left( \left\{ \omega \right\} \right)$.
> ^thm-main-balanced-angled

> __Theorem [main-balanced-full-angle].__ There exists a maximizer $K \in \mathcal{K}_{\pi/2}$ of the sofa area functional $\mathcal{A}_{\pi/2}(K)$ such that $w_K^\circ + z_K^\circ \leq \beta_K\left( \left\{ \pi/2 \right\} \right)$.
> ^thm-main-balanced-full-angle

The idea behind [[b. Angle Hypothesis/03. Balanced optimum#^thm-main-balanced-angled]] and [[b. Angle Hypothesis/03. Balanced optimum#^thm-main-balanced-full-angle]] comes from the _balancedness_ by Gerver. Gerver approximated a sofa as a polygonal intersection of hallways and stripes. Then, the sides contributed are equal.

In the theorems, the balancedness is one-sided, which is only needed for us to bound $h_K(\epsilon)$ in long term. Moreover, we deal with not the intersection but a modified area $\mathcal{A}$. Note that the niche $\mathcal{N}(K)$ is 

# Balanced polygon optimum

The first step is to prove the balancedness condition for polygonal sofas.

> __Theorem [polygon-balanced-angled].__ Let $\Theta$ be a finite angle set with rotation angle $\omega \in (0, \pi/2)$ and size $\geq 3$. Let $K \in \mathcal{K}_\Theta$ be any maximizer of the polygon area functional $\mathcal{A}_{\Theta}(K)$. Then it should be that $w_K^\circ \leq \beta_K(\left\{ \pi/2 \right\})$ and $z_K^\circ \leq \beta_K\left( \left\{ \omega \right\} \right)$. ^thm-polygon-balanced-angled

The idea is to understand $\mathcal{A}_\Theta(K)$ as the intersection and adjust the side $H$ vertically. Essentially, we take the intersection
$$
S_\Theta = P_\omega \cap \bigcap_{t \in \Theta} \left( R_t(L) + \mathbf{x}(t) \right) 
$$
and adjust the values of $\mathbf{x}(t)$ to increase the area of the intersection $S_\Theta$. However, note that the area of $S_\Theta$ is not always equal to $\mathcal{A}_\Theta(\mathbf{x})$.

We explicitly spell out a part of the logic used for balancedness. Denote $\mathcal{H}^1$ as the dimension one Hausdorff measure on $\mathbb{R}^2$. That is, $\mathcal{H}^1(X)$ for $X$ being a disjoint union of line segments is the sum of line segments of $X$.

> __Lemma [perturbation-half-plane].__ Let $H_0 = H(t_0, h_0)$ be a closed half-plane with normal angle $t_0 \in S^1$ and boundary $l_0 = l(t_0, h_0)$. Let $X$ be a Nef polygon which is made of finite boolean operations on closed half-planes with normal angles not equal to $t_0$ or $t_0 + \pi$. Then for any real value $c$ sufficiently small in absolute value with respect to $X$, we have $\left| H(t_0, h_0 + c) \cap X \right| = \left| H_0 \cap X \right| + \mathcal{H}^1(l_0 \cap X) c + O(c^2)$.
> ^lem-perturbation-half-plane

_Proof._ Gather all the hyperplanes $H_1, \dots, H_M$ with boundaries $l_1, \dots, l_M$ and normal angles $t_1, \dots, t_M \in S^1$ not equal to $t_0$ or $t_0 + \pi$. So the plane $\mathbb{R}^2$ is divided into open polygonal chambers with the lines $l_i$ for $1 \leq i \leq M$. Call the set of lines $\mathcal{L}$. Without loss of generality, we can replace $X$ with $X \setminus \cup_{i=1}^{n} l_i$, because doing so does not change the area of $X$ nor the one-dimensional value $\mathcal{H}^1(l_0 \cap X)$. Now $X$ is a disjoint union of a finite number of open polygonal chambers divided by the lines in $\mathcal{L}$. By additivity, it suffices to assume that $X$ is one of the chambers. The result follows. □

> __Lemma [perturbation-strip].__ Let $H_0 = H(t_0, h_0)$ be a closed half-plane with normal angle $t_0 \in S^1$ and boundary $l_0 = l(t_0, h_0)$. Let $X$ be a Nef polygon which is made of finite boolean operations on closed half-planes with normal angles not equal to $t_0$ or $t_0 + \pi$. Then for any real value $c$ sufficiently small in absolute value with respect to $X$, we have $\left| H(t_0, h_0 + c) \cap X \right| = \left| H_0 \cap X \right| + \mathcal{H}^1(l_0 \cap X) c + O(c^2)$.
> ^lem-perturbation-strip

_Proof._ Following the proof of [[b. Angle Hypothesis/03. Balanced optimum#^lem-perturbation-half-plane]], we can also assume that $X$ is an open polygon with normal angles different from $t$ or $t + \pi$. □

We factor out a part of the lemma.

> __Lemma [niche-is-minimal].__ Let $\Theta$ be a finite angle set with rotation angle $\omega \in (0, \pi/2]$ and size $\geq 3$. Let $\mathbf{x} : \Theta \to \mathbb{R}^2$ be a collection of vectors assigned for each $t \in \Theta \setminus \left\{ 0, \omega \right\}$. Assume that $K$ is a member of $\mathcal{K}_\Theta'$ such that $K \subseteq R_t(Q^+) + \mathbf{x}(t)$ for all $t \in \Theta$. Then we always have the followings. ^lem-niche-is-minimal
$$
\mathcal{N}(K) \subseteq F_K \cap \bigcup_{t \in \Theta} \left( R_t(Q^-) + \mathbf{x}(t) \right)
$$

_Proof._ Since we have
$$
\mathcal{N}(K) = F_K \cap \bigcup_{t \in \Theta} \left(R_t(Q^-) + \mathbf{x}_K(t) \right) 
$$
by definition, it remains to show $R_t(Q^-) + \mathbf{x}_K(t) \subseteq R_t(Q^-) + \mathbf{x}(t)$ for every $t \in \Theta$. This holds by the condition $K \subseteq R_t(Q^+) + \mathbf{x}(t)$. □

A core idea is to bound union of $Q^-_K(t)$. This is hard to control. But the closed half-planes $B_K$ and $D_K$ bounded by lines $b_K(t)$ and $d_K(t)$ are disjoint from $Q^-_K(t)$. The rightmost intersection of $b_K(t)$ and the $x$-axis is called the $W_K^\circ$, so consequently the ray from $W_K^\circ$ to infinity is disjoint from $\mathcal{N}(K)$. 


_Proof._ We will prove $w_K^\circ \leq \beta_K(\left\{ \pi/2 \right\})$. Then the inequality $z_K^\circ \leq \beta_K\left( \left\{ \omega \right\} \right)$ can be proved by appealing to the mirror symmetry of cap. Assume by contradiction that $w_K^\circ > \beta_K\left( \left\{ \pi/2 \right\} \right)$. We will adjust $K$ slightly to another $K' \in \mathcal{K}_{\Theta}$ such that $\mathcal{A}_{\Theta}(K) < \mathcal{A}_{\Theta}(K')$.

Note that
$$
K = (H + \mathbf{x}_K(0)) \cap \bigcap_{t \in \Theta \setminus \left\{ 0, \omega \right\} } (R_t(L) + \mathbf{x}_K(t)) \cap (R_\omega(H) + \mathbf{x}_K(\omega))
$$
by definition of $K$. That is, $K$ is the intersection of translates of $H$, $R_\omega(H)$ and $R_t(L)$ determined by their locations $\mathbf{x}_K : \Theta \to \mathbb{R}^2$. We will make adjustments to the locations, so that we define a new set
$$
K' = (H + \mathbf{x}(0)) \cap \bigcap_{t \in \Theta \setminus \left\{ 0, \omega \right\} } (R_t(L) + \mathbf{x}(t)) \cap (R_\omega(H) + \mathbf{x}(\omega))
$$
with new locations $\mathbf{x} : \Theta \to \mathbb{R}^2$. The new locations $\mathbf{x}$ are defined as $\mathbf{x}(t) = \mathbf{x}_K(t)$ for all $t \in \Theta \setminus \left\{ 0 \right\}$ (thus fixing the translates of $R_t(L)$ and $R_\omega(H)$) and let $\mathbf{x}(0) = \mathbf{x}_K(0) - \epsilon u_0$ for sufficiently small $\epsilon > 0$ (thus moving the translate of $H$ slightly downwards).

We shall show that $K'$ is a member of $\mathcal{K}_{\Theta}'$. (...)

Compare $K$ with $K'$


□


[[15. Cap contains niche#^lem-wedge-ends-in-cap]] implies the following.

> __Corollary [niche-gap-nonnegative].__ For any cap $K$ with a finite angle set, we have $w_K^\circ, z_K^\circ \geq 0$. Consequently, the line segment connecting $W_K^\circ$ and $A_K^-(0)$ is disjoint from $\mathcal{N}(K)$. Likewise, the line segment connecting $Z_K^\circ$ and $C^+_K(\omega)$ is disjoint from $\mathcal{N}(K)$. ^cor-niche-gap-nonnegative

What [[b. Angle Hypothesis/03. Balanced optimum#^thm-monotone-balancedness]] essentially does is to compare two sums of sides of $\mathcal{M}(K)$, each contributed by the upper and lower boundary of $H$. Note that $\mathcal{M}(K)$ is essentially an intersection of $H$, $R_\omega(V)$ and the rotating hallways of angles in $\Theta$. If the lower side of $H$ contributes more to the boundary of $\mathcal{M}(K)$ than , then we can move $H$ slightly in the direction of $v_0$ to increase the area of $\mathcal{M}(K)$. The details for proving [[b. Angle Hypothesis/03. Balanced optimum#^thm-monotone-balancedness]] is a bit more delicate, for which the rest of this section is dedicated to.

We start by enlarging the space $\mathcal{K}_\Theta$ a little bit.

- Left side of $b_K(t)$ and the line segment connecting $W_K(t)$, $A^-_K(0)$ are disjoint.
- $T_K(t)$ and the line segment connecting $W_K(t)$, $A^-_K(0)$ are disjoint. 
- So line segment connecting $W_K^\circ$ and $A^-_K(0)$ is disjoint from $\mathcal{N}(K)$. 
- If $\omega = \pi/2$
	- IF $\mathcal{N}(K)$ is nonempty, then the segments on A and C are disjoint from $\mathcal{N}(K)$. So turns out that 
	- IF $\mathcal{N}(K)$ is empty, then $\mathcal{A}(K)$ can't be maximum.
- If $\omega < \pi/2$, then we are done with above.

Define $N = \mathcal{N}(K)$. Let $\mathbf{x} : \Theta \to \mathbb{R}^2$ be an arbitrary map. Define a convex set $K'$ and a set $N'$ which depends on $\mathbf{x}$ as the following.

$$
N' = F_K \cap \bigcup_{t \in \Theta} \left( R_t(Q^-) + \mathbf{x}(t) \right)
$$

If $\mathbf{x} = \mathbf{x}_K$, then $K' = K$. The idea is to fix $\mathbf{x}(t) = \mathbf{x}_K(t)$ for every $t \in \Theta \setminus \left\{ 0, \omega \right\}$ and adjust $\mathbf{x}(0)$ and $\mathbf{x}(\omega)$ slightly, so that $K' \in \mathcal{K}_\Theta'$ and $\mathcal{A}(K')$ is slightly larger than $\mathcal{A}(K)$. Let $\mathbf{x}(0) = \mathbf{x}_K(0) - \epsilon_0 v_0$ and $\mathbf{x}(\omega) = \mathbf{x}_K(\omega) - \epsilon_\omega u_\omega$ for sufficiently small and arbitrary $\epsilon_0, \epsilon_\omega \geq 0$. 

As we adjust $\mathbf{x}(0)$ and $\mathbf{x}(\omega)$ slightly, there is a change in the area of $K'$ and $N'$. Let $s_u = \beta_K(\left\{ \pi/2 \right\})$, $s_r = \beta_K(\left\{ \omega \right\})$, $s_d = \beta_K\left( \left\{ 3\pi/2 \right\} \right)$ and $s_l = \beta_K\left( \left\{ \pi + \omega \right\} \right)$ be the four side lengths of $K$. As the stripes $H + \mathbf{x}(0)$ and $R_\omega(V) + \mathbf{x}(\omega)$ translates, the upper (resp. lower) side of $H + \mathbf{x}(0)$ contribute an area decrement (resp. increment) of $\epsilon_0 s_u$ (resp. $\epsilon_0 s_d$) in $K'$, and similarly the upper (resp. lower) side of $R_\omega(V) + \mathbf{x}(\omega)$ contribute area decrement (resp. increment) of $\epsilon_\omega s_r$ (resp. $\epsilon_\omega s_l$) in $K'$. Summing up, we have the following change in the area of $K'$.
$$
|K'| = |K| - \epsilon_0 (s_u - s_d) - \epsilon_{\omega} (s_r - s_l) + O(\max(\epsilon_0^2, \epsilon_\omega^2))
$$
Denote the one-dimensional Hausdorff measure of $\mathbb{R}^2$ as $H^1$, so that if $X$ is a disjoint union of line segments in $\mathbb{R}^2$ then $H^1(X)$ is the sum of all lengths of the line segments. Let $n_d = H^1(N \cap l_K(3\pi/2))$ and $n_l = H^1 \left( N \cap l_K(\pi + \omega) \right)$ be the total sum of the sides of $N$ on the lines $l_K(3\pi/2)$ and $l_K(\pi + \omega)$ respectively. Then we have the following change in the area of $N$.
$$
|N'| = |N| + \epsilon_0 n_d + \epsilon_\omega n_l 
$$

We have the following inequalities. 
- If $\omega < \pi/2$, then $w_K + n_d \leq s_d$ because $N \cap l_K(3\pi/2)$ and the line segment connecting $W_K(t)$ and $A_K^-(0)$ are disjoint. Likewise, we have $z_K + n_r \leq s_r$.
- If $\omega = \pi/2$, then $n_d = n_r$, $s_d = s_r$, and $w_K + n_d + z_K \leq s_d$.

Note $w \leq s_d - n_d$ and $z \leq s_l - n_l$.

Some choices of $\epsilon_0$ and $\epsilon_\omega$ makes $K'$ not a proper member of $\mathcal{K}'_{\Theta}$ member because of width 1 condition. We choose $\epsilon_0$ and $\epsilon_\omega$ carefully so that $K'$ is a member of $\mathcal{K}'_{\Theta}$.
1. If $s_u > 0$, then setting $\epsilon_0 = 0$ and pushing only $\epsilon_\omega$ suffice.
2. If $s_r > 0$, then setting $\epsilon_\omega = 0$ and pushing only $\epsilon_0$ suffice.
3. If $s_u = s_r = 0$, then we should push $\epsilon_0 = \epsilon_\omega = \epsilon$ at the same pace. 
This will keep the condition.

Cases:
1. If $z > s_r$ but $w > s_u$, push according to 1
2. If $w > s_u$ but $z \leq s_r$, push according to 2
3. If $w > s_u$ AND $z > s_r$, push according to 3

In all three cases, we can make adjustment that makes $|K'| - |N'|$ larger. Now, it could be that $N'$ is not the niche of $K'$. But note that $\mathcal{N}(K')$ should be contained in $N'$.

By the Blaschke selection theorem, we can take converging