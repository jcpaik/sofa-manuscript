> __Definition [cap-space-special].__ Define $\mathcal{K}^\mathrm{i}$ as the subset of caps $K \in \mathcal{K}^\mathrm{c}$ with the following properties. ^def-cap-space-special
> 
> 1. For any $t \in [0, \pi] \setminus \left\{ \pi/2 \right\}$ we have $\sigma_K(t) = 0$.
> 2. The inner corner $\mathbf{x}_K : [0, \pi/2] \to \mathbb{R}^2$ is continuously differentiable.
> 3. For all $t \in (0, \pi/2)$, we have $\mathbf{x}_K'(t) \cdot u_t < 0$ and $\mathbf{x}_K'(t) \cdot v_t > 0$.
> 4. We have $|K| \geq 2.2$.

> __Theorem [cap-space-special].__ The space $\mathcal{K}^\mathrm{i}$ is a convex subspace of $\mathcal{K}$ containing all balanced maximum caps $K \in \mathcal{K}^\mathrm{c}$ and the cap $\mathcal{C}(G)$ of Gerver's sofa. ^thm-cap-space-special

_Proof._ We first show that $\mathcal{K}^\mathrm{i}$ is a convex subset of the convex domain $\mathcal{K}^\mathrm{c}$. The conditions (1), (2), and (3) of [[#^def-cap-space-special]] are linear and so preserved under the barycentric operation of $\mathcal{K}^\mathrm{c}$. For any $\lambda \in [0, 1]$, by the Brunn-Minkowski theorem
$$
|(1 - \lambda)K_1 + \lambda K_2| \geq |K_1|^{1 - \lambda} |K_2|^{\lambda}
$$
we have $|c_\lambda(K_1, K_2)| \geq 2.2$ if $|K_1|, |K_2| \geq 2.2$. This shows that the condition (4) of [[#^def-cap-space-special]] is also closed under $c_\lambda$. So $\mathcal{K}^\mathrm{i}$ defines a convex subset of $\mathcal{K}^\mathrm{c}$.

That any balanced maximum cap $K \in \mathcal{K}^\mathrm{c}$ satisfies the conditions (1), (2), and (3) of [[#^def-cap-space-special]] is exactly [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/00. Preface#^thm-injectivity]]. Since $K$ attains the maximum value of sofa area functional ([[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/20. Balanced Maximum Sofa#^thm-limiting-maximum-cap-max]]), we should have $2.2 < |G| \leq \mathcal{A}(K) \leq |K|$. So it also satisfies the condition (4) of [[#^def-cap-space-special]]. (TODO: say that $G$ also satisfies them) □

> __Definition [varphi-constants].__ Define absolute constants $\varphi^{\mathrm{R}} := \varphi$ and $\varphi^{\text{L}} := \pi/2 - \varphi$, where the constant $\varphi$ comes from the derivation of Gerver's sofa. ^def-varphi-constants

For the cap $K := \mathcal{C}(G)$ of Gerver's sofa $G$, the inner corner $\mathbf{x}_K(t)$ draws a main 'core' part of the niche $\mathcal{N}(K)$ at the interval $t \in [\varphi^\mathrm{R}, \varphi^\mathrm{L}]$. Following this, we break the cap $K$ and niche $\mathcal{N}(K)$ into three parts using two lines. This is the core idea for the construction of the upper bound $\mathcal{Q}$.

> __Definition [cap-left-right].__ For any $K \in \mathcal{K}^\mathrm{c}$, define the line $\overline{b}_K^\mathrm{R} := \overline{b}_K(\varphi^\mathrm{R})$ and the half-plane $H_K^\mathrm{R} := H_K^\mathrm{b}(\varphi^\mathrm{R})$ bounded by the line $\overline{b}_K^\mathrm{R}$ with normal angle $\varphi^\mathrm{R} + \pi$. Define the points $W_K^\mathrm{R} := W_K(\varphi^\mathrm{R})$ and $\mathbf{x}_K^\mathrm{R} := \mathbf{x}_K(\varphi^\mathrm{R})$ on the line $\overline{b}_K^\mathrm{R}$.
> 
> Similarly, define the line $\overline{d}_K^\mathrm{L} := \overline{d}_K(\varphi^\mathrm{L})$ and the half-plane $H_K^\mathrm{L} := H_K^\mathrm{d}(\varphi^\mathrm{L})$ bounded by the line $\overline{d}_K^\mathrm{L}$ with normal angle $\varphi^\mathrm{L} + \pi$. Define the point $Z_K^\mathrm{L} := Z_K(\varphi^\mathrm{L})$ and $\mathbf{x}_K^\mathrm{L} := \mathbf{x}_K(\varphi^\mathrm{L})$ on the line $\overline{d}_K^\mathrm{L}$. ^def-cap-left-right

> __Definition [cap-right-left-parallelogram].__ For any $K \in \mathcal{K}^\mathrm{i}$ with $|K| > 2.2$, define the following parallelograms. [^remind-def] ^def-cap-right-left-parallelogram
$$
P_K^\mathrm{R} := H \cap H_K(\varphi^\mathrm{R}) \cap H_K^\mathrm{R} \qquad P_K^\mathrm{L} := H \cap H_K(\pi/2 + \varphi^\mathrm{L}) \cap H_K^\mathrm{L}
$$

> __Lemma [cap-right-left-parallelogram].__ The parallelogram $P_K^\mathrm{R}$ is bounded by the lines $l(\pi/2, 0)$, $l(\pi/2, 1)$, $a_K(\varphi^\textrm{R})$ and $\overline{b}_K(\varphi^\textrm{R})$. It has base $\sec \varphi$, height 1, and angle of $\pi/2 \pm \varphi$ at each vertices. The lower-left corner of $P_K^\mathrm{R}$ is $W_K^\mathrm{R}$. ^lem-cap-right-left-parallelogram

_Proof._ Recall that the point $W_K^\mathrm{R} = W_K(\varphi^\mathrm{R})$ is the intersection $\overline{b}_K^\mathrm{R} \cap l(\pi/2, 0)$ by definition. So $W_K(\varphi^\mathrm{R})$ is the lower-left corner of the parallelogram $P_K^\mathrm{R}$. □

> __Lemma [cap-left-right-disjoint].__ For any $K \in \mathcal{K}^\mathrm{i}$, the sets $K \cap H_K^\mathrm{R}$ and $K \cap H_K^\textrm{L}$ are disjoint. ^lem-cap-left-right-disjoint

_Proof._ Fix such $K$. Because $K \subseteq H \cap  H_K(\varphi^\mathrm{R})$, the set $K \cap H_K^\mathrm{R}$ is contained in the paralleogram $P_K^\mathrm{R} := H \cap H_K(\varphi^\mathrm{R}) \cap H_K^\mathrm{R}$ of angle $\varphi^\mathrm{R}$ and unit heights. Likewise, the set $K \cap H_K^\mathrm{L}$ is contained in the parallelogram. Now assume by contradictory that $K \cap H_K^\mathrm{R}$ and $K \cap H_K^\mathrm{L}$ intersect. Then $P_K^\mathrm{R}$ and $P_K^\mathrm{L}$ should intersect as well. The bases of $P_K^\mathrm{R}$ and $P_K^\mathrm{L}$ on the line $l(\pi/2, 1)$ have length $\sec \varphi$. Note that $K$ is contained in the trapezoid $R := H \cap H_K(\varphi^\mathrm{R}) \cap H_K(\pi/2 + \varphi^\mathrm{L})$ containing $P_K^\mathrm{R}$ and $P_K^\mathrm{L}$. Since $P_K^\mathrm{R}$ and $P_K^\mathrm{L}$ overlaps, the side length of $R$ on the line $l(\pi/2, 1)$ is at most $2s$, and so the side length of $R$ on the line $l(\pi/2, 0)$ is at most $2s + 2 \tan \varphi$. Now the area of $R$ is at most $2s + \tan \varphi = \dots < 2.2$, so $|K| \leq |R| < 2.2$ and we get contradiction. □

By [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-cap-left-right-disjoint]], such a $K$ is a disjoint union of three parts $K \cap H_K^\mathrm{R}$, $K \setminus H_K^\mathrm{R} \setminus H_K^\mathrm{L}$, $K \cap H_K^\mathrm{L}$ from right to left, separated by the lines $\overline{b}_K^\mathrm{R}$ and $\overline{d}_K^\mathrm{L}$. The niche $\mathcal{N}(K)$ is also paritioned into three parts $\mathcal{N}(K) \cap H_K^\mathrm{R}$, $\mathcal{N}(K) \cap H_K^\textrm{L}$ and $\mathcal{N}(K) \setminus H_K^\mathrm{R} \setminus H_K^\mathrm{L}$. We find a lower bound of the area for each part.

> __Definition [right-left-body].__ Take arbitrary cap $K \in \mathcal{K}^\mathrm{i}$. Define the convex body ^def-right-left-body
$$
B_K := K \cap \bigcap_{t \in [\varphi_R, \pi/2]} H_K^\textrm{b}(t).
$$
> Similarly, define the convex body
$$
D_K := K \cap \bigcap_{t \in [0, \varphi_L]} H_K^\textrm{d}(t).
$$

> __Lemma [monotonicity-intervals].__ Fix an arbitrary $K \in \mathcal{K}^\mathrm{i}$. Take any $t \in (\varphi^\mathrm{R}, \pi/2]$. ^lem-monotonicity-intervals
> 
> 1. The point $\mathbf{x}_K(t)$ is outside the half-plane $H_K^\textrm{R}$.
> 2. We have $Q_K^-(t) \cap H_K^\mathrm{R} = H_K^\mathrm{R} \setminus H_K^\mathrm{b}(t)$.
> 
> Analogously, take any $t \in [0, \varphi^\textrm{L})$.
> 
> 3. The point $\mathbf{x}_K(t)$ is outside the half-plane $H_K^\textrm{L}$
> 4. We have $Q_K^-(t) \cap H_K^\mathrm{L} = H_K^\mathrm{L} \setminus H_K^\mathrm{d}(t)$.

_Proof._ The point $\mathbf{x}_K(\varphi^\mathrm{R})$ is on the boundary $\overline{b}_K^\mathrm{R}$ of $H_K^\mathrm{R}$ by definition. By (3) of [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^def-cap-space-special]], we have $\mathbf{x}'_K(t) \cdot u_{\varphi^\mathrm{R}} < 0$ for all $t \in (\varphi^\mathrm{R}, \pi/2)$. By integrating, we have $\mathbf{x}_K(t) \cdot u_{\varphi^\mathrm{R}} < \mathbf{x}_K(\varphi^\mathrm{R}) \cdot u_{\varphi^\mathrm{R}}$ for all $t \in (\varphi^\mathrm{R}, \pi/2]$, so we have $\mathbf{x}_K(t) \not\in H_K^\mathrm{R}$.

We now show $Q_K^-(t) \cap H_K^\mathrm{R} = H_K^\mathrm{R} \setminus H_K^\mathrm{b}(t)$. Recall that the quadrant $Q_K^-(t)$ have half-lines $b_K(t)$ and $d_K(t)$ as boundary, so we have $Q_K^-(t) = \mathbb{R}^2 \setminus H_K^\mathrm{b}(t) \setminus H_K^\mathrm{d}(t)$. Because $\mathbf{x}_K(t)$ is outside the half-plane $H_K^\mathrm{R}$ of normal angle $\varphi^\mathrm{R}$, the quadrant $H_K^\mathrm{d}(t) \setminus H_K^\mathrm{b}(t)$ is disjoint from $H_K^\mathrm{R}$. So
$$
Q_K^-(t) \cap H_K^\mathrm{R} = \left( Q_K^-(t) \cup \left( H_K^\mathrm{d}(t) \setminus H_K^\mathrm{b}(t) \right)  \right) \cap H_K^\mathrm{R} = (\mathbb{R}^2 \setminus H_K^\mathrm{b}(t)) \cap H_K^\mathrm{R}.
$$
The proof for left part can be done similarly. □

> __Lemma [right-left-body].__ For any $K \in \mathcal{K}^\mathrm{i}$, we have $K \cap H_K^\mathrm{R} \setminus B_K \subseteq \mathcal{N}(K) \cap H_K^\mathrm{R}$. ^lem-right-left-body

_Proof._ Expanding the [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^def-right-left-body]] of $B_K$ and using (2) of [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-monotonicity-intervals]] at the third equality, we have
$$
\begin{align*}
K \cap H_K^\mathrm{R} \setminus B_K & = K \cap H_K^\mathrm{R} \cap \bigcup_{t \in [\varphi^\mathrm{R}, \pi/2]} (\mathbb{R}^2 \setminus H_K^\mathrm{b}(t)) \\
& = K \cap \bigcup_{t \in [\varphi^\mathrm{R}, \pi/2]} (H_K^\mathrm{R} \setminus H_K^\mathrm{b}(t)) \\
& = K \cap \bigcup_{t \in [\varphi^\mathrm{R}, \pi/2]} (Q_K^-(t) \cap H_K^\mathrm{R}) \\
& = K \cap H_K^\mathrm{R} \cap \bigcup_{t \in [\varphi^\mathrm{R}, \pi/2]} Q_K^-(t) \\
& \subseteq K \cap H_K^\mathrm{R} \cap \bigcup_{t \in [0, \pi/2]} Q_K^-(t) \\
& = \mathcal{N}(K) \cap H_K^\mathrm{R}.
\end{align*}
$$
□

> __Lemma [right-left-body].__ For any cap $K \in \mathcal{K}^\mathrm{c}$, let $B := B_K$ and $D := D_K$. Then the followings are true. ^lem-right-left-body
> 
> 1. For every $t \in [\varphi^\textrm{R}, \pi/2]$, we have $h_K(t) + h_B(\pi + t) \leq 1$.
> 2. Equality holds in (1) at $t = \varphi^\textrm{R}, \pi/2$. So $l_B(3\pi/2) = l(\pi/2, 0)$ and $l_B(\pi + \varphi^\mathrm{R}) = \overline{b}_K^\mathrm{R}$.
> 3. For every $t \in [0, \varphi^\textrm{L}]$, we have $h_K(\pi/2 + t) + h_D(3\pi/2 + t) \leq 1$.
> 4. Equality holds in (3) at $t = 0, \varphi^\textrm{R}$. So $l_D(3\pi/2) = l(\pi/2, 0)$ and $l_D(3\pi/2 + \varphi^\mathrm{L}) = \overline{d}_K^\mathrm{L}$.

_Proof._ (1) By [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^def-right-left-body]], we have $B \subseteq H_K^\mathrm{b}(t)$ for all $t \in [\varphi_R, \pi/2]$, and this completes the proof.

(2) By XX, we have $A_K^-(0) \in H_K^\mathrm{b}(t)$ for all $t \in [\varphi^\mathrm{R}, \pi/2]$ and so $A_K^-(0) \in B_K$. This with $B_K \subseteq K$ implies that $l_B(3\pi/2) = l(\pi/2, 0)$. It remains to prove $l_B(\pi + \varphi^\mathrm{R}) = \overline{b}_K^\mathrm{R}$. Since $B \subseteq H_K^\mathrm{b} (\varphi^\mathrm{R})$, and $\overline{b}_K^\mathrm{R}$ is the boundary of $H_K^\mathrm{R} = H_K^\mathrm{b}(\varphi^\mathrm{R})$, it suffices to show that there exists some point $p \in B \cap \overline{b}_K^\mathrm{R}$.

We will show that the upper boundary $\delta K$ of $K$ and the line $\overline{b}_K^\mathrm{R}$ intersect at a single point. As an intermediate step, we show that the point $W_K^\mathrm{R}$ is in the edge $e_K(3\pi/2)$ excluding the endpoints $A_K^+(0)$ and $C_K^-(\pi/2)$. We just have shown that $A_K^-(0) \in B_K$, and note that $B_K \subseteq P_K^\mathrm{R}$ by definition. So $P_K^\mathrm{R}$ contains the points $W_K(\varphi^\mathrm{R})$ and $A_K^-(0)$ in the lower side on $l(\pi/2, 0)$. Because $P_K^\mathrm{R}$ has base length $\sec \varphi < 2.2$, but the edge $e_K(3\pi/2)$ of $K$ connecting $A_K^-(0)$ to $C_K^+(\pi/2)$ is of length $\geq 2.2$, the point $W_K(\varphi^\mathrm{R})$ should be in the edge $e_K(3\pi/2)$ excluding the endpoints. Now, since the line $\overline{b}_K^\mathrm{R}$ passes through $W_K^\mathrm{R}$ which is in the edge $e_K(3\pi/2)$ of $K$, it should pass through exactly one another point of the boundary $\partial K$ of $K$. That point is the unique intersection of $\delta K$ and $\overline{b}_K^\mathrm{R}$.

Now take $p$ as the unique intersection of $\delta K$ and $\overline{b}_K^\mathrm{R}$. Recall that our goal is to show $p \in B \cap \overline{b}_K^\mathrm{R}$. Since $p \in K \cap \overline{b}_K^\mathrm{R}$, it suffices to show that $p \in H_K^\mathrm{b}(t)$ for all $t \in [\varphi^\mathrm{R}, \pi/2]$. By (2) of [[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/15. Cap Contains Niche#^thm-monotonization-connected-iff]] and that $p \in \delta K$, the point $p$ is outside the niche $\mathcal{N}(K)$. So $p$ is outside all $Q_K^-(t)$ over $t \in [0, \pi/2]$. By the equality $Q_K^-(t) \cap H_K^\mathrm{R} = H_K^\mathrm{R} \setminus H_K^\mathrm{b}(t)$ for all $t \in (\varphi^\mathrm{R}, \pi/2]$ in [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-monotonicity-intervals]], the point $p$ should be inside $H_K^\mathrm{b}(t)$ for all such $t$. This completes the goal.

The proofs of (3) and (4) can be done using symmetric arguments. □

> __Definition [right-left-tails].__ For any convex body $B$, define the convex curve ^def-right-left-tails
$$
\mathbf{r}_B := \mathbf{u}_{B}^{\pi + \varphi^\textrm{R}, 3\pi/2}
$$
> which is from the vertex $X_B := v_B^+(\pi + \varphi^\mathrm{R})$ to the vertex $W_B := v_B^-(3\pi/2)$. Likewise, for any convex body $D$, define the convex curve
$$
\textbf{l}_D := \mathbf{u}_D^{3\pi/2, 3\pi/2 + \varphi^\textrm{L}}
$$
> which is from the vertex $Z_D := v_D^+(3\pi/2)$ to the vertex $Y_K := v_D^-(3\pi/2 + \varphi^\mathrm{L})$.

Now we bound the right and left part of $\mathcal{N}(K)$.

> __Lemma [cap-left-right-tail].__ Fix an arbitrary $K \in \mathcal{K}^\mathrm{i}$ and take $B := B_K$. We have ^lem-cap-left-right-tail
$$
\left| \mathcal{N}(K) \cap H_K^\textrm{R} \right| \geq \mathcal{J}\left( X_B, W_K^\mathrm{R} \right) -  \mathcal{J}\left( \mathbf{r}_B \right) 
$$
> and similarly
$$
\left| \mathcal{N}(K) \cap H_K^\textrm{L} \right| \geq \mathcal{J}\left( Z_K(\varphi^\textrm{L}), v_D^-(3\pi/2 + \varphi^\textrm{L}) \right)  -  \mathcal{J}\left( \mathbf{u}_B^{3\pi/2, 3\pi/2 + \varphi^\textrm{R}} \right).
$$

_Proof._ Recall the [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^def-right-left-tails]] that the curve $\mathbf{r}_B := \mathbf{u}_{B}^{\pi + \varphi^\textrm{R}, 3\pi/2}$ is the segment of $\partial B$ from the vertex $X_B := v_B^+(\varphi^\textrm{R} + \pi)$ of $B$ to the vertex $W_B := v_B^-(3\pi/2)$ of $B$. Also, we have equality $W_K^\mathrm{R} = v_B\left( \pi + \varphi^\mathrm{R}, 3\pi/2 \right)$ from (2) of [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-right-left-body]].

If $X_B = W_B$, then by (1) of [[03. Optimality of Gerver's Sofa/05. Setup/20. Convex Curve#^lem-convex-curve-cut]] the curve $\mathbf{u}_B^{\pi + \varphi^\textrm{R}, 3\pi/2}$ and the points $X_B, W_B, W_K^\mathrm{R}$ degenerate to a single point. So the lower bound becomes zero if $X_B = W_B$.

Now assume otherwise that $X_B \neq W_B$. Define the closed curve $\Gamma$ obtained by following $\mathbf{r}_B$ in the reverse direction, and then the line segments from $X_B$ to $W_K^\mathrm{R}$ and from $W_K^\mathrm{R}$ to $W_B$ respectively. Then by XX, the curve $\Gamma$ is a counterclockwise Jordan curve enclosing a region $R$. By YY and ZZ and WW, the area of $R$ is equal to the lower bound $\mathcal{J}\left( X_B, W_K^\mathrm{R} \right) -  \mathcal{J}\left( \mathbf{r}_B \right)$. So it remains to show that the region $R$ is contained in the set $\mathcal{N}(K) \cap H_K^\mathrm{R}$.

Take any point $p \in R$. Our goal is to show that $p \in \mathcal{N}(K) \cap H_K^\mathrm{R}$. By (3) of ZZ and (2) of [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-right-left-body]], we have
$$
p \in H_B(\pi + \varphi^\mathrm{R}) \cap H_B(3\pi/2) = H_K^\mathrm{R} \cap H(\pi/2, 0).
$$
Now define the half-line $r$ from $p$ extending in the direction $v_0$. Then the ray $r$ should intersect the boundary $\Gamma$. By the containment above, the ray $r$ should intersect $\Gamma$ at a point $q \in \mathbf{r}_B$. By the definition of $\mathbf{r}_B$, there is some $t \in ( \varphi^\mathrm{R}, \pi/2)$ such that $q \in e_B(\pi + t)$. By (1) of [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-right-left-body]], we have $h_K(t) - 1 \leq q \cdot u_t$.

Main observation is that, the half-line $b_K(t)$ intersected with that half-plane $H_K^b(\varphi_R)$ is not different from the full line $\overline{b}_K(t)$. Another words, $Q_K^-(t) \cap H_K^b(\varphi_R) = H_K^b(\varphi_R) \setminus H_K^b($

1. The supporting line $l_B(\varphi^\mathrm{R} + \pi)$ is the line $\overline{b}_K^\mathrm{R}$ and the corresponding edge $e_B(\varphi^\mathrm{R} + \pi)$ connects two points $W_K(\varphi^\mathrm{R})$ and $\overline{b}_K^\mathrm{R} \cap \delta K$. (proof: shoot ray upwards
2. The edge $e_B(3\pi/2)$ of $B$ connects two points $W_K(\varphi^\mathrm{R})$ and $A_K^-(0)$. Correspondingly, for any $t \in (\varphi^\mathrm{R} + \pi, 3\pi/2)$, the half-plane may or may not $W_K(\varphi^\mathrm{R})$ and excludes $\overline{b}_K^\mathrm{R} \cap \delta K$ and $A_K^-(0)$.
3. So $H_K^\mathrm{b}(t) \cap B_K = H_K^\mathrm{b}(t) \cap H_K^\mathrm{b}(\varphi_R) \cap H_K(3\pi/2)$.

The point $\mathbf{x}_K(\varphi_R)$ is strictly inside $K \setminus \delta K$. So $\overline{b}_K(\varphi_R)$ intersects at the upper boundary $\delta K$ for some point $p$. □

Then we approximate the middle part of the niche by the core traced out by $\mathbf{x}_K$ restricted to the interval $[\varphi^\mathrm{R}, \varphi^\mathrm{L}]$.

> __Lemma [cap-middle-lower-estimate].__ Fix an arbitrary $K \in \mathcal{K}^\mathrm{i}$. We have $|M_K| \geq \mathcal{I}(\mathbf{x}_K|_{[\varphi^\mathrm{R}, \varphi^\mathrm{L}]}) + \mathcal{I}(\mathbf{x}_K(\varphi^\mathrm{L}), Z_K(\varphi^\mathrm{L})) + \mathcal{I}(\mathbf{x}_K(\varphi^\mathrm{R}), W_K(\varphi^\mathrm{R}))$. ^lem-cap-middle-lower-estimate

_Proof._ Omit the subscript $K$, and restrict the domain of $\mathbf{x}$ to $[\varphi^\mathrm{R}, \varphi^\mathrm{L}]$ for simplification. Define $Y := \mathbb{R}^2 \setminus H_K^\mathrm{R} \setminus H_K^\mathrm{L}$ as the open cone bounded by the lines $\overline{b}_K^\mathrm{R}$ and $\overline{d}_K^\mathrm{L}$. By [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-monotonicity-intervals]] the curve $\mathbf{x}(t)$ on $t \in [\varphi^\mathrm{R}, \varphi^\mathrm{L}]$ starts at $\overline{b}_K^\mathrm{R}$ and ends at $\overline{d}_K^\mathrm{L}$, and the middle parts $(\varphi^\mathrm{R}, \varphi^\mathrm{L})$ are inside the open cone $Y$.

Take the horizontal line $H_L$ described by the equation $y = -h$ for sufficiently large $h > 0$, so that it is far below the trajectory of $\mathbf{x}$. We construct a closed curve $\Gamma$, consisting of the following four curves in order.

1. $\mathbf{x} : [\varphi^\mathrm{R}, \varphi^\mathrm{L}] \to \mathbb{R}^2$.
2. The line segment $s_L$ from $\mathbf{x}_K(\varphi_L)$ to $d \cap H_L$.
3. Follow the line segment $s_M$ from $d \cap H_L$ to $b \cap H_L$.
4. Follow the line segment $s_R$ from $b \cap H_L$ to $\mathbf{x}_K(\varphi_L)$.

Then $\Gamma$ is a Jordan curve since the interior of $\mathbf{x}$ is inside the open cone $Y$, and $h$ is taken so that $s_M$ is disjoint from $\mathbf{x}$. Let $G$ be the open region enclosed by the Jordan curve $\Gamma$. Similarly, let $R$ be the trapezoid formed by the vertices $z_K(\varphi_R), d \cap H_L, b \cap H_L, w_K(\varphi_R)$. 

$G \subseteq \left( \mathcal{N}(K) \cap K_M \right) \cup P$. Why? Since $\Gamma$ is inside the triangular region $T$ bounded by $b$, $d$, and $H_L$, so is $G \subseteq T$. So it suffices to check $G \setminus T \subseteq G \cap \text{region above } y=0$ is contained inside. For any $p \in G$, shoot a ray $r_p$ above. It never hits $s_M$. If it hits $s_L$, then as $s_L \cap H_0$ is the line connecting $s_R$  

Define the half-plane $H^\mathrm{o} := H_+(\pi/2, 0)$ above the $x$-axis. We have $G \cap H^\mathrm{o} \subseteq N$. Take any $p \in G \cap H^\mathrm{o}$. Make a ray $r_p$ starting from point $p$ in the direction of $v(0)$. It should hit some point on $\Gamma$. It can never be the bottom segment $s_M$. If it is $\mathbf{x}$, then as $\mathbf{x}$ is .....

□

We embed $\mathcal{K}^{\mathrm{c}}$ in a larger convex space $\mathcal{L}$ and extend $\mathcal{A}_2$ on $\mathcal{K}^{\mathrm{c}}$ to functional $\mathcal{Q}$ on $\mathcal{L}$. Unlike $\mathcal{A}_2$ on $\mathcal{K}^{\mathrm{c}}$, $\mathcal{Q}$ on $\mathcal{L}$ turns out to be quadratic and concave.

> __Definition [cap-tail-space].__ Define $\mathcal{L}$ as the space of tuples $(K, B, D)$ of convex bodies such that the followings are true. ^def-cap-tail-space
> 
> 1. $K \in \mathcal{K}^\mathrm{i}$, $B \subseteq K$, and $D \subseteq K$.
> 2. For every $t \in [\varphi^\textrm{R}, \pi/2]$, we have $h_K(t) + h_B(\pi + t) \leq 1$.
> 3. Equality holds in (2) at $t = \varphi^\textrm{R}, \pi/2$.
> 4. For every $t \in [0, \varphi^\textrm{L}]$, we have $h_K(\pi/2 + t) + h_D(3\pi/2 + t) \leq 1$.
> 5. Equality holds in (4) at $t = 0, \varphi^\textrm{R}$.

> __Proposition [cap-tail-space].__ The space $\mathcal{L}$ is a convex domain with the barycentric operation ^pro-cap-tail-space
$$
c_\lambda((K_1, B_1, D_1), (K_2, B_2, D_2)) := (c_\lambda(K_1, K_2), c_\lambda(B_1, B_2), c_\lambda(D_1, D_2)). 
$$

_Proof._ The product $\mathcal{K} \times \mathcal{K} \times \mathcal{K}$ of convex domains $\mathcal{K}$ is naturally a convex domain. Recall that $\mathcal{K}^\mathrm{i}$ is a convex subspace of $\mathcal{K}$. That $B \subseteq K$ (resp. $D \subseteq K$) can be written as linear constraints $h_B(t) \leq h_K(t)$ (resp. $h_D(t) \leq h_K(t)$) over all $t \in S^1$. So the condition (1) of [[#^def-cap-tail-space]] is preserved under barycentric operations. That the conditions (2) to (5) of [[#^def-cap-tail-space]] are linear constraints are evident. □

> __Theorem [cap-tail-extension].__ For any $K \in \mathcal{K}^\mathrm{i}$, the triple $(K, B_K, D_K)$ is in $\mathcal{L}$. ^thm-cap-tail-extension

_Proof._ We need to check the conditions of [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^def-cap-tail-space]] for $B := B_K$ and $D := D_K$. Condition (1) is evident from the definition. Conditions (2) to (5) are exactly [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-right-left-body]]. □

> __Remark [cap-tail-extension].__ Even though both $\mathcal{K}^\mathrm{i}$ and $\mathcal{L}$ are convex domains, the injection $\mathcal{K}^\mathrm{i} \to \mathcal{L}$ defined as map $K \mapsto (K, B_K, D_K)$ in [[#^thm-cap-tail-extension]] is _not_ linear. The lower left portion of the convex body $B_K$ is the _Aleksandrov body_ (or the _Wulff shape_) $\bigcap_{t \in [\varphi^\mathrm{R}, \pi/2]} H_+(t, f(t))$ of the function $f(t) := 1 - h_K(\pi + t)$ over $t \in [\varphi^\mathrm{R}, \pi/2]$, which is hard to understand in terms of $f$, $K$ or $h_K$ directly. This makes the injection $\mathcal{K}^\mathrm{i} \to \mathcal{L}$ very important. ^rem-cap-tail-extension

> __Definition [upper-bound-q].__ Define the function $\mathcal{Q} : \mathcal{L} \to \mathbb{R}$ as ^def-upper-bound-q
$$
\begin{align*}
\mathcal{Q}(K, B, D) & := |K| + \mathcal{J}\left( \mathbf{l}_D \right) + \mathcal{J} \left( Y_D,   \mathbf{x}_K^\textrm{L} \right) - \mathcal{J}\left( \mathbf{x}_K|_{[\varphi^\textrm{R}, \varphi^\textrm{L}]} \right) + \mathcal{J} \left( \mathbf{x}_K^\textrm{R}, X_B \right)  + \mathcal{J}\left( \mathbf{r}_B \right) .
\end{align*}
$$

> __Theorem [upper-bound-q].__ For any $K \in \mathcal{K}^\mathrm{i}$, we have $\mathcal{A}(K) \leq \mathcal{Q}(K, B_K, D_K)$. ^thm-upper-bound-q

_Proof._ Add all the inequalities from [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-cap-left-right-tail]] and [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/05. Definition#^lem-cap-middle-lower-estimate]].
$$
\begin{align*}
\mathcal{A}(K) & = |K| - |\mathcal{N}(K)| \\
& = (|K| - |\mathcal{N}(K) \setminus H_K^\mathrm{R} \setminus H_K^\mathrm{L}|) - |\mathcal{N}(K) \cap H_K^\mathrm{R}| - |\mathcal{N}(K) \cap H_K^\mathrm{L}| \\
& \leq 
\end{align*}
$$

□

> __Theorem [upper-bound-q-gerver].__ If $K := \mathcal{C}(G)$ is the cap of Gerver's sofa, then we have $\mathcal{A}(K) = \mathcal{Q}(K, B_K, D_K)$. ^thm-upper-bound-q-gerver

_Proof._  □

[^remind-def]: Recall that $H$ is the horizontal strip $\mathbb{R} \times [0, 1]$, $H_K(\varphi^\mathrm{R})$ is the supporting half-plane of $K$ with boundary $a_K(\varphi^\mathrm{R})$, and $H_K^\mathrm{R}$ is the half-plane with boundary $\overline{b}_K(\overline{b}^\textrm{R})$.