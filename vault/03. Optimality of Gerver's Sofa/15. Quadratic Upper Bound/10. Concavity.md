We prove the following [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^thm-upper-bound-concave]] in this [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity]].

> __Theorem [upper-bound-concave].__ The functional $\mathcal{Q} : \mathcal{L} \to \mathbb{R}$ is concave and quadratic. ^thm-upper-bound-concave

> __Figure [mamikon-sofa].__ Mamikon's theorem applied to the region with area $\mathcal{S}(K)$, bounded from below by the upper boundary $\delta K$ of cap $K$, and bounded from above by outer corner $\mathbf{y}_K : [0, \omega] \to \mathbb{R}^2$ of tangent hallways $L_K(t)$. ^fig-mamikon-sofa
> 
> ![](images/sofaMamikon.svg)

The main idea of proving [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^thm-upper-bound-concave]] is depicted in [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^fig-mamikon-sofa]] (compare with XX). We will compare 

> __Definition [mamikon-middle].__ For any $K \in \mathcal{K}^\mathrm{i}$, define ^def-mamikon-middle
$$
\mathcal{S}_K := \mathcal{M}_K\left( 0, \varphi^\mathrm{R}; \mathbf{l}_K^{\pi/2} \right) + 
\mathcal{M}_K\left( \varphi^\mathrm{R}, \varphi^\mathrm{L}; \mathbf{y}_K \right) + 
\mathcal{M}_K\left( \varphi^\mathrm{L}, \pi/2; \mathbf{l}_K^{\pi/2 + \varphi^\mathrm{L}} \right) + 
\mathcal{M}_K\left( \pi/2, \pi; \mathbf{l}_K^{\pi} \right)
$$

> __Definition [mamikon-right-left].__ For any convex bodies $B$ and $D$, define ^def-mamikon-right-left

Note that [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^def-mamikon-middle]] and [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^def-mamikon-right-left]] only uses Mamikon areas in [[03. Optimality of Gerver's Sofa/05. Setup/30. Mamikon's Theorem#^def-mamikon]]. So by [[03. Optimality of Gerver's Sofa/05. Setup/30. Mamikon's Theorem#^thm-mamikon-convex]], these are convex and quadratic.

> __Lemma [mamikon-sofa-convex].__ The values $\mathcal{S}_K$, $\mathcal{S}_D^\mathrm{R}$, $\mathcal{S}_B^\mathrm{L}$ are convex and quadratic as functionals on the convex bodies $K, B, D$ respectively. ^lem-mamikon-sofa-convex

_Proof._  □

> __Definition [upper-bound-middle].__ For any $K \in \mathcal{K}^\mathrm{i}$, define the functional ^def-upper-bound-middle
$$
\mathcal{P}_K := |K| + \mathcal{J}\left( Z_K^\mathrm{L}, \mathbf{x}_K^\mathrm{L} \right) -  \mathcal{J}\left( \mathbf{x}_K|_{[\varphi^\mathrm{R}, \varphi^\mathrm{L}]} \right) + \mathcal{J}\left( \mathbf{x}_K^\mathrm{R}, W_K^\mathrm{R} \right).
$$

> __Definition [modulo-linear].__ For any functionals $f(V)$ and $g(V)$ on $V \in\mathcal{V}$ in convex domain $\mathcal{V}$, write $f(V) \equiv_V g(V)$ if $f(V) - g(V)$ is linear in $V \in \mathcal{V}$. ^def-modulo-linear

It is easy to check that the relation $\equiv_V$ in [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^def-modulo-linear]] is an equivalence relation on the functionals on convex domain $\mathcal{V}$.

> __Lemma [upper-boundary-tracing].__  ^lem-upper-boundary-tracing

_Proof._ We first break the value $|K|$ into a sum of convex curve area functionals. By Remark 5.1.2, page 276 of [@schneider_2013], we have $|K| = \frac{1}{2} \int_{t \in S^1} h_K(t) \, \sigma_K(dt)$. As $K \in \mathcal{K}$ is a cap with rotation angle $\pi/2$, the measure $\sigma_K$ is zero on the set $(\pi, 2\pi) \setminus \left\{ 3\pi/2 \right\}$ and $h_K(3\pi/2) = 0$. As $K \in \mathcal{K}^\mathrm{i}$, we have $\sigma_K(0) = \sigma_K(\pi) = 0$ too. So
$$
|K| = \frac{1}{2} \int_{t \in (0, \pi)} h_K(t) \, \sigma_K(dt).
$$
$$
\begin{align*}
|K| & = \mathcal{J}(\delta K) \\
& = \mathcal{J}\left( \mathbf{u}_K^{0, \psi_L} \right)  + \mathcal{J}(\mathbf{u}_K^{\psi_L, \psi_R}) + \sigma_K(\pi/2) / 2 + \mathcal{J}(\mathbf{u}_K^{\pi/2, \pi}).
\end{align*}
$$
 □

> __Lemma [linear-values-manipulation].__  ^lem-linear-values-manipulation

_Proof._ Next, we treat the expression $\mathcal{I}(\mathbf{x}_K|_{[\varphi_R, \varphi_L]})$. We have $\mathbf{y}(t) = \mathbf{x}(t) + u_t + v_t$. Now
$$
\begin{split}
\mathcal{I}(\mathbf{y}_K) & = \frac{1}{2} \int_{0}^\omega \mathbf{y}_K(t) \times d \mathbf{y}_K(t) \\
& = \frac{1}{2} \int_{0}^\omega (\mathbf{x}_K(t) + c_t) \times d (\mathbf{x}_K(t) + c_t)  \\
& = \mathcal{I}(\mathbf{x}_K) + \frac{1}{2} \left( \int_{0}^\omega c_t \times d \mathbf{x}_K(t) 
+ \int_{0}^\omega \mathbf{x}_K(t) \times d c_t + \int_{0}^\omega c_t \times d c_t \right) 
\end{split}
$$
so $\mathcal{I}(\mathbf{y}_K) - \mathcal{I}(\mathbf{x}_K)$ is convex-linear with respect to $K$, by the convex-linearity of $\mathbf{x}_K$ ([[old/xb. Upper Bound A1/25. Upper Bound A1/03. Boundary measure#^thm-cap-convex-linear]]). So we have $\mathcal{I}(\mathbf{x}) \equiv_{\mathcal{L}} \mathcal{I}(\mathbf{y})$. □

> __Lemma [mamikon-middle-eq].__ For any $K \in \mathcal{K}^\mathrm{i}$, we have $\mathcal{S}_K \equiv_K \mathcal{P}_K$. ^lem-mamikon-middle-eq

_Proof._ Expand all the Mamikon terms in $\mathcal{S}_K$. It is easier to verify this by following the bold lines in [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^fig-mamikon-sofa]] from right to left.
$$
\begin{split}
\mathcal{S}_K
& = - \mathcal{J}\left( \mathbf{u}_K^{0, \varphi^\mathrm{R}} \right) && +
\mathcal{J}\left( A_K(0), \mathbf{l}_K^{\pi/2}(0) \right) && + 
\mathcal{J}\left( \mathbf{l}_K^{\pi/2}(0), \mathbf{l}_K^{\pi/2}(\varphi^\mathrm{R}) \right) && + 
\mathcal{J}\left( \mathbf{l}_K^{\pi/2}(\varphi^\mathrm{R}), A_K(\varphi^\mathrm{R}) \right) 
\\
& \phantom{=} -
\mathcal{J}\left( \mathbf{u}_K^{\varphi^\mathrm{R}, \varphi^\mathrm{L}} \right) && +
\mathcal{J}\left( A_K(\varphi^\mathrm{R}), \mathbf{y}_K(\varphi^\mathrm{R}) \right) && + 
\mathcal{J}\left( \mathbf{y}_K|_{[\varphi^\mathrm{R}, \varphi^\mathrm{L}]} \right) && +
\mathcal{J}\left( \mathbf{y}_K(\varphi^\mathrm{L}), A_K(\varphi^\mathrm{L}) \right)
\\
& \phantom{=} - 
\mathcal{J}\left( \mathbf{u}_K^{\varphi^\mathrm{L}, \pi/2} \right) && + 
\mathcal{J}\left( A_K(\varphi^\mathrm{L}), \mathbf{y}_K(\varphi^\mathrm{L}) \right) && +
\mathcal{J}\left( \mathbf{y}_K(\varphi^\mathrm{L} ), \mathbf{l}_K^{\pi/2 + \varphi^\mathrm{L}}(\varphi^\mathrm{L}) \right) && +
\mathcal{J}\left( \mathbf{l}_K^{\pi/2 + \varphi^\mathrm{L}}(\varphi^\mathrm{L}), A_K(\pi/2) \right)
\\
& \phantom{=} - 
\mathcal{J}\left( \mathbf{u}_K^{\pi/2, \pi} \right) && + 
\mathcal{J}\left( C_K(0), \mathbf{l}_K^{\pi}(\pi/2) \right) && +
\mathcal{J}( \mathbf{l}_K^{\pi}(\pi/2), C_K(\pi/2)) 
\end{split}
$$
The first column adds up to $-|K| + \mathcal{J}(A_K(\pi/2), C_K(\pi/2))$ by [[03. Optimality of Gerver's Sofa/15. Quadratic Upper Bound/10. Concavity#^lem-upper-boundary-tracing]]. Call the term in $i$'th row and $j$'th column as simply $J_{ij}$. We have $J_{12} = p_K(0) / 2$. $J_{13} = \left( \mathbf{l}_K^{\pi/2}(0) -  \mathbf{l}_K^{\pi/2}(\varphi^\mathrm{R}) \right) \cdot u_0$. 
$J_{14} + J_{22} = \mathcal{J}\left( \mathbf{l}_K^{\pi/2}(\varphi^\mathrm{R}), \mathbf{y}_K(\varphi^\mathrm{R}) \right)$


□

> __Lemma [mamikon-right-left-eq].__ For any convex bodies $B$ and $D$, ^lem-mamikon-right-left-eq
$$
\mathcal{S}_D = 
$$

$$
\begin{align*}
\mathcal{Q}(K, B, D) & := |K| + \mathcal{J}\left( \mathbf{l}_D \right) + \mathcal{J} \left( Y_D,   \mathbf{x}_K(\varphi^\textrm{L}) \right) \\
& \phantom{=} - \mathcal{J}\left( \mathbf{x}_K|_{[\varphi^\textrm{R}, \varphi^\textrm{L}]} \right) + \mathcal{J} \left( \mathbf{x}_K(\varphi^\textrm{R}), X_B \right)  + \mathcal{J}\left( \mathbf{r}_B \right) .
\end{align*}
$$


_Proof._ Let $(K, \mathbf{b}, \mathbf{d}) \in \mathcal{L}$ be arbitrary. For any quadratic functionals $\mathcal{F}_1$ and $\mathcal{F}_2$ on $\mathcal{L}$, write $\mathcal{F}_1 \equiv_{\mathcal{L}} \mathcal{F}_2$ if their difference $\mathcal{F}_2 - \mathcal{F}_1$ is a convex-linear function on $\mathcal{L}$. If $\mathcal{F}_1 \equiv_{\mathcal{L}} \mathcal{F}_2$ then $\mathcal{F}_1$ is concave if and only if $\mathcal{F}_2$ is. The proof comprises of two steps. First, we reduce the 

Further break it down into convex curve area functionals.
$$
|K| = 
$$

The terms $\mathcal{I}(v_K(\varphi_R), \mathbf{y}_K(\varphi_R))$ and $\mathcal{I}(W_K(\varphi_R), \mathbf{x}_K(\varphi_R))$. The first one is on the line $a_K(t)$, and the second one is on the line $b_K(t)$.
$$
\mathcal{I}(v_K(\varphi_R), \mathbf{y}_K(\varphi_R)) \equiv_{\mathcal{L}} \mathcal{I}(W_K(\varphi_R), \mathbf{x}_K(\varphi_R))
$$
A similar reasoning gives
$$
\mathcal{I}(v_K(\varphi_L + \pi/2), \mathbf{y}_K(\varphi_L)) \equiv_{\mathcal{L}} \mathcal{I}(Z_K(\varphi_R), \mathbf{x}_K(\varphi_R))
$$

Finally, 

The expression

is convex and quadratic by [[03. Optimality of Gerver's Sofa/05. Setup/30. Mamikon's Theorem#^thm-mamikon-convex]]. We show that $\mathcal{Q}_K + \mathcal{S}_K$ is linear in terms of $K$.

□