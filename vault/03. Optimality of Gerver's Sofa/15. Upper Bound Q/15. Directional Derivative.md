We will calculate the directional derivative of $\mathcal{Q}$ at (the cap of) Gerver's sofa. The value turns out to be zero, so since $\mathcal{Q}$ is concave and quadratic, Gerver's sofa achieves the maximum value of $\mathcal{Q}$.

> __Theorem [variation-curve].__ Let $C^\mathrm{BV}[a, b]$ be the real vector space of all continuous maps of bounded variation from $[a, b]$ to $\mathbb{R}^2$. Then the curve area functional $\mathcal{J}(\mathbf{x})$ on $\mathbf{x} \in C^\mathrm{BV}[a, b]$ is quadratic. Moreover, the directional derivative of $\mathcal{J}$ from $\mathbf{x}$ to $\mathbf{x}^*$ evaluates to ^thm-variation-curve
$$
D \mathcal{J}(\mathbf{x} ; \mathbf{x}^*) = \left[ \int_a^b (\mathbf{x}^*(t) - \mathbf{x}(t))  \times d\mathbf{x} (t) \right] +  \mathcal{J}(\mathbf{x}(b), \mathbf{x}^*(b)) - \mathcal{J}(\mathbf{x}(a), \mathbf{x}^*(a)).
$$

_Proof._ Consider the bilinear form $\mathcal{B}(\mathbf{x}_1, \mathbf{x}_2) = \int_a ^b \mathbf{x}_1(t) \times d \mathbf{x}_2(t)$ on $\mathbf{x}_1, \mathbf{x}_2 \in C^\mathrm{BV}[a, b]$. Apply [[old/xb. Upper Bound A1/25. Upper Bound A1/02. Calculus of variation#^lem-derivative-calculation]] to $2\mathcal{J}(\mathbf{x}) = \mathcal{B}(\mathbf{x}, \mathbf{x})$ to get ^eqn-variation-curve
$$
2 D \mathcal{J}(\mathbf{x} ; \mathbf{x}^*) = \mathcal{B}(\mathbf{x}, \mathbf{x}^*) + \mathcal{B}(\mathbf{x}^*, \mathbf{x}) - 2 \mathcal{B}(\mathbf{x}, \mathbf{x}).
$$
With integration by parts ([[02. Injectivity of Maximum-area Sofas/10. Notations and Properties/17. Lebesgue-Stieltjes Measure#^thm-integration-by-parts]]), we get
$$
\int_a^b \mathbf{x}(t) \times d \mathbf{x}^*(t) = \mathbf{x} (b) \times \mathbf{x}^*(b) - \mathbf{x}(a) \times \mathbf{x}^*(a) + \int_a^b \mathbf{x}^*(t) \times d\mathbf{x} (t)
$$
or
$$
\mathcal{B}(\mathbf{x}, \mathbf{x}^*) = 2\mathcal{J}(\mathbf{x}(b), \mathbf{x}^*(b)) - 2\mathcal{J}(\mathbf{x}(a), \mathbf{x}^*(a)) + \mathcal{B}(\mathbf{x}^*, \mathbf{x}).
$$
Plug this back in [[#^eqn-variation-curve]] and rearrange the terms to get the desired equality. □

> __Theorem [convex-curve-area-variation].__ Fix $a, b \in \mathbb{R}$ such that $a < b < a + \pi$. Define $f(K) := \mathcal{J}\left( \mathbf{u}_K^{a, b} \right)$ as a functional on $K \in \mathcal{K}$. Then $f$ is quadratic on $\mathcal{K}$ and its directional derivative from $K$ to $K^*$ evaluates to ^thm-convex-curve-area-variation
$$
D f(K; K^*) = \int_{t \in (a, b)} \left( h_{K^*}(t) - h_K(t) \right) \, \sigma_{K}(dt) + \mathcal{J}\left( v_{K^*}^-(b), v_K^- (b) \right) - \mathcal{J}\left( v_{K^*}^+(a), v_K^+ (a) \right).
$$

_Proof._ Define the bilinear form $\mathcal{B} : \mathcal{K} \times \mathcal{K} \to \mathbb{R}$ on $\mathcal{K}$ as ^eqn-b-def
$$
\mathcal{B}(K_1, K_2) := \frac{1}{2} \int_{t \in (a, b)} h_{K_1}(t) \, \sigma_{K_2}(dt) .
$$
We first show ^eqn-b-vertex
$$
\mathcal{B}(K_1, K_2) = \frac{1}{2} \int_{t \in (a, b)} v_{K_1}^+(t) \times d v_{K_2}^+(t) = \frac{1}{2} \int_{t \in (a, b)} v_{K_1}^-(t) \times d v_{K_2}^+(t).
$$
To do so, check
$$
v_{K_1}^{\pm}(t) \times \textrm{d} v_{K_2}(t) = v_{K_1}^{\pm}(t) \times (v_t \sigma_{K_2}) = (v_{K_1}^{\pm}(t) \times v_t) \sigma_{K_2} = h_{K_1}(t) \sigma_{K_2}
$$
as pairs of measures on $t \in (a, b)$.

By integration by parts ([[02. Injectivity of Maximum-area Sofas/10. Notations and Properties/17. Lebesgue-Stieltjes Measure#^thm-integration-by-parts]]) and that the left limit of $v_{K_1}^+$ at $t$ is $v_{K_1}^-(t)$ ([[02. Injectivity of Maximum-area Sofas/10. Notations and Properties/10. Convex Body#^thm-limits-converging-to-vertex]]), we get
$$
\int_{t \in (a, b)} d v_{K_1}^+(t) \times v_{K_2}^+(t) + \int_{t \in (a, b)} v_{K_1}^-(t) \times d v_{K_2}^+(t) = v_{K_1}^-(b) \times v_{K_2}^-(b) - v_{K_1}^+(a) \times v_{K_2}^+(b).
$$
With [[#^eqn-b-vertex]] and the anticommutativity $a \times b = -b \times a$ of cross product, this becomes
$$
\mathcal{B}(K_1, K_2) - \mathcal{B}(K_2, K_1) = 2 \mathcal{J}(v_{K_1}^-(b), v_{K_2}^-(b)) - 2 \mathcal{J} (v_{K_1}^+(a), v_{K_2}^+(b)).
$$

Now use [[03. Optimality of Gerver's Sofa/05. Setup/05. Convex Space#^lem-derivative-calculation]] on $f(K) = \mathcal{B}(K, K)$ to get
$$
\begin{align*}
D f(K; K^*) & = \mathcal{B}(K, K^*) + \mathcal{B}(K^*, K) - 2 \mathcal{B}(K, K) \\
& = 2\mathcal{B}(K^*, K) - 2 \mathcal{B}(K, K) + \mathcal{J}\left( v_{K^*}^-(b), v_K^- (b) \right) - \mathcal{J}\left( v_{K^*}^+(a), v_K^+ (a) \right)
\end{align*}
$$
and use [[#^eqn-b-def]]. □

We introduce a measure $\iota_K$ to calculate the directional derivative of $\mathcal{I}$ on the inner corner $\mathbf{x}_K$ of cap $K$.

> __Definition [i-cap].__ For any cap $K \in \mathcal{K}^{\mathrm{c}}$, define the function $i_K : (0, \pi] \to \mathbb{R}$ as $i_K(t) = g_K^+(t) - 1$ and $i_K(t + \pi / 2) = g^+_K(t) - 1$ for every $t \in (0, \pi/2]$. Define $\iota_K$ as the measure on $[0, \pi]$ derived from the density function $i_K$. That is, $\iota_K(dt) = i_K(t) dt$ and $\iota_K\left( \left\{ 0 \right\} \right) = 0$ in particular. ^def-i-cap

[[old/xb. Upper Bound A1/25. Upper Bound A1/15. Directional derivative of A1#^def-i-cap]] is motivated by the following lemma.

> __Lemma [i-cap].__ Let $I \subseteq [0, \pi/2]$ be any interval. Let $K, K^* \in \mathcal{K}^{\mathrm{c}}$ be arbitrary. Then the following holds. ^lem-i-cap
$$
\int_{t \in I} \mathbf{x}_{K}(t) \times d \mathbf{x}_{K^*} (t) = \left< p_{K} - 1, \iota_{K^*} \right>_{I \cup (I + \pi/2)} 
$$

_Proof._ By [[old/xb. Upper Bound A1/25. Upper Bound A1/01. Definition of A1#^thm-inner-corner-deriv]] and [[old/xb. Upper Bound A1/25. Upper Bound A1/01. Definition of A1#^pro-arm-length-unsigned]], the derivative of $\mathbf{x}_{K_2}(t)$ with respect to $t$ exists almost everywhere and is the following.
$$
\mathbf{x}'_{K_2}(t) = -(g_{K_2}^+(t) - 1) u_t + (h_{K_2}^+(t) - 1) v_t
$$
Meanwhile, we have the following.
$$
\mathbf{x}_{K_1}(t) = (p_{K_1} (t) - 1) u_t + 
(p_{K_1} (t + \pi / 2) - 1) v_t
$$
So the cross-product $\mathbf{x}_{K_1}(t) \times \mathbf{x}_{K_2}'(t)$ is equal to the following almost everywhere.
$$
(h_{K_2}^+(t) - 1) (p_{K_1} (t) - 1) + (g_{K_2}^+(t) - 1) (p_{K_1} (t + \pi / 2) - 1)
$$
Now the left-hand side is equal to
$$
\int_{t \in J} (h_{K_2}^+(t) - 1) (p_{K_1} (t) - 1) + (g_{K_2}^+(t) - 1) (p_{K_1} (t + \pi / 2) - 1) \, dt
$$
and by [[old/xb. Upper Bound A1/25. Upper Bound A1/15. Directional derivative of A1#^def-i-cap]] this integral is equal to $\left< p_{K_1} - 1, \iota_{K_2} \right>_{I \cup (I + \pi/2)}$. □

> __Theorem [variation-a2].__ Let $(K, \mathbf{b}, \mathbf{d})$ and $(K^*, \mathbf{b}^*, \mathbf{d}^*)$ be two elements of $\mathcal{L}$. Then we have the following. ^thm-variation-a2
$$
\begin{align*}
D\mathcal{Q}(K, \mathbf{b}, \mathbf{d}; K^*, \mathbf{b}^*, \mathbf{d}^*) & =
\left< p_{K^*} - p_K, \beta_K \right>_{[0, \pi]} -
\left< p_{K^*} - p_K, \iota_{K_1} \right>_{[\varphi_R, \varphi_L]} \\
& \phantom{=} + 
\left< p_\mathbf{b^*} - p_\mathbf{b}, \beta_\mathbf{b} \right>_{[\varphi_R, \pi/2] + \pi} + 
\left< p_\mathbf{d^*} - p_\mathbf{d}, \beta_\mathbf{d} \right>_{[0, \varphi_L] + 3\pi/2} \\
& \phantom{=} + \left( (v_{\mathbf{b}}^+(\varphi_L) - \mathbf{x}_K(\varphi_L)) \cdot v_0 \right) \left( \mathbf{x}_K(\varphi_L) \cdot u_0 \right) \\
& \phantom{=} + \left( (v_{\mathbf{b}}^+(\varphi_L) - \mathbf{x}_K(\varphi_L)) \cdot v_0 \right) \left( \mathbf{x}_K(\varphi_L) \cdot u_0 \right) 
\end{align*}
$$

_Proof._ □

Now we finally let $\varphi_R = \varphi$ and $\varphi_L = \pi/2 - \varphi$ and calculate the directional derivative at Gerver's sofa.

> __Theorem [variation-a2-gerver].__ Let $\varphi_R = \varphi$ and $\varphi_L = \varphi$, and let $(K, \mathbf{b}, \mathbf{d}) := (K_G, \mathbf{b}_{K_G}, \mathbf{d}_{K_G})$ be the cap and two tails of Gerver's sofa. Then $D \mathcal{Q}(K, \mathbf{b}, \mathbf{d}; -) \leq 0$. ^thm-variation-a2-gerver

_Proof._ Since $v_{\mathbf{b}}^+(\varphi_L) =\mathbf{x}_K(\varphi_L)$, the vertical term zeroes out.

1. $p_K(t) + p_{\mathbf{b}}(t + \pi) = 1$ on $t \in [0, \theta]$.
2. $\beta_K(dt) = dt/2$ on $t \in [0, \varphi]$
3. $\beta_K(dt) = \beta_{\mathbf{b}}(dt + \pi) +  \iota_K(dt)$ on $t \in [\varphi, \theta]$
4. $\beta_K(dt) = \iota_K(dt)$ on $t \in [\theta, \pi/2 - \theta]$

□

> __Remark [ttt].__ So far, doesn't seem to justify the choice of constants $\varphi_R$ and $\varphi_L$. Indeed, arbitrary choice of $\varphi_R$ and $\varphi_L$ near $\varphi$ and $\pi/2-\varphi$ indeed give another upper bound of sofa area. However, in this case the maximizer $(K, \mathbf{b}, \mathbf{d}) \in \mathcal{L}$ of $\mathcal{Q}$ does not match at the endpoints. In particular, the triple never comes from the embedding $\mathcal{K} \to \mathcal{L}$. Recall that the solution $(\varphi_R, \varphi_L) = (\varphi, \pi/2 - \varphi)$ was derived by trying to match the endpoints $v_{\mathbf{b}}(\varphi_R) = \mathbf{x}_K(\varphi_R)$ and $v_{\mathbf{d}}(\varphi_L) = \mathbf{x}_K(\varphi_L)$. ^rem-ttt