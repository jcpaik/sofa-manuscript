(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    104051,       2238]
NotebookOptionsPosition[     99791,       2170]
NotebookOutlinePosition[    100190,       2186]
CellTagsIndexPosition[    100147,       2183]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"<<", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Setup.m\>\""}], 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.936948174516007*^9, 3.9369481812316504`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4150777a-f66e-430c-9b61-9701cab11681"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omega", "=", 
   RowBox[{"80", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "6"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9319946456189833`*^9, 3.93199464872186*^9}, {
   3.931994717084818*^9, 3.931994718365975*^9}, {3.931994861038878*^9, 
   3.931994871495871*^9}, {3.9320053877513237`*^9, 3.932005413347075*^9}, 
   3.9383944266480007`*^9, {3.938394481135964*^9, 3.938394481898979*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"26e0bb32-e3c2-499d-8371-85b58dbe1265"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"theta", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Subdivide", "[", 
     RowBox[{"0", ",", "omega", ",", "n"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], ",", 
        RowBox[{"Sin", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"0", ",", 
          RowBox[{"omega", "+", 
           RowBox[{"Pi", "/", "2"}]}], ",", "n"}], "]"}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931994640012061*^9, 3.931994640521565*^9}, {
  3.931994710247663*^9, 3.931994781213228*^9}, {3.9320033675589437`*^9, 
  3.93200338504405*^9}, {3.9320041849885387`*^9, 3.932004185325304*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"617774e2-e845-41cd-84eb-0c2ef1140339"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha", "=", "0.01"}], ";"}]], "Input",
 CellChangeTimes->{{3.932004424402845*^9, 3.932004426072941*^9}, {
  3.932005403546439*^9, 3.932005404094356*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"17dda065-49c7-4629-b36e-f5350d88ba98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Gradient", " ", "Descent", " ", "to", " ", "make", " ", "it", " ", 
    "balanced"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sofaPolygon", "=", 
      RowBox[{"Sofa", "[", 
       RowBox[{"theta", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"sigma", "=", 
      RowBox[{"Norm", "/@", 
       RowBox[{"Differences", "@", 
        RowBox[{"CapVertices", "@", "sofaPolygon"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigmaAssoc", "=", 
      RowBox[{"AssociationThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Most", "@", 
           RowBox[{"Rest", "@", 
            RowBox[{
            "SofaPolygon`Private`capEdges", "[", "sofaPolygon", "]"}]}]}], 
          "-", "n", "-", "2"}], ")"}], "\[IndentingNewLine]", "->", "sigma"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sigmaAssoc", "[", 
       RowBox[{"-", "1"}], "]"}], "=", 
      RowBox[{
       RowBox[{"sigmaAssoc", "[", "0", "]"}], "=", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"polyline", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Last", "@", 
          RowBox[{"CapVertices", "@", "sofaPolygon"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NicheVertices", "@", "sofaPolygon"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"First", "@", 
          RowBox[{"CapVertices", "@", "sofaPolygon"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"polylineLengths", "=", 
      RowBox[{"Norm", "/@", 
       RowBox[{"Differences", "@", "polyline"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lengthAssignments", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"NicheIndices", "[", "sofaPolygon", "]"}], "->", 
        "polylineLengths"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nuAssoc", "=", 
      RowBox[{"GroupBy", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"lengthAssignments", ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "n"}], "-", "1"}], "->", "0"}], ",", 
            RowBox[{"n", "->", "0"}]}], "\[IndentingNewLine]", "}"}]}], "]"}],
         ",", 
        RowBox[{"First", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Last", "[", "#", "]"}]}], "&"}], ")"}]}], ",", "Total"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradAssoc", "=", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sigmaAssoc", ",", "nuAssoc"}], "}"}], ",", "Total"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gradAssoc", "[", 
       RowBox[{"-", "1"}], "]"}], "=", 
      RowBox[{
       RowBox[{"gradAssoc", "[", "0", "]"}], "=", "0"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gradx", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"gradAssoc", "[", 
           RowBox[{"i", "-", "n", "-", "1"}], "]"}], "*", 
          RowBox[{"SofaU", "[", 
           RowBox[{"sofaPolygon", ",", "i"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"gradAssoc", "[", "i", "]"}], "*", 
          RowBox[{"SofaV", "[", 
           RowBox[{"sofaPolygon", ",", "i"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "+=", 
      RowBox[{"alpha", " ", "gradx"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"loop", ",", "10000"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.931994935996705*^9, 3.931994965106319*^9}, {
   3.9320029875567017`*^9, 3.932003058122963*^9}, {3.932003181004818*^9, 
   3.9320031975822783`*^9}, {3.932003261680764*^9, 3.932003266447866*^9}, {
   3.9320041603454313`*^9, 3.932004160624715*^9}, {3.9320042796505613`*^9, 
   3.932004283326665*^9}, {3.932004340253236*^9, 3.932004344055587*^9}, {
   3.932004434053068*^9, 3.932004519470294*^9}, {3.93200459841225*^9, 
   3.932004619838097*^9}, {3.9320047986941*^9, 3.9320048041394453`*^9}, {
   3.9320050052079153`*^9, 3.93200505077488*^9}, {3.932005089923738*^9, 
   3.932005121988071*^9}, {3.932005252066298*^9, 3.932005285177815*^9}, {
   3.932005328311356*^9, 3.932005332743297*^9}, 3.9320066848651943`*^9, {
   3.9383773319240503`*^9, 3.9383773417633123`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"fdbbcefb-f420-455d-9d0b-bcd1a04fc037"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cap", "=", 
   RowBox[{"CapVertices", "[", "sofaPolygon", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"niche", "=", 
   RowBox[{"NicheVertices", "[", "sofaPolygon", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932005063456279*^9, 3.9320050655987*^9}, {
  3.932005295820413*^9, 3.9320053206109047`*^9}, {3.938377375636503*^9, 
  3.938377455503654*^9}, {3.938393922642734*^9, 3.938394097413948*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e360a209-0c5b-437e-a080-9d658949f4df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hallwayWalls", "[", 
    RowBox[{"armlength_", ",", "override___"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Black", ",", "override", ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "armlength"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "armlength"}]}], "}"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "armlength"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "armlength"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"105dfe0a-2949-4819-a386-ada0f6308b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hallwayInterior", "[", 
    RowBox[{"armlength_", ",", "override___"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
     "MS`SofaHallwayDefaultFillingColor", ",", "override", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "armlength"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "armlength"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "armlength"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "armlength"}], ",", "1"}], "}"}]}], "}"}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hallway", "[", 
    RowBox[{"armlength_", ",", "override___"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hallwayInterior", "[", 
      RowBox[{"armlength", ",", "override"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"hallwayWalls", "[", 
      RowBox[{"armlength", ",", "override"}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.938651847937395*^9, 3.938651860031205*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"0dcc7c4b-adb3-456a-9406-a93e18648904"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"transHallwayWalls", "[", 
   RowBox[{"corner_", ",", "angle_", ",", "armlength_", ",", "override___"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Translate", "[", 
   RowBox[{
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"hallwayWalls", "[", 
       RowBox[{"armlength", ",", "override"}], "]"}], ",", "angle", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "corner"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transHallway", "[", 
   RowBox[{"corner_", ",", "angle_", ",", "armlength_", ",", "override___"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Translate", "[", 
   RowBox[{
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"hallway", "[", 
       RowBox[{"armlength", ",", "override"}], "]"}], ",", "angle", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "corner"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.938651824472847*^9, 3.938651845395276*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"d738563d-6e00-41b2-9a8b-6aafa1fd0574"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"balancedPolygonAngled", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"FaceForm", "[", "MS`SofaDefaultFillingColor", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "@", 
         RowBox[{"SofaVertices", "[", "sofaPolygon", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"transHallwayWalls", "[", 
        RowBox[{
         RowBox[{"SofaX", "[", 
          RowBox[{"sofaPolygon", ",", "4"}], "]"}], ",", 
         RowBox[{"theta", "[", 
          RowBox[{"[", 
           RowBox[{"4", "+", "1"}], "]"}], "]"}], ",", "4", ",", 
         RowBox[{"Lighter", "@", 
          RowBox[{"Lighter", "@", 
           RowBox[{"Lighter", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}]}]}], "]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "@", 
         RowBox[{"SofaVertices", "[", "sofaPolygon", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", "Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "2"}], "]"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"niche", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Darker", "[", "Green", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"5", "+", "n"}], "]"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"6", "+", "n"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"niche", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"niche", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Thin", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"transHallwayWalls", "[", 
           RowBox[{
            RowBox[{"SofaX", "[", 
             RowBox[{"sofaPolygon", ",", "i"}], "]"}], ",", 
            RowBox[{"theta", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "4", ",", "Gray", 
            ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "theta", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.587225036603072`"}], "-", "0.2`"}], ",", 
         RowBox[{"1.6117105412180863`", "+", "0.2`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "->", "width"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938394112710369*^9, 3.938394113312533*^9}, {
  3.938394171934712*^9, 3.938394329633999*^9}, {3.938394365513163*^9, 
  3.938394409140126*^9}, {3.938394449720351*^9, 3.938394465333166*^9}, {
  3.9383944994249077`*^9, 3.9383945608349333`*^9}, {3.938394603998831*^9, 
  3.938394673819401*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"baf21c4a-0954-44d7-bd07-19c2154f1900"],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[None], FaceForm[RGBColor[1, 1, 0.87]], PolygonBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQ/StN6N+Ekz/tGSCgIccw8ODfaT/sNWZnu2ibXbEP
ki1t7N36zX7FcdeWkBkP7ecITrjbteSLfabU/0dWrc/s1W/WvQm4/Ml+9aFz
am8tX9rvSJxbcW/6R/u69d+9BL1e2R8InWuyInUb1PwP9vfXJby3FHu3H8a3
2TWlODXyw36xLXEMPYnv7U05WCduiv+0/6+3iMCniLf2UzYmHlC99mV/j4nX
iTdmL+037Y1S3hP2ff9Z55eqTHWP7G2XVIq4pf7c/+j2xbi0lxft5Qx87FrS
H+1/9JrlsvK3nfY/j8rseDDlzv6Hzw4+VJtw097sxbQXYsuv73fgLZh5L/+6
vWh+6s4qz9P7q79LvL9Z8MheLWx7Ylj9zv2u8yaF+Vfct+dqVNPYeX61/fI0
4c869x7be/4zzGSuOW6/Qn2LRu+ju/Yu5lFaZtcv2zPVLGl58POB/cn2U5rf
Y27br2HWdHX+ecm+knNdD4/3A/taaHjOLTFgM97wCBbeDABOdLts
     "]]}, GeometricTransformationBox[GeometricTransformationBox[
     {RGBColor[
       NCache[
        Rational[19, 27], 0.7037037037037037], 
       NCache[
        Rational[73, 81], 0.9012345679012346], 
       NCache[
        Rational[19, 27], 0.7037037037037037]], 
      LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
      LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
      0.5971585917027862, -0.8021231927550437}, {0.8021231927550437, 
      0.5971585917027862}}, {0., 0.}}], {-0.2131799130682956, 
    0.5762757940171775}], 
   {EdgeForm[GrayLevel[0]], FaceForm[None], PolygonBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQ/StN6N+Ekz/tGSCgIccw8ODfaT/sNWZnu2ibXbEP
ki1t7N36zX7FcdeWkBkP7ecITrjbteSLfabU/0dWrc/s1W/WvQm4/Ml+9aFz
am8tX9rvSJxbcW/6R/u69d+9BL1e2R8InWuyInUb1PwP9vfXJby3FHu3H8a3
2TWlODXyw36xLXEMPYnv7U05WCduiv+0/6+3iMCniLf2UzYmHlC99mV/j4nX
iTdmL+037Y1S3hP2ff9Z55eqTHWP7G2XVIq4pf7c/+j2xbi0lxft5Qx87FrS
H+1/9JrlsvK3nfY/j8rseDDlzv6Hzw4+VJtw097sxbQXYsuv73fgLZh5L/+6
vWh+6s4qz9P7q79LvL9Z8MheLWx7Ylj9zv2u8yaF+Vfct+dqVNPYeX61/fI0
4c869x7be/4zzGSuOW6/Qn2LRu+ju/Yu5lFaZtcv2zPVLGl58POB/cn2U5rf
Y27br2HWdHX+ecm+knNdD4/3A/taaHjOLTFgM97wCBbeDABOdLts
     "]]}, 
   {RGBColor[0, 0, 1], Thickness[Large], 
    LineBox[{{-0.9402131724686703, 1.}, {0.08748866352592355, 1.}}], 
    LineBox[{{1.6117105412180863`, 0.}, {0.5840087052234996, 0.}}]}, 
   {RGBColor[0, 
     NCache[
      Rational[2, 3], 0.6666666666666666], 0], Thickness[Large], 
    LineBox[{{-1.3022820963770743`, 
     0.7879547035132801}, {-1.4586755162271001`, 0.5778818836644121}}], 
    LineBox[{{-0.21317991306829556`, 
     0.5762757940171775}, {-0.3695733329183243, 0.3662029741683064}}]}, 
   {Thickness[Tiny], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{1., 0.}, {0., 1.}}, {0., 
       0.}}], {1.002892214861677, 0.}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.9730448705798238, -0.23061587074244017`}, {0.23061587074244017`, 
       0.9730448705798238}}, {0., 0.}}], {0.5091612575200052, 
     0.3158062141578098}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.8936326403234123, -0.44879918020046217`}, {0.44879918020046217`, 
       0.8936326403234123}}, {0., 0.}}], {0.31001047264077314`, 
     0.5305025664018788}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.766044443118978, -0.6427876096865393}, {0.6427876096865393, 
       0.766044443118978}}, {0., 0.}}], {0.05431917777173295, 
     0.6208710429738928}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.5971585917027862, -0.8021231927550437}, {0.8021231927550437, 
       0.5971585917027862}}, {0., 0.}}], {-0.2131799130682956, 
     0.5762757940171775}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.39607976603915673`, -0.9182161068802741}, {0.9182161068802741, 
       0.39607976603915673`}}, {0., 0.}}], {-0.4465867803547493, 
     0.399423332658996}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.17364817766693041`, -0.984807753012208}, {0.984807753012208, 
       0.17364817766693041`}}, {0., 0.}}], {-0.9876560286313645, 
     0.17415040550708172`}]}},
  ImageSize->404,
  PlotRange->{{-1.787225036603072, 1.8117105412180863`}, {-0.2, 
   1.2}}]], "Output",
 CellChangeTimes->{
  3.938394099879013*^9, {3.938394221012155*^9, 3.938394309712083*^9}, {
   3.938394385329048*^9, 3.938394409632943*^9}, {3.938394441425337*^9, 
   3.938394579520492*^9}, 3.938394610980846*^9, 3.938394641893278*^9, 
   3.9383946751342907`*^9, 3.9385575807079697`*^9, 3.938651520503436*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"777f571e-de07-42e7-ab51-fa763512be66"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"save", "[", "balancedPolygonAngled", "]"}]], "Input",
 CellChangeTimes->{{3.9383946765110598`*^9, 3.938394678233794*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"8b0b1bab-e6cc-426f-95ae-3160e7d5ca85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omega", "=", 
   RowBox[{"90", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9319946456189833`*^9, 3.93199464872186*^9}, {
   3.931994717084818*^9, 3.931994718365975*^9}, {3.931994861038878*^9, 
   3.931994871495871*^9}, {3.9320053877513237`*^9, 3.932005413347075*^9}, 
   3.9383944266480007`*^9, {3.938394481135964*^9, 3.938394481898979*^9}, {
   3.938394783369913*^9, 3.9383947847775993`*^9}, {3.9383949578155107`*^9, 
   3.938394961245428*^9}, 3.938395015627873*^9, {3.9383972523460903`*^9, 
   3.938397252450451*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6fb8a938-1cec-4eae-9a1a-f81d2fc4bba6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"theta", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Subdivide", "[", 
     RowBox[{"0", ",", "omega", ",", "n"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], ",", 
        RowBox[{"Sin", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"0", ",", 
          RowBox[{"omega", "+", 
           RowBox[{"Pi", "/", "2"}]}], ",", "n"}], "]"}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931994640012061*^9, 3.931994640521565*^9}, {
  3.931994710247663*^9, 3.931994781213228*^9}, {3.9320033675589437`*^9, 
  3.93200338504405*^9}, {3.9320041849885387`*^9, 3.932004185325304*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"d557a001-ad59-49c0-a63f-786a6908db06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha", "=", "0.01"}], ";"}]], "Input",
 CellChangeTimes->{{3.932004424402845*^9, 3.932004426072941*^9}, {
   3.932005403546439*^9, 3.932005404094356*^9}, {3.9383948051631413`*^9, 
   3.9383948396849422`*^9}, 3.938394910785153*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"def6f61f-3aeb-40ec-9bbc-477401a18148"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Gradient", " ", "Descent", " ", "to", " ", "make", " ", "it", " ", 
    "balanced"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sofaPolygon", "=", 
      RowBox[{"Sofa", "[", 
       RowBox[{"theta", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"sigma", "=", 
      RowBox[{"Norm", "/@", 
       RowBox[{"Differences", "@", 
        RowBox[{"CapVertices", "@", "sofaPolygon"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigmaAssoc", "=", 
      RowBox[{"AssociationThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Most", "@", 
           RowBox[{"Rest", "@", 
            RowBox[{
            "SofaPolygon`Private`capEdges", "[", "sofaPolygon", "]"}]}]}], 
          "-", "n", "-", "2"}], ")"}], "\[IndentingNewLine]", "->", "sigma"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sigmaAssoc", "[", 
       RowBox[{"-", "1"}], "]"}], "=", 
      RowBox[{
       RowBox[{"sigmaAssoc", "[", "0", "]"}], "=", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"polyline", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Last", "@", 
          RowBox[{"CapVertices", "@", "sofaPolygon"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NicheVertices", "@", "sofaPolygon"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"First", "@", 
          RowBox[{"CapVertices", "@", "sofaPolygon"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"polylineLengths", "=", 
      RowBox[{"Norm", "/@", 
       RowBox[{"Differences", "@", "polyline"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lengthAssignments", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"NicheIndices", "[", "sofaPolygon", "]"}], "->", 
        "polylineLengths"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nuAssoc", "=", 
      RowBox[{"GroupBy", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"lengthAssignments", ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "n"}], "-", "1"}], "->", "0"}], ",", 
            RowBox[{"n", "->", "0"}]}], "\[IndentingNewLine]", "}"}]}], "]"}],
         ",", 
        RowBox[{"First", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Last", "[", "#", "]"}]}], "&"}], ")"}]}], ",", "Total"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradAssoc", "=", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sigmaAssoc", ",", "nuAssoc"}], "}"}], ",", "Total"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gradAssoc", "[", 
       RowBox[{"-", "1"}], "]"}], "=", 
      RowBox[{
       RowBox[{"gradAssoc", "[", "0", "]"}], "=", "0"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gradx", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"gradAssoc", "[", 
           RowBox[{"i", "-", "n", "-", "1"}], "]"}], "*", 
          RowBox[{"SofaU", "[", 
           RowBox[{"sofaPolygon", ",", "i"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"gradAssoc", "[", "i", "]"}], "*", 
          RowBox[{"SofaV", "[", 
           RowBox[{"sofaPolygon", ",", "i"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "+=", 
      RowBox[{"alpha", " ", "gradx"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"loop", ",", "10000"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.931994935996705*^9, 3.931994965106319*^9}, {
   3.9320029875567017`*^9, 3.932003058122963*^9}, {3.932003181004818*^9, 
   3.9320031975822783`*^9}, {3.932003261680764*^9, 3.932003266447866*^9}, {
   3.9320041603454313`*^9, 3.932004160624715*^9}, {3.9320042796505613`*^9, 
   3.932004283326665*^9}, {3.932004340253236*^9, 3.932004344055587*^9}, {
   3.932004434053068*^9, 3.932004519470294*^9}, {3.93200459841225*^9, 
   3.932004619838097*^9}, {3.9320047986941*^9, 3.9320048041394453`*^9}, {
   3.9320050052079153`*^9, 3.93200505077488*^9}, {3.932005089923738*^9, 
   3.932005121988071*^9}, {3.932005252066298*^9, 3.932005285177815*^9}, {
   3.932005328311356*^9, 3.932005332743297*^9}, 3.9320066848651943`*^9, {
   3.9383773319240503`*^9, 3.9383773417633123`*^9}, {3.938394791369397*^9, 
   3.9383947915364733`*^9}, {3.938394846943684*^9, 3.9383948610088873`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"76e0281f-9371-4e6d-b516-b736ecd6bd16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cap", "=", 
   RowBox[{"CapVertices", "[", "sofaPolygon", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"niche", "=", 
   RowBox[{"NicheVertices", "[", "sofaPolygon", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932005063456279*^9, 3.9320050655987*^9}, {
  3.932005295820413*^9, 3.9320053206109047`*^9}, {3.938377375636503*^9, 
  3.938377455503654*^9}, {3.938393922642734*^9, 3.938394097413948*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"1e20161c-3a5b-46c1-8213-91430a2897ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "@", 
  RowBox[{"Position", "[", 
   RowBox[{
    RowBox[{"NicheIndices", "[", "sofaPolygon", "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.938397187820155*^9, 3.938397210151346*^9}, {
  3.938397267772406*^9, 3.93839726791644*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"1769e153-7da6-44fc-ae39-c4e863f8d4c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{{3.938397189589718*^9, 3.938397210346286*^9}, {
   3.9383972641301527`*^9, 3.938397268164659*^9}, 3.938557590318303*^9, 
   3.9386515292774763`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"8891a038-93e5-4916-9669-5be142e71837"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"balancedPolygon", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"FaceForm", "[", "MS`SofaDefaultFillingColor", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "@", 
         RowBox[{"SofaVertices", "[", "sofaPolygon", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"transHallwayWalls", "[", 
         RowBox[{
          RowBox[{"SofaX", "[", 
           RowBox[{"sofaPolygon", ",", "2"}], "]"}], ",", 
          RowBox[{"theta", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "4", ",", "LightBlue"}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "@", 
         RowBox[{"SofaVertices", "[", "sofaPolygon", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Darker", "[", "Green", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"niche", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"niche", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"2", "+", "n"}], "]"}], "]"}], ",", 
           RowBox[{"cap", "[", 
            RowBox[{"[", 
             RowBox[{"3", "+", "n"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"niche", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"niche", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"niche", "[", 
            RowBox[{"[", "12", "]"}], "]"}], ",", 
           RowBox[{"niche", "[", 
            RowBox[{"[", "11", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Thin", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"transHallwayWalls", "[", 
           RowBox[{
            RowBox[{"SofaX", "[", 
             RowBox[{"sofaPolygon", ",", "i"}], "]"}], ",", 
            RowBox[{"theta", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "4", ",", "Gray", 
            ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "theta", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.587225036603072`"}], "-", "0.2`"}], ",", 
         RowBox[{"1.6117105412180863`", "+", "0.2`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.25"}], ",", "1.25"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"width", "/", "2"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938394814575593*^9, 3.9383948151013823`*^9}, 
   3.93839534466986*^9, {3.9383970325397043`*^9, 3.938397170381194*^9}, {
   3.938397222432149*^9, 3.938397235559513*^9}, {3.938397275798682*^9, 
   3.938397300415923*^9}, 3.938557573811899*^9, {3.938651712562154*^9, 
   3.938651713770687*^9}, {3.938652965259788*^9, 3.938652984087227*^9}, {
   3.9386562667423363`*^9, 3.938656267795856*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"5fa191ab-fb67-4e72-ad51-9c37f37813d1"],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[None], FaceForm[RGBColor[1, 1, 0.87]], PolygonBox[CompressedData["
1:eJxTTMoPSmViYGCQB2IQ3S8Tzxb047c9AwQ0HFxydw7TvV/2U9vSfrcFX7Y/
tbCcZ9nJH/apnlJy630e2YdlKarqe32zt/JcwZw54YX9rLQvMxnvfra/oLDt
pXr+G/vmrVNe2Pp/tD+60lPhypN39mej4rWuHH0LNf+D/XUIfz+M3wZRv38/
VP1ciHn7L0HNi4DYt98eat8ZiHv2p0PdcxTi3v2zoe6dBPHPfkbRqw5et+bZ
7L0X9+i81qv9MP+lH1mxfPvv5/ud9nxNZX3eb19W8GPqnYfP9u+vuKPaVLrA
/lLD10O2a5/s5xFTcjBPumr/suth2DrmR/vzxZ+uFte+Yn+GUzvn1dbb+99P
jCwr3/HIXv4tz6mJmy7v7/7Z7dN+6oG9j1xGZE7m4f1NPyWNHPme2x87u+JG
Q9mhPXcUeXya9B/bq0Pk7Zuh8lwQ/fZ9UP07IObbf4Sa/xBivz3cfoj77GHu
y4O4334l1P0JEP/Z+0L9twXif1j8MgAArWz4SA==
     "]]}, 
   {Thickness[Large], GeometricTransformationBox[GeometricTransformationBox[
      {RGBColor[0.87, 0.94, 1], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.9009688679024191, -0.4338837391175581}, {0.4338837391175581, 
       0.9009688679024191}}, {0., 0.}}], {0.43297825396816886`, 
     0.5850179015656619}]}, 
   {EdgeForm[GrayLevel[0]], FaceForm[None], PolygonBox[CompressedData["
1:eJxTTMoPSmViYGCQB2IQ3S8Tzxb047c9AwQ0HFxydw7TvV/2U9vSfrcFX7Y/
tbCcZ9nJH/apnlJy630e2YdlKarqe32zt/JcwZw54YX9rLQvMxnvfra/oLDt
pXr+G/vmrVNe2Pp/tD+60lPhypN39mej4rWuHH0LNf+D/XUIfz+M3wZRv38/
VP1ciHn7L0HNi4DYt98eat8ZiHv2p0PdcxTi3v2zoe6dBPHPfkbRqw5et+bZ
7L0X9+i81qv9MP+lH1mxfPvv5/ud9nxNZX3eb19W8GPqnYfP9u+vuKPaVLrA
/lLD10O2a5/s5xFTcjBPumr/suth2DrmR/vzxZ+uFte+Yn+GUzvn1dbb+99P
jCwr3/HIXv4tz6mJmy7v7/7Z7dN+6oG9j1xGZE7m4f1NPyWNHPme2x87u+JG
Q9mhPXcUeXya9B/bq0Pk7Zuh8lwQ/fZ9UP07IObbf4Sa/xBivz3cfoj77GHu
y4O4334l1P0JEP/Z+0L9twXif1j8MgAArWz4SA==
     "]]}, 
   {RGBColor[0, 
     NCache[
      Rational[2, 3], 0.6666666666666666], 0], 
    LineBox[{{-0.9303990199649331, 1.}, {0.930399019964932, 1.}}], 
    LineBox[{{1.7481251000297424`, 0.}, {0.8177260800648214, 0.}}], 
    LineBox[{{-0.8177260800648224, 0.}, {-1.748125100029743, 
     1.0704179041302858`*^-16}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{-1.081846149939652, 0.9654331808681532}, {-1.2414566053252323`, 
     0.8885688366581468}}], 
    LineBox[{{-0.7150710038290657, 0.03214651786969246}, {-0.7494772219271341,
      0.015577356504506427`}}], 
    LineBox[{{0.432978253968169, 0.5850179015656619}, {0.3077740166806541, 
     0.5247227187208396}}]}, 
   {Thickness[Tiny], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{1., 0.}, {0., 1.}}, {0., 
       0.}}], {1.006230577222595, 0.}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.9749279121818236, -0.2225209339563144}, {0.2225209339563144, 
       0.9749279121818236}}, {0., 0.}}], {0.6461476142685795, 
     0.334119618063}], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.9009688679024191, -0.4338837391175581}, {0.4338837391175581, 
       0.9009688679024191}}, {0., 0.}}], {0.43297825396816886`, 
     0.5850179015656619}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.7818314824680298, -0.6234898018587335}, {0.6234898018587335, 
       0.7818314824680298}}, {0., 0.}}], {0.15165476193964011`, 
     0.720490072111531}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.6234898018587336, -0.7818314824680298}, {0.7818314824680298, 
       0.6234898018587336}}, {0., 0.}}], {-0.15165476193964114`, 
     0.720490072111531}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.43388373911755795`, -0.9009688679024193}, {0.9009688679024193, 
       0.43388373911755795`}}, {0., 0.}}], {-0.4329782539681702, 
     0.5850179015656617}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.22252093395631445`, -0.9749279121818236}, {0.9749279121818236, 
       0.22252093395631445`}}, {0., 0.}}], {-0.6461476142685803, 
     0.334119618063}], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       6.123233995736766*^-17, -1.}, {1., 6.123233995736766*^-17}}, {0., 
       0.}}], {-1.006230577222595, 3.8151282262456683`*^-19}]}},
  ImageSize->202,
  PlotRange->{{-1.787225036603072, 1.8117105412180863`}, {-0.25, 
   1.25}}]], "Output",
 CellChangeTimes->{{3.938394799069422*^9, 3.9383948154341507`*^9}, 
   3.9383948527805347`*^9, 3.9383948866652327`*^9, 3.9383949442372828`*^9, 
   3.938394998413411*^9, 3.9383950338899384`*^9, 3.938395345719564*^9, {
   3.9383970343651237`*^9, 3.93839709035672*^9}, {3.938397121329502*^9, 
   3.9383971706322403`*^9}, 3.938397235852948*^9, {3.938397270588099*^9, 
   3.9383973007554407`*^9}, 3.938557590334214*^9, 3.938651529301635*^9, 
   3.938651725715769*^9, {3.9386529663806143`*^9, 3.9386529854460993`*^9}, 
   3.938656268087678*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"fec88264-0fb5-4954-ac99-b4fd8321b10e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"save", "[", "balancedPolygon", "]"}]], "Input",
 CellChangeTimes->{3.938397333704927*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"af806008-fab2-4abb-9be4-73af1213f0c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polygonSofaVanilla", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"FaceForm", "[", "MS`SofaDefaultFillingColor", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "@", 
         RowBox[{"SofaVertices", "[", "sofaPolygon", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "@", 
         RowBox[{"SofaVertices", "[", "sofaPolygon", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Thin", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"transHallwayWalls", "[", 
           RowBox[{
            RowBox[{"SofaX", "[", 
             RowBox[{"sofaPolygon", ",", "i"}], "]"}], ",", 
            RowBox[{"theta", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "4", ",", "Gray", 
            ",", 
            RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "theta", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.587225036603072`"}], "-", "0.2`"}], ",", 
         RowBox[{"1.6117105412180863`", "+", "0.2`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"width", "/", "2"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938557595602077*^9, 3.93855762640092*^9}, {
  3.938653006026976*^9, 3.938653006126259*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"c57f3530-e28d-4b0b-a2ca-67c819b9530a"],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[None], FaceForm[RGBColor[1, 1, 0.87]], PolygonBox[CompressedData["
1:eJxTTMoPSmViYGCQB2IQ3S8Tzxb047c9AwQ0HFxydw7TvV/2U9vSfrcFX7Y/
tbCcZ9nJH/apnlJy630e2YdlKarqe32zt/JcwZw54YX9rLQvMxnvfra/oLDt
pXr+G/vmrVNe2Pp/tD+60lPhypN39mej4rWuHH0LNf+D/XUIfz+M3wZRv38/
VP1ciHn7L0HNi4DYt98eat8ZiHv2p0PdcxTi3v2zoe6dBPHPfkbRqw5et+bZ
7L0X9+i81qv9MP+lH1mxfPvv5/ud9nxNZX3eb19W8GPqnYfP9u+vuKPaVLrA
/lLD10O2a5/s5xFTcjBPumr/suth2DrmR/vzxZ+uFte+Yn+GUzvn1dbb+99P
jCwr3/HIXv4tz6mJmy7v7/7Z7dN+6oG9j1xGZE7m4f1NPyWNHPme2x87u+JG
Q9mhPXcUeXya9B/bq0Pk7Zuh8lwQ/fZ9UP07IObbf4Sa/xBivz3cfoj77GHu
y4O4334l1P0JEP/Z+0L9twXif1j8MgAArWz4SA==
     "]]}, 
   {EdgeForm[GrayLevel[0]], FaceForm[None], PolygonBox[CompressedData["
1:eJxTTMoPSmViYGCQB2IQ3S8Tzxb047c9AwQ0HFxydw7TvV/2U9vSfrcFX7Y/
tbCcZ9nJH/apnlJy630e2YdlKarqe32zt/JcwZw54YX9rLQvMxnvfra/oLDt
pXr+G/vmrVNe2Pp/tD+60lPhypN39mej4rWuHH0LNf+D/XUIfz+M3wZRv38/
VP1ciHn7L0HNi4DYt98eat8ZiHv2p0PdcxTi3v2zoe6dBPHPfkbRqw5et+bZ
7L0X9+i81qv9MP+lH1mxfPvv5/ud9nxNZX3eb19W8GPqnYfP9u+vuKPaVLrA
/lLD10O2a5/s5xFTcjBPumr/suth2DrmR/vzxZ+uFte+Yn+GUzvn1dbb+99P
jCwr3/HIXv4tz6mJmy7v7/7Z7dN+6oG9j1xGZE7m4f1NPyWNHPme2x87u+JG
Q9mhPXcUeXya9B/bq0Pk7Zuh8lwQ/fZ9UP07IObbf4Sa/xBivz3cfoj77GHu
y4O4334l1P0JEP/Z+0L9twXif1j8MgAArWz4SA==
     "]]}, 
   {Thickness[Tiny], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{1., 0.}, {0., 1.}}, {0., 
       0.}}], {1.006230577222595, 0.}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.9749279121818236, -0.2225209339563144}, {0.2225209339563144, 
       0.9749279121818236}}, {0., 0.}}], {0.6461476142685795, 
     0.334119618063}], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.9009688679024191, -0.4338837391175581}, {0.4338837391175581, 
       0.9009688679024191}}, {0., 0.}}], {0.43297825396816886`, 
     0.5850179015656619}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.7818314824680298, -0.6234898018587335}, {0.6234898018587335, 
       0.7818314824680298}}, {0., 0.}}], {0.15165476193964011`, 
     0.720490072111531}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.6234898018587336, -0.7818314824680298}, {0.7818314824680298, 
       0.6234898018587336}}, {0., 0.}}], {-0.15165476193964114`, 
     0.720490072111531}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.43388373911755795`, -0.9009688679024193}, {0.9009688679024193, 
       0.43388373911755795`}}, {0., 0.}}], {-0.4329782539681702, 
     0.5850179015656617}], 
    GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       0.22252093395631445`, -0.9749279121818236}, {0.9749279121818236, 
       0.22252093395631445`}}, {0., 0.}}], {-0.6461476142685803, 
     0.334119618063}], GeometricTransformationBox[GeometricTransformationBox[
      {GrayLevel[0.5], Opacity[0.5], LineBox[{{-4, 0}, {0, 0}, {0, -4}}], 
       LineBox[{{-4, 1}, {1, 1}, {1, -4}}]}, {{{
       6.123233995736766*^-17, -1.}, {1., 6.123233995736766*^-17}}, {0., 
       0.}}], {-1.006230577222595, 3.8151282262456683`*^-19}]}},
  ImageSize->202,
  PlotRange->{{-1.787225036603072, 1.8117105412180863`}, {-0.2, 
   1.2}}]], "Output",
 CellChangeTimes->{{3.938557605984116*^9, 3.938557632112485*^9}, 
   3.938651529325718*^9, 3.938653006398838*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"69970d1a-2266-4a47-a1aa-45a93ad3a4fb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"save", "[", "polygonSofaVanilla", "]"}]], "Input",
 CellChangeTimes->{{3.938557620954083*^9, 3.938557628515777*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"bc019253-230e-454c-befe-4c26b309c14e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"MS`GerverxNumerical", "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "/.", 
  RowBox[{"t", "->", "0.2"}]}]], "Input",
 CellChangeTimes->{{3.9386523212524776`*^9, 3.938652324967914*^9}, {
  3.93865241124935*^9, 3.938652416167601*^9}, {3.938652466287949*^9, 
  3.938652475331213*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"70a31700-9c5f-46ba-ac46-5a771d1353ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.5093717305407384`"}], ",", "1.2280154756157673`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.938652416555956*^9, 3.938652467856429*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"50a3b275-b4e6-4ed9-a23c-d89764b0720b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"MS`GerverxNumerical", "[", "u", "]"}], ",", "u"}], "]"}], "/.", 
  RowBox[{"u", "->", "3"}]}]], "Input",
 CellChangeTimes->{{3.93865251551058*^9, 3.938652516407398*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"62925ca9-6f14-4e04-bf8b-e97f003344e7"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9386525166408854`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"1617a3b3-e0f4-4848-afd4-16ad5a7fc472"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pointWithDerivative", "[", 
    RowBox[{"f_", ",", "t_", ",", "mult_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Point", "@", 
      RowBox[{"f", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"diff", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f", "[", "u", "]"}], ",", "u"}], "]"}], "/.", 
          RowBox[{"u", "->", "t"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "t", "]"}], "-", 
           RowBox[{"mult", "*", "diff"}]}], ",", 
          RowBox[{
           RowBox[{"f", "[", "t", "]"}], "+", 
           RowBox[{"mult", "*", "diff"}]}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointWithDerivative", "[", 
    RowBox[{"f_", ",", "t_", ",", "mult_", ",", "dir_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Point", "@", 
      RowBox[{"f", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"diff", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f", "[", "u", "]"}], ",", "u"}], "]"}], "/.", 
          RowBox[{"u", "->", "t"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "t", "]"}], "-", 
           RowBox[{"mult", "*", 
            RowBox[{"Projection", "[", 
             RowBox[{"diff", ",", "dir"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"f", "[", "t", "]"}], "+", 
           RowBox[{"mult", "*", 
            RowBox[{"Projection", "[", 
             RowBox[{"diff", ",", "dir"}], "]"}]}]}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.93865257898127*^9, 3.9386526529909687`*^9}, {
  3.938652856270362*^9, 3.938652878585141*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b5897356-3db5-4be0-ba4f-585747f08416"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gerverPlotRange", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.587225036603072`"}], "-", "0.25`"}], ",", 
        RowBox[{"1.6117105412180863`", "+", "0.25`"}]}], "}"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"MS`GerverxNumerical", "[", 
         FractionBox["\[Pi]", "2"], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "/", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.25"}], ",", "1.25"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"balancedPolygonLimit", "=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", 
      RowBox[{"Pi", "/", "7"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"gerverCurves", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"transHallway", "[", 
          RowBox[{
           RowBox[{"MS`GerverxNumerical", "[", "t", "]"}], ",", "t", ",", 
           "3"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"MS`GerverSofa", "/.", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "[", "_", "]"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "Small", "]"}], ",", "Blue", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"pointWithDerivative", "[", 
            RowBox[{"MS`GerverxNumerical", ",", "t", ",", "0.1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "t", "]"}], ",", 
               RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"pointWithDerivative", "[", 
            RowBox[{"MS`GerverDNumerical", ",", "t", ",", "0.1"}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"pointWithDerivative", "[", 
            RowBox[{"MS`GerverCNumerical", ",", "t", ",", "0.1"}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"MaTeX", "[", "\"\<\\\\mathbf{x}(t)\>\"", "]"}], ",", 
             RowBox[{"MS`GerverxNumerical", "[", "t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"MaTeX", "[", "\"\<\\\\mathbf{C}(t)\>\"", "]"}], ",", 
             RowBox[{"MS`GerverCNumerical", "[", "t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Right", ",", "Bottom"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"MaTeX", "[", "\"\<\\\\mathbf{D}(t)\>\"", "]"}], ",", 
             RowBox[{"MS`GerverDNumerical", "[", "t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotRange", "->", "gerverPlotRange"}], ",", 
       RowBox[{"ImageSize", "->", 
        RowBox[{"width", "/", "2"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.938651582273428*^9, 3.938651684601739*^9}, 
   3.938651751086556*^9, {3.938651886673465*^9, 3.938652009786889*^9}, {
   3.9386523107149*^9, 3.938652312455624*^9}, {3.938652486613368*^9, 
   3.938652573228785*^9}, {3.93865263105422*^9, 3.93865280537497*^9}, {
   3.93865288307228*^9, 3.938652925538595*^9}, {3.9386530208060017`*^9, 
   3.93865307607782*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"3ed25bed-852a-403b-b40e-7353c8f61393"],

Cell[BoxData[
 GraphicsBox[{GeometricTransformationBox[GeometricTransformationBox[{
      {GrayLevel[0.75], EdgeForm[None], 
       PolygonBox[{{-3, 0}, {0, 0}, {0, -3}, {1, -3}, {1, 1}, {-3, 1}}]}, 
      {GrayLevel[0], LineBox[{{-3, 0}, {0, 0}, {0, -3}}], 
       LineBox[{{-3, 1}, {1, 1}, {1, -3}}]}}, {{{
      0.9009688679024191, -0.4338837391175581}, {0.4338837391175581, 
      0.9009688679024191}}, {0, 0}}], {-0.24117786917075665`, 
    0.523682382685558}], 
   {RGBColor[1, 1, 0.87], EdgeForm[GrayLevel[0]], 
    PolygonBox[{{-0.002931102747568361, 
      0.05518676049838907}, {-0.0075077211477384, 
      0.09053224433819837}, {-0.013606412660485952`, 
      0.1253351796409147}, {-0.02120120315269523, 
      0.15953289495971165`}, {-0.030263707684347576`, 
      0.19306373142378394`}, {-0.040763166503033424`, 
      0.22586713013002274`}, {-0.05266648405966139, 
      0.2578837183204711}, {-0.06593827100576961, 
      0.28905539424496024`}, {-0.08054088912959365, 
      0.3193254106095894}, {-0.09643449918483407, 
      0.34863845651307224`}, {-0.11357711156289788`, 
      0.3769407377744405}, {-0.1319246397562651, 
      0.4041800555571583}, {-0.15143095655755753`, 
      0.43030588319636326`}, {-0.17204795293586453`, 
      0.45526944113771095`}, {-0.19372559952891225`, 
      0.4790237698981564}, {-0.21641201068675506`, 
      0.5015238009609528}, {-0.2400535109998163, 
      0.522726425519191}, {-0.26459470424132275`, 
      0.5425905609843353}, {-0.28997854465145556`, 
      0.5610772151784293}, {-0.3161464104878934, 
      0.5781495481309521}, {-0.34303817976484235`, 
      0.5937729314036967}, {-0.370592308100146, 
      0.6079150048695116}, {-0.3987459085876401, 
      0.6205457308733012}, {-0.4274348336095711, 
      0.6316374457063071}, {-0.4565937585016293, 
      0.6411649083273959}, {-0.48615626698096903`, 
      0.6491053462678579}, {-0.5160358229611974, 
      0.6554156021434079}, {-0.5461316059131602, 
      0.6600426635877341}, {-0.5763764300476724, 
      0.6629794331345903}, {-0.6067035922391745, 
      0.6642219172844704}, {-0.6370462979339245, 
      0.6637684267295264}, {-0.6673377353194726, 
      0.6616195780275219}, {-0.6975111495100281, 
      0.6577782929908836}, {-0.727499916679408, 
      0.6522497957913859}, {-0.7572246746503857, 
      0.645057960820489}, {-0.7865796945555036, 
      0.63626619093454}, {-0.8154954846739376, 
      0.6258992640285892}, {-0.8439062017278565, 
      0.6139812781607924}, {-0.8717471399538075, 
      0.6005387757685603}, {-0.8989548155992705, 
      0.5856006962499344}, {-0.9254670496080297, 
      0.5691983257620765}, {-0.9512230484058931, 
      0.5513652443018654}, {-0.976163482700509, 
      0.5321372701363265}, {-1.0002305642113472`, 
      0.51155240165329}, {-1.0233681202482943`, 
      0.4896507567052537}, {-1.045521666059788, 
      0.46647450952194436`}, {-1.0666384748739537`, 
      0.4420678252694908}, {-1.0866676455588282`, 
      0.41647679233647555`}, {-1.1055601678304374`, 
      0.389749352429386}, {-1.1232689849402542`, 
      0.36193522856216287`}, {-1.1397490537763817`, 
      0.33308585102662447`}, {-1.1549574023156846`, 
      0.3032542814325403}, {-1.1688531843670402`, 
      0.2724951349080245}, {-1.1813977315488688`, 
      0.24086450055272687`}, {-1.192554602447161, 
      0.208419860238005}, {-1.2022896289033165`, 
      0.17522000584987357`}, {-1.2105709593842584`, 
      0.1413249550720373}, {-1.2173690993904753`, 
      0.10679586580772375`}, {-1.2226569488608843`, 
      0.07169494934034183}, {-1.224595356112935, 
      0.05518676049838907}, {-1.226164284520757, 
      0.05393398196390663}, {-1.227838485878468, 
      0.052637306541543444`}, {-1.2296195873906839`, 
      0.051299594902786044`}, {-1.2315091543658316`, 
      0.04992374603163245}, {-1.2335086894420904`, 
      0.048512696014961686`}, {-1.2356196318356432`, 
      0.04706941681843678}, {-1.2378433566114944`, 
      0.045596915048337586`}, {-1.2401811739771011`, 
      0.04409823069972405}, {-1.2426343285990682`, 
      0.042576435891334995`}, {-1.2452039989431383`, 
      0.04103463358763164}, {-1.2478912966377111`, 
      0.039475956308399146`}, {-1.2506972658611129`, 
      0.03790356482632364}, {-1.25362288275283, 
      0.03632064685296571}, {-1.2566690548489214`, 
      0.03473041571355542}, {-1.2598366205418015`, 
      0.03313610901103731}, {-1.2631263485645952`, 
      0.031540987279797435`}, {-1.266538937500247, 
      0.029948332629507732`}, {-1.270075015315565, 
      0.02836144737952641}, {-1.2737351389203686`, 
      0.02678365268429606}, {-1.2775197937519045`, 
      0.025218287150184128`}, {-1.2814293933846885`, 
      0.02366870544421342}, {-1.285464279165918, 
      0.022138276895132772`}, {-1.289624719876597, 
      0.02063038408728084}, {-1.2939109114185072`, 
      0.019148421447698342`}, {-1.2983229765271467`, 
      0.01769579382694633}, {-1.3028609645107572`, 
      0.016275915074090402`}, {-1.3075248510155446`, 
      0.014892206606312741`}, {-1.312314537817196, 
      0.013548095973615792`}, {-1.3172298526387862`, 
      0.012247015419083246`}, {-1.322270548995155, 
      0.010992400435165577`}, {-1.327436306063838, 
      0.00978768831645895}, {-1.3327267285826143`, 
      0.008636316709447676}, {-1.3381413467737344`, 
      0.007541722159681663}, {-1.3436796162948779`, 
      0.0065073386568613965`}, {-1.34934091821689, 
      0.005536596178303978}, {-1.3551245590283292`, 
      0.0046329192312645545`}, {-1.3610297706668522`, 
      0.003799725394588215}, {-1.367055710577463, 
      0.003040423860167941}, {-1.3732014617976305`, 
      0.002358413974684651}, {-1.3794660330692792`, 
      0.00175708378210564}, {-1.385848358977654, 
      0.0012398085674178777`}, {-1.3923473001170357`, 
      0.0008099494020726023}, {-1.398961643283296, 
      0.0004708516916175473}, {-1.406144222619559, 
      0.00021031225587999969`}, {-1.413554883601666, 
      0.000050270067591080924`}, {-2.2275264588605035`, 
       0}, {-2.2275264588605035`, 0.}, {-2.226778818785235, 
      0.016562087318832297`}, {-2.2245240237876267`, 
      0.051858217785779606`}, {-2.221401977586004, 
      0.08671801400284965}, {-2.2174344169630595`, 
      0.12111218014518921`}, {-2.2126442129613957`, 
      0.1550122774857072}, {-2.2070553402787363`, 
      0.18839076838343466`}, {-2.20069284502541, 
      0.22122105923695135`}, {-2.193582810877922, 
      0.2534775423446123}, {-2.1857523236644165`, 
      0.2851356366143848}, {-2.177229434419805, 
      0.3161718270672522}, {-2.1680431209502307`, 
      0.34656370307934997`}, {-2.158223247948455, 
      0.3762899953092721}, {-2.1478005257035693`, 
      0.4053306112583223}, {-2.1368064674502505`, 
      0.433666669412881}, {-2.125273345404538, 
      0.46128053191951573`}, {-2.1132341455348063`, 
      0.488155835744978}, {-2.1007225211182936`, 
      0.5142775222748028}, {-2.087772745135142, 
      0.5396318653058545}, {-2.0744196615534736`, 
      0.5642064973898445}, {-2.060698635560539, 
      0.5879904344865842}, {-2.0466455027964265`, 
      0.6109740988875171}, {-2.0322965176482186`, 
      0.633149340371914}, {-2.017688300663814, 
      0.6545094555599938}, {-2.0028577851459275`, 
      0.6750492054291635}, {-1.987842162987986, 
      0.6947648309615369}, {-1.9726814269605326`, 
      0.7136508981032055}, {-1.957450991769296, 
      0.731662322793316}, {-1.9421991235397567`, 
      0.748792495552475}, {-1.9269606024142123`, 
      0.7650523754383158}, {-1.911769627125311, 
      0.780454115453369}, {-1.8966597768986881`, 
      0.7950110398039961}, {-1.8816639741427468`, 
      0.808737619997373}, {-1.8668144479599484`, 
      0.8216494498020146}, {-1.8517349056071764`, 
      0.834092528316528}, {-1.8344565141786922`, 
      0.8476307429841015}, {-1.8170997087010683`, 
      0.8605292060035924}, {-1.799685718636366, 
      0.8727928624663366}, {-1.7822354667372662`, 
      0.8844273199469717}, {-1.7647695491743782`, 
      0.8954388359889434}, {-1.7473082161045403`, 
      0.9058343050101234}, {-1.7298713526966911`, 
      0.915621244642947}, {-1.7124784606314394`, 
      0.9248077815239432}, {-1.6951486400900015`, 
      0.9334026365479858}, {-1.6779005722476972`, 
      0.9414151096030314}, {-1.660752502286706, 
      0.9488550638015343}, {-1.6437222229422959`, 
      0.9557329092251386}, {-1.6268270585962146`, 
      0.9620595861996474}, {-1.6100838499304209`, 
      0.9678465481176384}, {-1.5935089391537998`, 
      0.9731057438264732}, {-1.5771181558139633`, 
      0.9778495995997846}, {-1.5609268032056878`, 
      0.9820910007108642}, {-1.54494964538698, 
      0.9858432726266891}, {-1.5292008948131945`, 
      0.9891201618416232}, {-1.513694200599049, 
      0.9919358163701126}, {-1.4984426374178013`, 
      0.9943047659179616}, {-1.4834586950462574`, 
      0.9962419017520215}, {-1.4687542685636858`, 
      0.997762456288358}, {-1.4543406492121078`, 
      0.9988819824191736}, {-1.4402285159248214`, 0.9996163325989604}, {
      0.19311838528487416`, 1}, {0.20588049050780868`, 0.9998371021345642}, {
      0.2192296636403373, 0.9993215654426753}, {0.2334833544817059, 
      0.998409999760843}, {0.2480336396227507, 0.9971058467423422}, {
      0.26286955423838015`, 0.9953933906899533}, {0.2779795250526531, 
      0.9932572252276954}, {0.2933513791219686, 0.9906822741052125}, {
      0.30897235328337636`, 0.9876538117518396}, {0.3248291042608626, 
      0.9841574835599668}, {0.3409077194218601, 0.9801793258775161}, {
      0.35719372817562994`, 0.9757057856895764}, {0.3736721140045674, 
      0.970723739969473}, {0.3903273271188975, 0.9652205146798088}, {
      0.4071432977246433, 0.959183903404288}, {0.4241034498941795, 
      0.9526021855914221}, {0.4411907160281173, 0.9454641443915238}, {
      0.4583875518967129, 0.937759084068725}, {0.47567595224844217`, 
      0.9294768469700844}, {0.4930374669728525, 0.9206078300342161}, {
      0.5104532178042704, 0.9111430008222366}, {0.5279039155524319, 
      0.9010739130542164}, {0.5453698778455953, 0.8903927216347229}, {
      0.5628310473712049, 0.8790921971514634}, {0.5802670105986886, 
      0.8671657398314587}, {0.5976570169685093, 0.8546073929396361}, {
      0.6149799985311277, 0.8414118556051765}, {0.6314182808508729, 
      0.8282253766914024}, {0.6461766128290161, 0.8157424492007895}, {
      0.6610981587900323, 0.8024535614782687}, {0.676151075050036, 
      0.7883425302944325}, {0.6913028054558849, 0.7733942808343234}, {
      0.7065201174207641, 0.7575948723338161}, {0.721769138799335, 
      0.740931522593583}, {0.7370153955684994, 0.7233926313446152}, {
      0.7522232021019651, 0.7049686061727517}, {0.7673224743481131, 
      0.6856947006839664}, {0.7822566151866801, 0.6655952729083485}, {
      0.7969883169142729, 0.6446732846774187}, {0.8114805011649897, 
      0.622933185417566}, {0.8256963734541855, 0.6003808975141803}, {
      0.8395994769976157, 0.5770237997908648}, {0.8531537457436141, 
      0.5528707091344943}, {0.8663235565571386, 0.5279318602988776}, {
      0.8790737804957698, 0.5022188839217362}, {0.8913698331190544, 
      0.47574478279161564`}, {0.9031777237739482, 0.44852390640320844`}, {
      0.9144641038005427, 0.42057192384137776`}, {0.9251963136037343, 
      0.39190579503593526`}, {0.9353424285380356, 0.36254374043093585`}, {
      0.944871303554305, 0.33250520911390946`}, {0.9537526165588203, 
      0.3018108454520528}, {0.9619569104367979, 0.270482454283951}, {
      0.9694556336941986, 0.23854296471688527`}, {0.9762211796734368, 
      0.2060163925812137}, {0.9822269243004318, 0.17292780159468057`}, {
      0.9874472623223037, 0.1393032632908148}, {0.9918576419969158, 
      0.10516981576682403`}, {0.9954345981974063, 0.07055542130756808}, {
      0.9981557838968255, 0.03548892294331121}, {1., 0.}, {
      0.19311838528487416`, 0}, {0.1874409947124228, 
      0.00003223380273019824}, {0.18176433615552234`, 
      0.00012893105484863916`}, {0.17608914153534122`, 
      0.0002900792886747254}, {0.17072035228968882`, 0.0005027722156384899}, {
      0.1656532713889946, 0.0007618524484453913}, {0.16065380121966927`, 
      0.0010744279966994235`}, {0.15572249501578242`, 
      0.0014389973736303092`}, {0.1508598806371257, 0.001854053520359627}, {
      0.14606646051507272`, 0.0023180841884660125`}, {0.14134271160385464`, 
      0.0028295723230492846`}, {0.13668908533725474`, 0.003386996446219851}, {
      0.13210600759072597`, 0.00398883104093973}, {0.12759387864893362`, 
      0.004633546935141488}, {0.12315307317872416`, 0.0053196116860514215`}, {
      0.11878394020752048`, 0.006045489964643271}, {0.11448680310714347`, 
      0.006809643940148828}, {0.11026195958305766`, 0.007610533664551798}, {
      0.10610968166903861`, 0.008446617456991325}, {0.10203021572725847`, 
      0.009316352288001662}, {0.09802378245378514, 0.01021819416351454}, {
      0.0940905768894895, 0.011150598508550835`}, {0.09023076843635428, 
      0.012112020550528296`}, {0.08644450087917692, 0.01310091570211215}, {
      0.08273189241265845, 0.014115739943535523`}, {0.0790930356738685, 
      0.015154950204316786`}, {0.07552799778007638, 0.01621700474430108}, {
      0.07203682037193698, 0.01730036353395334}, {0.06861951966201911, 
      0.018403488633830487`}, {0.06527608648866302, 0.019524844573160435`}, {
      0.06200648637515322, 0.020662898727455924`}, {0.05881065959419109, 
      0.021816121695091298`}, {0.055688521237651674`, 
      0.022982987672770593`}, {0.05263996129160721, 0.02416197482981559}, {
      0.04966484471659989, 0.0253515656812026}, {0.046763011533144626`, 
      0.026550247459277147`}, {0.04393427691244225, 0.0277565124840759}, {
      0.04117843127228228, 0.02896885853218551}, {0.038495240378113714`, 
      0.0301857892040683}, {0.035884445449261136`, 0.031405814289785054`}, {
      0.033345763270262736`, 0.032627450133045466`}, {0.030878886307305824`, 
      0.033849219993517185`}, {0.02848348282973449, 0.03506965440732461}, {
      0.02615919703660319, 0.036287291545669134`}, {0.023905649188249174`, 
      0.037500677571502695`}, {0.021722435742855702`, 0.03870836699418697}, {
      0.019609129497977183`, 0.03990892302207102}, {0.017565279736996415`, 
      0.04110091791292033}, {0.015590412380483283`, 0.04228293332213097}, {
      0.013684030142423368`, 0.0434535606486626}, {0.01184561269128407, 
      0.04461140137862486}, {0.010074616815884962`, 0.04575506742645193}, {
      0.008370476596038278, 0.0468831814736004}, {0.006732603577924528, 
      0.04799437730470638}, {0.005160386954167458, 0.04908730014113797}, {
      0.003653193748571674, 0.05016060697187968}, {0.0022103690054854695`, 
      0.051212966881686264`}, {0.000831235983750525, 
      0.05224306137644338}, {-0.0004849036448006258, 
      0.0532495847056735}, {-0.0017387695923393124`, 
      0.05423124418212578}, {-0.002931102747568361, 0.05518676049838907}}]}, 
   {RGBColor[0, 0, 1], PointSize[
    Small], {PointBox[{-0.24117786917075665`, 0.523682382685558}], 
     LineBox[{{-0.19576470037273272`, 
      0.5455522121383083}, {-0.2865910379687806, 0.5018125532328077}}]}, {
     PointBox[{-1.2620710044277754`, 0.03204616023093644}], 
     LineBox[{{-1.2844128634238845`, 
      0.021286888001433697`}, {-1.2397291454316663`, 
      0.042805432460439184`}}]}, {
     PointBox[{-1.6959547435453335`, 0.9330150281333556}], 
     LineBox[{{-1.6281997157512005`, 
      0.9656441298156087}, {-1.7637097713394665`, 0.9003859264511025}}]}, 
    InsetBox[
     GraphicsBox[
      {Thickness[0.04800768122899664], FilledCurveBox[CompressedData["
1:eJxTTMoPymNmYGBgBGIlIAaxQYCJAQEYCbAZofqYyVCDLE6MOcSYTy1zBptf
AGcWAkc=
        "], CompressedData["
1:eJxTTMoPSmVmYGBgBGJrIGYC4jVCOnzpdrIOM8FA2AHGj1GNkDlXI+pw/gwQ
6EjB+cKVk0rOHhFyAAmfyZFzeNOW2210W9xh5beXFWcUlBw+7/u4NT1MAmJe
phJEfreEQ3oaEExTclgLMj9OBoMvEBtw36hdGa5f5dqjYIYaZYe+iG5/RgFx
OF9h14J9qXqicL6JMRB8Fobrh/Fh5mt8Unk566QInN+mwK56Zouog/OEZqG0
KgQfpM04WMmhFY0P8zfMf2lgIOqwN7/m7UxRJYcvIPdOE4SE2z15BwYQaOCC
2/ei9nH2eR0+DD7MvTyOfF4zNHlQ/WPMBueDzb/GDOeDpY0Z4fzsqQmFFp9/
2MP4Xlv9jyezfbGHmQ/jw+yPBvnHhgHuHrD9L3kdpoPi66aMw5Jbyx8bNjM5
7Ai2ivifLuZwnfe2WGoZo0Pl/R+3jE+LOswAq2OAh8v8E5OXZKt9tkfnw9LT
dq8NFnN2Mjr0g+Jxg7BDi3gta6YbC5wPiS92OB/snkwueHqE8WHmg92/hwPO
B0fHMzZ4PML4B7v3NZkwizmkQvkHoHyYPNh4STGof9kh7igWg6hTFoCET5q0
Q9Dbyx9nMIrC7VMHpSdNYQw+zL0ea44uZ7AQgfsHbIyaOJwPNi9RAs5/4Brv
OGujJJwvAspfLDJwPnr+BADQXmqN
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4oBb0jWJQWoO6WlA8IzRAcbnduTzmqHJBOd/
2fdxa3oYk4OJMRB8VnUIeOJ5yfQys0O3jeeutEPKDj0R3f6MG3gc3NccXc7Q
oQRRN1kUzj/Qva/JpFkOzn/gGu84q1HZIYJTrN24X9lhi/mPQyla6g41nzYE
ZEupOTyIEN9+8YAm3H6IvQj+icNOazP/IfhPEhdeM+HXgvNl5sVpnjbQctBV
lP+SY6bmsEEvbzGjjZYDAwgoIPiNLEf7Da+rwvkzJvBXmXGrOMxZpLzzz3IN
iHt/KDlITL3CmdGk5jATBG4qOrwp3ir621vF4cOi9QpnIxQd7mjKrvn/WRHO
h/kXxo9RjZA5N0fKgT824L7RckUHkcpJJWdTRB2q7/+4ZXxayaFdgV31zBYB
iHvFVBzSwPHBBrH3kaqDMRgwwt0P48P8B+PD/b9RbD5TAoIPi18A5Va4qA==

        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
        0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 
        0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYC4h9vXx+wdNZzWCOkw5d+T9IBxg94e/njDEUp
hzMgoKPnsL97X5OJs5TDlAn8VWbcuPnxIUHqC17qwvkvsrS/Tb+r6/Bl38et
6WJSDs/R+P63pGsSL+k6/AcDSYepIPNW60Ls9ZF08DnBbjvbVNfhTVtut5G0
uINIj9crFhMdB41PKi9ncYo4sHB2ySe/04LzW3j9109xRfBrPm0IyLbScggB
+0cUzp8JApJicP4MND5Y/qeYw3SQe7y1HBhAoEHc4UGE+PaLDDoOytceBTPM
UYLYx6oH5x/ftaOXrQDBn7NIeeef5Zj8ld9eVpxhUIbz14LC307ZITUNCNoQ
fF1F+S85Ygh+7W+rgnMaOnB+SuwdN+YfOg5/v5U+mFOoBgkPPl2Iew8g+DNA
/jiN4AeCwv0Tgg8Jb3WIf47qOMgtf+GhV6/uMKW9NepyDYJ/FOS/AAQfrP+c
tgMTiM5TdzC32Rs0baE2JBx3qTl47K+VtTiuBXdvMsi9OzTgfLC8O4Kfmf+h
9aQIJv+Opuya/5eV4HxYeG7Qy1vMaIPgg81bjuCD3TFLCzX81TUdUkDhvEzS
4fzVsDf6vzUcolUjZM7JSDhsNv9xKOWVBiQ81ojD+bD0B+NX3f9xy5hb1OEP
KL8s1nRQB6U3TWFoeteC80VB6VVEF86H5a++iG5/xgmI/AbLfwCZm3V6
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYCYm431VKmU0YOB7r3NZk0yznA+MrXHgUzvFFw
iBDffpFhnZGDiTEQLFZ26PZ6xWIiaOTAwtkln6yn5mDf9Oj4jGxDh6eJC6+Z
nNdw8D7Bbju71cBhg17eYkYbLYfrQp8cz6ch+A4g9dEI/vMs7W/TfQ0cZObF
aZ42QPCfgMzjR/BPHHZam/lPE84Hu+ezpoN9ZcQK01oDB9EeoMOmaELsn2ro
8AKkLlbd4XDb8vBTRkYODCBwQBnOl9+1YF9qnxycrwDi84k5lGwV/X16naHD
Fq8NFnMqeR1mgkCmgYP0RrH5TArMcPu/7Pu4NT2MCc7nduTzmqGJ4KenAcEz
RoT/QPoTGOH+NwYDRnj4wPjTJ/BXmXUj+CBvmRQaOiy5tfyxYTO7g+qT5nln
fxk6nD0DBDwCEPd1GjmIVE4qOdsiAo+/oLeXP85wlHRAj18APWDFCw==
        "]]},
      AspectRatio->Automatic,
      BaselinePosition->Scaled[0.32631885041954006`],
      ImageSize->{20.829967621419677`, 15.14319302615193},
      PlotRange->{{0., 20.830000000000002`}, {0., 
       15.139999999999999`}}], {-0.24117786917075665, 0.523682382685558}, {
     Left, Bottom}], InsetBox[
     GraphicsBox[
      {Thickness[0.04325259515570934], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
        0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIDIGYC4pkgkKnk4L7m6HKGGbIOMP6XfR+3pofJQcQ9
lBxC3l7+OCNRzuGOpuya/58V4Xzla4+CGfYg+LdB8s0I/lohHb70OkWH1DQg
eCbrUH3/xy1jb0WHGNUImXM24g69Ed3+jB9kHFoV2FXPfBFxWANS/08Czhep
nFRyVkUMzlf/pPJylqeQAwMIHBB14HHk85qxkt8hGGRfo4TDDLAHeBzOnwEC
HSmI+pOcEP1TZOD8Fd9eVpwJUITz00HuK1N2sC9xrD0tw+1wYteOXjYBVYet
Xhss5ljyO2wx/3EoxUsN4v5sIYcniQuvmbxXdzgDBmIOHvtrZS3UNRx2BltF
/H8uAec/cI13nGUoA+eHc4q1G+9XcLhwNeyNvrU6JHwzFCH+SVB2MAaBYkWH
8sPbXGfqKjvsza95O3Mpgv9h0XqFsy8QfFh8ofPB6iwQfEh4Ifjg+GjTgPPB
7mPXhPOTY++4MUtoQuLjnSKcPxsk76ngYKC1UvhCizokfuXkHP5+K30wZ6KG
g/yuBftS9aTh6sH+/ygO5/eD45sLzpfZKDaf6cEv+xkT+KvMXqvC+bD4gfHf
tOV2G82WhPijgQsSTsLCkHT0RxzOh8SnPJwP808VON4kHNDTOwBLsTh5
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4hfFW0V/v9ZySE8DgmeMDjA+tyOf1wxNJjj/
y76PW9PDmBzOgECPlkPAE89LppeZHTbp5S1mjNFw6Ino9mfcwONgarM3aJqi
uoOJMRBMFoXzD3TvazJploPzH7jGO85qVHao/21VcE5Dw2GL+Y9DKVrqDiI9
Xq9Ytmg5PIgQ337xgCbcfrB5nxH8E4ed1mb+Q/CfJC68ZsKvBefLzIvTPG2g
5XB8145etgtaDhtA7rTRcpgxEwh2IvgSIHUFCL6B1krhC0s0HOYsUt75Z7mG
w99vpQ/mTFR3kJh6hTOjSQ3ijmI1hzcge7xVHAJvSdckflJ1uKMpu+b/Z0U4
H+ZfGD9GNULm3Bwph0cgfzmoOYhUTio5myIKsS9F3aFdgV31zBYBiHs3aDik
geODzWELyF01Wg7GYMAIdz+MD/MfjA/3/0ax+UwJCD4sfgGk0tBA
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
        0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 
        0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYC4pOHndZm5hk6rBHS4Uu/J+kA4we8vfxxhqKU
gzEIJBs67O/e12TiLOUgPvUKZ0YQbv6fb6UP5jgi+I5Nj47PsDZ0+LLv49Z0
MSkHBzT+l523uv6aGjr8BwNJiHlKhg5nQMBH0uHzhoDsWc8NHN605XYbSYs7
XBf65Hg+zcBB45PKy1mcIg5zFinv/NOuD+fLLn/hoXdfD84X6fF6xXJFzyEE
7B9ROH8mCEiKwfkz0Phg+Z9iDvpaK4UvPNFzYACBBnEH28qIFaa+Bg7K1x4F
M8xRcugPLlGZ7m8I5xuA1Lcg+NLz4jRPL8Dkr/z2suIMgzKcvxYU/nbKkHDo
R/CTY++4MUcg+N1A55kkGsD59b+tCs6dMHD4Cwr3QjUH/4sTY/5dNoC49wCC
P2MCf5XZaQQ/8JZ0TeInBB8S3uoQ/6w3cJADhWO9usN0kL5uBB8cHiUIPli/
sYEDE2eXfHKeusPzLO1v02UNHGo+ASNul5rDkwjx7RcT9OHuBaePQF04Hyz/
QAfOZwGZsw6Tf0dTds3/y0pwPiw8fU6w286+iuA/AJnnoAvng+PTRB/ON7XZ
GzTtoK5DShoQLJN0yMj/0Hpyiq5DtGqEzDkZCQdfkH+adSHhsUYczoelPxi/
6v6PW8bcog5T2lujLtvoOaiD0pumsEMLy9F+w3J9OB+cXq8ZwPmw/NUX0e3P
OAGR32D5DwBTW3zV
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYCYrvKiBWmf00cDnTvazJplnOA8ZWvPQpmeKPg
0OP1isXkoYmDiTEQLFZ2OFAra5HuYuLAwtkln6yn5lCyVfT36XnGDk8TF14z
Oa/hUPvbquDcDiOHDXp5ixlttBy43VRLmWYh+MUg9X0IvvS8OM3TDUYOMiDa
AMF/AjKPH8E/cdhpbeY/TTgf7J7Pmg6Fa7pvZ2wwchAFOXSKpkM9yP4Txg4v
srS/TY9Vd/i681bX31QTBwYQOKAM58vvWrAvtU8OzlcA8fnEHFa88ND7/9DY
YYvXBos5lbwOZ0BgjpGD9Eax+UwKzHD7v+z7uDU9jAnO53bk85qhieCnpwHB
M0aE/0D6Exjh/jcGA0Z4+MD4p0H+3Ifgg8N7ibHDklvLHxs2sztEiG+/yKBn
4nAW5C4eAYj79pg4iFROKjnbIgKPv6C3lz/OcJR0QI9fAGgFyoU=
        "]]},
      AspectRatio->Automatic,
      BaselinePosition->Scaled[0.32631885041954006`],
      ImageSize->{23.117339975093397`, 15.14319302615193},
      PlotRange->{{0., 23.12}, {0., 
       15.139999999999999`}}], {-1.6959547435453335, 0.9330150281333556}, {
     Right, Bottom}], InsetBox[
     GraphicsBox[
      {Thickness[0.042265426880811495`], 
       FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
         0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 
         3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, {{{
         9.754690000000002, 8.59219}, {9.754690000000002, 
         11.068799999999998`}, {8.089060000000002, 12.415599999999998`}, {
         6.02969, 12.415599999999998`}, {1.4156300000000002`, 
         12.415599999999998`}, {1.4156300000000002`, 11.9453}, {2.57813, 
         11.9453}, {2.57813, 5.371880000000001}, {1.4156300000000002`, 
         5.371880000000001}, {1.4156300000000002`, 4.8999999999999995`}, {
         6.02969, 4.8999999999999995`}, {8.132809999999997, 
         4.8999999999999995`}, {9.754690000000002, 6.24688}, {
         9.754690000000002, 8.59219}}, {{8.264059999999999, 
         8.603129999999998}, {8.264059999999999, 7.321879999999999}, {8.1, 
         6.751560000000001}, {7.715629999999997, 6.2359399999999985`}, {
         7.3328099999999985`, 5.732810000000001}, {6.59844, 
         5.371880000000001}, {5.612500000000001, 5.371880000000001}, {
         3.9687499999999996`, 5.371880000000001}, {3.9687499999999996`, 
         11.9453}, {5.612500000000001, 11.9453}, {6.565629999999998, 
         11.9453}, {7.3328099999999985`, 11.5719}, {7.737499999999997, 
         11.0031}, {8.056249999999999, 10.5531}, {8.264059999999999, 
         10.017199999999997`}, {8.264059999999999, 8.603129999999998}}}], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4hfFW0V/v9Z2SE8DgmeMDjA+tyOf1wxNJjj/
y76PW9PDmBzOgECPtkPAE89LppeZHTbp5S1mjNF06Ino9mfcwONgarM3aJqi
hoOJMRBMFoXzD3TvazJploPzH7jGO85qVHao/21VcE5D02GL+Y9DKVrqDiI9
Xq9Ytmg7PIgQ337xgCbcfrB5nxH8E4ed1mb+Q/CfJC68ZsKvBefLzIvTPG2g
5XB8145etgvaDhtA7rTRcpgxEwh2IvgSIHUFCL6+1krhC0s0HeYsUt75Z7mG
w99vpQ/mTNRwkJh6hTOjSQ3ijmJ1hzcge7xVHAJvSdckflJzuKMpu+b/Z0U4
H+ZfGD9GNULm3Bwph0cgfzkA/Vk5qeRsiqiDAci+FA2HdgV21TNbBCDu3aDp
kAaODzaHLSB31Wg7GIMBI9z9MD7MfzA+3P8bxeYzJSD4sPgFAMI40F4=
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
        0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 
        0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYC4pOHndZmvjN0WCOkw5d+T9IBxg94e/njDEUp
B2MQeGzosL97X5OJs5SD+NQrnBmXcPP/fCt9MOcggu/Y9Oj4jN2GDl/2fdya
Libl4IDG/7LzVtffrYYO/8FAEmLeIkOHMyDgI+nweUNA9qx0Q4c3bbndRtLi
DteFPjmef2bgoPFJ5eUsThEH/4sTY/45I/iyy1946N3Xh/NFerxesVzRdwgB
+0cUzp8JApJicP4MND5Y/qeYg77WSuELT/QdGECgQdzBtjJihelZAwfla4+C
GeYoOfQHl6hMP28I5xuA1LMYwfnS8+I0Tytg8ld+e1lxhkEZzl8LCn87ZUg4
8CP4ybF33JhvGML53UDnmTw0gPPrf1sVnPMwdPgLCvdCNUh4BBtC3HsAwZ8x
gb/K7DSCH3hLuibxE4IPCW91iH/0DR3kQOFYr+4wHaSPG8EHh8cXAzgfrH+z
gQMTZ5d8cp66w/Ms7W/T5xo41HwCRtwuNYfCNd23MwwQ7gWnj0A9OP9JhPj2
iw904XwWkDnrMPl3NGXX/L+sBOfDwtPnBLvt7KsI/gOQeQ56cD63m2opkxQi
vkxt9gZNO6jnkJIGBMskHTLyP7SenKLnEK0aIXNORsLBF+SfZj1IeKwRh/Nh
6Q/Gr7r/45Yxt6jDlPbWqMs2+g7qoPSmKQxJ79YGcD44vYYZwvmw/NUX0e3P
OAGR32D5DwCNIH9B
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4htCnxzPTzN1ONC9r8mkWc4Bxle+9iiY4Y2C
g+qT5nlnq0wdTIyBYLGyQ4T49osM90wcWDi75JP11Bx4/NdPSbUwcXiauPCa
yXkNB4mpVzgzgowdNujlLWa00XJYcn8f3xxjBJ8XpF4Dwd9i/uNQipSxg8y8
OM3TBgj+E5B5/Aj+icNOazP/acL5YPd81nTgcVMtZfIydhDt8XrFMkUTYn+S
icOLLO1v02PVHSYEl6hM/2/iwAACB5ThfPldC/al9snB+QogPp+Yg2PTo+Mz
qk0ctnhtsJhTyeuQngYEZsYO0hvF5jMpMMPt/7Lv49b0MCY4n9uRz2uGJoIP
1veMEeE/kP4ERrj/jcGAER4+MH5K7B035ggEPxIU3nYmDktuLX9s2Mzu8GlD
QPas4yYOZ88AAY+AA8iatDBTB5HKSSVnW0Tg8Rf09vLHGY6SDujxCwAiacM4

        "]]},
      AspectRatio->Automatic,
      BaselinePosition->Scaled[0.32631885041954006`],
      ImageSize->{23.662535491905356`, 15.14319302615193},
      PlotRange->{{0., 23.66}, {0., 
       15.139999999999999`}}], {-1.2620710044277754, 0.03204616023093644}, {
     Left, Top}]}},
  ImageSize->202,
  PlotRange->{{-2.4509882660333235`, 1.2479473117878346`}, {-0.25, 
   1.25}}]], "Output",
 CellChangeTimes->{{3.938651655427959*^9, 3.938651685782835*^9}, 
   3.938651752389312*^9, {3.938651890554543*^9, 3.9386519125661163`*^9}, {
   3.938651959066162*^9, 3.938652010167227*^9}, 3.938652312864489*^9, 
   3.938652508678234*^9, 3.938652559763102*^9, {3.938652645068132*^9, 
   3.9386528058716908`*^9}, {3.938652905249345*^9, 3.9386529257725687`*^9}, {
   3.938653017850251*^9, 3.938653076836647*^9}, 3.9386562789253597`*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"798459cd-ebeb-4378-a112-04becf3b03c7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"save", "[", "balancedPolygonLimit", "]"}]], "Input",
 CellChangeTimes->{{3.938652948999823*^9, 3.938652949445039*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"27de9ef1-9761-410f-9c4d-16e08a046417"],

Cell[BoxData[
 RowBox[{
  RowBox[{"balancedPolygonCombined", "=", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"balancedPolygon", ",", "balancedPolygonLimit"}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "width"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.938656287668057*^9, 3.9386563122552147`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"67584dd8-8b48-4caf-b8af-69c3d66c5b72"],

Cell[BoxData[
 RowBox[{"save", "[", "balancedPolygonCombined", "]"}]], "Input",
 CellChangeTimes->{{3.938656313686407*^9, 3.938656315921706*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"f204c416-dc70-4188-81eb-5222a3febb5b"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
  "Blue", " ", "horizontal", " ", "sides", "\[IndentingNewLine]", "Green", 
   " ", "slanted", " ", "sides", "\[IndentingNewLine]", "Label", " ", "K", 
   "\[IndentingNewLine]", "Label", " ", "niche"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.932008225430006*^9, 
  3.9320082405031767`*^9}},ExpressionUUID->"c8d2b6ca-394d-4b75-a9c4-\
4132b360577e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extremeSofa", "=", 
   RowBox[{"Sofa", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Pi", "/", "6"}], ",", 
        RowBox[{"Pi", "/", "3"}], ",", 
        RowBox[{"Pi", "/", "2"}]}], "}"}]}], ",", 
     RowBox[{"N", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "/", "3"}], "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "/", "3"}], "]"}]}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.936948190396494*^9, 3.9369482005241957`*^9}, {
  3.936948251719211*^9, 3.936948333209179*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"a1202835-32ff-48fd-a2cc-1655607a7d6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thin", ",", "LightGray"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"MS`SofaDefaultFillingColor", ",", 
       RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
       RowBox[{"Polygon", "@", 
        RowBox[{"SofaVertices", "@", "extremeSofa"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "/", "3"}], "]"}], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "/", "3"}], "]"}]}], ",", "1"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"MaTeX", "[", "\"\<\\\\mathbf{x}(\\\\pi/6)\>\"", "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "/", "3"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.1"}], ",", "Center"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"MaTeX", "[", "\"\<\\\\mathbf{x}(\\\\pi/3)\>\"", "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "/", "3"}], "]"}]}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "Center"}], "}"}]}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"ImageSize", "->", "width"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.936948347749734*^9, 3.93694834879875*^9}, {
  3.93694840905469*^9, 3.93694854319597*^9}, {3.936948579105525*^9, 
  3.936948610641548*^9}, {3.936949124479546*^9, 3.9369491314647493`*^9}, {
  3.9386510747630863`*^9, 3.938651086284177*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"d90423de-4601-4636-9610-88b5c437ba81"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0.85], Thickness[Tiny]}, 
   {RGBColor[1, 1, 0.87], EdgeForm[GrayLevel[0]], 
    PolygonBox[SofaPolygon`SofaVertices[$CellContext`extremeSofa]]}, {
    PointBox[NCache[{3^Rational[-1, 2], 1}, {0.5773502691896258, 1}]], 
    PointBox[NCache[{-3^Rational[-1, 2], 1}, {-0.5773502691896258, 1}]], 
    InsetBox[
     GraphicsBox[
      {Thickness[0.029265437518290898`], FilledCurveBox[CompressedData["
1:eJxTTMoPymNmYGBgBGIlIAaxQYCJAQEYCbAZofqYyVCDLE6MOcSYTy1zBptf
AGcWAkc=
        "], CompressedData["
1:eJxTTMoPSmVmYGBgBGJrIGYC4jVCOnzpdrIOM8FA2AHGj1GNkDlXI+pw/gwQ
6EjB+cKVk0rOHhFyAAmfyZFzeNOW2210W9xh5beXFWcUlBw+7/u4NT1MAmJe
phJEfreEQ3oaEExTclgLMj9OBoMvEBtw36hdGa5f5dqjYIYaZYe+iG5/RgFx
OF9h14J9qXqicL6JMRB8Fobrh/Fh5mt8Unk566QInN+mwK56Zouog/OEZqG0
KgQfpM04WMmhFY0P8zfMf2lgIOqwN7/m7UxRJYcvIPdOE4SE2z15BwYQaOCC
2/ei9nH2eR0+DD7MvTyOfF4zNHlQ/WPMBueDzb/GDOeDpY0Z4fzsqQmFFp9/
2MP4Xlv9jyezfbGHmQ/jw+yPBvnHhgHuHrD9L3kdpoPi66aMw5Jbyx8bNjM5
7Ai2ivifLuZwnfe2WGoZo0Pl/R+3jE+LOswAq2OAh8v8E5OXZKt9tkfnw9LT
dq8NFnN2Mjr0g+Jxg7BDi3gta6YbC5wPiS92OB/snkwueHqE8WHmg92/hwPO
B0fHMzZ4PML4B7v3NZkwizmkQvkHoHyYPNh4STGof9kh7igWg6hTFoCET5q0
Q9Dbyx9nMIrC7VMHpSdNYQw+zL0ea44uZ7AQgfsHbIyaOJwPNi9RAs5/4Brv
OGujJJwvAspfLDJwPnr+BADQXmqN
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4oBb0jWJQWoO6WlA8IzRAcbnduTzmqHJBOd/
2fdxa3oYk4OJMRB8VnUIeOJ5yfQys0O3jeeutEPKDj0R3f6MG3gc3NccXc7Q
oQRRN1kUzj/Qva/JpFkOzn/gGu84q1HZIYJTrN24X9lhi/mPQyla6g41nzYE
ZEupOTyIEN9+8YAm3H6IvQj+icNOazP/IfhPEhdeM+HXgvNl5sVpnjbQctBV
lP+SY6bmsEEvbzGjjZYDAwgoIPiNLEf7Da+rwvkzJvBXmXGrOMxZpLzzz3IN
iHt/KDlITL3CmdGk5jATBG4qOrwp3ir621vF4cOi9QpnIxQd7mjKrvn/WRHO
h/kXxo9RjZA5N0fKgT824L7RckUHkcpJJWdTRB2q7/+4ZXxayaFdgV31zBYB
iHvFVBzSwPHBBrH3kaqDMRgwwt0P48P8B+PD/b9RbD5TAoIPi18A5Va4qA==

        "]], 
       FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIbIGYC4o16eYsZ7xg6GIPAYSUHGH+tkA5fup2yw3Wh
T47nlyH4/hcnxvwrRvADbknXJG7ShvP/fCt9MMcQwTcBmVusBedLz4vTPF2g
6aB87VEwg46Sg+zyFx569zUc3i9ar3C2Q9Fh+gT+KjNtDYf/IBCvAOdD9CP4
Z0BARsHBY3+trIW7hsOKby8rzggoONT/tio4l4HgS4Hsm4Dg6yrKf8mZpuHQ
aeO5K01JwSEQ7H4Nh9uasmv+Oys4+Jxgt519VRNiP7+Sw4yZQPBTC85v4fVf
P6VVG5V/VAfO32L+41CKl45D9f0ft4yzFRyeZ2l/m75X2yE1DQjYZCHh81HT
AWTszEhRB32tlcIXjmg6ZIDkl4nA+X0R3f6MExB8sH99EPzgt5c/zkgUdogP
CVJfoKnloP5J5eUsTWGHKe2tUZdjEHx5UPj+R/DfFG8V/a2tDTfvSeLCayb5
2g4ilZNKzqqIQcLvBNR/8RJw/pd9H7eml0k4PIgQ336RQcfBfc3R5QwWUhB/
uenC/Q+WP6AP59eC9GvoQ/SbyTskgNx7Us/hQPe+JhNmGTgf7J9GCTgf7J4n
4nA+zP1PQe5drw/nH2xbHn5KyADOvwmMTiNXA4c1oPTyD8GPUo2QObdHBM5v
VWBXPfMFwa8CxRe3qMNfcPo1cGgDyW8RhYTXaX1IfO2UgPPB6bFOBs6X37Vg
X+o5BP++a7zjLEFZOD8dFE5iCpD0r2AADx/VJ83zzkYZwvng+KhH8GH5EZ0P
y68AFSyprg==
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
        3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}}}, {{{23.065600000000003`, 
        12.909399999999998`}, {23.065600000000003`, 13.040599999999998`}, {
        22.9563, 13.117199999999997`}, {22.8688, 13.117199999999997`}, {
        22.814099999999996`, 13.117199999999997`}, {22.7156, 
        13.117199999999997`}, {22.628100000000003`, 12.876599999999996`}, {
        18.957800000000002`, 2.5656300000000005`}, {18.8922, 2.36875}, {
        18.8922, 2.2375000000000003`}, {19.001599999999996`, 
        2.1609399999999996`}, {19.0891, 2.1609399999999996`}, {
        19.154700000000002`, 2.1609399999999996`}, {19.253100000000003`, 
        2.17188}, {19.329700000000003`, 2.40156}, {23., 
        12.712499999999997`}, {23.065600000000003`, 12.909399999999998`}}}], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
         3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
         3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
         3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQBmIQvfSFh97/RhsH9U8qL2d1yjjA+OGcYu3G+ooONpUR
K0xrrR06bTx3pSkpO+hrrRS+kGIF50+fwF9llm0J5xdvFf19ms/SoRvEL1J0
EJ96hTPjk4XDnvyatzOvKsD5p88AQQ5CPiX2jhvzDzUH+6ZHx2d4WznscAAy
bqg7mBgDwWMEH6zOwxrOB7tvrbXDhathb/RnqztIgMx7ZO0QeEu6JvGTmoPE
vDjN0wcQ/O87b3X9DcXkg5xzhgfB//ut9MGciaoO/0Gg3tohDQTUVB003vLu
MziJ4D9JXHjNhN8Gzi8B+d/OxqHm04aA7CoE/0WW9rfpsmpw/qMI8e0XHdQd
9tfKWqRfsXaQXQ4M+HgNh/w13bczHljB+eDwrLOE86MVHD8m81g4vAFJdKvC
+TNmAsFOBThfpHJSydkUUQdbUPjEWjrI71qwL3WdEDx8YXxY/ML4sPj3WHN0
OcMNMQf09AEASQv33Q==
         "], CompressedData["
1:eJxTTMoPSmViYGAQA2IQvUEvbzHjHGuHVgV21TNTZBxg/OkzgSBSCs7/DwLx
Eg7XhT45nk+zdviy7+PW9G1iDhLz4jRPK1g7vGnL7TaaLeJg3/To+IzdVg4x
qhEy5+4IQ/jeCL76k+Z5Z2dZwvlg89wsHR66xjvOChRzeJ6l/W26LlTeRtxh
f62sRbqIJdx+Hv/1U1J/WDikpwFBmxSc777m6HKGGbJwPn9swH2jdgUH28qI
Faaxlg7dNp670jYpOcwA+8sKzve5ODHm32cE/4Z0TaKRqzWE/0jR4Xniwmsm
+dYOdzRl1/xXVoSHh3DlpJKzIQpwvivI/go5B/TwBADOyJa0
         "]}], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4mzOnwvSuR0cDnTvazJplnOA8ZWvPQpmeKPg
oPKked7ZX/YOJsZAsFjZIUJ8+0WGOHsHFs4u+WQ9NQce//VTUnfYOTxNXHjN
5LyGg/jUK5wZl2wdNujlLWa00XJYcn8f35zNCD5Y/QoEf4v5j0Mps2wdZObF
aZ42QPCfgMzjR/BPHHZam/lPE84Hu+ezpgOHm2op0ylbB9Eer1csUzQdJED2
P7JzeJGl/W16rLpDb3CJyvR6ewcGEDigDOfL71qwL7VPDs5XAPH5xBzsmx4d
n/HbzmGL1waLOZW8DqlpQLDN1kF6o9h8JgVmuP1f9n3cmh7GBOdzO/J5zdBE
8NNB+p4xIvwH0p/ACPe/MRgwwsMHxk+IvePGfAPBDweF9z47hyW3lj82bGZ3
+LAhIHuWu73D2TNAwCMAcd81eweRykklZ1tE4PEX9PbyxxmOkg7o8QsAly7I
zQ==
        "]]},
      AspectRatio->Automatic,
      BaselinePosition->Scaled[0.32631885041954006`],
      ImageSize->{34.165758405977584`, 15.14319302615193},
      PlotRange->{{0., 34.17}, {0., 15.139999999999999`}}], 
     NCache[{3^Rational[-1, 2], 1}, {0.5773502691896258, 1}], {-0.1, Center}],
     InsetBox[
     GraphicsBox[
      {Thickness[0.029265437518290898`], FilledCurveBox[CompressedData["
1:eJxTTMoPymNmYGBgBGIlIAaxQYCJAQEYCbAZofqYyVCDLE6MOcSYTy1zBptf
AGcWAkc=
        "], CompressedData["
1:eJxTTMoPSmVmYGBgBGJrIGYC4jVCOnzpdrIOM8FA2AHGj1GNkDlXI+pw/gwQ
6EjB+cKVk0rOHhFyAAmfyZFzeNOW2210W9xh5beXFWcUlBw+7/u4NT1MAmJe
phJEfreEQ3oaEExTclgLMj9OBoMvEBtw36hdGa5f5dqjYIYaZYe+iG5/RgFx
OF9h14J9qXqicL6JMRB8Fobrh/Fh5mt8Unk566QInN+mwK56Zouog/OEZqG0
KgQfpM04WMmhFY0P8zfMf2lgIOqwN7/m7UxRJYcvIPdOE4SE2z15BwYQaOCC
2/ei9nH2eR0+DD7MvTyOfF4zNHlQ/WPMBueDzb/GDOeDpY0Z4fzsqQmFFp9/
2MP4Xlv9jyezfbGHmQ/jw+yPBvnHhgHuHrD9L3kdpoPi66aMw5Jbyx8bNjM5
7Ai2ivifLuZwnfe2WGoZo0Pl/R+3jE+LOswAq2OAh8v8E5OXZKt9tkfnw9LT
dq8NFnN2Mjr0g+Jxg7BDi3gta6YbC5wPiS92OB/snkwueHqE8WHmg92/hwPO
B0fHMzZ4PML4B7v3NZkwizmkQvkHoHyYPNh4STGof9kh7igWg6hTFoCET5q0
Q9Dbyx9nMIrC7VMHpSdNYQw+zL0ea44uZ7AQgfsHbIyaOJwPNi9RAs5/4Brv
OGujJJwvAspfLDJwPnr+BADQXmqN
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4oBb0jWJQWoO6WlA8IzRAcbnduTzmqHJBOd/
2fdxa3oYk4OJMRB8VnUIeOJ5yfQys0O3jeeutEPKDj0R3f6MG3gc3NccXc7Q
oQRRN1kUzj/Qva/JpFkOzn/gGu84q1HZIYJTrN24X9lhi/mPQyla6g41nzYE
ZEupOTyIEN9+8YAm3H6IvQj+icNOazP/IfhPEhdeM+HXgvNl5sVpnjbQctBV
lP+SY6bmsEEvbzGjjZYDAwgoIPiNLEf7Da+rwvkzJvBXmXGrOMxZpLzzz3IN
iHt/KDlITL3CmdGk5jATBG4qOrwp3ir621vF4cOi9QpnIxQd7mjKrvn/WRHO
h/kXxo9RjZA5N0fKgT824L7RckUHkcpJJWdTRB2q7/+4ZXxayaFdgV31zBYB
iHvFVBzSwPHBBrH3kaqDMRgwwt0P48P8B+PD/b9RbD5TAoIPi18A5Va4qA==

        "]], 
       FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIbIGYC4o16eYsZ7xg6GIPAYSUHGH+tkA5fup2yw3Wh
T47nlyH4/hcnxvwrRvADbknXJG7ShvP/fCt9MMcQwTcBmVusBedLz4vTPF2g
6aB87VEwg46Sg+zyFx569zUc3i9ar3C2Q9Fh+gT+KjNtDYf/IBCvAOdD9CP4
Z0BARsHBY3+trIW7hsOKby8rzggoONT/tio4l4HgS4Hsm4Dg6yrKf8mZpuHQ
aeO5K01JwSEQ7H4Nh9uasmv+Oys4+Jxgt519VRNiP7+Sw4yZQPBTC85v4fVf
P6VVG5V/VAfO32L+41CKl45D9f0ft4yzFRyeZ2l/m75X2yE1DQjYZCHh81HT
AWTszEhRB32tlcIXjmg6ZIDkl4nA+X0R3f6MExB8sH99EPzgt5c/zkgUdogP
CVJfoKnloP5J5eUsTWGHKe2tUZdjEHx5UPj+R/DfFG8V/a2tDTfvSeLCayb5
2g4ilZNKzqqIQcLvBNR/8RJw/pd9H7eml0k4PIgQ336RQcfBfc3R5QwWUhB/
uenC/Q+WP6AP59eC9GvoQ/SbyTskgNx7Us/hQPe+JhNmGTgf7J9GCTgf7J4n
4nA+zP1PQe5drw/nH2xbHn5KyADOvwmMTiNXA4c1oPTyD8GPUo2QObdHBM5v
VWBXPfMFwa8CxRe3qMNfcPo1cGgDyW8RhYTXaX1IfO2UgPPB6bFOBs6X37Vg
X+o5BP++a7zjLEFZOD8dFE5iCpD0r2AADx/VJ83zzkYZwvng+KhH8GH5EZ0P
y68AFSyprg==
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
        3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}}}, {{{23.065600000000003`, 
        12.909399999999998`}, {23.065600000000003`, 13.040599999999998`}, {
        22.9563, 13.117199999999997`}, {22.8688, 13.117199999999997`}, {
        22.814099999999996`, 13.117199999999997`}, {22.7156, 
        13.117199999999997`}, {22.628100000000003`, 12.876599999999996`}, {
        18.957800000000002`, 2.5656300000000005`}, {18.8922, 2.36875}, {
        18.8922, 2.2375000000000003`}, {19.001599999999996`, 
        2.1609399999999996`}, {19.0891, 2.1609399999999996`}, {
        19.154700000000002`, 2.1609399999999996`}, {19.253100000000003`, 
        2.17188}, {19.329700000000003`, 2.40156}, {23., 
        12.712499999999997`}, {23.065600000000003`, 12.909399999999998`}}}], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}}}, CompressedData["
1:eJxd1GtIVEEUAOBNJRN8wOq6yirrdV9qZZar3IfC0dLCfiRluWBprq5aSRoU
pWSghv3YQAkjtbKnqOUj+pFisFoiLr5QKjGTLDHMSGhNJOjHtmevdwY6MD++
e+fOmZlzuIy57KjFUyaTbXONNNfwcI2274dindVJcLBrpF0WogLJTgy1Gobq
2rPHXgqwEB3e5dQwMKe6mr+vjYd4jFoGDGt+trhmQZwfEAmWIlckJsGvx70R
kx0a4rHh1O4zuTriZoxQA5R3WT+VZAoQ3u5KnBcFZWjgiQtOLaR7RnHEfkd6
Gy0mFqr+8uVTOwzEy/mPZo1lOuJv6Hqt+LyXhZDb731KzFqIwv1+pB6sCmeL
gzji3y8yz7Vkc7CbUW+UvqKW9i85c951EXI9+X7JpOybOa0HPF7RLEucYfdO
vjtC7b6nQep1XK+PhekPJ37uydGDEvcRyUE/1CyNzhnAN113ySOGJy7E+2Cp
3fkbqbXLta2TGQLExXQGTl+nlvYvWXEz44fXhlbMlyrAgYZaedGABvCx0cGL
9bNHwgTGPR6+pOWltMwwsHJ25+adZB46N1evTAwxgGVxOjioWPwzH/966/19
Dvbjes8YwGPKznMQWHHr4uRTBt5iP5k5yPYJvhH/gHoc85RSu+cbGVC15kaP
l1Mbse+eULvPr+WJ3f0qF4iTKkwdCVUCpGF/m9TEQ1ZbjVGjIg7C+YUKGMV7
svFwUmcKm1oIFPs9gdqO73s4Yn/sNzsL3fJd/sWfg6Daa6R+72UW3uD6w0px
/9OseD9WJalvXYS3biIrhNiwrl1tWQ0lVg88tFliVeJ6K6xo/zC4hn3fRH0Y
++s4dU5EiqPAl4VFrNcFFXH/Md7kHA0lzlp752j6qhD7dftWvh45qa/kxoaA
ykSrQCz9HyrxPM+D4f//xz+YZtPL
        "]], 
       FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
        3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4mzOnwvSuR0cDnTvazJplnOA8ZWvPQpmeKPg
oPKked7ZX/YOJsZAsFjZIUJ8+0WGOHsHFs4u+WQ9NQce//VTUnfYOTxNXHjN
5LyGg/jUK5wZl2wdNujlLWa00XJYcn8f35zNCD5Y/QoEf4v5j0Mps2wdZObF
aZ42QPCfgMzjR/BPHHZam/lPE84Hu+ezpgOHm2op0ylbB9Eer1csUzQdJED2
P7JzeJGl/W16rLpDb3CJyvR6ewcGEDigDOfL71qwL7VPDs5XAPH5xBzsmx4d
n/HbzmGL1waLOZW8DqlpQLDN1kF6o9h8JgVmuP1f9n3cmh7GBOdzO/J5zdBE
8NNB+p4xIvwH0p/ACPe/MRgwwsMHxk+IvePGfAPBDweF9z47hyW3lj82bGZ3
+LAhIHuWu73D2TNAwCMAcd81eweRykklZ1tE4PEX9PbyxxmOkg7o8QsAly7I
zQ==
        "]]},
      AspectRatio->Automatic,
      BaselinePosition->Scaled[0.32631885041954006`],
      ImageSize->{34.165758405977584`, 15.14319302615193},
      PlotRange->{{0., 34.17}, {0., 15.139999999999999`}}], 
     NCache[{-3^Rational[-1, 2], 1}, {-0.5773502691896258, 1}], {
     0.1, Center}]}},
  ImageSize->404]], "Output",
 CellChangeTimes->{
  3.9369483490742483`*^9, {3.9369484154459267`*^9, 3.936948482782671*^9}, {
   3.936948525973591*^9, 3.936948543617714*^9}, {3.9369486067577333`*^9, 
   3.936948610886059*^9}, {3.936949127586206*^9, 3.9369491318009253`*^9}, 
   3.938651087442459*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"5c857d2e-0d64-43ed-bec5-626a289ee547"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 356}, {114, Automatic}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e57880f2-4cae-495f-96c7-1cf993959fb0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 320, 8, 30, "Input",ExpressionUUID->"4150777a-f66e-430c-9b61-9701cab11681"],
Cell[881, 30, 533, 10, 52, "Input",ExpressionUUID->"26e0bb32-e3c2-499d-8371-85b58dbe1265"],
Cell[1417, 42, 959, 26, 52, "Input",ExpressionUUID->"617774e2-e845-41cd-84eb-0c2ef1140339"],
Cell[2379, 70, 267, 5, 30, "Input",ExpressionUUID->"17dda065-49c7-4629-b36e-f5350d88ba98"],
Cell[2649, 77, 4922, 119, 577, "Input",ExpressionUUID->"fdbbcefb-f420-455d-9d0b-bcd1a04fc037"],
Cell[7574, 198, 534, 11, 52, "Input",ExpressionUUID->"e360a209-0c5b-437e-a080-9d658949f4df"],
Cell[8111, 211, 1077, 31, 94, "Input",ExpressionUUID->"105dfe0a-2949-4819-a386-ada0f6308b9c"],
Cell[9191, 244, 1607, 43, 199, "Input",ExpressionUUID->"0dcc7c4b-adb3-456a-9406-a93e18648904"],
Cell[10801, 289, 1098, 28, 94, "Input",ExpressionUUID->"d738563d-6e00-41b2-9a8b-6aafa1fd0574"],
Cell[CellGroupData[{
Cell[11924, 321, 4333, 112, 325, "Input",ExpressionUUID->"baf21c4a-0954-44d7-bd07-19c2154f1900"],
Cell[16260, 435, 5150, 94, 174, "Output",ExpressionUUID->"777f571e-de07-42e7-ab51-fa763512be66"]
}, Open  ]],
Cell[21425, 532, 224, 3, 30, "Input",ExpressionUUID->"8b0b1bab-e6cc-426f-95ae-3160e7d5ca85"],
Cell[21652, 537, 712, 13, 52, "Input",ExpressionUUID->"6fb8a938-1cec-4eae-9a1a-f81d2fc4bba6"],
Cell[22367, 552, 960, 26, 52, "Input",ExpressionUUID->"d557a001-ad59-49c0-a63f-786a6908db06"],
Cell[23330, 580, 345, 6, 30, "Input",ExpressionUUID->"def6f61f-3aeb-40ec-9bbc-477401a18148"],
Cell[23678, 588, 5023, 120, 577, "Input",ExpressionUUID->"76e0281f-9371-4e6d-b516-b736ecd6bd16"],
Cell[28704, 710, 535, 11, 52, "Input",ExpressionUUID->"1e20161c-3a5b-46c1-8213-91430a2897ec"],
Cell[CellGroupData[{
Cell[29264, 725, 362, 8, 30, "Input",ExpressionUUID->"1769e153-7da6-44fc-ae39-c4e863f8d4c3"],
Cell[29629, 735, 321, 6, 34, "Output",ExpressionUUID->"8891a038-93e5-4916-9669-5be142e71837"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29987, 746, 4897, 128, 367, "Input",ExpressionUUID->"5fa191ab-fb67-4e72-ad51-9c37f37813d1"],
Cell[34887, 876, 5674, 99, 101, "Output",ExpressionUUID->"fec88264-0fb5-4954-ac99-b4fd8321b10e"]
}, Open  ]],
Cell[40576, 978, 196, 4, 30, "Input",ExpressionUUID->"af806008-fab2-4abb-9be4-73af1213f0c8"],
Cell[CellGroupData[{
Cell[40797, 986, 2239, 58, 241, "Input",ExpressionUUID->"c57f3530-e28d-4b0b-a2ca-67c819b9530a"],
Cell[43039, 1046, 4223, 73, 96, "Output",ExpressionUUID->"69970d1a-2266-4a47-a1aa-45a93ad3a4fb"]
}, Open  ]],
Cell[47277, 1122, 223, 4, 30, "Input",ExpressionUUID->"bc019253-230e-454c-befe-4c26b309c14e"],
Cell[CellGroupData[{
Cell[47525, 1130, 471, 11, 30, "Input",ExpressionUUID->"70a31700-9c5f-46ba-ac46-5a771d1353ed"],
Cell[47999, 1143, 274, 6, 34, "Output",ExpressionUUID->"50a3b275-b4e6-4ed9-a23c-d89764b0720b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48310, 1154, 318, 7, 30, "Input",ExpressionUUID->"62925ca9-6f14-4e04-bf8b-e97f003344e7"],
Cell[48631, 1163, 151, 2, 34, "Output",ExpressionUUID->"1617a3b3-e0f4-4848-afd4-16ad5a7fc472"]
}, Open  ]],
Cell[48797, 1168, 2417, 66, 304, "Input",ExpressionUUID->"b5897356-3db5-4be0-ba4f-585747f08416"],
Cell[CellGroupData[{
Cell[51239, 1238, 3832, 88, 390, "Input",ExpressionUUID->"3ed25bed-852a-403b-b40e-7353c8f61393"],
Cell[55074, 1328, 27755, 487, 99, "Output",ExpressionUUID->"798459cd-ebeb-4378-a112-04becf3b03c7"]
}, Open  ]],
Cell[82844, 1818, 225, 4, 30, "Input",ExpressionUUID->"27de9ef1-9761-410f-9c4d-16e08a046417"],
Cell[83072, 1824, 429, 10, 52, "Input",ExpressionUUID->"67584dd8-8b48-4caf-b8af-69c3d66c5b72"],
Cell[83504, 1836, 228, 4, 30, "Input",ExpressionUUID->"f204c416-dc70-4188-81eb-5222a3febb5b"],
Cell[83735, 1842, 438, 9, 136, "Input",ExpressionUUID->"c8d2b6ca-394d-4b75-a9c4-4132b360577e"],
Cell[84176, 1853, 1059, 31, 52, "Input",ExpressionUUID->"a1202835-32ff-48fd-a2cc-1655607a7d6e"],
Cell[CellGroupData[{
Cell[85260, 1888, 2169, 56, 157, "Input",ExpressionUUID->"d90423de-4601-4636-9610-88b5c437ba81"],
Cell[87432, 1946, 12343, 221, 612, "Output",ExpressionUUID->"5c857d2e-0d64-43ed-bec5-626a289ee547"]
}, Open  ]]
}
]
*)

