Our goal is to show that the maximizer $\mathcal{A}_\Theta$ on $\mathcal{K}_\Theta$ is balanced in the sense of Gerver. We circumvented the issue of preserving the connectedness by separtating the cap $K \in \mathcal{K}_\Theta$ from its niche $\mathcal{N}_\Theta(K)$. Let $\Theta^* := \Theta \cup (\Theta + \pi/2) \cup \left\{ \omega + \pi, 3\pi/2 \right\}$. Then the support function $h = p_K$ of $K$ restricted to the set $\Theta^*$ determines the cap
$$
K = \bigcap_{t \in \Theta^*} H^-(t, h(t))
$$
and the polygon niche
$$
\mathcal{N}_{\Theta}(K) = H^-(\omega + \pi, h(\omega + \pi)) \cap H^-(3\pi/2, h(3\pi/2)) \cap \bigcup_{t \in \Theta}  
$$
completely. More specifically, they are Nef polygons determined by hyperplanes with angle $t \in \Theta^*$ and distance $h(t)$ from the origin.

Assume that $K$ is not balanced. We want to show that $\mathcal{A}_\Theta(K)$ does not attain the maximum value. We will now tweak the individual values of $h : \Theta^* \to \mathbb{R}$ to $h'$ and make the corresponding area functional $|K| - |\mathcal{N}(K)|$ larger. The issue is that, as we tweak the values of $h$ to $h'$, there might not be a corresponding $K' \in \mathcal{K}_\Theta$ such that $h' = p_{K'}$. After making such adjustments from $h$ to $h'$, we need to reconstruct a cap $K''$ so that $\mathcal{A}_\Theta(K'') > \mathcal{A}_\Theta(K)$. This will comprise of multiple steps. 

%%
This is done by taking the maximizer $K \in \mathcal{K}_\Theta$ of $\mathcal{A}_\Theta(K)$ and adjusting $K$. However, merely just adjusting $K$ will make $K$ go outside $\mathcal{K}_\Theta$. We will extend the polygon cap space $\mathcal{K}_\Theta$ successively to $\mathcal{K}_\Theta'$ and $\mathcal{H}_\Theta$. That is, we have a chain of injections $\mathcal{K}_\Theta \subseteq \mathcal{K}_\Theta' \to \mathcal{H}_\Theta$. We will take any non-balanced $K \in \mathcal{K}_\Theta$ and show that it cannot maximize $\mathcal{A}_\Theta$. Using that $K$ is not balanced, we will make small adjustment to $K$ to construct a $h \in \mathcal{H}_\Theta$ with larger $\mathcal{A}_\Theta(h)$ than $\mathcal{A}_\Theta(K)$. Then we will successively find $K' \in \mathcal{K}_\Theta'$ and $K'' \in \mathcal{K}_\Theta$ such that $\mathcal{A}_\Theta(h) \leq \mathcal{A}_\Theta(K') \leq \mathcal{A}_\Theta(K'')$. Consequently, we find a $K'' \in \mathcal{K}_\Theta$ with a larger $\mathcal{A}_\Theta$ than $K \in \mathcal{K}_\Theta$, completing the proof.
%%

We first define the extension $\mathcal{K}_\Theta'$ of $\mathcal{K}_\Theta$.

> __Definition [angled-cap-space-ext].__ Let $\Theta$ be any angle set with rotation angle $\omega \in (0, \pi/2]$. Define $\mathcal{K}_\Theta'$ as the collection of all convex bodies $K$ satisfying the following conditions. ^def-angled-cap-space-ext
> 
> 1. $K$ is a convex body with normal angles in the set $\Theta \cup (\Theta + \pi/2) \cup \left\{ \pi + \omega, 3\pi/2 \right\}$.
> 2. The widths $p_K(\omega) + p_K(\omega + \pi)$ and $p_K(\pi/2) + p_K(3\pi/2)$ of $K$ along the angles $\omega$ and $\pi/2$ are at most 1.

Note that only the condition 2 of [[a. Angle hypothesis/04. Polygon Sofas#^def-angled-cap-space]] is relaxed in [[a. Angle hypothesis/05. Balanced polygon sofas#^def-angled-cap-space-ext]].

> __Proposition [angled-cap-space-ext].__ $\mathcal{K}_\Theta \subseteq \mathcal{K}_\Theta'$. ^pro-angled-cap-space-ext

> __Definition [height-space].__ Let $\Theta$ be an arbitrary finite angle set with rotation angle $\omega$ of size $\geq 3$. Define $\Theta^*$ as the set $\Theta \cup (\Theta + \pi/2) \cup \left\{ \omega + \pi, 3\pi/2 \right\}$. Define $\mathcal{H}_\Theta$ as the space of all functions $h : \Theta ^* \to \mathbb{R}$ such that $h(\omega) + h(\omega + \pi)$ and $h(\pi/2) + h(3\pi/2)$ are at most 1. ^def-height-space

> __Proposition [height-space-embedding].__ The map $p_- : \mathcal{K}_\Theta' \to \mathcal{H}_\Theta$ mapping $K$ to its support function $p_K$ restricted to $\Theta^*$ is a well-defined injection. ^pro-height-space-embedding

In summary, we have a sequence of inclusions $\mathcal{K}_\Theta \to \mathcal{K}_\Theta' \to \mathcal{H}_\Theta$. The space $\mathcal{H}_\Theta$ is the most extended space where the movement is free. We will extend many definitions on a cap $K \in \mathcal{K}_\Theta$ to $\mathcal{H}_\Theta$. First, the edges $a_K, b_K, c_K, d_K$ of $K$ are generalized naturally as they only depend on the support function $p_K$.

> __Definition [height-edges].__ 
> ^def-height-edges


Second, the area functional is generalized well. It comprises of the cap and niche. We only need to follow the equation above.

Now we define the contribution of the lines for each polygon $\mathcal{C}(h)$ and $\mathcal{N}(h)$ of the lines.

> __Definition [height-geometries].__ Take an arbitrary $h \in \mathcal{K}_\Theta$. Define the following concepts. ^def-height-geometries
> 
> 1. Define $\mathbf{x}_h (t) := h(t) u_t + h(t + \pi/2) v_t$ for all $t \in \Theta$. 
> 2. Define the subsets $F_h$, $\mathcal{C}(h)$, $\mathcal{N}(h)$ of $\mathbb{R}^2$ as the following.
$$
\begin{gather*}
 \\
F_h := H^+(\omega, h(\omega) - 1) \cap H^+(\pi/2, h(\pi/2) - 1) \\
\mathcal{C}(h) := F_h \cap \bigcap_{t \in \Theta} \left( R_t(Q^+) + \mathbf{x}_h(t) \right) \\
\mathcal{N}(h) := F_h \cap \bigcup_{t \in \Theta \setminus \left\{ 0, \omega \right\}  } \left( R_t(Q^-) + \mathbf{x}_h(t) \right)
\end{gather*}
$$
> 3. Define $a_h(t) = l(t, h(t)), c_h(t) = l(t + \pi/2, h(t + \pi/2))$ for all $t \in \Theta$.
> 4. Define $b_h(t) = l(t, h(t) - 1), d_h(t) = l(t + \pi/2, h(t + \pi/2) - 1)$ for all $t \in \Theta$.
> 5. Define $\mathcal{A}_\Theta(h) = |\mathcal{C}(h)| -  |\mathcal{N}(h)|$.
> 6. For any $t \in \Theta \setminus \{\pi/2\}$, define $w_h(t)$ as the intersection of $b_K(t)$ with 

> __Proposition [height-geometries].__ The definitions in [[a. Angle hypothesis/05. Balanced polygon sofas#^def-height-geometries]] are generalizations of the corresponding concepts in $K \in \mathcal{K}_\Theta$ in the following sense. Let $K \in \mathcal{K}_\Theta$ be arbitrary and let $h := p_K$. Then the followings hold. ^pro-height-geometries
> 
> - $?_h = ?_K$ for $? = \mathbf{x}, a, b, c, d$.
> - $F_h = F_\omega$.
> - $\mathcal{C}(h) = K$ and $\mathcal{N}(h) = \mathcal{N}(K)$.
> - $\mathcal{A}_\Theta(h) = \mathcal{A}_\Theta(K)$

> __Definition [height-balanced].__ For any $h \in \mathcal{H}_\Theta$, say  ^def-height-balanced


The space $\mathcal{H}_\Theta$ is an affine subspace of $\mathbb{R}^{2|\Theta|}$ with coordinates indexed by $\Theta^*$, and thus naturally equipped with a topology.

> __Definition [height-space-compact].__ Define $\mathcal{D}_\Theta$ as the subspace of $\mathcal{H}_\Theta$ with $h$ such that $h(\omega) = h(\pi/2) = 1$, $K_h$ nonempty, for every $t \in \Theta \cup (\Theta + \pi/2) \setminus \left\{ \omega, \pi/2 \right\}$, we have $h(t) = p_{K_h}(t)$. ^def-height-space-compact

> __Proposition [height-to-polygon-reduction].__ For any $h \in \mathcal{H}_\Theta$ with nonempty $K_h$, there exists a $h' \in \mathcal{D}_\Theta$ such that $\mathcal{A}(h) \leq \mathcal{A}(h')$. ^pro-height-to-polygon-reduction

There is an embedding from $\mathcal{K}_\Theta$ to $\mathcal{H}_\Theta$ by taking $K$ to $h(t) = p_K(t)$. That $\mathcal{H}_\Theta$ is unbounded makes it easier to make adjustment; small adjustment to an element of $\mathcal{K}_\Theta$ may make it move outside $\mathcal{K}_\Theta$, and furthermore invalidate the condition $p_K$. On the other hand, there is a reduction from an element of $\mathcal{H}_\Theta$ to $\mathcal{K}_\Theta$ that also monotonically increases the value of $\mathcal{A}$.

> __Definition [height-geometries].__ Take any $h \in \mathcal{H}_\Theta$. Define $\mathbf{x}_h (t) := h(t) u_t + h(t + \pi/2) v_t$ for all $t \in \Theta$. Also, define the subsets $F_h$, $K_h$, $N_h$ of $\mathbb{R}^2$ as the following. ^def-height-geometries


> __Proposition [height-cap].__ For any $h \in \mathcal{H}_\Theta$, the set $\mathcal{C}(h)$ is ^pro-height-cap
$$
\mathcal{C}(h) = \bigcap_{t \in \Theta^*} H^-(t, h(t))
$$
> and is either empty or a convex polygon with normal angles in $\Theta^*$.

> __Proposition [height-area-continuous].__ $\mathcal{A} : \mathcal{H}_\Theta \to \mathbb{R}$ is continuous. ^pro-height-area-continuous

_Proof._ Appeal to general balancedness. □

> __Theorem [height-maximizer].__ There exists a $h \in \mathcal{H}_\Theta$ that maximizes $\mathcal{A}(h)$. Moreover, it can be assumed that $h = p_K$ for some $K \in \mathcal{K}_\Theta$. ^thm-height-maximizer

_Proof._ We will define a compact subset $\mathcal{D}$ of $\mathcal{H}_\Theta$. Then we will show that for any $h' \in \mathcal{H}_\Theta$, there exists a $h \in \mathcal{D}$ such that $\mathcal{A}(h) \geq \mathcal{A}(h')$. Once this is done, we can take the maximizer of $\mathcal{A}(h)$ over $h \in \mathcal{D}$ by using the compactness of $\mathcal{D}$.

□

> __Proposition [height-cap].__ For any $h \in \mathcal{H}_\Theta$, the set $\mathcal{C}(h)$ is either empty or is a convex polygon in $\mathcal{K}_\Theta'$ with edges in tangent line. ^pro-height-cap

> __Definition [height-cap-side-length].__ For any $t \in \Theta^*$, let $\kappa_h(t)$ be the side length $\lambda^1(\partial \mathcal{C}(h) \cap l_h(t))$ of $\mathcal{C}(h)$. ^def-height-cap-side-length

> __Proposition [height-niche-polyline].__ For any $h \in \mathcal{H}_\Theta$, the set $F_h \setminus \mathcal{N}(h)$ is a closed set on or above a polyline $\mathcal{L}(h)$. If $\omega < \pi/2$ or $\omega = \pi/2$ with some $\mathbf{x}_h$ on or above the line $y=0$, then the polyline $\mathcal{L}(h)$ consists of the following lines from left to right. The half-line ending with $Z_K^\circ$, then a series of finite segments which are subsets of $b_h(t)$ and $d_h(t)$, and ending with $W_K^{\circ}$ and  . Otherwise (that is, $\omega = \pi/2$ and all $\mathbf{x}_h$ are below the line $y=0$), the polyline $\mathcal{L}(h)$ is simply the line $y=0$. ^pro-height-niche-polyline

> __Definition [height-niche-side-length].__ For any $t \in \Theta^*$, let $\nu_h(t)$ be the side length $\lambda^1(\partial \mathcal{N}(h) \cap l_h(t))$ of $\mathcal{N}(h)$. ^def-height-niche-side-length

> __Lemma [height-wedge-positive].__ For any $h \in \mathcal{D}_\Theta$, 
> ^lem-height-wedge-positive

> __Theorem [height-balanced].__ Let $h \in \mathcal{H}_\Theta$ be a maximizer of $\mathcal{A}(h)$. Then 
> ^thm-height-balanced


- Show that the maximizer has $N_h \subset K_h$. 

This section focuses on proving [[a. Angle hypothesis/00. Preface#^thm-main-balanced-angled]] and [[a. Angle hypothesis/00. Preface#^thm-main-balanced-full-angle]]. The main idea is the _balancedness_ condition of optimum intersection used by Gerver.

In the theorems, the balancedness is one-sided, which is only needed for us to bound $h_K(\epsilon)$ in long term.

> __Definition [cap-space-angled].__ Let $\Theta$ be an angle set with rotation angle $\omega$. Define $\mathcal{K}_\Theta$ as the collection of caps $K \in \mathcal{K}_\omega$ such that $K$ is an intersection of closed half-planes with normal angles in $\Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$. ^def-cap-space-angled

Denote $\mathcal{H}^1$ as the dimension one Hausdorff measure on $\mathbb{R}^2$. So if the set $X \subset \mathbb{R}^2$ is a disjoint union of line segments, then $\mathcal{H}^1(X)$ is the total sum of the lengths of the line segments constituting $X$. We observe that

> __Lemma [niche-is-minimal].__ Let $\Theta$ be a finite angle set with rotation angle $\omega \in (0, \pi/2]$ and size $\geq 3$. Let $\mathbf{x} : \Theta \to \mathbb{R}^2$ be a collection of vectors assigned for each $t \in \Theta \setminus \left\{ 0, \omega \right\}$. Assume that $K$ is a member of $\mathcal{K}_\Theta'$ such that $K \subseteq R_t(Q^+) + \mathbf{x}(t)$ for all $t \in \Theta$. Then we always have the followings. ^lem-niche-is-minimal
$$
\mathcal{N}(K) \subseteq F_K \cap \bigcup_{t \in \Theta} \left( R_t(Q^-) + \mathbf{x}(t) \right)
$$

_Proof._ Since we have
$$
\mathcal{N}(K) = F_K \cap \bigcup_{t \in \Theta} \left(R_t(Q^-) + \mathbf{x}_K(t) \right) 
$$
by definition, it remains to show $R_t(Q^-) + \mathbf{x}_K(t) \subseteq R_t(Q^-) + \mathbf{x}(t)$ for every $t \in \Theta$. This holds by the condition $K \subseteq R_t(Q^+) + \mathbf{x}(t)$. □

To use the right balancedness, we use this setting.
$$
F' := H(\pi + \omega, a) \cap H(3\pi/2, b)
$$
$$
K' := F' \cap \bigcap_{t \in \Theta } (R_t(Q^+) + \mathbf{x}(t))
$$
$\mathbf{x} : \Theta \to \mathbb{R}^2$ can be really arbitrary. The only condition is that $a + \mathbf{x}(0) \cdot v_0 \leq 1$ and $b + \mathbf{x}(\omega) \cdot u_\omega \leq 1$. 

 Can go wild. What happens is that:
$$
\begin{align*}
N' & = F' \cap \bigcap_{t \in \Theta} (R_t(Q^-) + \mathbf{x}(t)) \\
S' & = K' \setminus N'
\end{align*}
$$

Then we have $\mathcal{N}_\Theta(K') \subseteq N'$, so consequently $S' \subseteq \mathcal{M}_\Theta(K')$. By switching $\mathbf{x}$ with $\mathbf{x}_{K'}$ we can also attain the equality.

We are solving for the maximization of $S'$.