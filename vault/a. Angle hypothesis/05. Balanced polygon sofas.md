Our goal is to show that the maximizer $\mathcal{A}_\Theta$ on $\mathcal{K}_\Theta$ is balanced in the sense of Gerver. We circumvented the issue of preserving the connectedness by separtating the cap $K \in \mathcal{K}_\Theta$ from its niche $\mathcal{N}_\Theta(K)$. Let $\Theta^* := \Theta \cup (\Theta + \pi/2) \cup \left\{ \omega + \pi, 3\pi/2 \right\}$. Then the support function $h = p_K$ of $K$ restricted to the set $\Theta^*$ determines the cap ^eqn-cap-support-ftn
$$
K = \bigcap_{t \in \Theta^*} H^-(t, h(t))
$$
and the polygon niche ^eqn-niche-support-ftn
$$
\mathcal{N}_{\Theta}(K) = H^-(\omega + \pi, h(\omega + \pi)) \cap H^-(3\pi/2, h(3\pi/2)) \cap \bigcup_{t \in \Theta}  
$$
completely. More specifically, they are Nef polygons determined by hyperplanes with angle $t \in \Theta^*$ and distance $h(t)$ from the origin.

Assume that $K$ is not balanced. We want to show that $\mathcal{A}_\Theta(K)$ does not attain the maximum value. We will now tweak the individual values of $h : \Theta^* \to \mathbb{R}$ to $h'$ and make the corresponding area functional $|K| - |\mathcal{N}(K)|$ larger. The issue is that, as we tweak the values of $h$ to $h'$, there might not be a corresponding $K' \in \mathcal{K}_\Theta$ such that $h' = p_{K'}$. After making such adjustments from $h$ to $h'$, we need to reconstruct a cap $K''$ so that $\mathcal{A}_\Theta(K'') > \mathcal{A}_\Theta(K)$. This will comprise of multiple steps. 

%%
This is done by taking the maximizer $K \in \mathcal{K}_\Theta$ of $\mathcal{A}_\Theta(K)$ and adjusting $K$. However, merely just adjusting $K$ will make $K$ go outside $\mathcal{K}_\Theta$. We will extend the polygon cap space $\mathcal{K}_\Theta$ successively to $\mathcal{K}_\Theta'$ and $\mathcal{H}_\Theta$. That is, we have a chain of injections $\mathcal{K}_\Theta \subseteq \mathcal{K}_\Theta' \to \mathcal{H}_\Theta$. We will take any non-balanced $K \in \mathcal{K}_\Theta$ and show that it cannot maximize $\mathcal{A}_\Theta$. Using that $K$ is not balanced, we will make small adjustment to $K$ to construct a $h \in \mathcal{H}_\Theta$ with larger $\mathcal{A}_\Theta(h)$ than $\mathcal{A}_\Theta(K)$. Then we will successively find $K' \in \mathcal{K}_\Theta'$ and $K'' \in \mathcal{K}_\Theta$ such that $\mathcal{A}_\Theta(h) \leq \mathcal{A}_\Theta(K') \leq \mathcal{A}_\Theta(K'')$. Consequently, we find a $K'' \in \mathcal{K}_\Theta$ with a larger $\mathcal{A}_\Theta$ than $K \in \mathcal{K}_\Theta$, completing the proof.
%%

We first define the extension $\mathcal{K}_\Theta'$ of $\mathcal{K}_\Theta$.

> __Definition [angled-cap-space-ext].__ Let $\Theta$ be any angle set with rotation angle $\omega \in (0, \pi/2]$. Define $\mathcal{K}_\Theta'$ as the collection of all convex bodies $K$ satisfying the following conditions. ^def-angled-cap-space-ext
> 
> 1. $K$ is a convex body with normal angles in the set $\Theta \cup (\Theta + \pi/2) \cup \left\{ \pi + \omega, 3\pi/2 \right\}$.
> 2. The widths $p_K(\omega) + p_K(\omega + \pi)$ and $p_K(\pi/2) + p_K(3\pi/2)$ of $K$ along the angles $\omega$ and $\pi/2$ are at most 1.

Note that only the condition 2 of [[a. Angle hypothesis/04. Polygon Sofas#^def-angled-cap-space]] is relaxed from [[a. Angle hypothesis/05. Balanced Polygon Sofas#^def-angled-cap-space-ext]] of a cap $K \in \mathcal{K}_\Theta$. In particular, any translation of a cap $K \in \mathcal{K}_\Theta$ is a member of $\mathcal{K}_{\Theta}'$. 

> __Proposition [angled-cap-space-ext].__ We have $\mathcal{K}_\Theta \subseteq \mathcal{K}_\Theta'$. ^pro-angled-cap-space-ext

> __Definition [height-space].__ Let $\Theta$ be an arbitrary finite angle set with rotation angle $\omega$ of size $\geq 3$. Define $\Theta^*$ as the set $\Theta \cup (\Theta + \pi/2) \cup \left\{ \omega + \pi, 3\pi/2 \right\}$. Define $\mathcal{H}_\Theta$ as the space of all functions $h : \Theta ^* \to \mathbb{R}$ such that $h(\omega) + h(\omega + \pi)$ and $h(\pi/2) + h(3\pi/2)$ are at most 1. ^def-height-space

> __Proposition [height-space-embedding].__ The map $p_- : \mathcal{K}_\Theta' \to \mathcal{H}_\Theta$ mapping $K$ to its support function $p_K$ restricted to $\Theta^*$ is a well-defined injection. ^pro-height-space-embedding

In summary, we have a sequence of inclusions $\mathcal{K}_\Theta \to \mathcal{K}_\Theta' \to \mathcal{H}_\Theta$. The space $\mathcal{H}_\Theta$ is the most extended space where the movement is free. We will extend many definitions on a cap $K \in \mathcal{K}_\Theta$ to $\mathcal{H}_\Theta$. First, the edges $a_K, b_K, c_K, d_K$ of $K$ are generalized naturally as they only depend on the support function $p_K$ ([[15. Monotone sofas/07. Tangent Hallway#^pro-rotating-hallway-parts]]).

> __Definition [height-edges].__ For any $h \in \mathcal{H}_\Theta$ and angle $t \in \Theta$, define the following lines. ^def-height-edges
$$
\begin{gather}
a_h(t) = l(t, h(t)) \\
b_h(t) = l(t, h(t) - 1) \\
c_h(t) = l(t + \pi/2, h(t + \pi/2)) \\
d_h(t) = l(t + \pi/2, h(t + \pi/2) - 1)
\end{gather}
$$
> For any $K' \in \mathcal{K}_\Theta'$ with $h = p_{K'}$, define $?_{K'} = ?_{h}$ for $? = a, b, c, d$.

> __Proposition [height-edges].__ [[a. Angle hypothesis/05. Balanced Polygon Sofas#^def-height-edges]] agrees with the definition of $a_K, b_K, c_K, d_K$. ^pro-height-edges

Second, the cap and niche of a cap generalizes naturally to an arbitrary function $h \in \mathcal{H}_\Theta$. We only need to follow [[a. Angle hypothesis/05. Balanced Polygon Sofas#^eqn-cap-support-ftn]] and [[a. Angle hypothesis/05. Balanced Polygon Sofas#^eqn-niche-support-ftn]].

> __Definition [height-cap].__ For any $h \in \mathcal{H}_\Theta$, define its _cap_ ^def-height-cap
$$
\mathcal{C}(h) = \bigcap_{t \in \Theta^*} H_-(t, h(t)).
$$

> __Definition [height-niche].__ For any $h \in \mathcal{H}_\Theta$, define its _fan_ ^def-height-niche
$$
F_h = H_-(\omega + \pi, h(\omega + \pi)) \cup H_-(3\pi/2, h(3\pi/2))
$$
> and _niche_
$$
\mathcal{N}_{\Theta}(h) = F_h \cap \bigcup_{t \in \Theta \setminus \left\{ 0, \omega \right\} } H_-^\circ(t, h(t)) \cap H_-^\circ(t + \pi/2, h(t + \pi/2)).
$$

If $h = p_K$ originates from some $K \in \mathcal{K}_\Theta'$, then $\mathcal{C}(h)$ retrieves $K$ back.

> __Proposition [height-cap-back].__ For any $K \in \mathcal{K}_\Theta'$ and its support function $h = p_K$, $\mathcal{C}(h) = K$. ^pro-height-cap-back

Likewise, if $h = p_K$ originates from some cap $K \in \mathcal{K}_\Theta$, then $\mathcal{N}_\Theta(h)$ retrieves the polygonal niche $\mathcal{N}_\Theta(K)$.

> __Proposition [height-niche-back].__ For any cap $K \in \mathcal{K}_\Theta$ and $h = p_K$, we have $\mathcal{N}_\Theta(h) = \mathcal{N}_\Theta(K)$. ^pro-height-niche-back

Using the generalizations of cap and niche, the polygon sofa area functional $\mathcal{A}_\Theta(K)$ on a cap also generalizes to $h \in \mathcal{H}_\Theta$.

> __Definition [polygon-sofa-area].__ Define $\mathcal{A}_\Theta(h) = |\mathcal{C}(h)| - |\mathcal{N}_\Theta(h)|$ ^def-polygon-sofa-area

> __Proposition [polygon-sofa-area].__ For any cap $K \in \mathcal{K}_\Theta$ and $h = p_K$, we have $\mathcal{N}_\Theta(h) = \mathcal{N}_\Theta(K)$. ^pro-polygon-sofa-area

Now we define the contribution of the lines for each polygon $\mathcal{C}(h)$ and $\mathcal{N}(h)$ of the lines.

> __Definition [height-side-length].__ For any $t \in \Theta^*$, let $\kappa_h(t)$ be the side length $\lambda^1(\partial \mathcal{C}(h) \cap l(t, h(t)))$ of $\mathcal{C}(h)$, and let $\nu_h(t)$ be the side length $\lambda^1(\partial \mathcal{N}(h) \cap l_h(t))$ of $\mathcal{N}(h)$. ^def-height-side-length

For any $t \in \Theta$, the value $\kappa_h(t)$ (resp. $\kappa_h(t + \pi/2)$) is the length of the edge of $\mathcal{C}(h)$ on the line $a_h(t)$ (resp. $c_h(t)$). The value $\kappa_h(\omega + \pi)$ (resp. $\kappa_h(3\pi/2)$) is the length of the edge of $\mathcal{C}(h)$ on the left edge $l_h(\omega + \pi)$ (resp. right edge $l_h(3\pi/2)$) of the fan $F_h$. For any $t \in \Theta$, the value $\nu_h(t)$ (resp. $\nu_h(t + \pi/2)$) is the length of the edges of $\mathcal{N}(h)$ on the line $b_h(t)$ (resp. $d_h(t)$). The value $\nu_h(\omega + \pi)$ (resp. $\nu_h(3\pi/2)$) is the length of the edge of $\mathcal{N}(h)$ on the left edge $l_h(\omega + \pi)$ (resp. right edge $l_h(3\pi/2)$) of the fan $F_h$.

> __Definition [height-balanced].__ Say that $K \in \mathcal{K}_\Theta$ is _balanced_ if the following conditions are true. ^def-height-balanced
> 
> 1. $\kappa_h(t) = \nu_h(t)$ for all $t \in \Theta \cup (\Theta + \pi/2)$.
> 2. If $\omega < \pi/2$, then $\kappa_h(3\pi/2) - \nu_h(3\pi/2) = \kappa_h(\pi/2)$ and $\kappa_h(\omega + \pi) - \nu_h(\omega + \pi) = \kappa_h(\omega)$.
> 3. If $\omega = \pi/2$, then $\kappa_h(3\pi/2) - \nu_h(3\pi/2) = \kappa_h(\pi/2)$.

Now if some cap $K \in \mathcal{K}_\Theta$ is _not_ balanced, then we will show that there is some $h \in \mathcal{H}_\Theta$ with larger $\mathcal{A}_\Theta(h) > \mathcal{A}_\Theta(K)$.

> __Proposition [height-balanced].__ If some cap $K \in \mathcal{K}_\Theta$ is not balanced, then we will show that there is some $h \in \mathcal{H}_\Theta$ with larger $\mathcal{A}_\Theta(h) > \mathcal{A}_\Theta(K)$. ^pro-height-balanced

_Proof._ Appeal to the adjustment lemma. □

Now we will take the $h \in \mathcal{H}_\Theta$ that we took in [[a. Angle hypothesis/05. Balanced Polygon Sofas#^pro-height-balanced]] and reduce it to larger cap.

> __Proposition [height-to-cap].__ For any $h \in \mathcal{H}_\Theta$ with $\mathcal{A}_\Theta(h) > 0$, take $K' = \mathcal{C}(h) \in \mathcal{K}_\Theta'$, then we have $\mathcal{A}_\Theta(h) \leq \mathcal{A}_\Theta(K')$. ^pro-height-to-cap

_Proof._  □

Finally, we need to start with some $K' \in \mathcal{K}_\Theta'$ and find some $K'' \in \mathcal{K}_\Theta$ so that $\mathcal{A}_\Theta(K') \leq \mathcal{A}_\Theta(K'')$. This requires some balancedness argument.


We gather the following lemma.

> __Lemma [height-gap].__ The followings are true. ^lem-height-gap
> 
> - If $\omega < \pi/2$, then $\nu_h(\omega + \pi) + z_h^{\circ} \leq \kappa_h(\omega + \pi)$ and $\nu_h(3\pi/2) + w_h^{\circ} \leq \kappa_h(3\pi/2)$. 
> - If $\omega = \pi/2$ and $K$ is balanced, then $w_h^{\circ} + \nu_h(3\pi/2) + z_h^{\circ} \leq \kappa_h(3\pi/2)$.

_Proof._ Define $l_w$ as the line segment from $w_K^{\circ}$ to $A_K^-(0)$. Define $l_z$ as the line segment from $z_K^{\circ}$ to $C_K^+(\omega)$.