# Overview

Following [[@gerverMovingSofaCorner1992]] again, we will show that any moving sofa $S$ is contained in a larger _monotone sofa_ $\mathcal{M}(S)$ which is the intersection of two strips of width 1 and the tangent hallways of $S$ ([[10. Monotonization#^def-monotonization]], [[10. Monotonization#^thm-monotonization-is-sofa]]). So we can assume that a moving sofa of maximum area is a monotone sofa. We will also show that the monotone sofa $\mathcal{M}(S)$ is equal to $K \setminus \mathcal{N}(K)$ where $K = \mathcal{C}(S)$ is a convex set called the _cap_ of $S$ and $\mathcal{N}(K)$ is a set called the _niche_ determined by $K$.

> __Figure [monotone-sofa].__ The movement of a moving sofa $S$ in perspective of the hallway (left) and the sofa (right). The sofa $S$ is monotone and consists of the cap $K$ subtracted by its niche $N$. ^fig-monotone-sofa
> 
> ![100%](images/monotone-sofa.svg)

# Monotonization

Let $S$ be any moving sofa of rotation angle $\omega \in [0, \pi/2]$. Without loss of generality, translate $S$ so that it satisfies $p_S(\omega) = p_S(\pi/2) = 1$. Define the _monotonization_ of $S$ as the following set.

> __Definition [monotonization].__ Let $S$ be any moving sofa with rotation angle $\omega \in [0, \pi/2]$ such that $p_S(\omega) = p_S(\pi/2) = 1$. The _monotonization_ of $S$ is the intersection ^def-monotonization
$$
\mathcal{M}(S) = H \cap R_\omega(V) \cap \bigcap_{0 \leq t \leq \omega} L_S(t).
$$

The following is a consequence of the second condition of [[07. Moving Hallway Problem#^thm-moving-sofa-iff-hallway-intersection]].

> __Corollary [monotonization-contains].__ For any moving sofa $S$ with rotation angle $\omega$ satisfying $p_S(\omega) = p_S(\pi/2) = 1$, its monotonization $\mathcal{M}(S)$ contains $S$. ^cor-monotonization-contains

Gerver claimed in [[@gerverMovingSofaCorner1992]] that the monotonization $\mathcal{M}(S)$ of a moving sofa $S$ is also a moving sofa because $\mathcal{M}(S)$ satisfies the second condition of [[07. Moving Hallway Problem#^thm-moving-sofa-iff-hallway-intersection]]. However, he did not show that the set $\mathcal{M}(S)$ is connected, which is essential for the set $\mathcal{M}(S)$ to be a moving sofa. We will fill the gap in his argument by proving that $\mathcal{M}(S)$ is indeed connected.

> __Theorem [monotonization-is-sofa].__ Let $S$ be a moving sofa with rotation angle $\omega$ satisfying $p_S(\omega) = p_S(\pi/2) = 1$. Then the monotonization $\mathcal{M}(S)$ is connected, and thus a moving sofa with rotation angle $\omega$ containing $S$ by [[07. Moving Hallway Problem#^thm-moving-sofa-iff-hallway-intersection]]. ^thm-monotonization-is-sofa

> __Definition [monotone-sofa].__ Call a moving sofa _monotone_ if it is a monotonization of some sofa. ^def-monotone-sofa

We will prove [[10. Monotonization#^thm-monotonization-is-sofa]] at the very end of this subsection. Once [[10. Monotonization#^thm-monotonization-is-sofa]] is proved, we can safely assume that a sofa of maximum area is monotone because the monotone sofa $\mathcal{M}(S)$ contains the original sofa $S$ by [[10. Monotonization#^cor-monotonization-contains]]. 

# Structure of monotonization

It turns out that every monotonization $\mathcal{M}(S)$ of a sofa $S$ is equal to $K \setminus \mathcal{N}(K)$ where $K = \mathcal{C}(S)$ is a convex set called _the cap of_ $S$ and $\mathcal{N}(K)$ is a set called the _niche_ determined by the cap $K$. This structure of $\mathcal{M}(S)$ will used thoroughout the rest of the paper including the proof of [[10. Monotonization#^thm-monotonization-is-sofa]]. We need a couple of definitions to describe this.

> __Definition [parallelogram].__ For any angle $\omega \in [0, \pi/2]$, define the _parallelogram_ $P_\omega = H \cap R_\omega(V)$ with _rotation angle_ $\omega$.

If $\omega = \pi / 2$, then $P_\omega$ is the horizontal strip $H$. If $\omega < \pi/2$, $P_\omega$ is a proper parallelogram with the following points as vertices.

> __Definition [parallelogram-vertices].__ Let $O = (0, 0)$ be the origin, and note that if $\omega < \pi/2$ then $O$ is the upper-right corner of $P_\omega$. For any angle $\omega \in [0, \pi/2]$, define the point $o_\omega = (-\tan(\omega/2), -1)$ so that for any $\omega < \pi / 2$ the point $o_{\omega} = l(\omega, -1) \cap l(\pi/2, -1)$ is the lower-left corner of $P_\omega$. ^def-parallelogram-vertices

We also define the notion of a fan.

> __Definition [fan].__ For any angle $\omega \in [0, \pi/2]$, define the _fan_ $F_\omega = H(\pi+\omega, 1) \cap H(3\pi/2, 1)$ with angle $\omega$ as the convex cone pointed at $o_\omega$ bounded by the bottom edges of $P_\omega$. ^def-fan

We define the notion of a _cap_ as a convex body satisfying certain properties. 

> __Definition [angle-set].__ A set $\Theta$ is an _angle set_ with _rotation angle_ $\omega \in [0, \pi/2]$ if $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq [0, \omega]$ and $\Theta$ is closed. ^def-angle-set

> __Definition [cap].__ Let $\Theta$ be an angle set with rotation angle $\omega$. A _cap_ $K$ with _angle set_ $\Theta$ (and _rotation angle_ $\omega$) is a convex body such that the followings hold. ^def-cap
> 
> 1. $p_K(\omega) = p_K(\pi/2) = 0$ and $p_K(\pi + \omega) = p_K(3\pi/2) = 1$.
> 2. $K$ is an intersection of half-planes with normal angles in $\Pi = \Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$.

Geometrically, the first condition of [[10. Monotonization#^def-cap]] states that $K$ is contained in the parallelogram $P_\omega$ and touches all sides of $P_\omega$.

Now we are ready to describe the structure of monotonization $\mathcal{M}(S)$ where $S$ is an arbitrary moving sofa with rotation angle $\omega \in [0, \pi/2]$ satisfying $p_S(\omega) = p_S(\pi/2) = 0$ without loss of generality. By breaking down each $L_S(t)$ into $Q_S^+(t) \setminus Q_S^-(t)$, we get the following representation of $\mathcal{M}(S)$ as a subtraction of two sets. ^eqn-monotonization
$$
\begin{split}
\mathcal{M}(S) & = P_\omega \cap \bigcap_{0 \leq t \leq \omega} L_S(t) = \left( P_\omega \cap \bigcap_{0 \leq t \leq \omega} Q^+_S(t) \right) \setminus \left( F_\omega \cap \bigcup_{0 \leq t \leq \omega} Q^-_S(t) \right)
\end{split}
$$
So $\mathcal{M}(S)$ is a subtraction of two sets. The first set $K = P_\omega \cap \bigcap_{0 \leq t \leq \omega} Q^+_S(t)$ is convex and we will soon show that $K$ satisfies [[10. Monotonization#^def-cap]] of a cap with angle set $\Theta = [0, \omega]$. With this, we will call $K$ _the cap of moving sofa_ $S$. We will also show that the second set $N = F_\omega \cap \bigcup_{0 \leq t \leq \omega} Q^-_S(t)$ is completely determined by the cap $K$. With this, we will define $N$ as _the niche of cap_ $K$. Imagine the set $K$ as a block of clay and rotate it inside the hallway $L$ in the clockwise angle of $\omega$ while touching the outer walls $a$ and $c$ of $L$. The intuition is that as $K$ rotates inside $L$, the inner corner of $L$ carves out the set $N$ from $K$, so that the final clay $K \setminus N$ is the monotone sofa $\mathcal{M}(S)$.

We now justify the full details of the previous paragraph. Define the first set of the subtraction in [[10. Monotonization#^eqn-monotonization]] as $\mathcal{C}(S)$.

> __Definition [cap-sofa].__ Let $S$ be any moving sofa with rotation angle $\omega \in [0, \pi/2]$ and $p_S(\omega) = p_S(\pi/2) = 0$. Define ^def-cap-sofa
$$
\mathcal{C}(S) = P_\omega \cap \bigcap_{0 \leq t \leq \omega} Q^+_S(t).
$$

> __Theorem [cap-hallway-intersection].__ The set $\mathcal{C}(S)$ in [[10. Monotonization#^def-cap-sofa]] is a cap with angle set $[0, \omega]$ containing $S$ as a subset. With this, call $\mathcal{C}(S)$ as _the cap of moving sofa_ $S$. ^thm-cap-hallway-intersection

_Proof._ Let $K = \mathcal{C}(S)$. That $S \subseteq K$ is an immediate consequence of [[10. Monotonization#^cor-monotonization-contains]] and $L_K(t) \subseteq Q_K^+(t)$. We now show that $K$ is a cap with angle set $[0, \omega]$. Define the following subset of $P_\omega$.

> __Definition [middle-set].__ For every $\omega \in [0, \pi/2]$, define $M_\omega$ as the convex hull of the points $O, -u_\omega, -v_0,$ and $o_\omega$. ^def-middle-set

Geometrically, $M_\omega$ is a subset of $P_\omega$ enclosed by the perpendicular legs from $O$ to the bottom sides of $P_\omega$. We also introduce the following terminologies.

> __Definition [further-in-direction].__ Say that a point $p_1$ is _further than_ (resp. _strictly further than_) the point $p_2$ _in the direction_ of vector $v \in \mathbb{R}^2$ if $p_1 \cdot v \geq p_2 \cdot v$ (resp. $p_1 \cdot v > p_2 \cdot v$). ^def-further-in-direction

> __Definition [closed-in-direction].__ Say that a set $X \subseteq \mathbb{R}^2$ is _closed in the direction of_ vector $v \in \mathbb{R}^2$ if, for any $x \in X$ and $\lambda \geq 0$, we have $x + \lambda v \in X$. ^def-closed-in-direction

We show the following lemma to prove that $K$ is a cap with angle set $[0, \omega]$.

> __Lemma [cap-contains-middle-set].__ The set $\mathcal{C}(S)$ in [[10. Monotonization#^def-cap-sofa]] contains $M_\omega$. ^lem-cap-contains-middle-set

We can prove [[10. Monotonization#^lem-cap-contains-middle-set]] as the following. From $p_S(\omega) = p_S(\pi/2) = 0$, we can take points $q$ and $r$ of $S$ so that $q$ is on the line $l(\pi/2, 0)$ further than $O$ in the direction of $-u_0$, and $r$ is on the line $l(\omega, 0)$ further than $O$ in the direction of $-v_\omega$. Take arbitrary $t \in [0, \omega]$. Because $Q^+_S(t)$ is a right-angled convex cone with normal vectors $u_t$ and $v_t$ containing $q$ and $r$, $Q_S^+(t)$ also contains $O$. Because $Q_S^+(t)$ contains $O$ and is closed in the direction of $-u_t$ and $-v_t$, $Q_S^+(t)$ contains $M_\omega$ as a subset.

Now we finish the proof that $K$ is a cap with angle set $[0, \omega]$. By [[10. Monotonization#^def-cap-sofa]] and [[10. Monotonization#^lem-cap-contains-middle-set]] we have $M_\omega \subseteq K \subseteq P_\omega$. So the first condition of [[10. Monotonization#^def-cap]] is satisfied. The second condition of [[10. Monotonization#^def-cap]] comes from that $P_\omega$ is the intersection of four half-planes with normal angles $\omega, \pi/2, \pi + \omega, 3\pi/2$, and $Q_S^+(t)$ is an intersection of two half-planes with normal angles $t$ and $\pi/2 + t$. □

The tangent hallways of a moving sofa $S$ are exactly same as the tangent hallways of its cap $K = \mathcal{C}(S)$. 

> __Proposition [cap-same-support-function].__ Let $S$ be any moving sofa with rotation angle $\omega \in [0, \pi/2]$ such that $p_S(\omega) = p_S(\pi/2) = 0$. Let $K = \mathcal{C}(S)$ be its cap. Then the support functions $p_S$ and $p_K$ of $S$ and $K$ agree on the set $[0, \omega] \cup [\pi/2, \pi/2 + \omega]$. Consequently, the tangent hallways $L_S(t)$ and $L_K(t)$ of $S$ and $K$ are equal for any $t \in [0, \omega]$. ^pro-cap-same-support-function

We omit the proof of [[10. Monotonization#^pro-cap-same-support-function]]. With [[07. Moving Hallway Problem#^pro-cap-same-support-function]], we have $Q^-_S(t) = Q^-_K(t)$ in particular. So we can define the set $N$ (equation [[#^eqn-niche]]) purely in terms of the cap $K = \mathcal{C}(S)$ as the following.

> __Definition [niche].__ Let $K$ be any cap with rotation angle $\omega \in [0, \pi/2]$ and angle set $\Theta \subseteq [0, \omega]$. Define the _niche_ of $K$ as the following. ^def-niche
$$
\mathcal{N}(K) = F_{\omega} \cap \bigcup_{t \in \Theta} Q^-_K(t)
$$

By [[10. Monotonization#^eqn-monotonization]] we have the following structure of a monotonization of a moving sofa.

> __Theorem [monotonization-structure].__ Let $S$ be any moving with rotation angle $\omega$ satisfying $p_S(\omega) = p_S(\pi/2) = 1$. Then the monotonization of $S$ is $\mathcal{M}(S) = K \setminus \mathcal{N}(K)$ where $K = \mathcal{C}(S)$ is the cap of $S$ with angle set $[0, \omega]$ and $\mathcal{N}(K)$ is the niche of $K$. ^thm-monotonization-structure

# Connectedness of monotonization

We now show the connectedness of the monotonization $\mathcal{M}(S)$ of a moving sofa $S$ as promised. 

_Proof._ (of [[10. Monotonization#^thm-monotonization-is-sofa]])

We show that $\mathcal{M}(S)$ is connected. Fix an arbitrary point $p$ in $\mathcal{M}(S)$. Take the line $l_\theta$ passing $p$ that makes an arbitrary angle $\theta \in [\omega, \pi/2]$ with the $x$-axis. Observe that $l_\theta \cap \mathcal{M}(S)$ is a nonempty line segment because $\bigcup_{t \in [0, \omega]} Q^-_S(t)$ is closed in the direction of $-u_\theta$. So the line $l_\theta$ meets $S$ for any $\theta$, then $p$ is connected to $S$ inside $\mathcal{M}(S)$ and the proof is done. Our goal now is to prove that there is some $\theta \in [\omega, \pi/2]$ such that $l_\theta$ meets $S$. Assume by contradiction that for any $\theta \in [\omega, \pi/2]$ the line $l_\theta$ is disjoint from $S$.

As $S \subseteq \mathcal{M}(S) \subseteq \mathcal{C}(S)$ and the support function of $S$ and $\mathcal{C}(S)$ agrees on the set $[0, \omega] \cup [\pi/2, \pi/2 + \omega]$, the support function of $\mathcal{M}(S)$ also agrees with that of $S$ on $[0, \omega] \cup [\pi/2, \pi/2 + \omega]$. As $p \in \mathcal{M}(S)$, the line $l_{\pi/2}$ is either equal to $l_{\mathcal{M}(S)}(0) = l_S(0)$ or strictly on the left side of $l_{S}(0)$. The line $l_{\pi/2}$ can't be equal to $l_S(0)$ because otherwise, $l_{\pi/2}$ contains some point of $S$ contradicting our assumption. So the line $l_{\pi/2}$ is strictly on the left side of $l_{S}(0)$, and there is a point of $S$ strictly on the right side of $l_{\pi/2}$.

Likewise, as $p \in \mathcal{M}(S)$, the line $l_{\omega}$ that passes through $p$ is either equal to $l_{\mathcal{M}(S)}(\omega + \pi/2) = l_S(\omega + \pi/2)$ or strictly on the right side of $l_S(\omega + \pi/2)$. The line $l_\omega$ cannot be equal to $l_S(\omega + \pi/2)$ as we assumed that $l_\omega$ is disjoint from $S$. So the line $l_{\omega}$ is strictly on the right side of $l_S(\omega + \pi/2)$, and there is a point of $S$ strictly on the left side of $l_{\omega}$.

As the line $l_\theta$ is disjoint from $S$ for any $\theta \in [\omega, \pi/2]$, the set $S$ is inside the set $X = \mathbb{R}^2 \setminus \bigcup_{\theta \in [\omega, \pi/2]} l_\theta$. Note that $X$ has exactly two connected components $X_L$ and $X_R$ on left and right respectively. As there is a point of $S$ strictly on the right side of $l_{\pi/2}$, $S \cap X_R$ is nonempty. As there is also a point of $S$ strictly on the left side of $l_\omega$, $S \cap X_L$ is also nonempty. We get contradiction as $S$ is a connected subset of $X$. 

As the set $\mathcal{M}(S)$ is connected, and satisfies the second condition of [[07. Moving Hallway Problem#^thm-moving-sofa-iff-hallway-intersection]] by definition, $\mathcal{M}(S)$ is a moving sofa with rotation angle $\omega$. By [[07. Moving Hallway Problem#^cor-monotonization-contains]], the moving sofa $\mathcal{M}(S)$ contains $S$. We observed that the support function of $\mathcal{M}(S)$ agrees with that of $S$ on $\Theta \cup (\Theta + \pi/2)$, so the cap of $\mathcal{M}(S)$ is equal to the cap of $S$. □

In the proof of [[10. Monotonization#^thm-monotonization-is-sofa]] we showed that the support function of $\mathcal{M}(S)$ is equal to that of $S$ on $[0, \omega] \cup [\pi/2, \pi/2 + \omega]$. So a sofa and its monotonization shares the same cap.

> __Corollary [monotonization-cap].__ The monotonization $\mathcal{M}(S)$ of any sofa $S$ with rotation angle $\omega \in [0, \pi/2]$ shares the same cap with $S$. That is, $\mathcal{C}(\mathcal{M}(S)) = \mathcal{C}(S)$. ^cor-monotonization-cap

Consequently, any monotone sofa $S$ is equal to its cap $K = \mathcal{C}(S)$ subtracted by its niche $\mathcal{N}(K)$ by [[#^thm-monotonization-structure]] and [[#^thm-monotonization-is-sofa]]. So monotization $S \mapsto \mathcal{M}(S)$ could be said as a 'projection' to monotone sofas in the sense that $\mathcal{M}$ is a surjective idempotent map that fixes monotone sofas.