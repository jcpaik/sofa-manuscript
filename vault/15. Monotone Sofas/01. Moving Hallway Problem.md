In this section, we define a _hallway intersection in standard position_ as a certain set contained in rotated hallways and strips ([[01. Moving Hallway Problem#^def-hallway-intersection]], [[01. Moving Hallway Problem#^def-standard-position]]) and show that a sofa is essentially such a set ([[01. Moving Hallway Problem#^thm-sofa-iff-hallway-intersection]]).

%% TODO: say that this chapter monotizes the movement %%

We observed that a sofa is essentially the intersection of rotating hallways in the introduction. Let us now examine this idea in full details. Let $S$ be a sofa with rotation angle $\omega \in [0, \pi/2]$ with the movement $f_t$ and time $t \in [a, b]$. So the sofa $S$ in movement at time $t$ is positioned at $S_t = f_t(S) \subseteq L$ inside the hallway and $S_a \subseteq L_H$, $S_b \subseteq L_V$ holds. Without loss of generality, we can assume that the sofa $S$ is equal to its initial position $S_a$ of the movement so that $f_a$ is the identity map on $\mathbb{R}^2$. 

In perspective of the sofa, $S$ is always contained in the rotating hallway $L_t = f_t^{-1}(S)$ for any time $t \in [a, b]$. Now note that the initial hallway $L_a$ is a translation of $L$ and the final $L_b$ is a translation of $L$ rotated counterclockwise by an angle of $\omega$. By the intermediate value theorem on the roation angle of $L_t$ for $a \leq t \leq b$, a sofa $S$ is always contained in some hallway rotated counterclockwise by an angle of $\theta$ for any $\theta \in [0, \omega]$. Also, the initial sofa $S = S_a$ should be in $H$, and the final sofa $S_b = f_b(S)$ should be in $V$, so that $S$ is also contained in $f_b^{-1}(V)$ which is the vertical strip rotated counterclockwise by $\omega$. Thus, a sofa $S$ with rotation angle $\omega \in [0, \pi/2]$ is contained in hallways rotated by any angle in $[0, \omega]$, and translations of strips $H$ and $R_\omega(V)$ where $R_\omega$ is the rotation of the plane along the origin by a counterclockwise angle of $\omega$ ([[01. Sofa#^def-rigid-motion]]). Summing up, $S$ adheres to the definition below with $\Theta = [0, \omega]$.

> __Definition [hallway-intersection].__ A shape $S$ is a _hallway intersection_ with _rotation angle_ $\omega \in [0, \pi/2]$ and _angle set_ $\Theta \subseteq \left[ 0, \omega \right]$ if the followings hold.
> ^def-hallway-intersection
> 
> - $S$ is connected.
> - $\Theta$ is a closed set such that $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq [0, \omega]$.
> - For every $\theta \in \Theta$, $S$ is contained in a translation of $R_\theta(L)$, the hallway rotated counterclockwise by an angle of $\theta$.
> - $S$ is contained in a translation of $H$ and $R_\omega(V)$.

We generalized the definition to an arbitrary set $\Theta$ of angles for future use. We will carry the rest of the argument with a general angle set $\Theta$, but mentally it helps to think of the case where $S$ is a sofa and the angle set $\Theta$ is $[0, \omega]$. Define the parallelogram $P_\omega$ as the intersection of two strips $H$ and $R_\omega(V)$ of width 1.

> __Definition [parallelogram].__ For any angle $\omega \in [0, \pi/2]$, define the _parallelogram_ $P_\omega = H \cap R_\omega(V)$ with rotation angle $\omega$ as the intersection of the horizontal strip $H = \mathbb{R} \times [0, 1]$, and the vertical strip $V = [0, 1] \times \mathbb{R}$ rotated counterclockwise by an angle of $\omega$ centered at the origin. For any $\omega \in [0, \pi/2)$ let $p_{\omega} = l(\omega, 1) \cap l(\pi/2, 1)$ be the upper-right corner of the parallelogram. ^def-parallelogram

Note that $P_\omega$ is a proper parallelogram if $\omega < \pi/2$, and the horizontal strip $H$ if $\omega = \pi/2$. Let us push $S$ towards the upper edges $l(\omega, 1)$ and $l(\pi/2, 1)$ inside $P_\omega$. This puts $S$ in _standard position_ defined as the following.

> __Definition [standard-position].__ Say that a shape $S$ is in _standard position_ with respect to the _rotation angle_ $\omega \in [0, \pi/2]$ if the followings hold. ^def-standard-position
> 
> - $S$ is contained in the parallelogram $P_{\omega}$.
> - $p_{S}(\omega)=p_S(\pi/2)=1$. In other words, $S$ touches the sides $l(\omega, 1)$ and $l(\pi/2, 1)$ of the parallelogram $P_\omega$.

The discussion above summarizes to that a sofa with rotation angle $\omega$ is always a hallway intersection with angle set $\Theta = [0, \omega]$.

> __Corollary [sofa-is-hallway-intersection].__ Let $S$ be any sofa with rotation angle $\omega \in [0, \pi/2]$. Then there is a rigid transformation $f$ such that $f(S)$ is a hallway intersection in standard position with rotation angle $\omega$ and angle set $[0, \omega]$. ^cor-sofa-is-hallway-intersection

_Proof._ From the discussions above, the initial position $S_a$ of $S$ in movement is a hallway intersection with angle set $[0, \omega]$. By pushing $S_a$ towards the upper edges of $P_\omega$ it can be put in standard position while still being a hallway intersection. □

From now on, assume an arbitrary hallway intersection $S$ in standard position with rotation angle $\omega$ and angle set $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq [0, \omega]$ (again, it helps to think of the case where $S$ as a sofa in standard position with $\Theta = [0, \omega]$, although the proofs work for general $\Theta$). For any angle $t \in \Theta$, the set $S$ is contained in some hallway $L_t$ rotated counterclockwise by $t$. By pushing $L_t$ towards $S$ as much as we can until it touches $S$ in the outer walls, we get a _tangent hallway_ $L_S(t)$ rotated counterclockwise by $t$ that still contains $S$. We formally define $L_S(t)$ as the following.

> __Definition [tangent-hallway].__ For any shape $S$ and angle $t \in S^1$, let the _tangent hallway_ $L_S(t)$ of $S$ with angle $t$ be the unique rigid transformation of $L$ rotated counterclockwise by an angle of $t$, touching $S$ in the outer walls. Formally, define the rigid transformation $g_S(t)$ as the map $g_S (t) = R_t \circ T_{\left( p_S(t) - 1, p_S(t + \pi/2) - 1 \right)}$, then the hallway is $L_S(t) = [g_S(t)](L)$. ^def-tangent-hallway

The map $g_S(t)$ is constructed so that it sends the standard hallway $L$ with $p_L(0) = p_L(\pi/2) = 1$ to the hallway $L' = L_S(t)$ with $p_{L'}(t) = p_{S}(t)$ and $p_{L'}(t + \pi/2) = p_{S}(t + \pi/2)$. That is, the map $g_S(t)$ sends the outer walls $a$ and $c$ of the hallway $L$ to the tangent lines $l_S(t)$ and $l_{S}(t + \pi/2)$. Note that this definition of $L_S(t)$ generalizes to any shape $S$ which may not be a hallway intersection as well. Let us give names to the sides and corners of $L_S(t)$.

> __Definition [rotating-hallway-parts].__ Let $Q^+ = (-\infty, 1]^2$ be the closed quarter-plane bounded by outer walls $a$ and $c$. Let $Q^- = (-\infty, 0)^2$ be the open quarter-plane bounded by inner walls $b$ and $d$, so that $L = Q^+ \setminus Q^-$. ^def-rotating-hallway-parts
> 
> For any shape $S$ and angle $t \in S^1$, let $a_S(t), b_S(t), c_S(t), d_S(t), \mathbf{x}_S(t), \mathbf{y}_S(t)$ be the parts of $L_S(t)$ corresponding to the parts $a, b, c, d, \mathbf{x}, \mathbf{y}, Q^+, Q^-$ of $L$ respectively. For example, $b_S(t) = f_S(b)$.

We observe the following immediate corollary of [[01. Moving Hallway Problem#^def-tangent-hallway]].

> __Corollary [tangent-hallway].__ For any shape $S$ and angle $t \in S^1$, the outer walls of $L_S(t)$ are $a_S(t) = l_S(t)$ and $c_S(t) = l_S(t + \pi/2)$ and the quarter-plane $Q^+_S(t)$ bounded by the outer walls is $Q^+_S(t) = H_S(t) \cap H_S(t + \pi/2)$. ^cor-tangent-hallway

We show that for a hallway intersection $S$, the pushed hallway $L_S(t)$ also contains $S$ for any $t \in \Theta$. This fact is crucial in monotonizing the shape of an arbitrary sofa.

> __Theorem [in-tangent-hallway].__ Let $S$ be an arbitrary shape contained in some hallway $L'$ rotated counterclockwise by an angle of $t \in S^1$. Then the tangent hallway $L_S(t)$ of $S$ contains $S$ as well. Consequently, for any hallway intersection $S$ with angle set $\Theta$, the tangent hallway $L_S(t)$ contains $S$ for any $t \in \Theta$. ^thm-in-tangent-hallway

_Proof._ First we show the case where $L' = L$ so that $t=0$. Our goal is to show that $L_S(0)$ also contains $S$. As $S \subseteq L$ we have $p_S(0) \leq 1$ and $p_S(\pi/2) \leq 1$. Let $(x_0, y_0)$ be the coordinate of $\mathbf{x}(0)$, then by [[01. Moving Hallway Problem#^def-tangent-hallway]] we have $x_0, y_0 \leq 0$. So $Q^-_S(0)$ is a subset of $(-\infty, 0)^2$ and disjoint from $S$. By [[#^cor-tangent-hallway]] $Q_S^+(0)$ contains $S$. Now $S \subseteq L = Q^+_S(0)\setminus Q^-_S(0)$, proving the goal. We move on to the general case and let $f$ be the rigid transformation that sends $L'$ to $L$. We have $f(S) \subseteq L'$ so $f(S) \subseteq L_{f(S)}(0)$ by the special case we have just shown. Observe that $L_{f(S)}(0) = f(L_S(t))$ holds by [[01. Moving Hallway Problem#^def-tangent-hallway]], as $f$ maps the hallway $L_S(t)$ touching $S$ in its outer walls with rotation angle $t$ to a hallway that touches $f(S)$ in its outer walls with rotation angle $0$. So we have $f(S) \subseteq f(L_S(t))$ and $S \subseteq L_S(t)$. □

> __Remark [in-tangent-hallway].__ [[#^thm-in-tangent-hallway]] depends crucially on the fact that the set $Q^-$ is closed in the direction of $-u_t$ for every $t \in [0, \pi/2]$. Otherwise, even if a hallway $L$ contains $S$ the pushed hallway $L_S(0)$ may not contain $S$. ^rem-in-tangent-hallway

We can finally show a sofa is essentially equivalent to a hallway intersection. That is, any hallway intersection $S$ with angle set $[0, \omega]$ admits a sofa movement $f_S(t) = [g_S(t)]^{-1}$. This movement is _monotonized_ as it is always guaranteed that the sofa $S_t = [f_S(t)](S)$ in movement is rotated clockwise by $t$ and always touches the outer walls of $S$.

> __Theorem [sofa-iff-hallway-intersection].__ If $S$ is a hallway intersection in standard position with angle set $[0, \omega]$ for $\omega \in [0, \pi/2]$, then $S$ is a sofa with rotation angle $\omega$ and the movement $f_S(t) = [g_S(t)]^{-1}$ for $t \in [0, \omega]$. Consequently, a shape $S$ is a sofa with rotation angle $\omega \in [0, \pi/2]$ if and only if there is a rigid transformation $f$ so that $f(S)$ is a hallway intersection in standard position with angle set $[0, \omega]$ ^thm-sofa-iff-hallway-intersection

_Proof._ We check that the map $f_S(t) = [g_S(t)]^{-1}$ with arbitrary $t \in [0, \omega]$ sending $L_S(t)$ to $L$ is a sofa movement of $S$. By the definition of $g_S (t) = R_t \circ T_{\left( p_S(t) - 1, p_S(t + \pi/2) - 1 \right)}$ ([[01. Moving Hallway Problem#^def-tangent-hallway]]) and continuity of $p_S$, $f_S(t)$ is also continuous respect to $t \in [0, \omega]$. By [[01. Moving Hallway Problem#^thm-in-tangent-hallway]], $L_S(t)$ always contains $S$ for all $t \in [0, \omega]$ so $[f_S(t)](S) \subseteq L$ for every $t \in [0, \omega]$. As $S$ is in standard position, $p_S(\omega) = p_S(\pi/2) = 1$ and so by [[#^cor-tangent-hallway]]  $l(\omega, 1)$ is the wall $a_S(\omega)$ and $l(\pi/2, 1)$ is the wall $c_S(0)$. This implies that $L_S(0)$ is a horizontal translation of $L$ and $L_S(\omega)$ is a translation of $R_\omega(L)$ in the direction $v_\omega$. So the transformation $g_S(0)$ fixes $H$ and $g_S(\omega)$ maps $V$ to $R_\omega(L)$. As $S$ is in standard position, $S \subseteq H = [g_S(0)](H)$ and $S \subseteq R_\omega(L) = [g_S(\omega)](V)$. That is, $[f_S(0)](S) \subseteq H$ and $[f_S(\omega)](S) \subseteq V$ and the movement $f_S(t)$ satisfies the boundary conditions as well.

With [[01. Moving Hallway Problem#^cor-sofa-is-hallway-intersection]], it remains to show that if $S$ is a hallway intersection in standard position with angle set $[0, \omega]$ then $S$ is a sofa with rotation angle $\omega$. □