Define the space of all caps $K$ with a fixed angle set $\Theta$ ([[10. Monotonization#^def-cap]]) as follows.

> __Definition [cap-space].__ Take any $\omega \in (0, \pi/2]$ and a closed set $\Theta$ such that $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq [0, \omega]$. Define the _space of caps_ $\mathcal{K}_\Theta$ with the _angle set_ $\Theta$ as the collection of all caps $K$ with angle set $\Theta$. If the angle set is $\Theta = [0, \omega]$, denote the space $\mathcal{K}_{[0, \omega]}$ simply as $\mathcal{K}_\omega$. ^def-cap-space

In [[15. Cap contains niche#^rem-niche-not-in-cap]], we observed that not all caps $K \in \mathcal{K}_\omega$ are the caps $\mathcal{C}(S)$ associated to some monotone sofa $S$ with rotation angle $\omega$. Denote $\mathcal{M}_\omega$ as the subset of $\mathcal{K}_\omega$ consisting of such caps $\mathcal{C}(S)$ associated to some monotone sofa $S$ with rotation angle $\omega$ (which is identified in [[15. Cap contains niche#^thm-monotonization-connected-iff]]).

Define the _sofa area functional_ $\mathcal{A}(K)$ on the space of caps $\mathcal{K}_\Theta$ or $\mathcal{K}_\omega$ as essentially the area of the sofa with cap $K$.

> __Definition [sofa-area-functional].__ For any angle $\omega \in [0, \pi/2]$ and a closed angle set $\left\{ 0, \omega \right\} \subseteq \Theta \subseteq [0, \omega]$, define the _sofa area functional_ $\mathcal{A}_{\Theta} : \mathcal{K}_\Theta \to \mathbb{R}$ on the space of caps $\mathcal{K}_\Theta$ as $\mathcal{A}_{\Theta}(K) = |K| - |\mathcal{N}(K)|$. Denote $\mathcal{A}_{[0, \omega]}$ as simply $\mathcal{A}_\omega$. Omit the subscript of $\mathcal{A}$ if the domain $\mathcal{K}_\Theta$ or $\mathcal{K}_\omega$ is clear from context. ^def-sofa-area-functional

In this subsection, we change the moving sofa problem to the maximization of the _sofa area functional_ $\mathcal{A} : \mathcal{K}_\omega \to \mathbb{R}$ on the convex space $\mathcal{K}_\omega$ of caps. A drawback is that the new problem is subtly harder from the original moving sofa problem, as the space $\mathcal{K}_\omega$ is strictly larger than the moving sofas. Also, the function $\mathcal{A}$ by itself is likely not a convex function. However, the benefit is that the domain $\mathcal{K}_\omega$ of $\mathcal{A}$ is now a convex space, allowing convex upper bounds of $\mathcal{A}$ that are amenable to convex analysis in future.

Also note that the area of $S$ depends solely on the cap $K$. So with [[#^thm-niche-in-cap]], we can turn the moving sofa problem into maximizing the sofa area functional $\mathcal{A}(K) = |K| - |\mathcal{N}(K)|$ of an arbitrary cap $K$.



Fix an arbitrary angle $\omega \in [0, \pi/2]$. Define $\mathcal{M}_\omega$ as the subset of $\mathcal{K}_\omega$ consisting of the caps of monotone sofas. By [[15. Cap contains niche#^thm-niche-in-cap]], maximizing the area of a moving sofa with rotation angle $\omega$ is exactly same as maximizing the sofa area functional $\mathcal{A}$ on the subset $\mathcal{M}_\omega$ of $\mathcal{K}_\omega$. Note that $\mathcal{M}_\omega$ is a proper subset of $\mathcal{K}_\omega$. For example, if the cap $K \in \mathcal{K}_\omega$ is too wide in width, then the niche $\mathcal{N}(K)$ may extrude out of $K$ so that $K$ cannot be the cap of a monotone sofa. But in practice we will basically optimize $\mathcal{A}(K)$ for all $K \in \mathcal{K}_\omega$ and show that the maximum is attained by the cap $K_G$ of Gerver's sofa.

> __Conjecture [gerver-cap].__ The cap $K = K_G$ of Gerver's sofa $S_G$ attains the maximum value of the area functional $\mathcal{A}(K)$ over all rotation angle $\omega \in [0, \pi/2]$ and caps $K \in \mathcal{K}_\omega$. ^con-gerver-cap

So [[15. Cap contains niche#^con-gerver-cap]] is a generaliztion of Gerver's conjecture. Extending the domain of the problem as in [[15. Cap contains niche#^con-gerver-cap]] actually will make the problem easier as we will later see that the space $\mathcal{K}_\omega$ is a _convex space_, while we don't know if the set $\mathcal{M}_\omega$ is convex or not. This however risks that 

In [[15. Cap contains niche#^con-gerver-cap]], we turned the moving sofa problem into optimizing the sofa area functional $\mathcal{A} : \mathcal{K}_\omega \to \mathbb{R}$ on the space of caps $\mathcal{K}_\omega$. Our main observation here is that the space of caps $\mathcal{K}_\omega$ is a _convex space_. A set $\mathcal{K}$ is a convex space if it is equipped with a convex combination operation $c_\lambda(-, -) : \mathcal{K} \times \mathcal{K} \to \mathcal{K}$ for every $\lambda \in [0, 1]$ such that it satisfies a set of axioms matchiing the properties of convex-linear combination in a real vector space (e.g. Axioms 1-4 of [[@nlab-convex-space]]). Any real vector space $V$ is a convex space with $c_\lambda(v_1, v_2) = (1 - \lambda) v_1 + \lambda v_2$. For the space of caps $\mathcal{K}_\Theta$, define their convex combination as $c_\lambda(K_1, K_2) = (1-\lambda) K_1 + \lambda K_2$ using the Minkowski sum. Then it is rountine to check that the combination is also a cap with rotation angle $\omega$, and that the combination satisfies the axioms of convex space.

# Calculus of Variation

Many values on the cap $K \in \mathcal{K}_\omega$ are convex-linear. 



The support function $p_K$ is convex-linear with respect to $K \in \mathcal{K}_\omega$. For an arbitrary angle $t \in S^1$, the vertices $A_K^+(t), A_K^-(t), C_K^+(t), C_K^-(t)$ ([[15. Cap contains niche#^def-cap-vertices]]) are all convex-linear with respect to $K \in \mathcal{K}_\omega$. Likewise, the corners $\mathbf{x}_K(t)$ and $\mathbf{y}_K(t)$ are convex-linear with respect to $K \in \mathcal{K}_\omega$.