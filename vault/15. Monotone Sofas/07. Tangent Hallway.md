# Tangent hallway

We start by defining the _tangent hallways_ for a general shape $S$ (that is, any nonempty compact subset $S$ of $\mathbb{R}^2$ by [[05. Notations and conventions#^def-shape]]).

> __Definition [rotation-map].__ Define $R_\theta : \mathbb{R}^2 \to \mathbb{R}^2$ as the rotation map of $\mathbb{R}^2$ along the origin by a counterclockwise angle of $\theta \in S^1$. ^def-rotation-map

> __Definition [tangent-hallway].__ For any shape $S$ and angle $t \in S^1$, define the _tangent hallway_ $L_S(t)$ of $S$ with angle $t$ as the following. ^def-tangent-hallway
$$
L_S(t) = R_t(L) + (p_S(t) - 1)  u_t + (p_S(t + \pi/2) - 1) v_t
$$

%%
We explain the motivation behind the equation of $L_S(t)$ in [[15. Monotone sofas/07. Tangent hallway#^def-tangent-hallway]]. Observe first that $L_S(t)$ is a rigid transformation of $L$. The outer walls of $L$ are the lines $x=1$ and $y=1$. So its rotation $R_t(L)$ have outer walls $l(t, 1)$ and $l(t + \pi/2, 1)$. By pushing $R_t(L)$ in the direction of $u_t$ by $p_S(t) - 1$ and in the direction of $v_t$ by $p_S(t + \pi/2) - 1$, the resulting hallway $L_S(t)$ have the outer walls $l(t, p_S(t)) = l_S(t)$ and $l(t + \pi/2, p_S(t + \pi/2)) = l_S(t + \pi/2)$.
%%

We have the following [[07. Tangent hallway#^pro-tangent-hallway]] which is the defining property of $L_S(t)$.

> __Proposition [tangent-hallway].__ For any shape $S$ and angle $t \in S^1$, the tangent hallway $L_S(t)$ is the unique rigid transformation of $L$ rotated counterclockwise by $t$, such that the outer walls of $L_S(t)$ corresponding to the outer walls $a$ and $c$ of $L$ are the tangent lines $l_S(t)$ and $l_S(t + \pi/2)$ of $S$ respectively. ^pro-tangent-hallway

_Proof._ Let $c_1$ and $c_2$ be arbitrary real values. Then $L' = R_t(L) + c_1 u_t + c_2 v_t$ is an arbitrary rigid transformation of $L$ rotated counterclockwise by $t$. The outer walls of $L'$ corresponding to the outer walls $a$ and $c$ of $L$ are then $l(t, c_1 + 1)$ and $l(t + \pi/2, c_2 + 1)$. They match with $l_S(t) = l(t, p_S(t))$ and $l_S(t + \pi/2) = l(t + \pi/2, p_S(t + \pi/2))$ if and only if $c_1 = p_S(t) - 1$ and $c_2 = p_S(t + \pi/2) - 1$. That is, if and only if $L' = L_S(t)$. □

Name the parts of tangent hallway $L_S(t)$ according to the parts of $L$ ([[05. Notations and conventions#^def-hallway-corners]], [[05. Notations and conventions#^def-hallway-walls]], and [[05. Notations and conventions#^def-hallway-regions]]) for future use.

> __Definition [rotating-hallway-parts].__ For any shape $S$ and angle $t \in S^1$, let $\mathbf{x}_S(t), \mathbf{y}_S(t), a_S(t), b_S(t), c_S(t), d_S(t), Q^+_S(t), Q^-_S(t)$ be the parts of $L_S(t)$ corresponding to the parts $\mathbf{x}, \mathbf{y}, a, b, c, d, Q^+, Q^-$ of $L$ respectively. ^def-rotating-hallway-parts

> __Proposition [rotating-hallway-parts].__ With [[07. Tangent hallway#^def-rotating-hallway-parts]], we have $L_S(t) = Q_S^+(t) \setminus Q_S^-(t)$ and $Q^+_S(t) = H_S(t) \cap H_S(t + \pi/2)$ in particular. Also we have the following representations of the parts purely in terms of the supporting function $p_S$ of $S$. ^pro-rotating-hallway-parts
$$
\begin{gather*}
\mathbf{x}_S(t) = (p_S(t) - 1) u_t + (p_S(t + \pi/2) - 1) v_t \\
\mathbf{y}_S(t) = p_S(t) u_t + p_S(t + \pi/2) v_t \\
a_S(t) = l_S(t) = l(t, p_S(t)) \\
b_S(t) \subseteq l(t, p_S(t) - 1) \\
c_S(t) = l_S(t + \pi/2) = l(t + \pi/2, p_S(t + \pi/2)) \\
d_S(t) \subseteq l(t + \pi/2, p_S(t + \pi/2) - 1)
\end{gather*}
$$

_Proof._ The formulas for $a_S(t)$ and $c_S(t)$ comes from [[15. Monotone sofas/07. Tangent Hallway#^pro-tangent-hallway]]. The formulas for $b_S(t)$ and $d_S(t)$ comes from the fact that they are of distance 1 away from $a_S(t)$ and $c_S(t)$ respectively. The formulas for $\mathbf{x}_S(t)$ and $\mathbf{y}_S(t)$ comes from reading the coordinates of $\mathbf{x}_S(t) = a_S(t) \cap c_S(t)$ and $\mathbf{y}_S(t) = b_S(t) \cap d_S(t)$ with respect to orthogonal unit vectors $u_t$ and $v_t$. □

# Moving Hallway Problem

We introduce the notion of _standard position_ of a moving sofa.

> __Definition [standard-position].__ A moving sofa $S$ with rotation angle $\omega \in (0, \pi/2]$ is in _standard position_ if $p_S(\omega) = p_S(\pi/2) = 1$. ^def-standard-position

> __Proposition [standard-position].__ For any moving sofa $S$ with rotation angle $\omega \in (0, \pi/2]$, there is a translation of $S$ in standard position which is (i) unique if $\omega < \pi/2$, or (ii) unique up to horizontal translations if $\omega = \pi/2$. ^pro-standard-position

_Proof._ With [[05. Notations and conventions#^def-sofa]] of a moving sofa, any translation of a moving sofa $S$ with rotation angle $\omega \in (0, \pi/2]$ is still a moving sofa with rotation angle $\omega$. With [[01. Introduction/05. Notations and conventions#^pro-support-function]], observe that $S$ satisfies the condition $p_S(\omega) = p_S(\pi/2) = 1$ if and only if the lines $l(\omega, 1)$ and $l(\pi/2, 1)$ are tangent to $S$ above $S$. By translating $S$ below the lines $l(\omega, 1)$ and $l(\pi/2)$ so that it makes contact with them, we get the following. □

So any moving sofa can be assumed to be in standard position by translating it.

Assume any moving sofa $S$ with rotation angle $\omega \in (0, \pi/2]$. Gerver observed in [[@gerverMovingSofaCorner1992]] that $S$ should be contained in the tangent hallways $L_S(t)$ for all $t \in [0, \omega]$. We summarize the full details of his ideas (line 18-22, p269; line 24-31, p270 of [[@gerverMovingSofaCorner1992]]) as the following [[15. Monotone sofas/07. Tangent hallway#^thm-moving-sofa-iff-hallway-intersection]].

> __Definition [strip].__ Define the unit-width horizontal and vertical strips $H = \mathbb{R} \times [0, 1]$ and $V = [0, 1] \times \mathbb{R}$ respectively. ^def-strip

> __Definition [parallelogram].__ For any angle $\omega \in [0, \pi/2]$, define the _parallelogram_ $P_\omega = H \cap R_\omega(V)$ with _rotation angle_ $\omega$. ^def-parallelogram

> __Theorem [moving-sofa-iff-hallway-intersection].__ Let $\omega \in (0, \pi/2]$ be an arbitrary angle. For a connected shape $S$, the followings are equivalent. Note that $P_\omega$ is the parallelogram defined in [[05. Notations and conventions#^def-parallelogram]]. ^thm-moving-sofa-iff-hallway-intersection
> 
> 1. $S$ is a moving sofa with rotation angle $\omega$.
> 2. $S$ is contained in a translation of $H$ and $R_\omega(V)$. Also, for every $t \in [0, \omega]$, $S$ is contained in a translation of $R_t(L)$, the hallway rotated counterclockwise by an angle of $t$.
> 3. $S$ can be translated so that (i) $S$ is a moving sofa with rotation angle $\omega$ in stanard position (ii) $S \subseteq P_\omega$ (iii) and $S \subseteq L_S(t)$ for all $t \in [0, \omega]$.

_Proof._ We first prove the following propsition.

> __Proposition [tangent-hallway-contains].__ For any shape $S$ contained in a translation of $R_t(L)$ with an angle $t \in S^1$, the tangent hallway $L_S(t)$ with angle $t$ contains $S$. ^pro-tangent-hallway-contains

For the proof of [[15. Monotone sofas/07. Tangent Hallway#^pro-tangent-hallway-contains]], assume that an arbitrary shape $S$ is contained in a translation $L'$ of $R_t(L)$ for some angle $t$. Then while keeping $S$ inside $L'$, we can push $L'$ towards $S$ in the directions $-u_t$ and $-v_t$ until the outer walls of the final $L' = L_S(t)$ make contact with $S$. The pushed hallway $L_S(t)$ still contains $S$ because the directions $-u_t$ and $-v_t$ of movement only push the inner walls of $L'$ away from $S$, ending the proof of [[15. Monotone sofas/07. Tangent Hallway#^pro-tangent-hallway-contains]].

Now we prove the equivalence of the three conditions in [[07. Tangent hallway#^thm-moving-sofa-iff-hallway-intersection]].

(1 $\Rightarrow$ 2) Consider the movement of $S$ inside the hallway $L$. For any angle $t \in [0, \omega]$, there is a moment where the sofa $S$ is rotated clockwise by an angle of $t$ inside $L$. Viewing this from the perspective of the sofa $S$, $S$ is contained in some translation of $L$ rotated _counterclockwise_ by an arbitrary $t \in [0, \omega]$. Likewise, by looking at the initial (resp. final) position of $S$ inside $L_H$ (resp. $L_V$) from the perspective of $S$, the set $S$ is contained in a translation of $H$ and $R_\omega(V)$ respectively.

(2 $\Rightarrow$ 3) Without loss of generality, translate $S$ so that $p_S(\omega) = p_S(\pi/2) = 0$. Since $S$ is contained in a translation of $H$ and $R_\omega(V)$, the width of $S$ along the direction of $u_\omega$ and $v_0$ ([[05. Notations and conventions#^def-width]]) are at most 1. So $p_S(\omega) = p_S(\pi/2) = 1$ implies $S \subseteq P_\omega$.

Since the support function $p_S(t)$ of $S$ is continuous, the tangent hallway $L_S(t)$ moves continuously with respect to $t$ by [[07. Tangent hallway#^def-tangent-hallway]]. For every $t \in [0, \omega]$, let $f_t$ be the unique rigid transformation that maps $L_S(t)$ to $L$. Then the rigid transformation $S_t := f_t(S)$ of $S$ also moves continuously with respect to $t$. Because $S \subseteq L_S(t)$ by [[07. Tangent hallway#^pro-tangent-hallway-contains]], by mapping it to $f_t$ we also have $S_t \subseteq L$. Because $L_S(0)$ is a translation of $L$ by definition, $f_0$ is a translation map and so $S_0$ is a translation of $S$.

It remains to show that $S_0 \subseteq L_H$ and $S_\omega \in L_V$. Because $p_S(\pi/2) = 1$, $L_S(0)$ is a translation of $L$ along the direction $u_0$, and so the map $f_0$ is also a translation along the direction $u_0$. Because $S \subseteq H$, we also have $S_0 = f_0(S) \subseteq H$. Likewise, since $p_S(\omega) = 1$ the hallway $L_S(\omega)$ is a translation of $L$ along the direction $v_\omega$, and so the map $f_\omega$ is a translation along the direction $v_\omega$. Because $S \subseteq R_\omega(V)$, we also have $S_\omega = f_\omega(S) \subseteq R_\omega(V)$. 

(3 $\Rightarrow$ 1) is obvious. □

So by condition 2, any moving sofa $S$ is a common, connected subset of two strips of width 1 and the rotated hallways. And by condition 3, we can also assume that the rotated hallways containing $S$ are the tangent hallways $L_S(t)$ of $S$. For any moving sofa $S$ with rotation angle $\omega \in (0, \pi/2]$, we will now always work with its tangent hallways $L_S(t)$ for $t \in [0, \omega]$.