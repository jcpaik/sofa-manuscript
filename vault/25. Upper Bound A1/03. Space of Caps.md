In the previous section, we showed that a sofa $S$ of maximum area can be assumed to be a monotone sofa. Moreover, we showed that $S$ is equal to its cap $K = \mathcal{C}(S)$ subtracted by the niche $\mathcal{N}(K)$ of $K$. Finally, we showed that $K$ contains $\mathcal{N}(K)$, so the area of $S$ can be expressed as the function $\mathcal{A}(K) = |K| - |\mathcal{N}(K)|$ of $K$.

In this section, we change the problem of maximizing the area of $S$ to maximizing the _area functional_ $\mathcal{A}(K)$ on the space $\mathcal{K}_\omega$ of caps. We first define the space of all caps with rotation angle $\omega$.

> __Definition [cap-space].__ For any angle set $\Theta$, let $\mathcal{K}_\Theta$ be the space of all caps $K$ with angle set $\Theta$. For any rotation angle $\omega \in [0, \pi/2]$, define $\mathcal{K}_\omega = \mathcal{K}_{[0, \omega]}$. ^def-cap-space

Note that the space of caps $\mathcal{K}_\Theta$ is a _convex space_. In general, a convex space $\mathcal{K}$ is equipped with a convex combination operation $c_\lambda()$ such that it satisfies .  for every caps $K_1, K_2 \in \mathcal{K}_\Theta$ and any $\lambda \in [0, 1]$, define their convex combination $c_\lambda(K_1, K_2) = (1-\lambda) K_1 + \lambda K_2$ using the Minkowski sum. Then the combination is also a cap in $\mathcal{K}_\Theta$. This makes the space $\mathcal{K}_\Theta$ amenable to calculus of variation that we will invoke in later parts. 

In general, a functional $f : \mathcal{K} \to \mathbb{R}$ defined on a convex space $\mathcal{K}$ with convex combination $c_\lambda$ is called _convex-linear_ if $f(c_\lambda(K_1, K_2)) = (1-\lambda) f(K_1) + \lambda f(K_2)$. Accordingly, define a function $g : \mathcal{K} \times \mathcal{K} \to \mathbb{R}$ as _convex-bilinear_ if the maps $K \mapsto g(K, K_2)$ and $K \mapsto g(K_1, K)$ are convex-linear for any $K_1, K_2 \in \mathcal{K}$. In this paper, call a function $h : \mathcal{K} \to \mathbb{R}$ as _quadratic functional_ on $\mathcal{K}$ if $h(K) = g(K, K)$ for some convex-bilinear function $g$. We define which quadratic functional is positive/negative semidefinite. 

> __Definition [positive-semidefinite-quadratic-functional].__ Let $\mathcal{K}$ be any convex space. A quadratic functional $f : \mathcal{K} \to \mathbb{R}$ is _positive semidefinite_ (resp. _negative semidefinite_) if, for any $K_1, K_2 \in \mathcal{K}$ and $K = c_\lambda(K_1, K_2)$ for arbitrary $\lambda \in [0, 1]$, the quadratic polynomial $f(K)$ of $\lambda$ has non-negative (resp. non-positive) quadratic coefficient. ^def-positive-semidefinite-quadratic-functional

Note that the vertices $A^+_K, A^-_K, C^+_K, C^-_K$ of cap and the corners $\mathbf{x}_K$ and $\mathbf{y}_K$ of the tangent hallway $L_K(t)$ are convex-linear with respect to $K$ by [[yy. Geometric Results#^thm-convex-body-linear]]. Let us define what is a quadratic functional on a convex space.

> __Theorem [variation-maximizer].__ Let $f$ be a concave quadratic functional on a convex space $\mathcal{K}$. Then $K_1 \in \mathcal{K}$ attains the global maximum of $f$ if and only if for any $K_2 \in \mathcal{K}$, if we let $K = c_\lambda(K_1, K_2)$ for any $\lambda \in [0, 1]$ then we have $\left. \frac{d}{d\lambda} \right|_{\lambda = 0} f(K) \leq 0$. ^thm-variation-maximizer

_Proof._ If $K_1$ is indeed a maimizer of $f$, then the value $f(K)$ should attain its maximum at $\lambda = 0$ so the result $\left. \frac{d}{d\lambda} \right|_{\lambda = 0} f(K) \leq 0$ follows. Now we show that whenever $\left. \frac{d}{d\lambda} \right|_{\lambda = 0} f(K) \leq 0$ for any $K_2$, then $K_1$ is a maximizer. Assume otherwise that there is some $K_2$ such that $f(K_2) > f(K_1)$. Then we have $f(K) \geq (1-\lambda) f(K_1) + \lambda f(K_2)$ by concavity of $f$.  □

For any cap $K$ with angle set $\Theta$, define the _area functional_ on $K$ as the following value.

> __Definition [area-functional].__ For any angle set $\Theta$, define the _area functional_ $\mathcal{A} : \mathcal{K}_\Theta \to \mathbb{R}$ on $K_\Theta$ as $\mathcal{A}(K) = |K| - |\mathcal{N}(K)|$. ^def-area-functional

So if $K$ is the cap of a monotone sofa $S$, then $\mathcal{A}(K)$ is the area of $S$. Note however that not every $K$ in $\mathcal{K}_\Theta$ is a cap of some monotone sofa. For example, if $K$ is too wide in width, then the niche $\mathcal{N}(K)$ may extrude out of $K$, so that it is impossible for the disconnected set $S = K \setminus \mathcal{N}(K)$ to be a moving sofa. However, it will be much easier to consider the optimization of area functional $\mathcal{A}(K)$ over all $K \in \mathcal{K}_\omega$. With this, we generalize [[01. Introduction#^con-gerver]] as the following.

> __Conjecture [gerver-cap].__ The cap $K = K_G$ of Gerver's sofa $S_G$ attains the maximum value of the area functional $\mathcal{A}(K)$ over all rotation angle $\omega \in [0, \pi/2]$ and caps $K \in \mathcal{K}_\omega$. ^con-gerver-cap

[[03. Space of Caps#^con-gerver-cap]] implies [[01. Introduction#^con-gerver]], because for any other monotone sofa $S$ with cap $K$, we have $|S| = \mathcal{A}(K) \leq \mathcal{A}(K_G) = |S_G|$ assuming [[03. Space of Caps#^con-gerver-cap]]. However, [[03. Space of Caps#^con-gerver-cap]] is stronger than [[01. Introduction#^con-gerver]] because it also says that $\mathcal{A}(K_G) \geq \mathcal{A}(K)$ for the caps $K$ that might not be a cap of a monotone sofa.

We collect miscellenious results on the geometry of caps.

## Boundary Measure

We establish a correspondence between caps and its boundary measures. Let $K$ be an arbitrary cap in $\mathcal{K}_\Theta$ with angle set $\Theta$ and rotation angle $\omega \in [0, \pi/2]$.

> __Theorem [cap-from-boundary-measure].__ Conversely to [[#^thm-boundary-measure-cap]], let $\beta$ be a measure on $\Theta \cup (\Theta + \pi/2)$ that satisfies the following equations. ^thm-cap-from-boundary-measure
$$
\int_{t \in \Theta} \cos(t) \, \beta(dt) = 1 \qquad \int_{t \in \Theta + \pi/2} \cos\left( \omega + \pi/2 - t \right)  \, \beta(dt) = 1
$$
> Then the followings hold.
> 
> - If $\omega = \pi/2$, then there is a cap $K$ with rotation angle $\omega$ and angle set $\Theta$ such that $\beta_K|_{\Theta \cup (\Theta + \pi/2)} = \beta$. This is unique up to horizontal translation: all the other caps $K'$ satisfying the same condition is a horizontal translation of $K$.
> - If $\omega < \pi/2$, then there is a unique cap $K$ with rotation angle $\omega$ and angle set $\Theta$ such that $\beta_K|_{\Theta \cup (\Theta + \pi/2)} = \beta$.

_Proof._ We first observe that there is a unique extension of $\beta$ on the set $\Pi = \Theta \cup (\Theta + \pi/2) \cup \{\pi + \omega, 3\pi/2\}$ such that $\int_{t \in \Pi} v_t \, \beta(dt) = 0$. Let $A = \int_{t \in \Theta}\sin(t)\,\beta(dt) \geq 0$, then we have $\int_{t \in \Theta} v_t \,\beta(dt) = - A u_0 + v_0$ by the first condition. Likewise, if we let $B = \int_{t \in \Theta + \pi / 2} \sin(\omega + \pi/2 - t)\,\beta(dt) \geq 0$, then we have $\int_{t \in \Theta + \pi/2}v_t\,\beta(dt) = B v_\omega - u_\omega$. By solving for $\int_{t \in \Pi} v_t \, \beta(dt) = 0$, we get the unique extension of $\beta$ on the points $\pi + \omega$ and $3\pi/2$ as the followings.

- If $\omega = \pi/2$, then $\beta(\left\{ \pi + \omega \right\}) = \beta(\left\{ 3\pi / 2 \right\}) = \int_{t \in \Theta \cup \Theta + \pi/2} \sin(t) \, \beta(dt) \geq 0$
- If $\omega < \pi/2$, then $\beta(\left\{ \pi + \omega \right\}) = B + v_\omega \cdot p_\omega > 0$ and $\beta(\left\{ 3 \pi/2 \right\}) = A + u_0 \cdot p_\omega \geq 0$.

Now we use [[yy. Geometric Results#^thm-supported-gauss-measure]]. If $\omega = \pi/2$, then there is a unique convex body $K$ up to translation so that $\beta_K = \beta$ on $\Pi$. The equations on $\beta$ imply that the width measured in the direction of $y$-axis is 1. So up to translation, the $K$ that is a cap ($p_K(\pi) = 1$ and $p_K(3\pi/2) = 0$) is unique up to horizontal translation. If $\omega < \pi/2$, then there is a unique convex body $K$ such that $\beta_K = \beta$ on $\Pi$ and $v_K^+(\omega) = p_\omega$. The equations on $\beta$ is equivalent to that $K$ has width 1 in the direction of $u_\omega$ and $v_0$. So this $K$ is a cap. □

%%
Summarizing the previous discussions, we have shown that any maximum sofa $S$ rotating by an angle of $\omega \in [0, \pi/2]$ can be assumed to be monotone with cap $K$ and angle set $[0, \omega]$ ([[yy. Monotone Sofas#^cor-monotonization-contains]] and [[yy. Monotone Sofas#^thm-monotonization-is-hallway-intersection]]). That is, $S = K \setminus \mathcal{N}(K)$ ([[yy. Monotone Sofas#^thm-monotonization-eq]]) where $K$ is the cap of $S$ and $\mathcal{N}(K)$ is the corresponding niche. With this, we will understand a maximum sofa $S$ by its cap $K$. In this subsection, we define the space $\mathcal{K}_\omega$ of all caps $K$ and analyze it.
%%