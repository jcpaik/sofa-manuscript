We now solve for the maximizer $K = K_{\max, 1}$ of our concave quadratic upper bound $\mathcal{A}_1(K)$. We do this _a priori_ by finding the cap $K$ where $\beta_{K} = \iota_{K}$ on the set $[0, \pi] \setminus \left\{ \pi/2 \right\}$. Then for every other cap $K'$, we have $D\mathcal{A}_1(K; K') = 0$ by [[15. Directional Derivative#^thm-variation-a1]] as we have $\beta_{K} = \iota_{K}$ on $[0, \pi] \setminus \left\{ \pi/2 \right\}$ and $p_{K'}(\pi/2) = p_K(\pi/2) = 1$. Now we solve for the equation $\beta_K = \iota_K$ on any open interval $(t_1, t_2) \cup (t_1 + \pi/2, t_2 + \pi/2)$. Note that this corresponds to (ODE3), Theorem 2 of [[@romikDifferentialEquationsExact2018]], generalized to arbitrary caps.

To prove [[20. Maximizer#^thm-balanced-ACx]] we need the following computations of $g'_K(t)$ and $h'_K(t)$.

> __Theorem [arm-length-derivative].__ Assume that for some $t_0 \in (0, \pi/2)$, the measure $\beta_K$ near $t_0$ and $t_0 + \pi/2$ is derived from a continuous density function $f$. That is, there exists an open set $U$ containing $\left\{ t, t + \pi/2 \right\}$ and a continuous $f : U \to \mathbb{R}$ such that $\beta_K(X) = \int_X f(x)\,dx$ for every measurable $X \subseteq U$. Then we have $g_{K}'(t_0) = -f(t_0) + h_{K}(t_0)$ and $h_K'(t_0) = f(t_0 + \pi/2) - g_K(t_0)$. ^thm-arm-length-derivative

_Proof._ We have the followings for every $t \in U$ by (TODO: some theorem in appendix).
$$g_{K}(t) = \int_{t}^{t+\pi/2} \cos \left( u - t \right) \beta(du)$$
$$h_{K}(t) = \int_{t}^{t+\pi/2} \sin \left( u - t \right) \beta(du)$$
Differentiate those at $t = t_0$ using Leibniz integral rule to get the following.
$$
g_{K}'(t_0) = -f(t_0) + \int_{t_0}^{t_0+\pi/2} \sin (u-t)\, \beta(du) = -f(t_0) + h_{K}(t_0) 
$$
$$
h_{K}'(t_0) = f\left( t_0 + \pi/2 \right) - \int_{t_0}^{t_0+\pi/2} \cos (u-t)\, \beta(du) = f(t_0 + \pi/2) - g_{K_1}(t_0)
$$
□

> __Theorem [balanced-ACx].__ Let $K \in \mathcal{K}_\pi/2$ be any cap. Let $0 \leq t_1 < t_2 < \pi/2$ be two arbitrary angles. The measure $\beta_{K}$ is the same as the measure $\iota_{K}$ on the set $(t_1, t_2) \cup (t_1 + \pi/2, t_2 + \pi/2)$ if there is a constant $a_0$ and $c_0$ such that $\beta_K(t) = (a_0 + t) dt$ and $\beta_K(t + \pi/2) = (c_0 + t) dt$ on the interval $t \in (t_1, t_2)$. Moreover, for such $K$ we have $g^{\pm}(t) = g^{\pm}(t_1) + (t - t_0)$. ^thm-balanced-ACx

_Proof._ Assume that $\beta_K = \iota_K$ on the set $(t_1, t_2) \cup (t_1 + \pi/2, t_2 + \pi/2)$. □

Computing the derivatives of arm lengths $g_{K_1}$ and $h_{K_1}$, we get the following using Leibniz integral rule. Here $0 < t < \omega$ is taken arbitrarily, and we use $\beta_{K_1}(dt) = i_{K_1}(t)dt$ to compute the boundary values in the Leibniz integral rule.

Putting back [[#^def-i-cap]], we obtain the following equations for $t \in (0, \omega)$.
$$
\begin{gather}
g'_{K_1}(t) = -h_{K_1}(t) + 1 + h_{K_1}(t) = 1 \\
h'_{K_1}(t) = g_{K_1}(t) - 1 - g_{K_1}(t) = -1
\end{gather}
$$
The boundary conditions are that we need the ledge heights to be equal to $g_{K_1}(0)=1$ and $h_{K_1}(\omega)=1$. So this gives formula $g_{K_1}(t) = 1 + t$ and $h_{K_1}(t) = 1 + (\omega-t)$. So $i_{K_1}(t) = (\omega-t)$ and $i_{K_1}(t+\pi/2) = t$, and this also gives the value of $\beta_{K_1}$ except for the point masses on $\omega$ and $\pi/2$. As the height $g_{K_1}(0)$ of the sofa has to be equal to 1, we have the following.
$$
\int_{t \in [0, \omega] } \cos \left( t \right) \, \beta_{K_1} (dt) = 1
$$
Computation then gives the following.
$$
\int_{t \in [0, \omega)} \cos (t) (\omega-t) \, dt + \cos(\omega) \beta_{K_1}(\{\omega\}) = 1 - \cos (\omega) + \cos (\omega) \beta_{K_1}(\left\{ \omega \right\}) = 1
$$
So consequently $\beta_{K_1}(\{\omega\}) = 1$ if $\omega < \pi/2$. By symmetry it is also that $\beta_{K_1}(\{\pi/2\}) = 1$ under the same assumption as well. This determines the boundary measure $\beta_{K_1}$ of $K_1$. The question then is whether such a boundary measure will indeed give rise to the cap $K_1$ such that $\beta_{K_1}(dt) = i_{K_1}(t)dt$ on $J_\omega$ except for the points $t = \omega, \pi/2$.

> __Definition [maximum-presofa-a1].__ For any rotation angle $\omega \in [0, \pi/2]$, define the cap $K_1 \in \mathcal{K}_\omega$ as the cap with boundary measure $\beta_{K_1}$ with support in $J_{\omega} \cup \left\{ \omega + \pi, 3 \pi/2 \right\}$ satisfying the following conditions on $J_{\omega}$. ^def-maximum-presofa-a1
> 
> - $\beta_{K_1}(\{\omega\}) = \beta_{K_1}(\{\pi/2\}) = 1$ if $\omega < \pi/2$, or $\beta_{K_1}\left( \left\{ \pi/2 \right\} \right) = 2$ if $\omega = \pi/2$.
> - $\beta_{{K_1}}(dt) = (\omega -t)dt$ on $t \in [0, \omega)$ and $\beta_{K_1}(dt) = (t - \pi/2)dt$ on $t \in (\pi/2, \omega + \pi/2]$.
> - If $\omega=\pi/2$, $K_1$ is symmetric along the $y$-axis.

_Proof._ We use [[01. Space of Caps#^thm-cap-from-boundary-measure]] to construct such a cap $K_1$. Calculating $\int_{t \in [0, \omega] } \cos \left( t \right) \, \beta_{K_1} (dt)$ gives 1 like the computation above. Likewise, calculating $\int_{t \in [\pi/2, \omega + \pi/2]} \cos\left( \omega + \pi/2 - t \right)  \, \beta_K(dt)$ also gives 1 by a similar computation. If $\omega = \pi/2$, the construction of [[01. Space of Caps#^thm-cap-from-boundary-measure]] gives a freedom of translating $K_1$ along the $x$-axis. Using the symmetry of $\beta_{K_1}$, position $K_1$ so that it is symmetric along the $y$-axis. □

> __Theorem [maximum-presofa-a1].__ The cap $K_1 \in \mathcal{K}_{\omega}$ attains the maximum value of $\mathcal{A}_1$. ^thm-maximum-presofa-a1

_Proof._ By [[01. Space of Caps#^thm-variation-maximizer]] and [[#^thm-variation-a1]] it suffice to check that $\beta_{K_1}(dt) = i_{K_1}(t)dt$ on $J_\omega$ except for the points $t = \omega, \pi/2$. Take any $t \in (0, \omega)$, then we have the following.
$$
\begin{align*}
g^+_K(t) & = \int_{u \in (t, t+\pi/2]} \cos (u-t)\, \beta(du) \\
& = \cos(\omega - t) + \cos(\pi/2 - t) + \int_{t}^{\omega} \cos(u-t)(\omega-u)\,du + \int_{\pi/2}^{t + \pi/2} \cos(u-t)(u - \pi/2)\,du  \\
& = 1 + t
\end{align*}
$$
Note that this computation holds for both cases $\omega < \pi/2$ and $\omega = \pi/2$. So on the domain $t \in (\pi/2, \omega + \pi/2]$ the measure $\beta_{K_1}(dt) = (t - \pi/2) dt$ is equal to $i_K(t) dt = (g^+_K(t - \pi/2) - 1) dt$. Similarly, we can also check $\beta_{K_1}(dt) = i_K(t) dt$ on any $t \in [0, \omega)$. □

> __Theorem [maximum-presofa-a1-area].__ The maximum value $\mathcal{A}_1(K_1)$ is $1 + \omega^2/2$.  ^thm-maximum-presofa-a1-area

_Proof._ If $\omega = \pi/2$, let $p_\omega = (0, 1)$. Let $\tau = (\pi/2-\omega)/2$. Then we have $p_\omega = (\tan(\tau), 1)$ for any angle $\omega \leq \pi/2$. Note that $K_1$ has mirror symmetry along the line segment connecting $(0, 0)$ and $p_\omega$.

Let us compute the value of $p_{K_1}(t)$ for $t \in [0, \omega]$. 
$$
\begin{align*}
p_{K_1}(t) - p_\omega \cdot u_t & = (A^-_{K_1}(t) - p_\omega) \cdot u_t =  \\
& = \sin(\omega - t) + \int_{t_0 \in [t, \omega] } (\omega - t_0) \sin \left( t_0 - t \right) \, dt_{0} \\
& = \omega - t
\end{align*}
$$
So $p_{K_1}(t) = \omega - t + p_{\omega} \cdot u_t$ on $t \in [0, \omega]$. By symmetry, $p_{K_1}(t) = t - \pi/2 + p_\omega \cdot u_t$ on $t \in [\pi/2, \omega + \pi/2]$. Now use the mirror symmetry to calculate half the area of $K_1$.
$$
\begin{align*}
\frac{1}{2} \int_{t \in [0, \omega]} p_{K_1}(t) \, \beta(dt) & = 
\frac{1}{2} + \frac{1}{2} \int_{t \in [0, \omega]} \left( \omega - t + p_\omega \cdot u_t \right)  (\omega-t) \, dt \\
& = \frac{1}{2} + \frac{1}{2} \left( \omega^3 / 3 + p_\omega \cdot (1 - \cos(\omega), \omega - \sin(\omega)) \right) 
\end{align*}
$$
So we have the following.
$$
\begin{align*}
|K_1| & = 1 + \omega^3 / 3 + p_\omega \cdot (1 - \cos \omega, \omega - \sin \omega) \\
& = \omega^3/3 + \omega + \cot\left( \pi/4 + \omega/2 \right)
\end{align*}
$$

Next, we compute the area of the niche $I(\mathbf{x}_{K_1})$. We have 
$$
\mathbf{x}_{K_1}(t) = (p_{K_1}(t) - 1)u_t + (p_{K_1}(t + \pi/2) - 1) v_t
$$
and
$$
\mathbf{x}'_{K_1} = -(g_{K_1}^+(t) - 1) \cdot u_t + (h_{K_1}^+(t) - 1) \cdot v_t = 
- t \cdot u_t + (\omega - t) \cdot v_t
$$
so
$$
\begin{align*}
I(\mathbf{x}_{K_1}) & = \frac{1}{2} \int_0^\omega (p_{K_1}(t) - 1)(\omega - t) + (p_{K_1}(t+\pi/2) - 1) t \, dt  \\
& = \frac{1}{2} \int_0^\omega (\omega - t + p_{\omega} \cdot u_t - 1) (\omega - t) \, dt + 
\frac{1}{2} \int_0^\omega (t + p_{\omega} \cdot v_t - 1) t \, dt \\
& = \omega^3 / 3 - \omega^2 / 2 + (-1 + \omega + \cot\left( \pi/4 + \omega/2 \right) )
\end{align*}
$$
Finally, we compute $\mathcal{A}_1(K_1) = |K_1| - I(\mathbf{x}_{K_1}) = 1 + \omega^2 / 2$. □

> __Corollary [sofa-a1-upper-bound].__ Under the assumption of injectivity hypothesis, $1 + \pi^2/8 = 2.2337\dots$ is an upper bound of the sofa area. ^cor-sofa-a1-upper-bound

_Proof._ By [[05. Definition#^thm-a1-is-upper-bound]], [[15. Directional Derivative#^thm-maximum-presofa-a1]] and [[15. Directional Derivative#^thm-maximum-presofa-a1-area]]. □
