We will use many definitions and theorems of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/20. Balanced Maximum Sofa|20. Balanced Maximum Sofa]]. We refer the reader there for the precise statements.

Recall that a balanced maximum cap $K_\infty$ defined as the limit of _maximum polygon caps_ $K_1, K_2, \dots$ converging to $K$ in Hausdorff distance $d_\text{H}$ ([[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/20. Balanced Maximum Sofa#^def-balanced-maximum-cap]]). Each maximum polygon cap $K_i$ have angle set $\Theta_{n_i} := \left\{ (\pi/2) j / n_i : 1 \leq j < n_i \right\}$ where $1 < n_1 < n_2 < \dots$ are increasing powers of 2. To refer each polygon cap $K_i$ more easily, we introduce the following notion. We will bound the arm lengths of a balanced maximum cap.

> __Definition [simple-notation-balanced-cap].__ Say that $K \in \mathcal{K}$ is a _balanced polygon cap_ with $n$ _steps_ of _step size_ $\delta = (\pi/2) / n$, if $n > 1$ and $n$ is a power of two, and $K$ is a balanced polygon cap with the angle set $\Theta_n := \left\{ (\pi/2) i / n : 1 \leq i < n \right\}$. ^def-simple-notation-balanced-cap

The main [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-balanced-polygon-sofa]] of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/20. Balanced Maximum Sofa|20. Balanced Maximum Sofa]] is that each maximum polygon cap $K = K_i$ is _balanced_ in the side lengths of $K_i$ and its polygon niche. Using this balancedness condition, we will establish an upper bound of the surface area measure $\sigma_{K}$ of a balanced polygon cap $K$ with $n$ steps of step size $\delta = (\pi/2) / n$ in [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-balanced-discrete-ineq]]. Then we will take the limit $n \to \infty$ and accordingly $\delta \to 0$, so that the polygon cap $K$ converges to the balanced maximum cap $K_{\infty}$ with its surface area measure $\sigma_{K_\infty}$ bounded from above. We use the following [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^def-o-notation]] to control error terms bounded by absolute functions of $\delta$.

> __Definition [o-notation].__ For any real-valued expressions $f$ and $g$ of $\delta \in \mathbb{R}$, write $f(\delta) = O_\delta(g(\delta))$ if the value of $g(\delta)$ depends solely on $\delta$, and there are absolute constants $C, \epsilon > 0$ such that for every $|\delta| < \epsilon$, we have $|f(\delta)| \leq C g(\delta)$. ^def-o-notation

Note that in [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^def-o-notation]], the value $f(\delta)$ might depend on other values than $\delta$, but the value of $g(\delta)$ should depend solely on $\delta$. For example, we can write $\delta^2 / (1 + h_K(0)^2) = O_\delta(\delta^2)$ where $K \in \mathcal{K}$ can be arbitrary, but we cannot write $\delta^2 = O_\delta(\delta^2(1+p_K(0)^2))$ as the value inside $O_\delta$ is not determined by $\delta$ only.

> __Lemma [leg-bounded].__ Any balanced polygon cap $K$ with $n$ steps have the diameter at most $5$. Consequently, the functions $f_K^{\pm}$ and $g_K^{\pm}$ are bounded from above by 5, and the perimeter $\mathcal{H}^1(\partial K)$ is bounded from above by 20. ^lem-leg-bounded

_Proof._ Since $n > 1$ is a power of two by [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^def-simple-notation-balanced-cap]], the angle set $\Theta_n$ of $K$ contains the angle $\pi/4$. By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/20. Balanced Maximum Sofa#^thm-limiting-maximum-cap-connected]], the cap $K$ satisfies the condition (1) of [[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/15. Cap Contains Niche#^thm-monotonization-connected-iff]]. So the cap $K$ also satisfies the condition (3) of [[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/15. Cap Contains Niche#^thm-monotonization-connected-iff]], and the $y$-coordinate of $\mathbf{x}_K(\pi/4)$ is at most one. Now $K \subseteq H \cap Q_K^+(\pi/4)$ and the polygon $H \cap Q_K^+(\pi/4)$ have diameter at most $2 + 2\sqrt{2} < 5$. So $K$ have the diameter at most 5.

By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/05. Arm Lengths#^def-cap-tangent-arm-length]], for any $t \in [0, \pi/2]$ we have $A_K^{\pm}(t) - C_K^{\pm}(t) = - f_K^{\pm}(t) v_t + g_K^{\pm}(t) u_t$ and since $A_K^{\pm}(t), C_K^{\pm}(t)$ are in $K$, the values $f_K^{\pm}(t)$ and $g_K^{\pm}(t)$ are also bounded by the diameter of $K$ which is at most 5. The convex body $K$ is circumscribed in the rectangle $R$ bounded by the lines $l_K(t)$ for $t = 0, \pi/2, \pi, 3\pi/2$. Because $K$ have diameter $\leq 5$, the perimeter of $R$ is $\leq 20$. So we have the perimeter $\mathcal{H}^1(\partial K) \leq 20$. â–¡

> __Definition [half-line-extension].__ For any cap $K \in \mathcal{K}^\mathrm{c}$ and angle $t \in [0, \pi/2]$, denote the infinite line extension of the half-line $b_K(t)$ as $\bar{b}_K(t)$. Likewise, denote the infinite line extension of the half-line $d_K(t)$ as $\bar{d}_K(t)$. ^def-half-line-extension

> __Definition [upper-half-planes].__ For any cap $K \in \mathcal{K}^\mathrm{c}$ and angle $t \in [0, \pi/2]$, define
$$
H_K^\mathrm{b}(t) := H_+(t, h_K(t) - 1)
$$
> which is the closed half-plane with normal angle $t + \pi$ with boundary $\bar{b}_K(t)$. Likewise, define
$$
H_K^\mathrm{d}(t) := H_+(t + \pi/2, h_K(t + \pi/2) - 1)
$$
> which is the closed half-plane with normal angle $t + 3\pi/2$ with boundary $\bar{d}_K(t)$. ^def-upper-half-planes

> __Figure [leg-computation].__ The hallway $L_K(t)$ depicted in upright position with sides $c_K(t \pm \delta)$ and $\bar{d}_K(t \pm \delta)$ for the proof of [[#^lem-leg-computation]]. The points $p, q, r$ are colored as orange, green, blue respectively. ^fig-leg-computation
> 
> ![](images/legComputation.svg)

> __Lemma [leg-computation].__ For any balanced polygon cap $K$ with the angle set $\Theta$ of step size $\delta$, and any angle $t \in \Theta$, we have the following calculations. ^lem-leg-computation
> 
> 1. $\mathcal{H}^1(b_K(t) \cap H_K^\mathrm{d}(t - \delta)) = \tan \delta \cdot \max(0, g_K^-(t) - 1 + \tan(\delta / 2))$
> 2. $\mathcal{H}^1(b_K(t) \cap H_K^\mathrm{d}(t + \delta)) = \tan \delta \cdot \max(0, 1 - g_K^+(t) + \tan(\delta / 2))$

_Proof._ (1) See the left side of [[#^fig-leg-computation]]. Let $p$ be the intersection of $\bar{d}_K(t - \delta)$ and $\bar{b}_K(t)$, depicted orange in the figure. Since $p \in \bar{b}_K(t)$, there is a unique real value $\alpha$ such that $p + \alpha v_t = \mathbf{x}_K(t)$. As $b_K(t)$ is the half-line from $\mathbf{x}_K(t)$ extending in the direction of $-v_t$, we have $\mathcal{H}^1(b_K(t) \cap H_K^\mathrm{d}(t - \delta)) = \max(\alpha, 0)$ and it remains to evaluate $\alpha$. Define $q$ as the intersection of $\bar{d}_K(t + \delta)$ and $\bar{d}_K(t)$, depicted green in the figure, and $\beta$ as the unique real value such that $q + \beta u_t = \mathbf{x}_K(t)$. Since the points $p$, $q$, $\mathbf{x}_K(t)$ form a right-angled triangle of angle $\delta$ at $q$, we have $\alpha = \tan \delta \cdot \beta$. It remains to compute $\beta$.

Let $r$ be the intersection of $c_K(t - \delta)$ and $c_K(t)$, depicted blue in the figure. Since the lines $c_K(t)$ and $d_K(t)$ are parallel of distance one, and so are $c_K(t - \delta)$ and $d_K(t - \delta)$, and the two pairs of lines make an angle of $\delta$, follow the dashed lines in the figure and we get $r = q + v_t + \tan(\delta / 2) u_t$. As $K$ have angle set $\Theta$ and the angles $t$ and $t + \delta$ are adjacent, we have $r = C_K^-(t)$. By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/05. Arm Lengths#^lem-cap-tangent-arm-length]] we have $r + g_K^-(t) u_t = \mathbf{y}_K(t)$. Summing up, we now have
$$
\begin{align*}
\beta & = (\mathbf{x}_K(t) - q) \cdot u_t = (\mathbf{x}_K(t) + v_t + \tan(\delta/2) u_t - r) \cdot u_t \\
& = (\mathbf{x}_K(t) + v_t + \tan(\delta / 2) u_t - \mathbf{y}_K(t) + g_K^-(t)u_t) \cdot u_t \\
& = g_K^-(t) + \tan(\delta/2) - 1
\end{align*}
$$
and the result follows from $\mathcal{H}^1(b_K(t) \cap H_K^\mathrm{d}(t - \delta)) = \max(\alpha, 0) = \tan \delta \cdot \max(0, \beta)$.

(2) The proof is analogous to that of (1). See the right side of [[#^fig-leg-computation]]. Let $p$ be the intersection of $\bar{d}_K(t + \delta)$ and $\bar{b}_K(t)$. Since $p \in \bar{b}_K(t)$ there is a unique real value $\alpha$ such that $p + \alpha v_t = \mathbf{x}_K(t)$. As $b_K(t)$ is the half-line from $\mathbf{x}_K(t)$ extending in the direction of $-v_t$, we have $\mathcal{H}^1(b_K(t) \cap H_K^\mathrm{d}(t + \delta)) = \max(\alpha, 0)$ and it remains to evaluate $\alpha$. Define $q$ as the intersection of $\bar{d}_K(t + \delta)$ and $\bar{d}_K(t)$, and $\beta$ as the unique real value such that $\mathbf{x}_K(t) + \beta u_t = q$. Since the points $p$, $q$, $\mathbf{x}_K(t)$ form a right-angled triangle of angle $\delta$ at $q$, we have $\alpha = \tan \delta \cdot \beta$. It remains to compute $\beta$.

Let $r$ be the intersection of $c_K(t + \delta)$ and $c_K(t)$. Since the lines $c_K(t)$ and $d_K(t)$ are parallel of distance one, and so are $c_K(t + \delta)$ and $d_K(t + \delta)$, and the two pairs of lines make an angle of $\delta$, we have $r = q + v_t - \tan(\delta / 2) u_t$. As $K$ have angle set $\Theta$ and the angles $t$ and $t + \delta$ are adjacent, we have $r = C_K^+(t)$. By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/05. Arm Lengths#^lem-cap-tangent-arm-length]] we have $r + g_K^+(t) u_t = \mathbf{y}_K(t)$. Summing up, we now have
$$
\begin{align*}
\beta & = (q - \mathbf{x}_K(t)) \cdot u_t = (- \mathbf{x}_K(t) - v_t + \tan(\delta/2) u_t + r) \cdot u_t \\
& = (-\mathbf{x}_K(t) - v_t + \tan(\delta / 2) u_t + \mathbf{y}_K(t) - g_K^+(t)u_t) \cdot u_t \\
& = 1 - g_K^+(t) + \tan(\delta/2)
\end{align*}
$$
and the result follows from $\mathcal{H}^1(d_K(t) \cap H_K^\mathrm{b}(t - \delta)) = \max(\alpha, 0) = \tan \delta \cdot \max(0, \beta)$. â–¡

We introduce the following auxiliary real functions. Note that $m_0$ is monotonically increasing, and is a piecewise function that satisfies $m_0(0) = -1$, $m_0(1) = 1/2$, $m_0(x) = 1$ for $x \geq 2$.

> __Definition [magic-function].__ Define $k_0, m_0 : \mathbb{R}_{\geq0} \to \mathbb{R}$ as $k_0(x) := \max\left( |x - 1|, (|x - 1| + 1) / 2 \right)$ and $m_0(x) = x - k_0(x)$. ^def-magic-function

We now bound the side lengths of a maximum polygon cap, using its balancedness. This is the most important part of the analysis.

> __Lemma [balanced-discrete-ineq].__ Let $K \in \mathcal{K}_\Theta$ be any maximum polygon cap of $n$ steps with step size $\delta = (\pi/2) / n$ and uniform angle set $\Theta := \Theta_n$. Take any $t \in \left\{ 0 \right\} \cup \Theta$. We have the following upper bound of side length $\sigma_K(t)$. ^lem-balanced-discrete-ineq
$$
\sigma_K(t) \leq k_0(g_K^+(t)) \cdot \delta + O_\delta(\delta^2)
$$

_Proof._ If $t = 0$, then as $K$ have angle set $\Theta$ and rotation angle $\omega = \pi/2$, it is an intersection of a finite number of half-planes with normal angles $\neq 0 \in S^1$ (see [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-angled-cap-space]]). So we have $\sigma_K(t) = 0$ and the bound holds trivially. Now assume $t \in \Theta$.

Write $s := \sigma_K(t)$. Because $K$ is balanced by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-balanced-polygon-sofa]], we have $s = \tau_K(t)$. By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-polyline-length]], the value $\tau_K(t) = \mathcal{H}^1(X)$ is the length of the set $X := b_K(t) \cap \partial \mathcal{N}_\Theta(K)$, the side(s) of the polygon niche $\mathcal{N}_\Theta(K)$ contributed by the half-line $b_K(t)$ form $\mathbf{x}_K(t)$. We will bound $\mathcal{H}^1(X)$ from above, thus bounding $s$.

Define the set $U := \left\{ t - \delta, t, t + \delta \right\}$ and $R := \bigcup_{u \in U} H_K^\mathrm{d} (u)$ as the union of three half-planes. Divide $X$ into $X \cap R$ and $X \setminus R$. We bound $\mathcal{H}^1(X \cap R)$ and $\mathcal{H}^1(X \setminus R)$ from above separately.

We first bound $\mathcal{H}^1(X \cap R)$ from above. As $X \subseteq b_K(t)$, we have
$$
\mathcal{H}^1(X \cap R) \leq \mathcal{H}^1(b_K(t) \cap R) = \max(b_K(t) \cap H_K^\mathrm{d}(t - \delta), b_K(t) \cap H_K^\mathrm{d}(t + \delta))
$$
and by the computation in [[#^lem-leg-computation]] and [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-leg-bounded]], we have
$$
\begin{align*}
\mathcal{H}^1(X \cap R) & \leq \delta \cdot \max(0, g_K^-(t) - 1, 1 - g_K^+(t)) + O_\delta(\delta^2).
\end{align*}
$$
Let $M = \max(0, g_K^-(t) - 1, 1 - g_K^+(t))$. We have $g_K^-(t) \leq g_K^+(t)$ by definition. So if $g_K^-(t) \leq 1$ then $M = \max(0, 1 - g_K^+(t)) \leq |1 - g_K^+(t)|$. If $g_K^-(t) > 1$ then we have $M = \max(0, g_K^-(t) - 1) \leq |1 - g_K^+(t)|$. Either way, we have $M \leq |1 - g_K^+(t)|$ and ^eqn-bound-x-r
$$
\mathcal{H}^1(X \cap R) \leq \left| g_K^+(t) - 1 \right| \cdot \delta + O_\delta(\delta^2).
$$

Now we bound $\mathcal{H}^1(X \setminus R)$ from above. Define the closed region $S := \bigcap_{u \in U} H_K^\mathrm{b} (u)$. Our intermediate goal is to show $X \setminus R \subseteq S$. Define $H_0 := H_+(\pi/2, 0)$ as the closed half-plane above the $x$-axis. Then, since $H_0 \cap \mathcal{N}_\Theta(K)$ is an open set, $H_0 \cap \partial \mathcal{N}_\Theta(K)$ is disjoint from $\mathcal{N}_\Theta(K)$. 

For every $u \in U$, we have $Q_K^-(u) \cup H_K^\mathrm{b}(u) \cup H_K^\mathrm{d}(u) = \mathbb{R}^2$. So
$$
X \subseteq H_0 \setminus \mathcal{N}_\Theta(K) \subseteq H_0 \setminus \bigcup_{u \in U} Q_K^-(u) \subseteq H_0 \cap \bigcap_{u \in U} (H_K^\mathrm{b}(u) \cup H_K^\mathrm{d}(u))
\subseteq H_0 \cap (R \cup S). 
$$

We just have shown that $X \setminus R \subseteq S$ where $S := \bigcap_{u \in U} H_K^\mathrm{b} (u)$ is the intersection of three closed half-planes with normal angles $u \in U$ and boundaries $\bar{b}_K(u)$. By definition of $X$, we have $X \subseteq \bar{b}_K(t)$ and $X \setminus R \subseteq \bar{b}_K(t) \cap S$. Define the intersections $B_+ := \bar{b}_K(t) \cap \bar{b}_K(t + \delta)$ and $B_- := \bar{b}_K(t) \cap \bar{b}_K(t - \delta)$. There is a unique real value $\beta$ such that $B_+ = B_- - \beta v_t$. Elementary geometry shows that the side $\bar{b}_K(t) \cap S$ of $S$ is empty if $\beta < 0$, or is a finite segment of length $\beta$ if $\beta \geq 0$. On the other hand, XX shows that $\beta = 2 \tan (\delta / 2) - \sigma_K(t)$. So ^eqn-bound-x-not-r
$$
\mathcal{H}^1(X \setminus R) \leq \max(0, 2 \tan (\delta / 2) - \sigma_K(t)) = \max(0, \delta - s) + O_\delta(\delta^2).
$$

Recall that $s = \nu_K(t) = \mathcal{H}^1(X)$. We divide the proof into cases on whether $s \leq \delta$ or not. If $s \leq \delta$, then adding [[#^eqn-bound-x-r]] and [[#^eqn-bound-x-not-r]] gives
$$
s \leq \left| g_K^+(t) - 1 \right| \cdot \delta + \delta - s + O_\delta(\delta^2)
$$
so rearranging gives
$$
s \leq (\left| g_K^+(t) - 1 \right| + 1)/2 \cdot \delta + O_\delta(\delta^2) \leq k_0(g_K^+(t)) + O_\delta(\delta^2).
$$
On the other hand, if $s > \delta$, then adding [[#^eqn-bound-x-r]] and [[#^eqn-bound-x-not-r]] gives
$$
s \leq \left| g_K^+(t) - 1 \right| \cdot \delta + O_\delta(\delta^2) \leq k_0(g_K^+(t)) + O_\delta(\delta^2).
$$
Either way, the claimed inequality holds. â–¡

> __Lemma [arm-length-discrete-bound].__ Let $K$ be any balanced polygon cap with $n$ steps of step size $\delta := (\pi/2) / n$ and angle set $\Theta := \Theta_n$. For any angle $t \in \left\{ 0 \right\} \cup \Theta$ and open interval $I := (t,t + \delta)$, the followings are true. ^lem-arm-length-discrete-bound
> 
> 1. For any $t' \in I$, we have $g_K^+(t) \geq g_K^{+}(t') = g_K^-(t') \geq g_K^-(t + \delta)$.
> 2. Moreover, the gap $g_K^+(t) - g_K^-(t + \delta)$ between the upper and the lower bound is at most $5 \delta$.

_Proof._ Since the angles $t$ and $t + \delta$ are two adjacent angles of the finite set $\left\{ 0, \pi/2 \right\} \cup \Theta$, we have
$$
A_K^+(t) = A_K^-(t + \delta) = A_K^+(t') = A_K^-(t')
$$
for all $t' \in I$. Call the common point $A$. Similarly, we have
$$
C_K^+(t) = C_K^-(t + \delta) = C_K^{+}(t') = C_K^{-}(t')
$$
for all $t' \in I$. Call the common point $C$. Take any $t' \in \overline{I} = [t, t + \delta]$. The lines $a_K(t')$ and $c_K(t')$ meet orthogonally at the point $\mathbf{y}_K(t')$. The line $a_K(t')$ passes through $A$, and the line $c_K(t')$ passes through $C$. So by elementary geometry, the trajectory of the point $\mathbf{y}_K(t')$ over all $t' \in \overline{I}$ forms an arc $\Delta$ of the circle $\Gamma$ with the diameter of length $\leq 5$ connecting $A$ and $C$. As the lines $a_K(t)$ and $a_K(t + \delta)$ makes an angle of $\delta$ at point $A$, the arc $\Delta$ have central angle $2\delta$ in $\Gamma$. The value $g_K^+(t)$ is the distance from $C$ to $\mathbf{y}_K(t)$, and $g_K^-(t + \delta)$ is the distance from $C$ to $\mathbf{y}_K(t + \delta)$. So (1) holds. The arc $\Delta$ connecting $\mathbf{y}_K(t)$ to $\mathbf{y}_K(t + \delta)$ has length at most $5\delta$. So (2) holds by triangle inequality. â–¡

> __Lemma [leg-convergence].__ Assume that a sequence of polygon caps $K_n$ converge to a cap $K \in \mathcal{K}^\mathrm{c}$ in Hausdorff distance as $n \to \infty$. Then we have ^lem-leg-convergence
$$
\lim_{ n \to \infty } \int_0^{\pi/2} \left| g_{K_n}^+(t) - g_K^+(t) \right| \, dt = 0. 
$$

_Proof._ The function $g_{K_n}^+$ is nonnegative and bounded from above by the diameter of $K_n$. The diameter of $K_n$ converges to the diameter of $K$. So by dominated convergence theorem, it suffices to show that for almost every $t \in (0, \pi/2)$, we have $g_{K_n}^+(t) \to g_K^+(t)$ as $n \to \infty$. Note that the set of all $t \in (0, \pi/2)$ such that either $\sigma_{K}\left( \left\{ t \right\} \right) > 0$ or $\sigma_{K_n}\left( \left\{ t \right\} \right) > 0$ for some $n$ is countable; otherwise, it contradicts that the measures $\sigma_{K_n}$ and $\sigma_K$ are finite. So we can exclude such measure zero case and assume that $\sigma_{K}\left( \left\{ t \right\} \right) = 0$ and $\sigma_{K_n}\left( \left\{ t \right\} \right) = 0$ for all $n \geq 1$. By our choice of $t$, we have $g_{K_n}^-(t) = g_{K_n}^+(t)$ and $g_K^-(t) = g_K^+(t)$. We now prove the goal $g_{K_n}^+(t) \to g_K^+(t)$ as $n \to \infty$.

The function $s : S^1 \to \mathbb{R}$, defined as $s(u) := \sin(u - t)$ for $u \in (t, t + \pi/2]$ and zero otherwise, is upper semicontinuous. By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/05. Arm Lengths#^lem-arm-length-convolution]], the value $g_{K_n}^+(t)$ (resp. $g_K^+(t)$) is the integral of $s$ over $\sigma_{K_n}$ (resp. $\sigma_K$). Because the measure $\sigma_{K_n}$ converges weakly to $\sigma_K$ as $n \to \infty$ ([[02. Injectivity Condition of Maximum-area Sofas/10. Notations and Properties/20. Surface Area Measure#^thm-surface-area-weak-convergence]]), by the Portmanteau theorem on finite measures we have $\limsup_{ n } g_{K_n}^+(t) \leq g_K^+(t)$.

Similarly, define $s^- : S^1 \to \mathbb{R}$ as $s(u) := \sin(u - t)$ for $u \in (t, t + \pi/2)$ and zero otherwise. Then $s^-$ is lower semicontinuous. By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/05. Arm Lengths#^lem-arm-length-convolution]] and [[01. Rotation Angle of Maximum-area Sofas/04. Notations/00. Preface#^thm-surface-area-measure-side-length]], the value $g_{K_n}^-(t)$ (resp. $g_K^-(t)$) is the integral of $s^-$ over $\sigma_{K_n}$ (resp. $\sigma_K$). Now by the Portmanteau theorem on finite measures we have $\liminf_{ n } g_{K_n}^-(t) \geq g_K^-(t)$. Because $g_{K_n}^-(t) = g_{K_n}^+(t)$ and $g_K^-(t) = g_K^+(t)$, the proof is complete. â–¡

We now take the limit of [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-balanced-discrete-ineq]] to show a corresponding inequality in 

> __Lemma [balanced-ineq-limit].__ Let $K$ be a balanced maximum cap. Then on the interval $t \in [0, \pi/2)$, we have $\sigma_K \leq k_0(g_K^+(t)) \, \mathrm{d} t$. ^lem-balanced-ineq-limit

_Proof._ Let $\mu_K$ be the measure $k_0(g_K^+(t)) \, \mathrm{d} t$ on $t \in [0, \pi/2)$. It suffices to show ^eqn-to-show-interval
$$
\sigma_K(I) \leq \mu_K(I) = \int_{t \in I} k_0(g_K^+(t)) \, d t
$$
for any open interval $I = (a, b) \subseteq [0, \pi/2)$ and half-open interval $I = [0, b) \subseteq [0, \pi/2)$. Then for any set $U$ open in the subspace topology of $[0, \pi/2)$ is a countable union of such intervals, so we have $\sigma_K(U) \leq \int_{t \in U} k_0(g_K^+(t))\,dt$. Since both $\sigma_K$ and $k_0(g_K^+(t)) \mathrm{d} t$ are outer regular, by taking $U$ to converge to arbitrary Borel subset of $[0, \pi/2)$ we have $\sigma_K \leq k_0(g_K^+(t)) \, \mathrm{d} t$ on $[0,\pi/2)$.

$K$ is the limit of balanced polygon caps $K_n$ of $n$ steps with step size $\delta = (\pi/2) / n$ as $n \to \infty$, where $n = n_1, n_2, \dots$ takes values in a strictly increasing powers of two. Let $\Theta := \bigcup_n \Theta_n$ be the union of angle sets $\Theta_n$ for powers of two $n = n_1, n_2, \dots$, so that $\Theta$ is the set of dyadic angles in $(0, \pi/2)$. As $\Theta$ is dense in $[0, \pi/2)$, it suffices to show [[#^eqn-to-show-interval]] for $I = (a, b)$ and $I = [0, b)$ for $a, b \in \Theta$ with $a < b$ by taking limits.

Take sufficiently large $n$ so that we can assume $a, b \in \Theta_n$. For every $t \in \left\{ 0 \right\} \cup \Theta_n$, we can assume ^eqn-single-step-integral
$$
\sigma_{K_n}\left( [t, t + \delta) \right) = \sigma_{K_n} (t) \leq k_0(g_{K_n}^+(t)) \cdot \delta + O_{\delta}(\delta^2) =  \int_t^{t + \delta} k_0(g_{K_n}^+(u)) \, du + O_{\delta}(\delta^2)
$$
by [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-balanced-discrete-ineq]] and [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-arm-length-discrete-bound]]. For the open interval $I := (a, b)$, sum up [[#^eqn-single-step-integral]] for all $t \in I \cap \Theta_{n}$ to get ^eqn-polygon-integral
$$
\begin{split}
\sigma_{K_n}(I) & \leq \sum_{t \in [a, b) \cap \Theta_n} \sigma_{K_n}\left( [t, t+ \delta) \right) \\
& \leq \left( \sum_{t \in [a, b) \cap \Theta_n} \int_t^{t + \delta} k_0(g_{K_n}^+(u)) \, du \right)  + O_{\delta}(\delta) \\
& = \int_a^b k_0(g_{K_n}^+(u))\,du + O_{\delta}(\delta) = \mu_{K_n}(I) + O_\delta(\delta).
\end{split}
$$
Here we use $|I \cap \Theta_n| \leq |\Theta_n| - 1 = n =  O_{\delta}(1/\delta)$.

We will now take $n \to \infty$ in [[#^eqn-polygon-integral]], first at the left-hand side. As $K_n \to K$ in Hausdorff distance, $\sigma_{K_n} \to \sigma_K$ in the weak convergence of measures ([[02. Injectivity Condition of Maximum-area Sofas/10. Notations and Properties/20. Surface Area Measure#^thm-surface-area-weak-convergence]]). Since $I$ is open in $S^1$, we have $\sigma_K(I) \leq \liminf_{ n } \sigma_{K_n}(I)$. As we take $n \to \infty$ in the right-hand side, by [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-leg-convergence]] and that $k_0$ is 1-Lipschitz, we have $\lim_{ n } \mu_{K_n}(I) = \mu_K(I)$. So by taking $n \to \infty$ in [[#^eqn-polygon-integral]], we get $\sigma_K(I) \leq \mu_K(I)$ for $I = (a, b)$ as desired.

Similarly, for the interval $I := [0, b)$, set $a = 0$ and observe that [[#^eqn-polygon-integral]] still holds. Because $K_n$ and $K$ are caps, if we set $U = (-\pi/2, b)$ then we have $\sigma_{K_n}(I) = \sigma_{K_n}(U)$ and $\sigma_K(I) = \sigma_K(U)$. So we still have $\sigma_K(I) \leq \liminf_{ n } \sigma_{K_n}(I)$. We also have $\lim_{ n } \mu_{K_n}(I) = \mu_K(I)$ by [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-leg-convergence]]. So by taking $n \to \infty$ in [[#^eqn-polygon-integral]], we have $\sigma_K(I) \leq \mu_K(I)$ for $I = [0, b)$ as desired. â–¡

> __Theorem [leg-length-bounds].__ Let $K$ be a balanced maximum cap. Then the function $f_K(t)$ in [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^thm-leg-nondegenerate]] on $t \in [0, \pi/2)$ is absolutely continuous, and we have $f'_K(t) \leq m_0(g_K(t))$ for almost every $t \in (0, \pi/2)$ except measure zero set. ^thm-leg-length-bounds

_Proof._ By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-balanced-ineq-limit]] and the Radon-Nikodym theorem, we have $\sigma_K = s_K(t) \mathrm{d} t$ for some measurable function $s_K : [0, \pi/2) \to \mathbb{R}_{\geq 0}$ that is unique up to null set. Since $\sigma_K \leq k_0(g_K^+(t)) \mathrm{d} t$, we can assume $s_K \leq g_K^+$. By [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/05. Arm Lengths#^thm-arm-length-differentiation]], we have $\mathrm{d} f_K^+(t) = g_K^+(t)\, \mathrm{d} t - \sigma_K = \left( g_K^+(t) - s_K(t) \right)\mathrm{d} t$ on $t \in [0, \pi/2)$. Use https://math.stackexchange.com/questions/4841299/prove-nu-is-absolutely-continuous-to-lebesgue-measure-if-and-only-if-f-is-a. â–¡

By mirror symmetry, any lower bound $f_n(t)$ of $f_K(t)$ gives a lower bound $f_{n}(\pi/2-t)$ of $g_K(t)$. [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^thm-leg-length-bounds]] then transfers any lower bound of $g_K(t)$ to a lower bound of $f_K'(t)$. Integrating $f_K'(t)$ and its lower bound $m_0(f_{n}(\pi/2-t))$, we obtain a new lower bound $f_{n+1}(t)$ of $f_K(t)$. Let us now iterate this indefinitely to get a good lower bound of $f_K$ ([[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-lower-bound-sequence]]).

> __Definition [integral-operator].__ For any continuous function $f : [0, \pi/2] \to \mathbb{R}$, define $\mathcal{F} f : [0, \pi/2] \to \mathbb{R}$ as the continuous function ^def-integral-operator
$$
\mathcal{F} f(x) = 1 + \int_0^x m_0(f(\pi/2 - u))\,du.
$$

> __Definition [lower-bound-sequence].__ Define the continuous functions $f_n : [0, \pi/2] \to \mathbb{R}$ for all integers $n \geq 0$ recursively as the following. ^def-lower-bound-sequence
> 
> 1. $f_0(x) := 0$ for all $x \in [0, \pi/2]$.
> 2. $f_{n+1}(x) := \max\left( f_n(x), \mathcal{F} f_n(x) \right)$ for all $x \in [0, \pi/2]$.

> __Lemma [lower-bound-sequence].__ The following holds for any $n \geq 0$. Let $K \in \mathcal{K}$ be any balanced maximum cap. Then we have $f_K(t) \geq f_n(t)$ for all $t \in [0, \pi/2)$ and $g_K(t) \geq f_n(\pi/2 - t)$ for all $t \in (0, \pi/2]$. ^lem-lower-bound-sequence

_Proof._ Induct on $n$. The base case $n \geq 0$ holds trivially. Now assume the inductive hypothesis that for any balanced maximum cap $K'$, we have $f_{K'}(t) \geq f_n(t)$ for all $t \in [0, \pi/2)$ and $g_{K'}(t) \geq f_n(\pi/2 - t)$ for all $t \in (0, \pi/2]$. Fix any balanced maximum cap $K$. For any $t \in [0, \pi/2)$, we have
$$
f_K(t) = f_K(0) + \int_0^t f_K'(u) \,du \geq f_K(0) + \int_0^t m_0(g_K(u)) \,du \geq f_K(0) + \int_0^t m_0(f_K(\pi/2 - u)) \,du 
$$
by the inductive hypothesis on $K' := K$ and [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^thm-leg-length-bounds]]. This combined with the inductive hypothesis $f_{K}(t) \geq f_n(t)$ on $K' := K$ implies that $f_K(t) \geq f_{n+1}(t)$.

From the inductive hypothesis, we proved $f_K(t) \geq f_{n+1}(t)$ for any balanced maximum cap $K$ and $t \in [0, \pi/2)$. Applying the same argument to $K' := K^{\mathrm{op}}$, we also have $f_{K^\mathrm{\mathrm{op}}}(t) \geq f_{n+1}(t)$ for all $t \in [0, \pi/2)$. This, by mirror symmetry, is equivalent to the other inequality $g_K(t) \geq f_{n+1}(\pi/2 - t)$ for all $t \in (0, \pi/2]$. â–¡

> __Definition [lower-bound-j].__ For any constant $c \in [0, 1]$, define the function $j_c : [0, \pi/2] \to \mathbb{R}$ as $j_c(x) := \max(1 - x, c)$. ^def-lower-bound-j

> __Lemma [lower-bound-j-iter].__ Define the constant $d_0 := 1/12$. Then for any $c \in [0, 2/3]$, we have $\mathcal{F} j_c(x) \geq j_{c + d_0}(x)$ on $x \in [0, \pi/2]$. ^lem-lower-bound-j-iter

_Proof._ Because $m_0$ is bounded from below by $-1$, it is always guaranteed that $\mathcal{F} j_c (x) \geq 1 - x$. So to show that $\mathcal{F} j_c(x) \geq j_{c + d_0}(x)$ on $x \in [0, 1]$, it suffices to show $\mathcal{F} j_c (x) \geq c + d_0$. We now show this by simply computing $\mathcal{F} j_c(x)$. Since the range of $j_c$ is in $[0, 1]$, we have ^eqn-jc-principal
$$
\begin{align*}
\mathcal{F} j_c(x) & = 1 + \int_0^x m_0(j_c(\pi/2 - u)) \, du \\
& = 1 - x + \int_0^x \frac{3}{2} j_c (\pi/2 - u) \,du
\end{align*} 
$$
and it suffices to show that the value is $\geq c + d_0$.

Assume the case $x \leq \pi/2 - 1 + c$. Then $\pi/2 - u \geq \pi/2 - x \geq 1 - c$ in the integral of [[#^eqn-jc-principal]] so
$$
\begin{align*}
\mathcal{F} j_c(x) & = 1 - x + \frac{3}{2} c x = 1 - (1 - 3/2 \cdot c)x \\
& \geq 1 - (1 - 3/2 \cdot c)(\pi/2 - 1 + c) \\
& \geq c + d_0
\end{align*}
$$
where the last inequality is obtained by minimizing the quadratic polynomial of $c \in \mathbb{R}$, which we omit the details.

It remains to check the case $x > \pi/2 - 1 + c$. Then [[#^eqn-jc-principal]] evaluates to
$$
\begin{align*}
\mathcal{F} j_c(x) & = 1 - x + \frac{3}{2} c (\pi/2 - 1 + c) + \int_{\pi/2 - 1 + c}^x \frac{3}{2}(1 - \pi/2 + u) \, du \\
& = 1 - x + \frac{3}{2} c (\pi/2 - 1 + c) + \frac{3}{4} \left( (x - \pi/2 + 1)^2 - c^2 \right).
\end{align*} 
$$
Minimize the quadratic polynomial over $x \in \mathbb{R}$, which we omit the details, then we have
$$
\mathcal{F} j_c (x) \geq \frac{5}{3} - \frac{\pi}{2} + \frac{3}{4} c (c + \pi - 2)
$$
where the equality holds at $x = \pi/2 - 1/3$. The lower bound is $\geq c + d_0$ by another minimization of quadratic polynomial over $c \in \mathbb{R}$. This completes the proof. â–¡

> __Lemma [operator-monotonicity].__ For any functions $f, g : [0, \pi/2] \to \mathbb{R}_{\geq 0}$ such that $f \leq g$ on $[0, \pi/2]$, we also have $\mathcal{F} f \leq \mathcal{F} g$. ^lem-operator-monotonicity

_Proof._ The function $m_0$ is monotonically increasing; now check the [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^def-integral-operator]] of $\mathcal{F}$. â–¡

> __Lemma [lower-bound-threshold].__ We have $f_{11}(x) > 1$ on $x \in (0, 1]$. ^lem-lower-bound-threshold

_Proof._ For any integer $1 \leq m \leq 10$, we will show that $f_m \geq j_{(m - 1)/12}$. The base case $f_1 = j_0$ is done by simple computation. Assuming the inductive hypothesis $f_m \geq j_{(m-1)/12}$ for $m \leq 9$, the inductive step
$$
f_{m+1} \geq \mathcal{F} f_m \geq \mathcal{F} j_{(m-1)/12} \geq j_{m/12}
$$
can be done using [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-operator-monotonicity]] and [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-lower-bound-j-iter]]. So $f_{10} \geq j_{9/12} > 2/3$ in particular.

Because $m_0(y) > 0$ for all $y > 2/3$, we now have 
$$
f_{11}(x) \geq \mathcal{F} f_{10} (x) = 1 + \int_0^x m_0(f_{10}(\pi/2 - u)) \, du > 1
$$
for all $x \in (0, \pi/2]$. â–¡

> __Remark [lower-bound-limit].__ The lower bound $f_n$ of the arm length $f_K$ of balanced maximum cap $K$ gets better as $n \to \infty$. We only took $n=11$ in [[02. Injectivity Condition of Maximum-area Sofas/20. Injectivity Condition/10. Bounding Arm Lengths#^lem-lower-bound-threshold]] which was sufficient for our purpose. As $n \to \infty$, it turns out that $f_n$ converges to the function $f : [0, \pi/2] \to \mathbb{R}$ described as the following. ^rem-lower-bound-limit
> 
> There exists unique constants $A_0 \in [0.95, 0.96]$, $B_0 \in [2.31, 2.32]$, $T_0 \in [0.50, 0.51]$ satisfying the following equations.
> 
> 1. $A_0 \cos (T/2) + B_0 \sin (T/2) = 1 + T$
> 2. $A_0 \cos ((\pi/2-T)/2) + B_0 \sin ((\pi/2-T)/2) = 2$
> 3. $- A_0 \sin T/2 + B_0 \cos T/2 = 2$
> 
> The function $f : [0, \pi/2] \to \mathbb{R}$, which is the solution to $f(0) = 1$ and $f'(t) = m_0(f(\pi/2 - t))$, evaluates to the following.
> 
> 1. $f(t) = 1 + t$ for $t \in [0, T_0]$,
> 2. $f(t) = A_0 \cos(t/2) + B_0 \sin(t/2)$ for $t \in [T_0, \pi/2 - T_0]$,
> 3. $f(\pi/2-T_0)=2$ and $f'(t) = (\pi/2 - t + 1)/2$ for $t \in [\pi/2 - T_0, \pi/2]$.