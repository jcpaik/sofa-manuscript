# Polygon Cap and Niche

Following the outline in [[01. Rotation Angle of Maximum-area Sofas/01. Introduction/05. Balanced Sofa]], we define a polygon cap $K$ and its polygon niche $\mathcal{N}_\Theta(K)$.

> __Definition [angle-set].__ Define an _angle set_ $\Theta$ with _rotation angle_ $\omega \in (0, \pi/2]$ as the pair $(\omega, X)$ of $\omega$ and a nonempty finite subset $X$ of $(0, \omega)$. ^def-angle-set

> __Remark [angle-set].__ The angle set $\Theta$ is essentially a finite subset $X$ of $(0, \omega)$ that does not forget the value of $\omega$. With a slight abuse of notation, we will treat the angle set $\Theta$ like the subset $X \subseteq (0, \omega)$ by, for example, saying $t \in \Theta$ instead of saying $t \in X$. Unless specified otherwise, the value $\omega$ will always denote the rotation angle of $\Theta$. ^rem-angle-set

> __Definition [angle-domain].__ For any angle set $\Theta$ with rotation angle $\omega$, define $\Theta^\diamond$ as the set $\Theta \cup (\Theta + \pi/2) \cup \left\{ \omega, \pi/2 \right\}$. ^def-angle-domain

> __Definition [angled-cap-space].__ Define the space $\mathcal{K}_\Theta^\mathrm{c}$ of _polygon caps with angle set_ $\Theta$ as the set of caps $K \in \mathcal{K}_\omega^\mathrm{c}$ which is the intersection of closed half-planes with normal angles in $\Theta^{\diamond} \cup \left\{\pi + \omega, 3\pi/2 \right\}$. ^def-angled-cap-space

Any cap $K \in \mathcal{K}_\omega^\mathrm{c}$ can be approximated by the polygon cap $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta^\mathrm{c}$ with angle set $\Theta$ circumscribing $K$ with the edges of normal angles in $\Theta^{\diamond} \cup \left\{\pi + \omega, 3\pi/2 \right\}$. The denser $\Theta$ is in $(0, \omega)$, the better the approximation $\mathcal{C}_\Theta(K)$ of $K$.

> __Definition [angled-cap].__ For any $K \in \mathcal{K}_\omega^\mathrm{c}$ and angle set $\Theta$ of rotation angle $\omega$, define ^def-angled-cap
$$
\mathcal{C}_\Theta(K) = P_\omega \cap \bigcap_{t \in \Theta} Q_K^+(t).
$$

> __Proposition [angled-cap].__ For any cap $K \in \mathcal{K}_\omega^\mathrm{c}$, the set $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta^\mathrm{c}$ contains $K$ as a subset. With this, call $\mathcal{C}_\Theta(K)$ the _polygon cap_ with _angle set_ $\Theta$ _approximating_ $K$. The map $\mathcal{C}_\Theta : \mathcal{K}_\omega^\mathrm{c} \to \mathcal{K}_\Theta^\mathrm{c}$ is a surjective map fixing the elements of $\mathcal{K}_\Theta^\mathrm{c} \subset \mathcal{K}_\omega^\mathrm{c}$. ^pro-angled-cap

_Proof._ That $K \subseteq \mathcal{C}_\Theta(K)$ comes from $K \subseteq P_\omega$ and $K \subseteq Q_K^+(t) = H_K(t) \cap g_K(t + \pi/2)$. We have $\mathcal{C}_\Theta(K) \in \mathcal{K}_\omega^\mathrm{c}$ as $K \subseteq \mathcal{C}_\Theta(K) \subseteq P_\omega$. We have $\mathcal{C}_\Theta(K) \in \mathcal{K}_\Theta^\mathrm{c}$ as the formula in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-angled-cap]] is the intersection of closed half-planes with normal angles in $\Theta^{\diamond} \cup \left\{\pi + \omega, 3\pi/2 \right\}$.

Now it remains to show that for any $K \in \mathcal{K}_\Theta^\mathrm{c}$, we have $\mathcal{C}_\Theta(K) = K$. Since $K \in \mathcal{K}_\Theta^\mathrm{c}$ is an intersection of closed half-planes with normal angles in $\Pi := \Theta^{\diamond} \cup \left\{\pi + \omega, 3\pi/2 \right\}$, we have $K = \bigcap_{t \in \Pi} H_K(t)$. As $K \in \mathcal{K}_\Theta^\mathrm{c} \subset \mathcal{K}_\omega^\mathrm{c}$, we have $h_K(\omega) = h_K(\pi/2) = 1$ and $h_K(\omega + \pi) = h_K(3\pi/2) = 0$ so
$$
K = \bigcap_{t \in \Pi} H_K(t) = P_\omega \cap \bigcap_{t \in \Theta} Q_K^+(t) = \mathcal{C}_\Theta(K)
$$
as we wanted. □

> __Definition [angled-niche].__ For every cap $K \in \mathcal{K}_\omega^\mathrm{c}$ and finite nonempty $\Theta \subset (0, \omega)$, define its _polygon niche_ ^def-angled-niche
$$
\mathcal{N}_\Theta(K) = P_\omega \cap \bigcup_{t \in \Theta} Q_K^-(t)
$$
> with angle set $\Theta$.

> __Proposition [angled-niche-polygon-cap].__ For any $K \in \mathcal{K}_\omega^\mathrm{c}$, we have $\mathcal{N}_\Theta(K) = \mathcal{N}_\Theta(\mathcal{C}_\Theta(K)) \subseteq \mathcal{N}(K)$. ^pro-angled-niche-polygon-cap

_Proof._ Let $K' := \mathcal{C}_\Theta(K)$. The support functions $h_X$ of $X = K, K'$ agree on the set $\Theta \cup (\Theta + \pi/2)$ by definition and [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-angled-cap]]. Observe that the [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-angled-niche]] of $\mathcal{N}_\Theta(X)$ only depends on $\omega$ and the values of $h_X$ on $\Theta \cup (\Theta + \pi/2)$. So we have $\mathcal{N}_\Theta(K) = \mathcal{N}_\Theta(K')$. That $\mathcal{N}_\Theta(K) \subseteq \mathcal{N}(K)$ follows from their respective definitions. □

> __Definition [polygon-upper-bound].__ Let $\Theta$ be an angle set with rotation angle $\omega$. Define the _polygon sofa area functional_ $\mathcal{A}_\Theta : \mathcal{K}_\omega^\mathrm{c} \to \mathbb{R}$ as $\mathcal{A}_\Theta(K) := |\mathcal{C}_\Theta(K)| - |\mathcal{N}_\Theta(K)|$. ^def-polygon-upper-bound

> __Theorem [polygon-upper-bound].__ For any polygon cap $K \in \mathcal{K}^\mathrm{c}_\Theta$ we have $\mathcal{A}_\Theta(K) = |K| - |\mathcal{N}_\Theta(K)|$. For every cap $K \in \mathcal{K}_\omega^\mathrm{c}$, we have $\mathcal{A}_{\omega}(K) \leq \mathcal{A}_\Theta(K)$. ^thm-polygon-upper-bound

_Proof._ Consequence of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-angled-cap]] and [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-angled-niche-polygon-cap]]. □

> __Remark [polygon-upper-bound].__ The upper bound $\alpha_{\max} \leq 2.37$ of [@kallusImprovedUpperBounds2018] was essentially established by computing the upper bound $\mathcal{A}_\Theta$  of $\mathcal{A}_{\pi/2}$ for a specific set $\Theta$ of five angles. ^rem-polygon-upper-bound

# Section Outline

%% TODO: this reads more like a note to self. Make it more accessible. %%

As described in [[01. Rotation Angle of Maximum-area Sofas/01. Introduction/05. Balanced Sofa]], we will maximize the value $\mathcal{A}_\Theta(K) = |K| - |\mathcal{N}_\Theta(K)|$ with respect to polygon cap $K \in \mathcal{K}_\Theta^\mathrm{c}$. We will show the main [[#^thm-balanced-polygon-sofa]] of this [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap]] that such a maximizer $K_\Theta := K$ is _balanced_ in the side lengths of $K$ and $\mathcal{N}_\Theta(K)$, which is defined precisely in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-balanced-polygon-sofa]]. Assume contradictory that $K \in \mathcal{K}_\Theta^\mathrm{c}$ is not balanced. Our goal is to find another polygon cap in $\mathcal{K}_\Theta^\mathrm{c}$ with a strictly larger value of $\mathcal{A}_\Theta$.

Let $h : \Theta^{\diamond} \to \mathbb{R}$ be the restriction of the support function $h_K$ of polygon cap $K \in \mathcal{K}_\Theta^\mathrm{c}$ to the domain $\Theta^{\diamond}$. We will see that $K$ and $\mathcal{N}_\Theta(K)$ are simple Nef polygons $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$ completely determined by $h$ on $\Theta^{\diamond}$ ([[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]]). So we can write the sofa area functional of $\mathcal{A}_\Theta(K)$ in terms of $h$ as
$$
\mathcal{A}_\Theta(h) := |\mathcal{C}_\Theta(h)| - |\mathcal{N}_\Theta(h)|.
$$

Forgetting that $h$ is the support function of $K$, we will change the function values of $h : \Theta^{\diamond} \to \mathbb{R}$ slightly to increase the value of $\mathcal{A}_\Theta(h)$. In the context of [[01. Rotation Angle of Maximum-area Sofas/01. Introduction/05. Balanced Sofa#^eqn-polygon]] in [[01. Rotation Angle of Maximum-area Sofas/01. Introduction/05. Balanced Sofa]], the value $\mathcal{A}_\Theta(h)$ is the area of the intersection $S_\Theta$ in [[01. Rotation Angle of Maximum-area Sofas/01. Introduction/05. Balanced Sofa#^eqn-polygon]], and the values of $h(\pi/2)$, $h(\omega)$, and $h(t), h(t + \pi/2)$ for each $t \in \Theta$ controls the locations of $H$, $V_\omega$, and $L_t$ for each $t \in \Theta$ in [[01. Rotation Angle of Maximum-area Sofas/01. Introduction/05. Balanced Sofa#^eqn-polygon]] respectively.

Let $h^+ : \Theta^{\diamond} \to \mathbb{R}$ be the adjusted function so that $\mathcal{A}_\Theta(h^+) > \mathcal{A}_\Theta(h)$. We will retrieve a convex body $K^+ := \mathcal{C}_\Theta(h^+)$ from $h^+$ and prove $\mathcal{A}_\Theta(K^+) > \mathcal{A}_\Theta(K)$. An issue is that the convex polygon $K^+$ from $h^+$ might not be a polygon cap in $\mathcal{K}_\Theta^\mathrm{c}$, because $K^+$ have width less than one in the direction of $u_\omega$ or $v_0$. We prevent this by adjusting $h$ to $h^+$ carefully so that $K^+$ is always a _translation_ of some polygon cap $K^0$ in $\mathcal{K}_\Theta^\mathrm{c}$. By translating $K^+$ back to $K^0$, we properly conclude $\mathcal{A}_\Theta(K) < \mathcal{A}_\Theta(K^0)$ as we want.

# Extensions of Polygon Cap

We extend the space $\mathcal{K}_\Theta^\mathrm{c}$ of polygon caps to the space $\mathcal{K}_\Theta^\mathrm{t}$ of all _translates_ of polygon caps.

> __Definition [cap-trans].__ Define the space of _polygon cap translates_ $\mathcal{K}_\Theta^\mathrm{t}$ as the collection of all translations $K'$ of arbitrary caps $K \in \mathcal{K}_\Theta^\mathrm{c}$ with angle set $\Theta$. ^def-cap-trans

> __Proposition [cap-trans-space].__ A convex polygon $K'$ is in $\mathcal{K}_\Theta^\mathrm{t}$ if and only if the followings are true. ^pro-cap-trans-space
> 
> 1. The widths $h_{K'}(\omega) + h_{K'}(\omega + \pi)$ and $h_{K'}(\pi/2) + h_{K'}(3\pi/2)$ of $K'$ measured along the angles $\omega$ and $\pi/2$ are exactly one.
> 2. $K'$ is a convex polygon with normal angles in the set $\Theta \cup (\Theta + \pi/2) \cup \left\{\omega, \pi/2, \omega + \pi, 3\pi/2 \right\}$.

_Proof._ Any translate $K'$ of an arbitrary $K \in \mathcal{K}_\Theta^\mathrm{c}$ satisfies (1) and (2) immediately. On the other hand, for any $K'$ satisfying conditions (1) and (2), find a translation $K$ of $K'$ so that $h_K(\omega) = h_K(\pi/2) = 1$ and $K \in \mathcal{K}_\Theta^\mathrm{c}$. Since the width of $K$ measured along the angles $\omega$ and $\pi/2$ are one, we get $h_K(\omega + \pi) = h_K(3\pi/2) = 0$. □

Subsequently, extend the set of support functions of $K \in \mathcal{K}_\Theta^\mathrm{t}$ to the space $\mathcal{H}_\Theta$ of _all_ functions $h : \Theta^{\diamond} \to \mathbb{R}$.

> __Definition [height-space].__ Define $\mathcal{H}_\Theta$ as the space of all functions $h : \Theta^{\diamond} \to \mathbb{R}$. ^def-height-space

> __Proposition [height-space-embedding].__ The map $\mathcal{K}_\Theta^\mathrm{t} \to \mathcal{H}_\Theta$ mapping $K' \in \mathcal{K}_\Theta^\mathrm{t}$ to its support function $h_{K'}$ restricted to the domain $\Theta^{\diamond}$ is an injection. ^pro-height-space-embedding

_Proof._ By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-trans-space]], the values of $h_{K'}$ on $\Theta^{\diamond}$ determine
$$
K' = \bigcap_{t \in \Theta^{\diamond} \cup \left\{ \omega + \pi, 3\pi/2 \right\}} H_{K'}(t) \in \mathcal{K}_\Theta^\mathrm{t}
$$
uniquely. □

We now have a series of extensions $\mathcal{K}_\Theta^\mathrm{c} \subseteq \mathcal{K}_{\Theta}^\mathrm{t} \hookrightarrow \mathcal{H}_\Theta$. We will extend the notion of cap, niche, and the polygon sofa area functional $\mathcal{A}_\Theta$ from $\mathcal{K}_\Theta^\mathrm{c}$ to $\mathcal{H}_\Theta$.

> __Definition [height-extensions].__ For any $h \in \mathcal{H}_\Theta$, define its _parallelogram_ ^def-height-extensions
$$
P_h := \bigcap_{t \in \left\{ \omega, \pi/2 \right\} } H_-(t, h(t)) \cap H_+(t, h(t) - 1)
$$
> and _cap_
$$
\mathcal{C}_\Theta(h) := P_h \cap \bigcap_{t \in \Theta \cup (\Theta + \pi/2)} H_-(t, h(t))
$$
> and _fan_
$$
F_h := \bigcap_{t \in \left\{ \omega, \pi/2 \right\} } H_+(t, h(t) - 1)
$$
> and _niche_
$$
\mathcal{N}_{\Theta}(h) := F_h \cap \bigcup_{t \in \Theta } \left( H_-^\circ(t, h(t) - 1) \cap H_-^\circ(t + \pi/2, h(t + \pi/2) - 1) \right)
$$
> and the _polygon sofa area functional_
$$
\mathcal{A}_\Theta(h) := |\mathcal{C}(h)| - |\mathcal{N}_\Theta(h)|.
$$

> __Proposition [cap-niche-nef-polygons].__ For any $h \in \mathcal{H}_\Theta$, the sets $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$ are simple Nef polygons ([[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^def-simple-nef-polygon]]) with the defining half-planes $H_-(t, h(t))$ over $t \in \Theta^{\diamond}$, $H_{+}(t, h(t) - 1)$ over $t \in \left\{ \omega, \pi/2 \right\}$, and $H_-^{\circ}(t, h(t) - 1)$ over $t \in \Theta \cup (\Theta + \pi/2)$. ^pro-cap-niche-nef-polygons

_Proof._ Check that [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^def-simple-nef-polygon]] holds for $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$. The boundaries of the defining half-planes differ as they differ in its normal angle or distance from the origin. The formulas of $\mathcal{C}_\Theta(h)$ and $\mathcal{N}_\Theta(h)$ in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] are defined from the mentioned half-planes by applying only union and intersection, so by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^pro-monotone-boolean-function]] the defining boolean function is monotone. □

We show that the notion of cap, niche, and polygon sofa area functional on $\mathcal{H}_\Theta$ in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] are compatible with that of $\mathcal{K}_\Theta^\mathrm{c}$.

> __Proposition [cap-extension-compatible].__ For any polygon cap translate $K' \in \mathcal{K}_\Theta^\mathrm{t}$ with $h := h_K \in \mathcal{H}_\Theta$ we have $\mathcal{C}_{\Theta}(h) = K'$. ^pro-cap-extension-compatible

_Proof._ By (2) of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-trans-space]], $K' = \bigcap_{t \in \Theta^{\diamond} \cup \left\{ \omega + \pi, 3\pi/2 \right\}} H_{K'}(t)$. By (1) of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-trans-space]], the intersection matches the [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] of $\mathcal{C}_\Theta(h_K)$. □

> __Proposition [niche-extension-compatible].__ For any polygon cap $K \in \mathcal{K}_\Theta^\mathrm{c}$ with $h := h_K \in \mathcal{H}_\Theta$ we have $\mathcal{N}_\Theta(h) = \mathcal{N}_\Theta(K)$. Consequently, we have $\mathcal{A}_\Theta(h) = \mathcal{A}_\Theta(K)$. ^pro-niche-extension-compatible

_Proof._ That $\mathcal{N}_\Theta(h) = \mathcal{N}_\Theta(K)$ comes from their respective definitions. Then $\mathcal{A}_\Theta(h) = \mathcal{A}_\Theta(K)$ comes from [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-extension-compatible]]. □

Now inherit [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] from $\mathcal{H}_\Theta$ to $\mathcal{K}_\Theta^\mathrm{t}$ under the extension $\mathcal{K}_\Theta^\mathrm{c} \subseteq \mathcal{K}_{\Theta}^\mathrm{t} \hookrightarrow \mathcal{H}_\Theta$.

> __Definition [cap-translate-extensions].__ For any cap translate $K' \in \mathcal{K}_\Theta^\mathrm{t}$ define $\mathcal{N}_\Theta(K')$ and $\mathcal{A}_\Theta(K')$ as that of the support function $h := h_{K'}$. That is, $\mathcal{N}_\Theta(h)$ and $\mathcal{A}_\Theta(h)$ in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-height-extensions]] respectively. ^def-cap-translate-extensions

> __Theorem [height-extensions].__ For any translation $K' := K + \mathbf{v} \in \mathcal{K}_{\Theta}'$ of a polygon cap $K \in \mathcal{K}_\Theta^\mathrm{c}$ by $\mathbf{v} \in \mathbb{R}^2$, we have $\mathcal{N}_\Theta(K') = \mathcal{N}_\Theta(K) + \mathbf{v}$ and $\mathcal{A}_\Theta(K') = \mathcal{A}_\Theta(K)$. So [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-cap-translate-extensions]] is a proper extension of $\mathcal{N}_\Theta$ and $\mathcal{A}_\Theta$ from $\mathcal{K}_\Theta^\mathrm{c}$ to $\mathcal{K}_\Theta^\mathrm{t}$. ^thm-height-extensions

_Proof._ By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-niche-nef-polygons]] and [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-cap-translate-extensions]], the polygon $\mathcal{N}_{\Theta}(K')$ is a simple Nef polygon with defining half-planes $H_{K'}(t)$ and $H_{K'}(t) - u_t$ (or their complement and/or interior) for $t \in \Theta^{\diamond}$. For any convex body $K$ and fixed $t \in S^1$, the supporting half-plane $H_K(t)$ is equivariant under the translation of $K$ so that $H_{K + \mathbf{v}}(t) = H_K(t) + \mathbf{v}$. So we have the equivariance $\mathcal{N}_\Theta(K') = \mathcal{N}_\Theta(K) + \mathbf{v}$. We then have
$$
\begin{align*}
\mathcal{A}_\Theta(K') & = |\mathcal{C}_\Theta(h_{K'})| - |\mathcal{N}_\Theta(h_{K'})| = |K'| - |\mathcal{N}_\Theta(K')| \\
& = |K| - |\mathcal{N}_\Theta(K)| = \mathcal{A}_\Theta(K)
\end{align*}
$$
by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-extension-compatible]] and [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-niche-extension-compatible]]. □

> __Proposition [cap-translate-reduction].__ Assume that $h^+ \in \mathcal{H}_\Theta$ is taken so that $K^+ := \mathcal{C}_\Theta(h^+)$ is a polygon cap translate in $\mathcal{K}_\Theta^\mathrm{t}$. Then $\mathcal{A}_\Theta(h^+) \leq \mathcal{A}_\Theta(K^+)$. ^pro-cap-translate-reduction

_Proof._ By the definition of $K^+ := \mathcal{C}_\Theta(h^+)$, we always have $h_{K^+}(t) \leq h^+(t)$ on $t \in \Theta^\diamond$ and $K^+ \subseteq P_{h^+}$.[^delicate-support] Since $K^+$ is a polygon cap translate, it has width 1 in the directions of $u_\omega$ and $u_{\pi/2}$, so is circumscribed in $P_{h^+}$. So we have equality $h_{K^+}(t) = h^+(t)$ for $t = \omega, \pi/2$, and $F_{h_K^+} = F_{h^+}$ in particular. From this and $h_{K^+}(t) \leq h^+(t)$ on $t \in \Theta^\diamond$, we have $\mathcal{N}_{\Theta}(h_{K^+}) \subseteq \mathcal{N}_\Theta(h^+)$. By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-extension-compatible]] on $K^+$ we have $\mathcal{C}_\Theta(h_{K^+}) = K^+ = \mathcal{C}_\Theta(h^+)$. Now
$$
\begin{align*}
\mathcal{A}_\Theta(h^+) & = |\mathcal{C}_\Theta(h^+)| - |\mathcal{N}_\Theta(h^+)| \\
& \leq |\mathcal{C}_\Theta(h_{K^+})| - |\mathcal{N}_\Theta(h_{K^+})| =\mathcal{A}_\Theta(h_{K^+}) = \mathcal{A}_\Theta(K^+)
\end{align*}
$$
where we use [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-cap-translate-extensions]] in the last equality. □

%% TODO: checked up to here %%

# Maximum Polygon Sofa

We now define the polygon cap $K_\Theta$ attaining the maximum value of $\mathcal{A}_\Theta$.

> __Definition [maximum-polygon-cap].__ Call a polygon cap $K_\Theta \in \mathcal{K}_\Theta^\mathrm{c}$ a _maximum polygon cap_ with _angle set_ $\Theta$ if $o_\omega \in K_\Theta$ and $K := K_\Theta$ attains the maximum value of $\mathcal{A}_\Theta : \mathcal{K}_\Theta^\mathrm{c} \to \mathbb{R}$. ^def-maximum-polygon-cap

> __Remark [maximum-polygon-cap].__ The condition $o_\omega \in K_\Theta$ in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^def-maximum-polygon-cap]] is only relevant when $\omega = \pi/2$. ^rem-maximum-polygon-cap

> __Lemma [maximum-polygon-cap-mirror].__ The mirror reflection of any maximum polygon cap $K_\Theta \in \mathcal{K}_\Theta^\mathrm{c}$ is a maximum polygon cap with the angle set $\omega - \Theta$. ^lem-maximum-polygon-cap-mirror

_Proof._ Observe that $\mathcal{A}_\Theta$ and $o_\omega$ are preserved under the mirror reflection $M_\omega$. □

> __Lemma [polygon-cap-bounded].__ Let $\omega \in (0, \pi/2]$ and $t \in (0, \omega)$ be arbitrary. There exists a constant $c_{\omega, t} > 0$ such that the following holds. Let $\Theta$ be any angle set of rotation angle $\omega$ containing $t$. Assume that $K \in \mathcal{K}_\Theta^\mathrm{c}$ satisfies $\mathcal{A}_\Theta(K) > 0$. Then the width of $K$ along the direction $u_0$ is at most $c_{\omega, t}$. ^lem-polygon-cap-bounded

_Proof._ If $\omega < \pi/2$, then as $K \subseteq P_\omega$ it suffices to take $c_{\omega, t}$ as the width of $P_\omega$ along the direction $u_0$. Now assume $\omega = \pi/2$ and fix $t$. Take any $K \in \mathcal{K}_\Theta^\mathrm{c}$ with the angle set $\Theta$ containing $t$, and let $d$ be the width of $K$ along $u_0$. Then $|K| \leq d$. The wedge $T_K(t)$ is a right triangle of side $\geq d - \sec t - \csc t$ and the non-right angle $t$. So $|\mathcal{N}_\Theta(K)| \geq |T_K(t)| \geq Q_t(d)$, where $Q_t(d)$ is a quadratic polynomial of $d$ completely determined by $t$ with positive leading coefficient. Now there exists a constant $c_{\pi/2, t} > 0$ so that for any $K \in \mathcal{K}_\Theta^\mathrm{c}$ with width $d > c_{\pi/2, t}$ we have $\mathcal{A}_\Theta(K) = |K| - |\mathcal{N}_\Theta(K)| \leq d - Q_t(d) \leq 0$. Take the contraposition to finish the proof. □

> __Theorem [maximum-polygon-cap].__ For any angle set $\Theta$, a maximum polygon cap $K_\Theta$ exists. ^thm-maximum-polygon-cap

_Proof._ We first show that $\mathcal{A}_\Theta(K) = |K| - |\mathcal{N}_\Theta(K)|$ on $K \in \mathcal{K}_\Theta^\mathrm{c}$ is continuous with respect to the Hausdorff distance $d_\mathrm{H}$ on $K \in \mathcal{K}_\Theta^\mathrm{c}$. By Theorem 1.8.20, page 68 of [@schneider_2013], $|K|$ is continuous with respect to $d_\mathrm{H}$. Fix an $K \in \mathcal{K}_\Theta^\mathrm{c}$ and take any $K' \in \mathcal{K}_\Theta^\mathrm{c}$ sufficiently close to $K$ in $d_\mathrm{H}$. By [[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/15. Cap Contains Niche#^pro-wedge]], the absolute value of $|\mathcal{N}_\Theta(K')| - |\mathcal{N}_\Theta(K)|$ is at most the sum of the areas of the symmetric difference $\Delta(t)$ between wedges $T_K(t)$ and $T_{K'}(t)$ over all angles $t \in \Theta$. As $K' \to K$ in $d_\mathrm{H}$, we have $h_{K'}(t) \to h_K(t)$ and $h_{K'}(t + \pi/2) \to h_K(t)$ so $|\Delta(t)| \to 0$. This shows that $|\mathcal{N}_\Theta(K')| \to |\mathcal{N}_\Theta(K)|$ as $K' \to K$ in $d_\mathrm{H}$. So $\mathcal{A}_\Theta(K)$ is continuous in $K$ with respect to $d_\mathrm{H}$.

Let $\mathcal{B}_\Theta$ be the collection of all $K \in \mathcal{K}_\Theta^\mathrm{c}$ such that $\mathcal{A}_\Theta(K) \geq 0$ and $o_\omega \in K$. By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-polygon-cap-bounded]], the width of any member of $\mathcal{B}_\Theta$ is bounded by the constant $c_{\omega, t}$. So by the Blasckhe selection theorem, the domain $\mathcal{B}_\Theta$ is compact in $\mathcal{K}_\Theta^\mathrm{c}$. Let $K_1 \in \mathcal{K}_\Theta^\mathrm{c}$ be the polygon cap with the support function $h_{K_1}(t) = 1$ for every $t \in \Theta^{\diamond}$ (this $K_1$ is equal to $\mathcal{C}_\Theta(K)$ where $K$ is the semicircle of angle $\pi/2 + \omega$ centered at $O$). Then $\mathcal{N}_\Theta(K_1)$ is empty and $o_\omega \in K_1$ so we have $K_1 \in \mathcal{B}_\Theta$ and $\mathcal{B}_\Theta$ is nonempty. So a maximizer $K_\Theta$ of $\mathcal{A}_\Theta(K_\Theta)$ on the compact and nonempty domain $\mathcal{B}_\Theta$ exists.

We finally show that $K := K_\Theta$ maximizes $\mathcal{A}_\Theta(K)$ over the domain $K \in \mathcal{K}_\Theta^\mathrm{c}$ larger than $\mathcal{B}_\Theta$. Take any other $K' \in \mathcal{K}_\Theta^\mathrm{c}$. Our goal is to show that $\mathcal{A}_\Theta(K') \leq \mathcal{A}_\Theta(K_\Theta)$. If $\mathcal{A}_\Theta(K') < 0$, then we have $\mathcal{A}_\Theta(K') < 0 \leq \mathcal{A}_\Theta(K_1)$ and $\mathcal{A}_\Theta(K_1) \leq \mathcal{A}_\Theta(K_\Theta)$ since $K_1 \in \mathcal{B}_\Theta$ so the proof is done. So assume $\mathcal{A}_\Theta(K') \geq 0$. If $\omega < \pi/2$, then we have $o_\omega \in K'$ so $K' \in \mathcal{B}_\Theta$ and again the proof is done. So assume also $\omega = \pi/2$. Now any horizontal translation of $K'$ is also a cap $K'' \in \mathcal{K}_\Theta^\mathrm{c}$ with the same $\mathcal{A}_\Theta(K'') = \mathcal{A}_\Theta(K')$. Find one translate $K''$ that contains the point $o_\omega = (0, 1)$. Then $K'' \in \mathcal{B}_\Theta$, and we have $\mathcal{A}_\Theta(K') = \mathcal{A}_\Theta(K'') \leq \mathcal{A}_\Theta(K_\Theta)$, completing the proof. □

> __Definition [polyline].__ For any $n \geq 1$ and a finite sequence $p_1, p_2, \dots, p_n \in \mathbb{R}^2$ of points on a plane with strictly increasing $x$-coordinates, call the union of the closed segments connecting adjacent points $p_i$ to $p_{i+1}$ ($1 \leq i < n$) an _$x$-monotone polyline_. ^def-polyline

> __Theorem [polyline].__ For any polygon cap $K \in \mathcal{K}_\Theta^\mathrm{c}$, the boundary of the closed set $F_\omega \setminus \mathcal{N}_\Theta(K)$ is a disjoint union of the following subsets, from left to right in $\mathbb{R}^2$. ^thm-polyline
> 
> 1. The open half-line from $C_K^+(\omega)$ extending in the direction $v_\omega$ but not containing $C_K^+(\omega)$.
> 2. An $x$-monotone polyline $\mathbf{p}_K$ from left to right connecting $C_K^+(\omega)$ to $A_K^-(0)$, with each segment of normal angle $t \in \Theta^\diamond$.
> 3. The open half-line from $A_K^-(0)$ extending in the direction $u_0$ but not containing $A_K^-(0)$.

_Proof._ Call the half-lines in (1) and (3) as $\mathbf{l}_K$ and $\mathbf{r}_K$ respectively. Let $X := \bigcup_{t \in \Theta} Q_K^-(t)$. Observe that $X$ is a Nef polygon closed in the direction of $-v_0$ ([[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/10. Monotone Sofa#^def-closed-in-direction]]) with edges of normal angles in $\Theta \cup \left\{ \omega, \pi/2 \right\}$. So since $F_\omega \setminus \mathcal{N}_\Theta(K) = F_\omega \setminus X$, it suffices to show that $\mathbf{l}_K$ and $\mathbf{r}_K$ are disjoint from $X$. Take any $t \in \Theta$. Since $w_K(t) > 0$ by [[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/15. Cap Contains Niche#^thm-wedge-ends-in-cap]], the point $A_K^-(0)$ and thus the half-line $\mathbf{r}_K$ is on the right side of the line $b_K(t)$. So $\mathbf{r}_K$ is disjoint from $Q_K^-(t)$. Likewise, from $z_K(t) > 0$ of [[01. Rotation Angle of Maximum-area Sofas/05. Monotone Sofa/15. Cap Contains Niche#^thm-wedge-ends-in-cap]], $Q_K(t)$ is disjoint from $Q_K^-(t)$ as well. □

> __Definition [polyline].__ Define the polyline $\mathbf{p}_K$ in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-polyline]] from $C_K^+(\omega)$ to $A_K^-(0)$ as the _polyline of cap_ $K \in \mathcal{K}_\Theta^\mathrm{c}$. ^def-polyline

> __Definition [polyline-length].__ For any cap $K \in \mathcal{K}_\Theta^\mathrm{c}$ and angle $t \in \Theta^\diamond$, define $\tau_K(t)$ as the sum of the lengths of the edges in the polyline $\mathbf{p}_K$ with normal angle $t$. ^def-polyline-length

The lengths $\tau_K(t)$ of the edges of $\mathbf{p}_K$ relates to the lengths of the boundary $\partial \mathcal{N}_\Theta(K)$ of the polygon niche $\mathcal{N}_\Theta(K)$.

> __Lemma [polyline-length].__ Let $K \in \mathcal{K}_\Theta^\mathrm{c}$ be arbitrary. ^lem-polyline-length
> 
> 1. For any $t \in \Theta$, we have
$$
\mathcal{H}^1 \left( \partial \mathcal{N}_\Theta(K) \cap b_K(t) \right) = \tau_K(t)
$$
> and
$$
\mathcal{H}^1 \left( \partial \mathcal{N}_\Theta(K) \cap d_K(t) \right) = \tau_K(t + \pi/2).
$$
> 2. For any $t \in \left\{ \omega, \pi/2 \right\}$, we have
$$
\mathcal{H}^1\left( \partial \mathcal{N}_\Theta(K) \cap l(t, 0) \right) = \mathcal{H}^1\left(\mathcal{N}_\Theta(K) \cap l(t, 0) \right) = \sigma_K(t + \pi) - \tau_K(t).
$$

_Proof._ Define $X := \bigcup_{t \in \Theta} Q_K^-(t)$ and recall that $\mathcal{N}_\Theta(K) = F_\omega \cap X$. Define the followings.

- The intersection $M := X \cap \partial F_\omega$ which is open in the subspace topology of $\partial F_\omega$.
- The boundary $N \subseteq F_\omega^\circ$ of $\mathcal{N}_\Theta(K)$ in the subspace topology of $F_\omega^\circ$.
- The intersection $P := \partial X \cap \partial F_\omega$ which is a finite set of points in $\partial F_\omega$.

We will check that the boundary $\partial \mathcal{N}_\Theta(K)$ is a disjoint union of $M, N, P$. Since $F_\omega^\circ$ is open, we have $N = \partial \mathcal{N}_\Theta(K) \cap F_\omega^\circ$. Since $M, P \subseteq \partial F_\omega$, and they are disjoint since $X$ is open, it suffices to show that $X' := \partial \mathcal{N}_\Theta(K) \cap \partial F_\omega$ is a union of $M$ and $P$. The union of $M$ and $P$ is $\overline{X} \cap \partial F_\omega$ so it contains $X'$. 

Define $D := K \cap \partial F_\omega$. Then $D = e_K(\omega + \pi) \cup e_K(3\pi/2)$ since $K$ is a cap. Define $Y := \partial(F_\omega \setminus \mathcal{N}_\Theta(K))$. We will check that $Y = N \cup (\partial F_\omega \setminus M)$. It is easy to check that $Y \cap F_\omega^\circ = N$. 

As in the proof of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-polyline]], the set $\mathbf{p}_K$ is equal to $Y \setminus \mathbf{l}_K \setminus \mathbf{r}_K$ where the two half-lines $\mathbf{l}_K$ and $\mathbf{r}_K$ in the proof are disjoint from $X$. Since $Y = N \cup (\partial F_\omega \setminus M)$ and $\partial F_\omega \setminus \mathbf{l}_K \setminus \mathbf{r}_K = D$, we have $\mathbf{p}_K = N \cup (D \setminus M)$.

We prove (1). 
$$
\mathcal{H}^1 \left( \partial \mathcal{N}_\Theta(K) \cap b_K(t) \right) = \mathcal{H}^1 \left( N \cap b_K(t) \right) =  \mathcal{H}^1 \left( \mathbf{p}_K \cap b_K(t) \right) = \tau_K(t)
$$
because $M, P, D \subseteq \partial F_\omega$ only intersect $\bar{b}_K(t)$ at a finite number of points.

We prove (2).
$$
\mathcal{H}^1\left( \partial \mathcal{N}_\Theta(K) \cap l(t, 0) \right) = \mathcal{H}^1\left(M \cap l(t, 0) \right) = \mathcal{H}^1\left((D \setminus \mathbf{p}_K) \cap l(t, 0) \right) = \sigma_K(t + \pi) - \tau_K(t)
$$
because $N$ is disjoint from $\partial F_\omega$ and $P$ is a finite number of points. □

Now we define the notion of balancedness on $K \in \mathcal{K}_\Theta^\mathrm{c}$.

> __Definition [polygon-cap-balanced].__ Say that a polygonal cap $K \in \mathcal{K}_\Theta^\mathrm{c}$ is _balanced_ if and only if for any $t \in \Theta^{\diamond}$, we have $\sigma_K\left( \left\{ t \right\} \right) = \tau_K(t)$. ^def-polygon-cap-balanced

We now show that any maximum polygon cap $K_\Theta \in \mathcal{K}_\Theta^\mathrm{c}$ is balanced. The following lemma chooses the right angle $t \in \Theta^\diamond$ to balance $K \in \mathcal{K}_\Theta^\mathrm{c}$.

> __Lemma [not-balanced-positive].__ Assume that a polygon cap $K \in \mathcal{K}_\Theta^\mathrm{c}$ is _not_ balanced. Then there exists an angle $t \in \Theta^\diamond$ such that $\sigma_K(t) > \tau_K(t)$. ^lem-not-balanced-positive

_Proof._ By following the polyline $\mathbf{p}_K$ from right to left, we have the identity
$$
C_K^+(\omega) - A_K^-(0) = \sum_{t \in \Theta^{\diamond}} \tau_K(t) v_t.
$$
Also, by following the upper boundary $\delta K$ of $K$ from right to left, we also have the identity
$$
C_K^+(\omega) - A_K^-(0) = \sum_{t \in \Theta^{\diamond}} \sigma_K(t) v_t.
$$
So we have $\sum_{t \in \Theta^{\diamond}} (\tau_K(t) - \sigma_K(t)) (v_t \cdot u_0) = 0$ where $v_t \cdot u_0 < 0$ for all $t \in \Theta^{\diamond}$. If $\sigma_K(t) \leq \tau_K(t)$ for all $t \in \Theta^{\diamond}$, then the equality should hold and $K$ should be balanced. Taking the contraposition concludes the proof. □

Execute the balancing step by pusing the edge $e_K(t)$ in the positive direction of $u_t$.

> __Lemma [balancing].__ Let $h \in \mathcal{H}_\Theta$ be the support function of arbitrary $K \in \mathcal{K}_\Theta^\mathrm{c}$. Let $t \in \Theta^{\diamond}$ be arbitrary. Take sufficiently small $\epsilon > 0$ relative to $K$ and $t$. Define $h^+ \in \mathcal{H}_\Theta$ as $h^+(t) = h(t) + \epsilon$ and $h^+(u) = h(u)$ for all $u \neq t$. Then we have ^lem-balancing
$$
\mathcal{A}_\Theta(h^+) = \mathcal{A}_\Theta(h) + (\sigma_K(t) - \tau_K(t)) \epsilon + O(\epsilon^2).
$$

_Proof._ First consider the case $t \not\in \left\{ \omega, \pi/2 \right\}$. We have
$$
|\mathcal{C}_\Theta(h^+)| = |\mathcal{C}_\Theta(h)| + \sigma_K(t) \epsilon + O(\epsilon^2)
$$
by applying [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^thm-simple-nef-polygon]] to the simple Nef polygon $\mathcal{C}_\Theta(h)$ (). We also have 
$$
|\mathcal{N}_\Theta(h^+)| = |\mathcal{N}_\Theta(h)| + \tau_K(t) \epsilon + O(\epsilon^2)
$$
by applying [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^thm-simple-nef-polygon]] to the simple Nef polygon $\mathcal{N}_\Theta(h) = \mathcal{N}_\Theta(K)$ ([[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-niche-nef-polygons]]) and using (1) of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-polyline-length]]. Subtract the two equations above to conclude the proof.

Now consider the case $t \in \left\{ \omega, \pi/2 \right\}$. Recall that by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-niche-nef-polygons]], the simple Nef polygon $\mathcal{C}_\Theta(h)$ have defining half-planes including $H_-(t, h(t))$ and $H_{+}(t, h(t) - 1)$. Now apply [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^thm-simple-nef-polygon]] twice to $C_\Theta(h)$ to get the following.
$$
|\mathcal{C}_\Theta(h^+)| = |\mathcal{C}_\Theta(h)| + (\sigma_K(t) - \sigma_K(t + \pi) ) \epsilon + O(\epsilon^2)
$$
Here, we first push $H_-(t, h(t)$ to $H_-(t, h^+(t))$ by $\epsilon$ while keeping $H_{+}(t, h(t) - 1)$ intact. Then, we push $H_{+}(t, h(t) - 1)$ towards $H_{+}(t, h^+(t) - 1)$ by $\epsilon$ while keeping $H_-(t, h^+(t))$ intact. Since the two half-planes have parallel boundaries of distance 1, the two applications of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^thm-simple-nef-polygon]] do not intefere with each other. We also have
$$
|\mathcal{N}_\Theta(h^+)| = |\mathcal{N}_\Theta(h)| + (\sigma_K(t + \pi) - \tau_K(t)) \epsilon + O(\epsilon^2)
$$
by applying [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/01. Nef Polygon#^thm-simple-nef-polygon]] to $\mathcal{N}_\Theta(h)$ and using (2) of [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-polyline-length]]. Subtract the two equations above to conclude the proof. □

Choosing the right angle $t \in \Theta^\diamond$ in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-not-balanced-positive]] guarantees that the new function $h^+ \in \mathcal{H}_\Theta$ with $h^+(t) := h(t) + \epsilon$ corresponds to a cap translate $K^+$.

> __Lemma [height-positive-increment].__ Let $K \in \mathcal{K}_\Theta^\mathrm{c}$ be arbitrary with the support function $h := h_K \in \mathcal{H}_\Theta$, so that $K = \mathcal{C}_\Theta(h)$ by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-extension-compatible]]. Let $t \in \Theta^\diamond$ be arbitrary such that $\sigma_K(t) > 0$. ^lem-height-positive-increment
> 
> Take any $\epsilon > 0$ sufficiently small relative to $K$ and $t$, and define $h^+ \in \mathcal{H}_\Theta$ as $h^+(t) := h(t) + \epsilon$ and $h^+(s) := h(s)$ on $s \neq t$. Then the intersection $K^+ := \mathcal{C}_\Theta(h^+)$ is a polygon cap translate in $\mathcal{K}_\Theta^\mathrm{t}$.

_Proof._ We prove the case $t \not\in \left\{ \omega, \pi/2 \right\}$. We have $K = \mathcal{C}_\Theta(h) \subseteq \mathcal{C}_\Theta(h^+) = K^+$ by the definition of $\mathcal{C}_\Theta$ and $K^+$. So $K \subseteq K^+ \subseteq P_\omega$ and $K^+ \in \mathcal{K}_\Theta^\mathrm{c}$ as we want.

Now assume $t \in \left\{ \omega, \pi/2 \right\}$. We first show that $K^+$ is a polygon cap translate. By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-trans-space]] it suffices to show that the width of $K^+$ is one in the angles $\omega$ and $\pi/2$.

Since $\sigma_K\left( \left\{ t \right\} \right) > 0$, we have $h_{K^+}(t) = h_K(t) + \epsilon$ for sufficiently small $\epsilon > 0$.[^crucial-proof] As $\epsilon > 0$, we have $h_{K^+}(t + \pi) = h_K(t + \pi) - \epsilon$ as well. So the width of $K^+$ along $u_t$ is one. If $\omega = \pi/2$ then we are done. If $\omega < \pi/2$, let $t'$ be the other value than $t$ in $\left\{ \omega, \pi/2 \right\}$. We have $h_{K^+}(t') = h_K(t')$ as $l_K(t)$ moves upwards. Also, as $\sigma_K(t' + \pi) \geq o_\omega \cdot u_0 > 0$, we have $h_{K^+}(t' + \pi) = h_K(t' + \pi)$ as $l_K(t + \pi)$ moves upwards, completing the proof. □

> __Remark [height-positive-increment].__ In [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-height-positive-increment]], we do not claim that $h^+$ is the supporting function $h_{K^+}$ of $K^+$. ^rem-height-positive-increment

Combine the steps above to show the balancedness of a maximum polygon cap.

> __Theorem [balanced-polygon-sofa].__ Any maximum polygon cap $K_\Theta \in \mathcal{K}_\Theta^\mathrm{c}$ is balanced. ^thm-balanced-polygon-sofa

_Proof._ Assume by contradiction that $K := K_\Theta$ is not balanced. Let $h := h_K \in \mathcal{H}_\Theta$ so that $\mathcal{A}_\Theta(K) = \mathcal{A}_\Theta(h)$ by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-niche-extension-compatible]]. Take $t \in \Theta^{\diamond}$ with $\sigma_K(t) > \tau_K(t) \geq 0$ as in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-not-balanced-positive]]. Now take sufficiently small $\epsilon > 0$ and define $h^+ \in \mathcal{H}_\Theta$ and the polygon cap translate $K^+ := \mathcal{C}_\Theta(h^+) \in \mathcal{K}_\Theta^\mathrm{c}$ as in [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-height-positive-increment]]. Then we have $\mathcal{A}_\Theta(h) < \mathcal{A}_\Theta(h^+)$ by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-balancing]]. We also have $\mathcal{A}_\Theta(h^+) \leq \mathcal{A}_\Theta(K^+)$ by [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^pro-cap-translate-reduction]]. Since $K^+$ is a translation of some polygon cap $K_0 \in \mathcal{K}_\Theta^\mathrm{c}$, we have $\mathcal{A}_\Theta(K^+) = \mathcal{A}_\Theta(K_0)$. Summing up, we have
$$
\mathcal{A}_\Theta(K) = \mathcal{A}_\Theta(h) < \mathcal{A}_\Theta(h^+) \leq \mathcal{A}_\Theta(K^+) = \mathcal{A}_\Theta(K_0)
$$
where $K_0 \in \mathcal{K}_\Theta^\mathrm{c}$ is a polygon cap, so $K\in \mathcal{K}_\Theta^\mathrm{c}$ cannot attain the maximum value of $\mathcal{A}_\Theta$, leading to contradiction. □

> __Theorem [balanced-polygon-sofa-connected].__ Any balanced polygon cap $K$ with angle set $\Theta$ contains its polygon niche $\mathcal{N}_\Theta(K)$. ^thm-balanced-polygon-sofa-connected

_Proof._ Denote $K_\Theta$ simply as $K$. By [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^thm-polyline]], it suffices to show that any vertex $p$ of the polyline $\mathbf{p}_K$ is contained in $K$. It suffices to show $p \in H_K(s)$ for any $s \in \Theta \cup \left\{ \omega \right\}$. Once this is done, apply a corresponding argument to mirror reflection of $K$ ([[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-maximum-polygon-cap-mirror]]) and reflect back to conclude $p \in H_K(\omega + \pi/2 - t)$ for any $t \in \Theta \cup \left\{ \omega \right\}$ as well. Then $p \in F_\omega \cap \bigcap_{t \in \Theta^{\diamond}} H_K(t) = K$, completing the proof.

Follow $\mathbf{p}_K$ from right to left, from the right endpoint $A_K^-(0)$ to the point $p$ and stop. By summing up the contribution of edges between $A_K^-(0)$ and $p$ in $\mathbf{p}_K$, we have 
$$
A_K^-(0) - p = \sum_{t \in \Theta^{\diamond}} c_t v_t
$$
with coefficients $c_t \in [0, \tau_K(t)]$ for every $t \in \Theta^{\diamond}$. Under this constraint on $c_t$, the value
$$
(p - A_K^-(0)) \cdot u_{s} = \sum_{t \in \Theta^{\diamond}} c_t (v_t \cdot u_{s})
$$
is maximized when $c_t = \tau_K(t)$ for all $t \leq s$ and $c_t = 0$ otherwise. For such $c_t$ we have the equality
$$
\sum_{t \in \Theta^{\diamond}} c_t v_t = A_K^+(s) - A_K^-(0)
$$
that can be obtained by following the upper boundary $\delta K$ from $A_K^-(0)$ to $A_K^+(s)$. So we have
$$
(p - A_K^-(0)) \cdot u_{s} \leq (A_K^+(s) - A_K^-(0)) \cdot u_{s}
$$
which implies $p \cdot u_{s} \leq A_K^+(s) \cdot u_{s}$, that in turn implies $p \in g_K(s)$ as we desired. □

[^delicate-support]: Note that we do not require $h^+ = h_{K^+}$ here. It is possible that the resulting cap $K^+$ have support function _less_ than $h^+$ after intersection, because it is not guaranteed that the values of $h^+$ are not guaranteed to be in convex position.

[^crucial-proof]: That $\sigma_K(t) > 0$ is extremely crucial here. Otherwise, $K^+$ might have width less than zero in the angle of either $t = \omega$ or $t = \pi/2$, which is necessary for $K^+$ to be a polygon cap translate. This is why we choose $t$ according to [[01. Rotation Angle of Maximum-area Sofas/10. Balanced Sofa/15. Maximum Polygon Cap#^lem-not-balanced-positive]].