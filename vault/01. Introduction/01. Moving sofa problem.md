Moving a large couch through a narrow hallway requires a well-planned pivoting. The _moving sofa problem_, first published by Leo Moser in 1966 [@moser1966problem], is asked in a two-dimensional idealization of such a situation: 

> What is the largest area $\mu_{\text{max}}$ of a connected shape that can move around the right-angled corner of a hallway with unit width?

More precisely, define the hallway $L$ as the union $L = L_H \cup L_V$ of sets $L_H = (-\infty, 1] \times [0, 1]$ and $L_V = [0, 1] \times (-\infty, 1]$ representing the horizontal and vertical side of $L$ respectively. A _moving sofa_ $S$ may be defined as a connected subset of $L_H$ that can be moved inside $L$ by a continuous rigid motion to a subset of $L_V$. It is known that there exists a moving sofa attaining the maximum area $\mu_{\text{max}}$ [@gerverMovingSofaCorner1992; @croft2012unsolved], but the precise value of $\mu_{\text{max}}$ remains unknown despite decades of partial progress [@hammersley1968enfeeblement; @gerverMovingSofaCorner1992; @romikDifferentialEquationsExact2018; @kallusImprovedUpperBounds2018].

The best bounds currently known on $\mu_{\max}$ are summarized as ^eqn-best-bounds
$$
\mu_G := 2.2195\dots \leq \mu_{\max} \leq 2.37.
$$
The lower bound $2.2195\dots \leq \mu_{\max}$ comes from Gerver's sofa $S_G$ of area $\mu_G := 2.2195\dots$ constructed in 1994 [@gerverMovingSofaCorner1992] (see [[#^fig-gerver]]). Gerver derived his sofa from local optimality considerations[^gerver-derivation] and conjectured $\mu_G = \mu_{\max}$ that his sofa attains the maximum area. Approximate solutions found by computer experiments are consistent with Gerver's conjecture.[^experiments]

> __Figure [gerver].__ Gerver's sofa $S_G$. The ticks denote the endpoints of 18 analytic curves and segments constituting the boundary of $S_G$ (see [@romikDifferentialEquationsExact2018] for details). The lower portion of $S_G$ is made of two small 'tails' (depicted red) and one large 'core' (depicted blue). ^fig-gerver
> 
> ![70%](images/gerver-sofa.svg)

On the other hand, the upper bound $\mu_{\max} \leq 2.37$ was proved by Kallus and Romik [@kallusImprovedUpperBounds2018]. If Gerver's conjecture $\mu_{\max} = \mu_G$ is true, then the remaining task would be to bring the upper bound of $\mu_{\max}$ down to the lower bound $\mu_G$. However, not many methods are known for bounding $\mu_{\max}$ from above. All known upper bounds approximates the sofa by a polygonal intersection $S_\Theta$ of the horizontal strip $H = \mathbb{R} \times [0, 1]$ and copies of hallways $L$ rotated counterclockwise by each angle in a finite set $\Theta \subseteq (0, \pi/2)$ (see [[01. Introduction/01. Moving Sofa Problem#^fig-polygon-sofa]]). The bound $\mu_{\max} \leq 2 \sqrt{2}$ by Hammersley [@hammersley1968enfeeblement] is obtained by taking a single angle $\Theta = \left\{ \pi/4 \right\}$, and the bound $\mu_{\max} \leq 2.37$ by Kallus and Romik is obtained by taking five specific angles and 

> __Figure [polygon-sofa].__ Polygonal intersection $S_\Theta$ used by 
> ![70%](images/polygon-sofa.svg)
> ^fig-polygon-sofa

We give a new approach for bounding $\mu_{\max}$ from above by interpreting the moving sofa problem as an infinite-dimensional convex quadratic programming. Consequently, we prove that any moving sofa satisfying a certain property, named as the _injectivity condition_ ([[01. Introduction/03. Main Result#^def-injectivity]]), has an area at most $1 + \pi^2/8 = 2.2337\dots$ ([[01. Introduction/03. Main Result#^thm-main]]). This upper bound, while conditional, is much closer to the lower bound $2.2195\dots$ of Gerver than the computer-assisted upper bound $2.37$ of Kallus and Romik. Since Gerver's sofa $S_G$ satisfies the injectivity condition, our conditional upper bound is effective on a domain containing the conjectured optimum $S_G$. We also conjecture the _injectivity hypothesis_ ([[01. Introduction/03. Main Result#^con-injectivity]]) that there exists a maximum-area moving sofa satisfying the injectivity condition. With our result, proving the injectivity hypothesis amounts to improving the upper bound to $\mu_{\max} \leq 1 + \pi^2/8$.


A major idea is to ignore the contribution of the two inner walls (see left of ).

The proof does not rely on any computer assistance, and reframes the problem to a convex quadratic optimization problem as a new approach. Then we use a calculus of variation based on the Brunn-Minkowski theory on convex bodies to prove the upper bound $1 + \pi^2/8$. 

Along the way, we prove a rigorous version of Mamikon's theorem that works for any planar convex body, which could be of independent interest.

> __Figure [presofa].__ The maximizing shape $S_1$ of $\mathcal{A}_1$ of area $1 + \pi^2/8 = 2.2337\dots$. The regions below two tails (red curves) stick out of the hallway $L$ during the movement of $S_1$ in $L$ (left). The shape $S_1$ is very similar to Gerver's sofa $S_G$ whose boundary is drawn in dotted lines (right). ^fig-presofa
> 
> ![100%](images/presofa-combined.svg)

[^gerver-derivation]: Gerver assumed five stages of the movement of a sofa to derive his sofa $S_G$ [@gerverMovingSofaCorner1992]. While his sofa $S_G$ is locally optimal (Theorem 2 of [@gerverMovingSofaCorner1992]), this does not eliminate the possibility of a maximum-area sofa with a different kind of movement. Romik's simplified derivation of $S_G$ in [@romikDifferentialEquationsExact2018] also relies on the same assumption (Equation 24, p324 of [@romikDifferentialEquationsExact2018]). So their derivations do not constitute a full proof of Gerver's conjecture $\mu_{\max} = \mu_G$.

[^experiments]: Wagner used Monte Carlo simulation to find an approximate solution (Figure 2 of [@wagner1976sofa]) that resembles Gerver's sofa in shape. More recent approximate solutions, as found by Gibbs [@gibbsComputationalStudySofas] in 2014 and Batsch [@batschNumericalApproachAnalysing2022] in 2022, deviate in area from Gerver's sofa by small margins of $1.7 \times 10^{-7}$ and $5.7 \times 10^{-9}$ respectively.
