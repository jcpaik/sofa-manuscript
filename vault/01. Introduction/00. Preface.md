# Moving Sofa Problem

Moving a large couch through a narrow hallway requires well-planned pivoting. The _moving sofa problem_, first published by Leo Moser in 1966 [@moser1966problem], is asked in a two-dimensional idealization of such a situation: 

> What is the largest area $\mu_{\text{max}}$ of a connected shape that can move around the right-angled corner of a hallway with unit width?

More precisely, define the hallway $L$ as the union $L = L_H \cup L_V$ of sets $L_H = (-\infty, 1] \times [0, 1]$ and $L_V = [0, 1] \times (-\infty, 1]$ representing the horizontal and vertical side of $L$ respectively. A _moving sofa_ $S$ may be defined as a connected subset of $L_H$ that can be moved inside $L$ by a continuous rigid motion to a subset of $L_V$. It is known that there exists a moving sofa attaining the maximum area $\mu_{\text{max}}$ [@gerverMovingSofaCorner1992; @croft2012unsolved], but the precise value of $\mu_{\text{max}}$ remains unknown despite decades of partial progress [@hammersley1968enfeeblement; @gerverMovingSofaCorner1992; @romikDifferentialEquationsExact2018; @kallusImprovedUpperBounds2018].

The best bounds currently known on $\mu_{\max}$ are summarized as ^eqn-best-bounds
$$
\mu_G := 2.2195\dots \leq \mu_{\max} \leq 2.37.
$$
The lower bound $2.2195\dots \leq \mu_{\max}$ comes from Gerver's sofa $S_G$ of area $\mu_G := 2.2195\dots$ constructed in 1994 [@gerverMovingSofaCorner1992] (see [[01. Introduction/00. Preface#^fig-gerver]]). Gerver derived his sofa from local optimality considerations[^gerver-derivation] and conjectured $\mu_G = \mu_{\max}$ that his sofa attains the maximum area. Approximate solutions found by computer experiments are consistent with Gerver's conjecture.[^experiments] On the other hand, the upper bound $\mu_{\max} \leq 2.37$ was proved by Kallus and Romik using extensive computer assistance [@kallusImprovedUpperBounds2018].

> __Figure [gerver].__ Gerver's sofa $S_G$. The ticks denote the endpoints of 18 analytic curves and segments constituting the boundary of $S_G$ (see [@romikDifferentialEquationsExact2018] for details). The lower portion of $S_G$ is made of two small 'tails' (depicted red) and one large 'core' (depicted blue). ^fig-gerver
> 
> ![70%](images/gerver-sofa.svg)

We prove that any moving sofa satisfying a certain property, named as the _injectivity condition_ ([[01. Introduction/00. Preface#^def-injectivity]]), has an area at most $1 + \pi^2/8 = 2.2337\dots$ ([[01. Introduction/00. Preface#^thm-main]]). This upper bound, while conditional, is much closer to the lower bound $2.2195\dots$ of Gerver than the upper bound $2.37$ of Kallus and Romik. Since Gerver's sofa $S_G$ satisfies the injectivity condition, our conditional upper bound is effective on the domain containing the conjectured optimum $S_G$. The proof does not rely on any computer assistance, and reframes the problem to a convex quadratic optimization problem as a new approach. Then we use a calculus of variation based on the Brunn-Minkowski theory on convex bodies to prove the upper bound $1 + \pi^2/8$. We also conjecture the _injectivity hypothesis_ ([[01. Introduction/00. Preface#^con-injectivity]]) that there exists a maximum-area moving sofa satisfying the injectivity condition. With our result, proving the injectivity hypothesis amounts to improving the upper bound to $\mu_{\max} \leq 1 + \pi^2/8$.

# Moving Hallway Problem

The moving sofa problem can be seen as an _inverse Kakeya problem_ [@bae2021reverse; @cabelloInverseKakeyaProblem2022]. The original Kakeya problem asks for the minimum-area chamber $R$ in which a needle $S$ of length 1 can be rotated the full $360\degree$, allowing the needle to translate in its movement [@kakeya1917some]. In an _inverse_ Kakeya problem, the shape of the chamber $R$ is fixed and we are asked to find the shape $S$ (the 'needle') of largest area that can rotate freely inside the chamber, also allowing translations in movement. For example, if the chamber is the strip $R = \mathbb{R} \times [0, 1]$ of unit width, and the shape $S$ has to rotate the full $360\degree$, the problem becomes the well-studied _isodiametric problem_ asking for the maximum-area planar shape with diameter at most 1.

The moving sofa problem, as an inverse Kakeya problem, has the hallway as the chamber $R = L$ and the moving sofa $S$ as the 'needle' inside $L$. The inverse Kakeya problem has been solved If the chamber $R$ is a planar convex set; it is a consequence of the Brunn-Minkowski theorem that the largest-area shape $S$ that can rotate the full $360\degree$ inside a convex chamber $R$ is the largest ball inscribed in $R$ [@cabelloInverseKakeyaProblem2022]. Since the hallway $L$ is non-convex, however, the same approach is not effective on the moving sofa problem.

The _rotation angle_ $\omega$ of a moving sofa $S$ is defined as the clockwise angle that $S$ rotates as it moves from $L_H$ to $L_V$ inside $L$. As an inverse Kakeya problem, the angle $\omega$ dictates how much the moving sofa $S$ should rotate inside the hallway $L$. Gerver's sofa has the rotation angle $\omega = \pi/2$. On the other hand, the unit square $[0, 1]^2$ can move inside $L$ with only translation, so it has the rotation angle $\omega = 0$.[^rotation-angle] Let $\omega$ be the rotation angle of a maximum-area moving sofa. Gerver showed that we can assume $\pi/ 3 \leq \omega \leq \pi/2$ ([@gerverMovingSofaCorner1992]). Kallus and Romik improved the lower bound of $\omega$ by showing that $\omega \geq \arcsin(84/85) = 81.203\dots^\circ$ [@kallusImprovedUpperBounds2018]. With this, we will only consider moving sofas with rotation angle $\omega \in (0, \pi/2]$, and it seems reasonable to conjecture that a maximum-area moving sofa has $\omega = \pi/2$.

> __Conjecture [angle].__ (Angle Hypothesis) There exists a maximum-area moving sofa with a movement of rotation angle $\omega = \pi/2$. ^con-angle

> __Remark [angle].__ A single moving sofa $S$ may admit different movements with varying rotation angles $\omega$. For any moving sofa $S$ mentioned in this paper, we will always assume a fixed rotation angle $\omega$ attached to it. So any moving sofa in this paper is technically a tuple of a shape and its fixed rotation angle. In this way, we can talk about _the_ rotation angle of a moving sofa. ^rem-angle

Once we fix the rotation angle $\omega \in (0, \pi/2]$ of a moving sofa $S$, we can change the moving sofa problem as the moving _hallway_ problem. In [@gerverMovingSofaCorner1992], Gerver looked at the hallway $L$ in the perspective of the moving sofa $S$, so that $S$ is fixed and the hallway $L$ moves around the sofa (see [[01. Introduction/00. Preface#^fig-monotone-sofa]]). In this perspective, we claim that the sofa $S$ is a common subset of the following sets.

1. For every angle $t \in [0, \omega]$, the rotated hallway $L_t$, which is the hallway $L$ rotated counterclockwise by $t$ and translated so that the outer walls of $L_t$ are in contact with $S$.
2. The horizontal strip $H = \mathbb{R} \times [0, 1]$.
3. A translation of $V_\omega$, where $V_\omega$ is the vertical strip $V = [0, 1] \times \mathbb{R}$ rotated counterclockwise by $\omega$ along the origin.

To observe (1) that $S \subseteq L_t$ for every angle $t \in [0, \omega]$, note that the sofa $S$ is rotated initially by a clockwise angle of $0$ and finally by $\omega$ during its movement. By the intermediate value theorem, there is a moment where a copy of $S$ is rotated clockwise by $t$ inside $L$. Push that copy of $S$ in $L$ towards the positive $x$ and $y$ directions, until it makes contact with the outer walls $x=1$ and $y=1$ of $L$. See this configuration in the perspective of $S$ to conclude $S \subseteq L_t$. To observe (2) and (3), note that the sofa $S$ is initialy in $L_H$ and finally in $L_H$ rotated clockwise by $\omega$; see the configurations in perspective of $S$ ot conclude that $S$ is in $H$ and a translation of $V_\omega$.

> __Figure [monotone-sofa].__ The movement of a moving sofa $S$ with rotation angle $\omega = \pi/2$ in perspective of the hallway (left) and the sofa (right). The monotone sofa $S$ is equal to the cap $K$ minus its niche $N$. The cap $K$ is a convex body with the outer walls of $L_t = L_S(t)$ as tangent lines of $K$ (and $S$). The niche $N$ is the union of all triangular regions bounded by the inner walls of $L_t = L_S(t)$. ^fig-monotone-sofa
> 
> ![100%](images/monotone-sofa-combined.svg)

Without loss of generality, we can translate the moving sofa $S$ horizontally and assume that $S$ is contained in $V_\omega$, not its arbitrary translation.[^translation] Then from (1), (2) and (3) above, we can always assume that $S$ is contained in the intersection ^eqn-monotone
$$
\mathcal{M}(S) := H \cap V_\omega \cap \bigcap_{0 \leq t \leq \omega} L_t
$$
that we will define as the _monotonization_ of a moving sofa $S$. The set $\mathcal{M}(S)$ is also movable inside $L$; observe that $\mathcal{M}(S)$ is in each rotating hallway $L_t$ of angle $t \in [0, \omega]$, and see this in the perspective of the fixed hallway $L$ instead of the moving hallway $L_t$ and vary $t$ from $0$ to $\omega$. So the monotonization $\mathcal{M}(S)$ is a moving sofa containing $S$[^connectedness] ([[15. Monotone sofas/10. Monotonization#^thm-monotonization-is-sofa]]), and we call such a sofa $\mathcal{M}(S)$ from monotonization a _monotone sofa_ ([[15. Monotone sofas/10. Monotonization#^def-monotone-sofa]]). Since any moving sofa $S$ is contained in a larger monotone sofa $\mathcal{M}(S)$, we only need to consider monotone sofas for the moving sofa problem.

# Main Result

Assume the maximum-area monotone sofa $S$ with rotation angle $\omega \in (0, \pi/2]$. Then we can assume $S = \mathcal{M}(S)$ in [[01. Introduction/00. Preface#^eqn-monotone]] as taking further monotonization does not increase the area.[^monotonization-monotone] For each angle $t \in [0, \omega]$, let $R_t : \mathbb{R}^2 \to \mathbb{R}^2$ be the rotation of $\mathbb{R}^2$ along the origin, and let $\mathbf{x}_S(t)$ be the coordinate of the inner corner of the rotated hallway $L_t$. Then the hallway $L_t = R_t(L) + \mathbf{x}_S(t)$ rotated counterclockwise by angle $t \in [0, \pi/2]$ is determined by its inner corner $\mathbf{x}_S(t)$. So the parametrization $\mathbf{x}_S : [0, \omega] \to \mathbb{R}^2$ of the inner corner with respect to angle $t$, defined as the _rotation path_ of $S$ in [@romikDifferentialEquationsExact2018], determines the monotone sofa
$$
S = H \cap V_\omega \cap \bigcap_{0 \leq t \leq \omega} \left( R_t(L) + \mathbf{x}_S(t) \right) 
$$
completely. In particular, Romik in [@romikDifferentialEquationsExact2018] derived Gerver's sofa $S = S_G$ by solving for the local optimality of area of $S$ as a set of ordinary differential equations on $\mathbf{x}_S$.[^gerver-derivation]

The _injectivity condition_ of $S$ essentially states that the inner corner $\mathbf{x}_S(t)$ is injective with respect to angle $t$.

> __Definition [injectivity].__ (Injectivity condition) A monotone sofa $S$ with rotation angle $\omega \in (0, \pi/2]$ satisfies the _injectivity condition_, if its rotation path $\mathbf{x}_S : [0, \omega] \to \mathbb{R}^2$ is injective and never below the bottom line $y = 0$ of $H$ nor the bottom line $x \cos \omega + y \sin \omega = 0$ of $V_\omega$.
> ^def-injectivity

In particular, Gerver's sofa $S_G$ is a monotone sofa satisfying the injectivity condition (note that the blue trajectory of $\mathbf{x}_{S_G}$ in [[01. Introduction/00. Preface#^fig-gerver]] is injective and never below the bottom line $y=0$). For any monotone sofa satisfying the injectivity condition, the following upper bound is established.

> __Theorem [main].__ (Main theorem) The area of any monotone sofa $S$ with rotation angle $\omega \in (0, \pi/2]$ satisfying the injectivity condition is at most $1 + \omega^2/2$. ^thm-main

So the upper bound of [[01. Introduction/00. Preface#^thm-main]] is effective on a domain of monotone sofas containing the conjectured optimum $S_G$. The upper bound $1 + \omega^2/2$ of [[01. Introduction/00. Preface#^thm-main]] maximizes at $\omega = \pi/2$ with the value $1 + \pi^2/8 = 2.2337\dots$, which is much closer to the lower bound $2.2195\dots$ of Gerver than the currently best upper bound of $2.37$ of Kallus and Romik ([[01. Introduction/00. Preface#^eqn-best-bounds]]). We conjecture that a monotone sofa of maximum area should satisfy the premise of [[01. Introduction/00. Preface#^thm-main]].

> __Conjecture [injectivity].__ (Injectivity hypothesis) There exists a monotone sofa $S$ of maximum area with rotation angle $\omega \in (0, \pi/2]$, satisfying the injectivity condition. ^con-injectivity

With [[01. Introduction/00. Preface#^thm-main]], proving [[01. Introduction/00. Preface#^con-injectivity]] will imply the unconditional upper bound $\mu_{\max} \leq 1 + \pi^2/2 = 2.2337\dots$.

The main idea for proving [[01. Introduction/00. Preface#^thm-main]] is to overestimate the area of a monotone sofa $S$. For the sake of explanation, fix the rotation angle $\omega = \pi/2$. Observe that the lower boundary of Gerver's sofa $S_G$ consists of two red 'tails' and one blue 'core' in [[01. Introduction/00. Preface#^fig-gerver]]. The core is parametrized by the inner corner $\mathbf{x}_{S_G}(t)$ for the interval $t \in [\varphi, \pi/2 - \varphi]$ with constant $\varphi = 0.0392\dots$ [@romikDifferentialEquationsExact2018], and forms the majority of the lower boundary. The region below the two tails, trimmed out by the inner left and right walls of $L_t$ respectively, constitutes only about $0.28 \%$ of the area $2.2195\dots$ of the whole sofa. Motivated by this, we define the overestimation $\mathcal{A}_1$ of the area $\mathcal{A}$ of a monotone sofa $S$ with rotation angle $\pi/2$ as: the area of the convex hull $K$ of $S$, that we call the _cap_ of $S$, subtracted by the region enclosed by $\mathbf{x}_S : [0, \omega] \to \mathbb{R}^2$ and the line $y=0$.

Another key idea for proving [[01. Introduction/00. Preface#^thm-main]] is to consider the area of $S$ as a function of the cap $K$. By doing so, we turn the problem to a quadratic optimization problem in convex analysis. In particular, the overestimated area $\mathcal{A}_1(K)$ as a function of the cap $K$ turns out to be a _concave_ and _quadratic_ functional with respect to the cap $K$. To justify this, we first construct the space $\mathcal{K}_\omega$ of all possible caps $K$ with a fixed rotation angle $\omega$. The space $\mathcal{K}_\omega$ itself is a convex space equipped with convex combination $c_\lambda(K_1, K_2) = (1 - \lambda) K_1 + \lambda K_2$ defined by the Minkowski sum of convex bodies. Then the Brunn-Minkowski theory [[@schneider_2013]] is used to establish that $\mathcal{A}_1$ is a quadratic functional on $\mathcal{K}_\omega$. We use Mamikon's theorem [@mnatsakanianAnnularRingsEqual1997], a theorem in classical geometry, to prove that $\mathcal{A}_1$ concave on $\mathcal{K}_\omega$. Finally, we introduce a calculus of variation based on the Brunn-Minkowski theory to find a local optimum $K_1$ of $\mathcal{A}_1$. Since $\mathcal{A}_1$ is concave, the local optimum $K_1$ is also a global optimum of $\mathcal{A}_1$, and [[01. Introduction/00. Preface#^thm-main]] is established by computing the maximum value $\mathcal{A}_1(K_1) = 1 + \omega^2/2$ of $\mathcal{A}_1$.

For the rotation angle $\omega = \pi/2$, the maximizer of $\mathcal{A}_1$ gives an unmovable sofa $S_1$ of area $1 + \pi^2/8 = 2.2337\dots$ very close to the area of Gerver's sofa $S_G$ (see [[01. Introduction/00. Preface#^fig-presofa]]). The shape of $S_1$ is very close to $S_G$, and cutting away the region under the red curves from $S_1$ gives a valid moving sofa of area approximately $2.2009\dots$, which is again very close to $S_G$ in its shape and area. The boundary of $S_1$ consists of three line segments and three parametric curves. The right side of $S_1$ is parametrized by the curve $\gamma : [0, \pi/2] \to \mathbb{R}^2$ with $\gamma(0) = (1, 1)$ and $\gamma'(t) = t(\cos t, -\sin t)$, which ends at $\gamma(\pi/2) = (\pi/2, 0)$. The left side of $S_1$ is parametrized by the curve symmetric to $\gamma$ along the $y$-axis. The center of the bottom part of $S_1$ is parametrized by the curve $\mathbf{x}_{S_1} : [0, \pi/2] \to \mathbb{R}^2$ with $\mathbf{x}_{S_1}(0) = (\pi/2-1, 0)$ and
$$
\mathbf{x}_{S_1}'(t) = -t (\cos t, \sin t) + (\pi/2- t) (-\sin t, \cos t)
$$
which is symmetric along the $y$-axis. The endpoints of the three curves are connected by three horizontal line segments of length 1 or 2 to form the boundary of $S_1$.

> __Figure [presofa].__ The maximizing shape $S_1$ of $\mathcal{A}_1$ of area $1 + \pi^2/8 = 2.2337\dots$. The regions below two tails (red curves) stick out of the hallway $L$ during the movement of $S_1$ in $L$ (left). The shape $S_1$ is very similar to Gerver's sofa $S_G$ whose boundary is drawn in dotted lines (right). ^fig-presofa
> 
> ![100%](images/presofa-combined.svg)

# Outline of the Paper

[[10. Notations and conventions/00. Preface]] contains basic definitions that will be used thoroughout this paper. Since [[10. Notations and conventions/00. Preface]] is comprehensive, the reader is not expected to read everything there in one setting. Instead, the reader can start off by reading the definitions on moving sofas and convex bodies, and later refer to the parts of this section as needed.

[[15. Monotone sofas/00. Preface]] proves [[15. Monotone sofas/10. Monotonization#^thm-monotonization-is-sofa]] that any moving sofa can be enlarged to a monotone sofa, and proves structural [[15. Monotone sofas/12. Structure of a monotone sofa#^thm-monotone-sofa-structure]] and [[15. Monotone sofas/15. Cap contains niche#^thm-niche-in-cap]] on monotone sofas. Using this, [[20. Sofa area functional/00. Preface]] reduces the moving sofa problem to the maximization of the _sofa area functional_ $\mathcal{A} : \mathcal{K}_\omega \to \mathbb{R}$ on the space of all possible caps $\mathcal{K}_\omega$. [[25. Upper bound A1/00. Preface]] proves the main [[01. Introduction/00. Preface#^thm-main]] by establishing the upper bound $1 + \omega^2/2$ of the sofa area $\mathcal{A}$ using the upper bound $\mathcal{A}_1$. Read the introduction of each chapter for their detailed outline.

[[A1. Convex bodies/00. Preface]] proves numerous properties of an arbitrary planar convex body $K$ that we will use thoroughly in this paper. So the logical ordering of this paper is [[10. Notations and conventions/00. Preface]], followed by [[A1. Convex bodies/00. Preface]], then the sections starting [[15. Monotone sofas/00. Preface]]. A logically inclined reader may read in this ordering to verify the correctness of all arguments. On the other hand, readers who are interested in the overall idea may either start by reading the sections in order and refer to the appendix when needed, or skim the introduction of each section of [[A1. Convex bodies/00. Preface]] then read the rest of the paper.

[^gerver-derivation]: Gerver assumed five stages of the movement of a sofa to derive his sofa $S_G$ [@gerverMovingSofaCorner1992]. While his sofa $S_G$ is locally optimal (Theorem 2 of [@gerverMovingSofaCorner1992]), this does not eliminate the possibility of a maximum-area sofa with a different kind of movement. Romik's simplified derivation of $S_G$ in [@romikDifferentialEquationsExact2018] also relies on the same assumption (Equation 24, p324 of [@romikDifferentialEquationsExact2018]). So their derivations do not constitute a full proof of Gerver's conjecture $\mu_{\max} = \mu_G$.

[^experiments]: Wagner used Monte Carlo simulation to find an approximate solution (Figure 2 of [@wagner1976sofa]) that resembles Gerver's sofa in shape. More recent approximate solutions, as found by Gibbs [@gibbsComputationalStudySofas] in 2014 and Batsch [@batschNumericalApproachAnalysing2022] in 2022, deviate in area from Gerver's sofa by small margins of $1.7 \times 10^{-7}$ and $5.7 \times 10^{-9}$ respectively.

[^rotation-angle]: As an inverse Kakeya problem, it may occur that smaller value of total rotation angle $\omega$ will lead to less movement of $S$ and thus a larger area of $S$. However, the extra constraints that $S$ has to move from horizontal side $L_H$ to vertical side $L_V$ penalizes the area of $S$ as $\omega$ gets smaller from $\pi/2$.

[^translation]: Translating the moving sofa $S$ may invalidate the initial condition $S \subseteq L_H$. To resolve this, we modify the [[10. Notations and conventions/00. Preface#^def-sofa]] of a moving sofa $S$ in so that only some _translation_ of $S$ is required to be movable from $L_H$ to $L_V$ inside $L$.

[^connectedness]: This uses an implicit assumption that the intersection $\mathcal{M}(S)$ should be connected. Indeed, [@gerverMovingSofaCorner1992] assumes the connectedness of $\mathcal{M}(S)$ in its proof of Theorem 1 of [@gerverMovingSofaCorner1992] without any justification. We justify this assumption rigorously in [[15. Monotone sofas/10. Monotonization#^thm-monotonization-is-connected]].

[^monotonization-monotone]: In fact, that $S$ attains the maximum-area only guarantees that $\mathcal{M}(S) \setminus S$ is of measure zero. We show in [[15. Monotone sofas/12. Structure of a monotone sofa#^thm-monotonization-fixpoint]] that for any monotone sofa, we have $\mathcal{M}(S) = S$.