Moving a large couch through a narrow hallway requires not only strength but also well-planned pivoting. The _moving sofa problem_, first published by Leo Moser in 1966, is a two-dimensional idealization of such a situation:

> What is the largest area $\mu_{\text{max}}$ of a connected shape that can move around the right-angled corner of a hallway with unit width?

More precisely, define the hallway $L$ as the union $L = L_H \cup L_V$ of sets $L_H = (-\infty, 1] \times [0, 1]$ and $L_V = [0, 1] \times (-\infty, 1]$ representing the horizontal and vertical side of $L$ respectively. A _moving sofa_ $S$ may be defined as a connected subset of $L_H$ that can be moved inside $L$ by a continuous rigid motion to a subset of $L_V$. It is known that there exists a moving sofa attaining the maximum area $\mu_{\text{max}}$ [[@gerverMovingSofaCorner1992]], but the precise value of $\mu_{\text{max}}$ remains unknown despite decades of attempts.

The best bounds currently known on $\mu_{\max}$ are summarized as ^eqn-best-bounds
$$
2.2195\dots \leq \mu_{\max} \leq 2.37.
$$
The lower bound $2.2195\dots \leq \mu_{\max}$ comes from Gerver's sofa $S_G$ of area $\mu_G := 2.2195\dots$ ([[01. Moving sofa problem#^fig-gerver]]) constructed in 1994. Gerver conjectured that his sofa attains the maximum possible area, so that $\mu_G = \mu_{\max}$, and approximate solutions found by computer experiments are consistent with his conjecture.[^experiments] On the other hand, the upper bound $\mu_{\max} \leq 2.37$ was proved by Kallus and Romik [[@kallusImprovedUpperBounds2018]] using computer assistance.

> __Figure [gerver].__ Gerver's sofa $S_G$. The ticks denote the endpoints of each analytic curve constituting the boundary of $S_G$. The lower portion of $S_G$ consists of two 'tails' (depicted red) and one 'core' (depicted blue). ^fig-gerver
> 
> ![70%](images/gerver-sofa.svg)

> __Conjecture [gerver].__ (Gerver's conjecture) Gerver's sofa $S_G$ attains the maximum area $\mu_{\max} = \mu_G$. ^con-gerver

The _rotation angle_ $\omega$ of a moving sofa $S$ is the clockwise angle that $S$ rotates as it moves from $L_H$ to $L_V$ inside $L$. Gerver's sofa has the rotation angle $\omega = 90^{\circ}$. On the other hand, the unit square $[0, 1]^2$ can move inside $L$ with only translation, so it has rotation angle $\omega = 0^\circ$. If $\omega$ is the rotation angle of a moving sofa of maximum area, [[@gerverMovingSofaCorner1992]] showed that we can assume $\omega \in [60^\circ, 90^\circ]$, and [[@kallusImprovedUpperBounds2018]] improved this by showing that $\omega \in [81.203\dots^\circ, 90^\circ]$ where the lower bound is $\arcsin(84/85)$. With this, we will only consider moving sofas with rotation angle $\omega \in (0^\circ, 90^\circ]$, and it seems reasonable to conjecture that a maximum-area moving sofa have $\omega = 90^\circ$.

> __Conjecture [angle].__ (Angle Hypothesis) There exists a maximum-area moving sofa with a movement of rotation angle $\omega = 90^\circ$. ^con-angle

> __Remark [angle].__ A single moving sofa $S$ may admit different movements in $L$ with varying rotation angles $\omega$. For any moving sofa $S$ mentioned in this paper, we will always assume a fixed rotation angle $\omega$ attached to it. So any moving sofa $S$ mentioned in this paper is technically the tuple of a shape and its fixed rotation angle. In this way, we can talk about _the_ rotation angle of a moving sofa $S$. ^rem-angle

Both bounds in [[01. Moving sofa problem#^eqn-best-bounds]] are based on the observations of Gerver in [[@gerverMovingSofaCorner1992]] that we sketch as follows. For the sake of explanation, we outline his ideas for the rotation angle $\omega = 90^\circ$, although his ideas generalize to every angle $\omega \in (0, \pi/2]$. He looked at the hallway $L$ from the perspective of the moving sofa $S$ in movement (see [[01. Moving sofa problem#^fig-monotone-sofa]]). In this perspective, a moving sofa $S$ with $\omega = \pi/2$ is always contained in the unit-width strip $H = \mathbb{R} \times [0, 1]$, and for every angle $t \in [0, \pi/2]$ a hallway $L_t$ rotated counterclockwise by an angle of $t$.[^intermediate-angle] We can also assume that the outer walls of each $L_t$ make contact with the sofa $S$, by pushing each $L_t$ in the directions orthogonal to the outer walls towards $S$ while fixing $S$.[^hallway-pov] After doing so, the envelope of the outer walls of $L_t$ will form the upper portion of the boundary of $S$. Finally, Gerver observed that for a maximum-area moving sofa $S$ with $\omega = 90^\circ$, we can simply assume that $S$ is the intersection of $H$ and the rotating hallways $L_t$ for all $t \in [0, \pi/2]$.

> __Figure [monotone-sofa].__ The movement of a monotone sofa $S$ in perspective of the hallway (left) and the sofa (right). The monotone sofa $S$ is equal to the cap $K$ minus its niche $N$. The cap $K$ is a convex body with the outer walls of $L_t = L_S(t)$ as tangent lines of $K$ (and $S$). The niche $N$ is the union of all triangular regions bounded by the inner walls of $L_t = L_S(t)$. ^fig-monotone-sofa
> 
> ![100%](images/monotone-sofa.svg)

In this paper, we rigorously define such maximum-area moving sofas $S$ from Gerver's observations over all rotation angle $\omega \in (0, \pi/2]$ as _monotone sofas_ ([[10. Monotonization#^def-monotone-sofa]]; see [[01. Introduction/01. Moving Sofa Problem#^fig-monotone-sofa]] for a picture). So for $\omega = \pi/2$ in particular, any monotone sofa $S$ is the intersection of $H$ and the hallways $L_t$ rotating around $S$ making contact with $S$ in the outer walls. Gerver's observations in [[@gerverMovingSofaCorner1992]] can be summarized as:

> __Theorem [monotone-sofa].__ There exists a monotone sofa with rotation angle $\omega \in (0, \pi/2]$. ^thm-monotone-sofa

It turns out that his proof of [[01. Introduction/01. Moving sofa problem#^thm-monotone-sofa]] in [[@gerverMovingSofaCorner1992]] has a logical gap that we fill in [[15. Monotone sofas/10. Monotonization#^thm-monotonization-is-connected]].

For a monotone sofa $S$ with the hallways $L_t$ containing $S$ and rotating counterclockwise by an angle of $t \in [0, \pi/2]$, the inner corner $\mathbf{x}_S(t)$ of $L_t$ completely determines the location of $L_t$. So the trajectory $\mathbf{x}_S : [0^\circ,90^\circ] \to \mathbb{R}^2$ of the inner corner, defined as the _rotation path_ of $S$ by [[@romikDifferentialEquationsExact2018]], determines the monotone sofa $S$ which is the intersection of $H$ and $L_t$ completely. In particular, [[@romikDifferentialEquationsExact2018]] derived Gerver's sofa by solving the area optimality condition as a set of ordinary differential equations on $\mathbf{x}_S$. In this paper, we establish the following conditional upper bound on monotone sofas with injective rotation path $\mathbf{x}_S$.

> __Theorem [main].__ For any monotone sofa $S$ with rotation angle $\omega = 90^{\circ}$, if the rotation path $\mathbf{x}_S : [0^\circ, 90^\circ] \to \mathbb{R}^2$ of $S$ is injective, and it is always on or above the bottom line $y = 0$ of $H$, then the area of $S$ is at most $1 + \pi^2/8 = 2.2337\dots$. ^thm-main

The upper bound $2.2337\dots$ is conditional but much closer to the lower bound $2.2195\dots$ of Gerver than the currently best upper bound of $2.37$ of Kallus and Romik. Note that the rotation path $\mathbf{x}_{S_G}$ of Gerver's sofa $S_G$ is also injective and always on or above the bottom line $y = 0$ of $H$ ([[01. Moving sofa problem#^fig-gerver]]). So the bound of [[01. Moving sofa problem#^thm-main]] is effective on a domain containing the conjectured maximum $S_G$. We conjecture that a monotone sofa of maximum area satisfies the premise of [[01. Moving sofa problem#^thm-main]].

> __Conjecture [injectivity].__ (Injectivity Hypothesis) There exists a monotone sofa $S$ of maximum area with rotation angle $\omega = 90^\circ$, such that the rotation path $\mathbf{x}_S : [0^\circ, 90^\circ] \to \mathbb{R}^2$ is injective and always on or above the line $y = 0$. ^con-injectivity

So the bound in [[01. Moving sofa problem#^thm-main]] can be made unconditional if the angle and injectivity hypotheses are true.

The lower portion of the boundary of Gerver's sofa $S_G$ consists of two 'tails' and one 'core' (see [[01. Introduction/01. Moving Sofa Problem#^fig-gerver]]). The core forms the majority of the lower boundary of $S_G$, and it is the trajectory of the inner corner $\mathbf{x}_{S_G}(t)$ for $t \in [\varphi, \pi/2 - \varphi]$ with $\varphi = 0.0392\dots$ [[@romikDifferentialEquationsExact2018]]. The left and right 'tail's are convex curves forming the envelopes of the inner left and right wall of the rotating hallways $L_t$ in contact with $S_G$ respectively. Our main idea for proving [[01. Moving sofa problem#^thm-main]] is to overestimate the area of a monotone sofa $S = S_G$ by subtracting only the area bounded by the rotation path $x_S(t)$ for all $t \in [0, \pi/2]$, ignoring the extra area taken away by the tails. As a result, the optimum of $\mathcal{A}_1$ gives a 'pre-sofa' $S_1$ which is not an actual moving sofa in the sense that a small portion at each ends of the inner corner extrudes out of the inner walls of $L$ during its movement.

In [[20. Sofa area functional/00. Preface]], we reduce the moving sofa problem to the maximization of the _sofa area functional_ $\mathcal{A} : \mathcal{K}_\omega \to \mathbb{R}$ ([[20. Sofa area functional/00. Preface#^def-sofa-area-functional]]) on the space of caps $\mathcal{K}_\omega$ ([[20. Sofa area functional/00. Preface#^def-cap-space]]). In particular, we change the main [[01. Moving sofa problem#^thm-main]] to [[20. Sofa area functional/00. Preface#^thm-main-cap]], which is a conditional upper bound of the sofa area functional for an arbitrary rotation angle $\omega$.

In [[25. Upper bound A1/00. Preface]], we prove [[20. Sofa area functional/00. Preface#^thm-main-cap]] by establishing the upper bound $\mathcal{A}_1 : \mathcal{K}_\omega \to \mathbb{R}$ of the sofa area functional $\mathcal{A}$. We will (i) observe that the domain of $\mathcal{A}_1$ (the space of caps $\mathcal{K}_\omega$) is convex, (ii) show that $\mathcal{A}$ is concave and quadratic, and (iii) finally show that the maximum value of $\mathcal{A}_1$ is $1 + \pi^2/8$, by introducing a calculus of variation on $\mathcal{A}_1$ based on the Brunn-Minkowski theory of convex bodies.

[[A1. Convex bodies/00. Preface]] proves numerous properties on a general planar convex body $K$ that we will need in this paper. Logical precedence of this paper is in the order of definitions in [[01. Introduction/05. Notations and conventions]], followed by [[A1. Convex bodies/00. Preface]] then the rest of the papers starting [[15. Monotone sofas/00. Preface]]. However, since the contents of [[A1. Convex bodies/00. Preface]] are rudimentary facts on planar convex bodies and not the main focus of this paper, it is recommended to read the sections in order and refer to the appendix when needed.

[^experiments]: Wagner used Monte Carlo simulation to find an approximate solution (Figure 2 of [[@wagner1976sofa]]) that resembles Gerver's sofa in shape. Recent approximate solutions for sofas, as found by Gibbs [[@gibbsComputationalStudySofas]] in 2014 and Batsch [[@batschNumericalApproachAnalysing2022]] in 2022, deviate in area from Gerver's sofa by small margins of $1.7 \times 10^{-7}$ and $5.7 \times 10^{-9}$, respectively.

[^intermediate-angle]: The sofa $S$ is rotated initially by $0^\circ$ and finally by $90^\circ$. Use the intermediate value theorem on the rotation of $S$ during its movement.

[^hallway-pov]: In perspective of the hallway $L$, this is equivalent to translating the sofa $S$ rotated clockwise by $t$ inside $L$ towards the outer walls $x=1$ and $y=1$ of $L$.