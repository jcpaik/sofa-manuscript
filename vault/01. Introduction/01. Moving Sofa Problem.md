Moving a large couch through a narrow hallway requires not only strength but also well-planned pivoting. The _moving sofa problem_, first published by Leo Moser in 1966, is a two-dimensional idealization of such a situation:

> What is the largest area $\mu_{\text{max}}$ of a planar shape that can move around the right-angled corner of a hallway with unit width?

More precisely, define the hallway $L$ as the union $L = L_H \cup L_V$ of sets $L_H = (-\infty, 0] \times [-1, 0]$ and $L_V = [-1, 0] \times (-\infty, 0]$ representing the horizontal and vertical side of $L$ respectively. A _moving sofa_ $S$ may be defined as a planar subset of $L_H$ that can be moved inside $L$ by a continuous rigid motion to a subset of $L_V$. It is known that there exists a moving sofa attaining the maximum area $\mu_{\text{max}}$ [[@gerverMovingSofaCorner1992]], but the precise value of $\mu_{\text{max}}$ remains unknown despite decades of attempts.

The currently best known bounds on $\mu_{\max}$ are summarized as the following. ^best-bounds
$$
2.2195\dots \leq \mu_{\max} \leq 2.37
$$
The lower bound $2.2195\dots \leq \mu_{\max}$ comes from Gever's sofa $S_G$ of area $\mu_G := 2.2195\dots$ ([[01. Moving sofa problem#^fig-gerver]]) constructed in 1994. Gerver conjectured that his sofa attains the maximum possible area, so that $\mu_G = \mu_{\max}$. Computer experiments suggest numerically maximum-area sofas that look like Gerver's sofa, supporting his conjecture. On the other hand, the upper bound $\mu_{\max} \leq 2.37$ was proved by Kallus and Romik [[@kallusImprovedUpperBounds2018]] using computer assistance.

> __Figure [gerver].__ Gerver's sofa $S_G$. ^fig-gerver
> 
> ![70%](images/gerver.svg)

> __Conjecture [gerver].__ (Gerver's conjecture) Gerver's sofa $S_G$ attains the maximum area $\mu_{\max} = \mu_G$. ^con-gerver

The _rotation angle_ $\omega$ of a moving sofa $S$ is the clockwise angle that $S$ rotates as it moves from $L_H$ to $L_V$ inside $L$. Gerver's sofa have the rotation angle $\omega = 90^{\circ}$. On the other hand, the unit square $[0, 1]^2$ can move inside $L$ with only translation, so it has rotation angle $\omega = 0^\circ$. If $\omega$ is the rotation angle of a moving sofa of maximum area, [[@gerverMovingSofaCorner1992]] showed that we can assume $\omega \in [60^\circ, 90^\circ]$, and [[@kallusImprovedUpperBounds2018]] improved this by showing that $\omega \in [81.203\dots^\circ, 90^\circ]$ where the lower bound is $\arcsin(84/85)$. With this, we will only consider moving sofas with rotation angle $\omega \in (0^\circ, 90^\circ]$, and it seems reasonable to conjecture that a maximum-area moving sofa have $\omega = 90^\circ$.

> __Conjecture [angle].__ (Angle Hypothesis) There exists a maximum-area moving sofa with a movement of rotation angle $\omega = 90^\circ$. ^con-angle

Both bounds in [[01. Moving sofa problem#^best-bounds]] are based on the observations of Gerver in [[@gerverMovingSofaCorner1992]] that we sketch as follows. Assuming the rotation angle $\omega = 90^\circ$, he looked at the hallway $L$ from the perspective of the moving sofa $S$ in movement (see [[01. Moving sofa problem#^fig-monotone-sofa]]). In this perspective, a moving sofa $S$ is always contained in the unit-width strip $H = \mathbb{R} \times [-1, 0]$, and for each angle $t \in [0, \pi/2]$, a hallway $L_t$ rotated counterclockwise by an angle of $t$ (use the intermediate value theorem on the rotation of $S$ during its movement). We can also assume that the outer walls of each $L_t$ make contact with the sofa $S$ by pushing each $L_t$ in the directions orthogonal to the outer walls towards $S$. After doing so, the envelope of the outer walls of $L_t$ will form the upper portion of the boundary of $S$. Finally, Gerver observed that for a maximum-area $S$ we can simply assume that $S$ is the intersection of $H$ and $L_t$ for all $t \in [0, \pi/2]$.

> __Figure [monotone-sofa].__ The movement of a moving sofa $S$ in perspective of the hallway (left) and the sofa (right). The sofa $S$ is monotone and equal to the cap $K$ (with the outer walls of $L_t = L_S(t)$ forming the tangent lines of $S$) minus its niche $N$ (the union of all triangular regions bounded by the inner walls of $L_t = L_S(t)$). ^fig-monotone-sofa
> 
> ![100%](images/monotone-sofa.svg)

In this paper, we call such a maximum-area moving sofa $S$ from Gerver's observations a _monotone sofa_ (a full [[10. Monotonization#^def-monotone-sofa]] is given in Section 1), so that any monotone sofa $S$ is the intersection of $H$ and the hallways $L_t$ rotating around $S$ making contact with $S$ in the outer walls. Gerver's observations can be summarized as the following.

> __Theorem [monotone-sofa].__ A moving sofa of maximum area can be assumed to be a monotone sofa. ^thm-monotone-sofa

For a monotone sofa $S$ with the hallways $L_t$ containing $S$ and rotating counterclockwise by an angle of $t \in [0, \pi/2]$, the inner corner $\mathbf{x}_S(t)$ of $L_t$ completely determines the location of $L_t$. So the trajectory $\mathbf{x}_S : [0^\circ,90^\circ] \to \mathbb{R}^2$ of the inner corner, defined as the _rotation path_ of $S$ by [[@romikDifferentialEquationsExact2018]], determines the monotone sofa $S$ which is the intersection of $H$ and $L_t$ completely. In particular, [[@romikDifferentialEquationsExact2018]] derived Gerver's sofa by solving the area optimality condition as a set of ordinary differential equations on $\mathbf{x}_S$. In this paper, we establish the following conditional upper bound on monotone sofas with injective rotation path $\mathbf{x}_S$.

> __Theorem [main].__ For any monotone sofa $S$ with rotation angle $\omega = 90^{\circ}$, if the rotation path $\mathbf{x}_S : [0^\circ, 90^\circ] \to \mathbb{R}^2$ of $S$ is injective, and it is always on or above the bottom line $y = -1$ of $H$, then the area of $S$ is at most $1 + \pi^2/8 = 2.2337\dots$. ^thm-main

The upper bound $2.2337\dots$ is conditional but much closer to the lower bound $2.2195\dots$ of Gerver than the currently best upper bound of $2.37$ of Kallus and Romik. Note that the rotation path $\mathbf{x}_{S_G}$ of Gerver's sofa $S_G$ is also injective and always on or above the bottom line $y = -1$ of $H$ ([[01. Moving sofa problem#^fig-gerver]]). So the bound of [[01. Moving sofa problem#^thm-main]] is effective on a domain containing the conjectured maximum $S_G$. We conjecture that a monotone sofa of maximum area satisfies the premise of [[01. Moving sofa problem#^thm-main]].

> __Conjecture [injectivity].__ (Injectivity Hypothesis) There exists a monotone sofa $S$ of maximum area with rotation angle $\omega = 90^\circ$, such that the rotation path $\mathbf{x}_S : [0^\circ, 90^\circ] \to \mathbb{R}^2$ is injective and always on or above the line $y = -1$. ^con-injectivity

So the bound in [[01. Moving sofa problem#^thm-main]] can be made unconditional if the angle and injectivity hypotheses are true.

The boundary of Gerver's sofa $S_G$ at the bottom side consists of the three curve segments that we will call the 'core' and the left/right 'tail's of $S_G$ respectively. The core is the trajectory of the inner corner $\mathbf{x}_{S_G}(t)$ for $t \in [\psi, \pi/2 - \psi]$ with constant $\psi = \dots$, which forms the majority of the boundary of $S_G$ at the bottom. The left and right 'tail's are convex curves forming the envelopes of the inner left and right wall of the rotating hallways $L_t$ in contact with $S_G$ respectively. Our main idea for proving [[01. Moving sofa problem#^thm-main]] is to overestimate the area of a monotone sofa $S = S_G$ by subtracting only the area bounded by the rotation path $x_S(t)$ for all $t \in [0, \pi/2]$, ignoring the extra area taken away by the tails. As a result, the optimum of $\mathcal{A}_1$ gives a 'pre-sofa' $S_1$ which is not an actual moving sofa in the sense that a small portion at each ends of the inner corner extrudes out of the inner walls of $L$ during its movement.

In [[15. Monotone sofas/00. Preface|00. Preface]], we rigorously define monotone sofas ([[10. Monotonization#^def-monotone-sofa]]) and establish [[01. Moving sofa problem#^thm-monotone-sofa]] by filling out a logical gap ([[10. Monotonization#^thm-monotonization-is-connected]]) of Gerver's proof in [[@gerverMovingSofaCorner1992]]. Moreover, we show that any monotone sofa $S$ is equal to $K \setminus \mathcal{N}(K)$ in [[12. Structure of a monotone sofa#^thm-monotonization-structure]], where $K = \mathcal{C}(S)$ is some convex set called the _cap of_ $S$ ([[12. Structure of a monotone sofa#^thm-cap-hallway-intersection]]), and $\mathcal{N}(K)$ is a subset of $K$ called the _niche_ ([[12. Structure of a monotone sofa#^def-niche]]) determined by the cap $K$ (see [[01. Moving sofa problem#^fig-monotone-sofa]]).

In Section 3, we reduce the moving sofa problem to the maximization of the _sofa area functional_ $\mathcal{A} : \mathcal{K}_\omega \to \mathbb{R}$ ([[20. Sofa area functional/00. Preface#^def-sofa-area-functional]]) on the space of caps $\mathcal{K}_\omega$ ([[20. Sofa area functional/00. Preface#^def-cap-space]]). In particular, we change the main [[01. Moving sofa problem#^thm-main]] to [[20. Sofa area functional/00. Preface#^thm-main-cap]], which is a conditional upper bound of the sofa area functional for an arbitrary rotation angle $\omega$.

In Section 4, we prove [[20. Sofa area functional/00. Preface#^thm-main-cap]] by establishing the upper bound $\mathcal{A}_1 : \mathcal{K}_\omega \to \mathbb{R}$ of the sofa area functional $\mathcal{A}$. We will (i) observe that the domain of $\mathcal{A}_1$ (the space of caps $\mathcal{K}_\omega$) is convex, (ii) show that $\mathcal{A}$ is concave and quadratic, and (iii) finally show that the maximum value of $\mathcal{A}_1$ is $1 + \pi^2/8$, by introducing a calculus of variation on $\mathcal{A}_1$ based on the Brunn-Minkowski theory of convex bodies.