> __Definition [varphi-constants].__ Fix absolute constants $\varphi_R = \varphi$ and $\varphi_L = \pi/2 - \varphi$, where the constant $\varphi$ comes from the derivation of Gerver's sofa (). ^def-varphi-constants

> __Remark [varphi-constants].__ Note that $\varphi_R \in (0, \pi/4)$ and $\varphi_L \in (\pi/4, \pi/2)$ in particular. Almost all theorems in this paper will work for arbitrary choice of constants $\varphi_R \in (0, \pi/4)$ and $\varphi_L \in (\pi/4, \pi/2)$. The only exceptions are XX and YY; see Rem XX and YY respectively. ^rem-varphi-constants

> __Definition [left-right-regions].__ Let $K \in \mathcal{K}$ be arbitrary. Define the convex bodies ^def-left-right-regions
$$
B_K := K \cap H_K^b(\varphi_R) \qquad B_K^0 := K \cap \bigcap_{t \in [\varphi_R, \pi/2]} H_K^b(t)
$$
> determined by $K$, so that $B_K^0 \subseteq B_K$. Similarly, define the convex bodies
$$
D_K := K \cap H_K^d(\varphi_L) \qquad D_K^0 := K \cap \bigcap_{t \in [0, \varphi_L]} H_K^d(t)
$$
> determined by $K$, so that $D_K^0 \subseteq D_K$. Define the region $M_K = K \setminus B_K \setminus D_K$.

> __Lemma [cap-left-right-disjoint].__ Let $K \in \mathcal{K}$ be of area $|K| > 2.2$. The the sets $D_K$ and $B_K$ are disjoint. Correspondingly, such a $K$ is a disjoint union of three parts $B_K, M_K, D_K$ from right to left, separated by the lines $b_K(\varphi_R)$ and $d_K(\varphi_L)$. ^lem-cap-left-right-disjoint

> __Lemma [cap-left-right-tail].__ $B_K \setminus B_K^0 = \mathcal{M}_{\mathbf{b}_K}$ and $\mathcal{M}_{\mathbf{b}_K} \subseteq \mathcal{N}_K \cap H_K^b(\varphi_R)$. ^lem-cap-left-right-tail

> __Lemma [tail-curve-area-functional].__ We have $\mathcal{J}\left( \mathbf{b}_K^{\varphi_R} \right) \leq \mathcal{N}_K \cap H_K^b(\varphi_R)$. ^lem-tail-curve-area-functional

Fix the constants $\varphi_R, \varphi_L$ and an arbitrary cap $K \in \mathcal{K}$. To avoid cluttering, write $b := \overline{b}_K(\varphi_R)$ and $H_b := H_K^b(\varphi_R)$, so that $H_b$ is the half-plane bounded by line $b$.

Partition $K$ into the regions $K \cap H_b$, and $K_R = K \cap H_K^d (\varphi_L)$ and $K_M = K \setminus H_K^b(\varphi_R) \setminus H_K^d (\varphi_L)$. 

The curve $\mathbf{x}_K : [\varphi_R, \varphi_L] \to \mathbb{R}^2$ is inside $K_M$ except endpoints because of monotonicity. Take the cone $Y$ bounded by the lines $b$ and $d$. Take the horizontal line $l_h$ described by the equation $y = -h$ for sufficiently large $h > 0$. Take the closed curve. First follow $\mathbf{x} := \mathbf{x}_K|_{[\varphi_R, \varphi_L]}$. Follow the line segment $s_L$ from $\mathbf{x}_K(\varphi_L)$ to $d \cap l_h$. Follow the line segment $s_M$ from $d \cap l_h$ to $b \cap l_h$. Follow the line segment $s_L$ from $b \cap l_h$ to $\mathbf{x}_K(\varphi_L)$. The Jordan arcs $\mathbf{x}$ and $s_L$ and $s_R$ only meet at corresponding endpoints because $\mathbf{x}$ is inside $K_M$ except endpoints, and $s_L \subset d$ and $s_R \subset d$. The $s_M$ only meet with $s_L$ and $S_R$ at corresponding endpoints too for the same reason. Finally, by taking $h$ sufficiently large we can push $s_M$ as down as possible so that $s_M$ is disjoint from $\mathbf{x}$. WIth this, the closed loop $\Gamma$ formed by $\mathbf{x}$, $s_L, s_M, s_R$ forms a Jordan curve, enclosing a region $G$.

Line segments $s_L$, $s_R$, $s_W$, $s_Z$. 

Area $\mathcal{I}(\Gamma) = \mathcal{I}(\mathbf{x}) + \mathcal{I}(s_L) + \mathcal{I}(s_M) + \mathcal{I}(s_R)$. Trapezoid $P$ formed by the vertices $z_K(\varphi_R), d \cap l_h, b \cap l_h, w_K(\varphi_R)$. 

$G \subseteq \left( \mathcal{N}_K \cap K_M \right) \cup P$. Why? Since $\Gamma$ is inside the triangular region $T$ bounded by $b$, $d$, and $l_h$, so is $G \subseteq T$. So it suffices to check $G \setminus T \subseteq G \cap \text{region above } y=0$ is contained inside. For any $p \in G$, shoot a ray $r_p$ above. It never hits $s_M$. If it hits $s_L$, then as $s_L \cap H_0$ is the line connecting $s_R$  

Then $\mathbf{z}_K^{\varphi_R, \varphi_L}$ is a curve below the niche $\mathcal{N}_K$. Define $\mathcal{A}_2^{\varphi_R, \varphi_L}$ as $|K| - \mathcal{I}(\mathbf{z}_K^{\varphi_R, \varphi_L})$.

Correspondingly, define $\mathcal{Q}^{\varphi_R, \varphi_L} : \mathcal{K}^{\varphi_R, \varphi_L}$ as

We embed $\mathcal{K}_{\pi/2}$ in a larger convex space $\mathcal{L}$ and extend $\mathcal{A}_2$ on $\mathcal{K}_{\pi/2}$ to functional $\mathcal{Q}$ on $\mathcal{L}$. Unlike $\mathcal{A}_2$ on $\mathcal{K}_{\pi/2}$, $\mathcal{Q}$ on $\mathcal{L}$ turns out to be quadratic and concave.

> __Definition [cap-tail-space].__ Define the _cap-tail space_ $\mathcal{L}$ as the space of tuples $(K, \mathbf{b}, \mathbf{d})$ of a cap $K \in \mathcal{K}$, curve $\mathbf{b} \in \mathcal{U}^{\pi + \varphi_R, 3\pi/2}$, and curve $\mathbf{d} \in \mathcal{U}^{\pi, \pi + \varphi_L}$ such that the followings are true. ^def-cap-tail-space
> 
> 1. $\sigma_K\left( \left\{ t \right\} \right) = 0$ for all $t \in [0, \pi] \setminus \left\{ \pi/2 \right\}$.
> 2. For every $t \in [\varphi_R, \pi/2]$, we have $h_K(t) + h_{\mathbf{b}}(\pi + t) \leq 1$.
> 3. We have $h_{\mathbf{b}}(\pi + \varphi_R) = 1 - h_K(\varphi_R)$ and $h_\mathbf{b}(3\pi/2) = 0$. That is, the equality in (2) holds for endpoints $t = \varphi_R, \pi/2$.
> 4. For every $t \in [0, \varphi_L]$, we have $p_K(t + \pi/2) + p_{\mathbf{d}}(\pi + t) \leq 1$.
> 5. We have $h_{\mathbf{b}}(\pi + \varphi_R) = 1 - h_K(\varphi_R)$ and $h_\mathbf{b}(3\pi/2) = 0$. That is, the equality in (2) holds for endpoints $t = \varphi_R, \pi/2$.

> __Proposition [extended-cap-space].__ The space $\mathcal{L}^{\varphi_R, \varphi_L}$ is a convex space containing any limiting maximum sofa and Gerver's sofa. ^pro-extended-cap-space

_Proof._ The product $\mathcal{T}$ of convex spaces $\mathcal{K}$, $\mathcal{U}^{\pi + \varphi_R, 3\pi/2}$, and $\mathcal{U}^{\pi, \pi + \varphi_L}$ is naturally a convex space. All conditions in [[c. Optimality of Gerver's Sofa/15. Upper Bound Q/05. Definition of Q#^def-cap-tail-space]] are linear equalities and inequalities on $(K, \mathbf{b}, \mathbf{d}) \in \mathcal{T}$, so restricting $\mathcal{T}$ to such conditions gives a subspace $\mathcal{L}^{\varphi_R, \varphi_L}$ which is a convex space. □

> __Theorem [cap-tail-extension].__ For any $K \in \mathcal{K}$, the triple $(K, \mathbf{b}_K, \mathbf{d}_K)$ is a member of $\mathcal{L}$. Correspondingly, the map $K \mapsto (K, \mathbf{b}_K, \mathbf{d}_K)$ is a well-defined injection $\mathcal{K} \to \mathcal{L}$. ^thm-cap-tail-extension

_Proof._ As $\mathbf{b}_K \in \mathcal{U}^{\pi + \varphi_R, 3\pi/2}$ and $\mathbf{d}_K \in \mathcal{U}^{\pi, \pi + \varphi_L}$ by Def xx, it suffices to check the conditions of [[c. Optimality of Gerver's Sofa/15. Upper Bound Q/05. Definition of Q#^def-cap-tail-space]].

Width conditions: the set $B_K^0$ is contained in $H_K^b(t)$, so holds.
Equality condition: trickier to show. As $B_K^0 \supseteq B_K \setminus \mathcal{N}_K$ and 

□

> __Definition [upper-bound-q].__ Define the function $\mathcal{Q} : \mathcal{L} \to \mathbb{R}$ as ^def-upper-bound-q
$$
\mathcal{Q}^{\varphi_R, \varphi_L}(K, \mathbf{b}, \mathbf{d}) = |K| - \mathcal{J}(\mathbf{b}) - \mathcal{I}(w_K(\varphi_R), \mathbf{x}_K(\varphi_R)) - \mathcal{I}\left( \mathbf{x}_K|_{[\varphi_R, \varphi_L]} \right) - \mathcal{I}(\mathbf{x}_K(\varphi_L), z_K(\varphi_L)) - \mathcal{J}(\mathbf{d}).
$$

